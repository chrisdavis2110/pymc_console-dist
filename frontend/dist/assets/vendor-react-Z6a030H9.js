const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/webgl-device-QoBMYpnS-B_xcj5O_.js","assets/maplibre-gl-B1CfjdFi.css"])))=>i.map(i=>d[i]);
var e,t,n,i,r,o=Object.defineProperty,s=(e,t,n)=>((e,t,n)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);import{g as a}from"./maplibre-gl-b91ci4Kr.js";function l(e,t){for(var n=0;n<t.length;n++){const i=t[n];if("string"!=typeof i&&!Array.isArray(i))for(const t in i)if("default"!==t&&!(t in e)){const n=Object.getOwnPropertyDescriptor(i,t);n&&Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:()=>i[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var c,u,d,h,f={exports:{}},p={},m={exports:{}},g={};function _(){if(c)return g;c=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),s=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.iterator,f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,m={};function _(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}function y(){}function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}_.prototype.isReactComponent={},_.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},_.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=_.prototype;var b=v.prototype=new y;b.constructor=v,p(b,_.prototype),b.isPureReactComponent=!0;var x=Array.isArray,w=Object.prototype.hasOwnProperty,S={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function C(t,n,i){var r,o={},s=null,a=null;if(null!=n)for(r in void 0!==n.ref&&(a=n.ref),void 0!==n.key&&(s=""+n.key),n)w.call(n,r)&&!E.hasOwnProperty(r)&&(o[r]=n[r]);var l=arguments.length-2;if(1===l)o.children=i;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps)void 0===o[r]&&(o[r]=l[r]);return{$$typeof:e,type:t,key:s,ref:a,props:o,_owner:S.current}}function T(t){return"object"==typeof t&&null!==t&&t.$$typeof===e}var k=/\/+/g;function I(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function A(n,i,r,o,s){var a=typeof n;"undefined"!==a&&"boolean"!==a||(n=null);var l=!1;if(null===n)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(n.$$typeof){case e:case t:l=!0}}if(l)return s=s(l=n),n=""===o?"."+I(l,0):o,x(s)?(r="",null!=n&&(r=n.replace(k,"$&/")+"/"),A(s,i,r,"",function(e){return e})):null!=s&&(T(s)&&(s=function(t,n){return{$$typeof:e,type:t.type,key:n,ref:t.ref,props:t.props,_owner:t._owner}}(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(k,"$&/")+"/")+n)),i.push(s)),1;if(l=0,o=""===o?".":o+":",x(n))for(var c=0;c<n.length;c++){var u=o+I(a=n[c],c);l+=A(a,i,r,u,s)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=h&&e[h]||e["@@iterator"])?e:null}(n),"function"==typeof u)for(n=u.call(n),c=0;!(a=n.next()).done;)l+=A(a=a.value,i,r,u=o+I(a,c++),s);else if("object"===a)throw i=String(n),Error("Objects are not valid as a React child (found: "+("[object Object]"===i?"object with keys {"+Object.keys(n).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return l}function L(e,t,n){if(null==e)return e;var i=[],r=0;return A(e,i,"","",function(e){return t.call(n,e,r++)}),i}function R(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},M={transition:null},D={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:M,ReactCurrentOwner:S};function N(){throw Error("act(...) is not supported in production builds of React.")}return g.Children={map:L,forEach:function(e,t,n){L(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return L(e,function(){t++}),t},toArray:function(e){return L(e,function(e){return e})||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},g.Component=_,g.Fragment=n,g.Profiler=r,g.PureComponent=v,g.StrictMode=i,g.Suspense=l,g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,g.act=N,g.cloneElement=function(t,n,i){if(null==t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=p({},t.props),o=t.key,s=t.ref,a=t._owner;if(null!=n){if(void 0!==n.ref&&(s=n.ref,a=S.current),void 0!==n.key&&(o=""+n.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in n)w.call(n,c)&&!E.hasOwnProperty(c)&&(r[c]=void 0===n[c]&&void 0!==l?l[c]:n[c])}var c=arguments.length-2;if(1===c)r.children=i;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:e,type:t.type,key:o,ref:s,props:r,_owner:a}},g.createContext=function(e){return(e={$$typeof:s,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},g.createElement=C,g.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},g.createRef=function(){return{current:null}},g.forwardRef=function(e){return{$$typeof:a,render:e}},g.isValidElement=T,g.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:R}},g.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},g.startTransition=function(e){var t=M.transition;M.transition={};try{e()}finally{M.transition=t}},g.unstable_act=N,g.useCallback=function(e,t){return P.current.useCallback(e,t)},g.useContext=function(e){return P.current.useContext(e)},g.useDebugValue=function(){},g.useDeferredValue=function(e){return P.current.useDeferredValue(e)},g.useEffect=function(e,t){return P.current.useEffect(e,t)},g.useId=function(){return P.current.useId()},g.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},g.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},g.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},g.useMemo=function(e,t){return P.current.useMemo(e,t)},g.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},g.useRef=function(e){return P.current.useRef(e)},g.useState=function(e){return P.current.useState(e)},g.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},g.useTransition=function(){return P.current.useTransition()},g.version="18.3.1",g}function y(){return u||(u=1,m.exports=_()),m.exports}var v=(h||(h=1,f.exports=function(){if(d)return p;d=1;var e=y(),t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function s(e,n,s){var a,l={},c=null,u=null;for(a in void 0!==s&&(c=""+s),void 0!==n.key&&(c=""+n.key),void 0!==n.ref&&(u=n.ref),n)i.call(n,a)&&!o.hasOwnProperty(a)&&(l[a]=n[a]);if(e&&e.defaultProps)for(a in n=e.defaultProps)void 0===l[a]&&(l[a]=n[a]);return{$$typeof:t,type:e,key:c,ref:u,props:l,_owner:r.current}}return p.Fragment=n,p.jsx=s,p.jsxs=s,p}()),f.exports),b=y();const x=a(b),w=l({__proto__:null,default:x},[b]);var S,E,C,T,k,I={},A={exports:{}},L={},R={exports:{}},P={};function M(){if(C)return L;C=1;var e=y(),t=(E||(E=1,R.exports=(S||(S=1,function(e){function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,o=e[i];if(!(0<r(o,t)))break e;e[i]=t,e[n]=o,n=i}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,o=e.length,s=o>>>1;i<s;){var a=2*(i+1)-1,l=e[a],c=a+1,u=e[c];if(0>r(l,n))c<o&&0>r(u,l)?(e[i]=u,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<o&&0>r(u,n)))break e;e[i]=u,e[c]=n,i=c}}}return t}function r(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();e.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,m=!1,g="function"==typeof setTimeout?setTimeout:null,_="function"==typeof clearTimeout?clearTimeout:null,y="undefined"!=typeof setImmediate?setImmediate:null;function v(e){for(var r=n(c);null!==r;){if(null===r.callback)i(c);else{if(!(r.startTime<=e))break;i(c),r.sortIndex=r.expirationTime,t(l,r)}r=n(c)}}function b(e){if(m=!1,v(e),!p)if(null!==n(l))p=!0,P(x);else{var t=n(c);null!==t&&M(b,t.startTime-e)}}function x(t,r){p=!1,m&&(m=!1,_(C),C=-1),f=!0;var o=h;try{for(v(r),d=n(l);null!==d&&(!(d.expirationTime>r)||t&&!I());){var s=d.callback;if("function"==typeof s){d.callback=null,h=d.priorityLevel;var a=s(d.expirationTime<=r);r=e.unstable_now(),"function"==typeof a?d.callback=a:d===n(l)&&i(l),v(r)}else i(l);d=n(l)}if(null!==d)var u=!0;else{var g=n(c);null!==g&&M(b,g.startTime-r),u=!1}return u}finally{d=null,h=o,f=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var w,S=!1,E=null,C=-1,T=5,k=-1;function I(){return!(e.unstable_now()-k<T)}function A(){if(null!==E){var t=e.unstable_now();k=t;var n=!0;try{n=E(!0,t)}finally{n?w():(S=!1,E=null)}}else S=!1}if("function"==typeof y)w=function(){y(A)};else if("undefined"!=typeof MessageChannel){var L=new MessageChannel,R=L.port2;L.port1.onmessage=A,w=function(){R.postMessage(null)}}else w=function(){g(A,0)};function P(e){E=e,S||(S=!0,w())}function M(t,n){C=g(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){p||f||(p=!0,P(x))},e.unstable_forceFrameRate=function(e){0>e||125<e||(T=0<e?Math.floor(1e3/e):5)},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},e.unstable_scheduleCallback=function(i,r,o){var s=e.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?s+o:s,i){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return i={id:u++,callback:r,priorityLevel:i,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(i.sortIndex=o,t(c,i),null===n(l)&&i===n(c)&&(m?(_(C),C=-1):m=!0,M(b,o-s))):(i.sortIndex=a,t(l,i),p||f||(p=!0,P(x))),i},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}}(P)),P)),R.exports);function n(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,r={};function o(e,t){s(e,t),s(e+"Capture",t)}function s(e,t){for(r[e]=t,e=0;e<t.length;e++)i.add(t[e])}var a=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),l=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,u={},d={};function h(e,t,n,i,r,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var f={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){f[e]=new h(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];f[t]=new h(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){f[e]=new h(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){f[e]=new h(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){f[e]=new h(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){f[e]=new h(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){f[e]=new h(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){f[e]=new h(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){f[e]=new h(e,5,!1,e.toLowerCase(),null,!1,!1)});var p=/[\-:]([a-z])/g;function m(e){return e[1].toUpperCase()}function g(e,t,n,i){var r=f.hasOwnProperty(t)?f[t]:null;(null!==r?0!==r.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null==t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,i)&&(n=null),i||null===r?function(e){return!!l.call(d,e)||!l.call(u,e)&&(c.test(e)?d[e]=!0:(u[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,i=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(p,m);f[t]=new h(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(p,m);f[t]=new h(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(p,m);f[t]=new h(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){f[e]=new h(e,1,!1,e.toLowerCase(),null,!1,!1)}),f.xlinkHref=new h("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){f[e]=new h(e,1,!1,e.toLowerCase(),null,!0,!0)});var _=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,v=Symbol.for("react.element"),b=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),I=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),O=Symbol.for("react.offscreen"),B=Symbol.iterator;function z(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=B&&e[B]||e["@@iterator"])?e:null}var U,V=Object.assign;function H(e){if(void 0===U)try{throw Error()}catch(TD){var t=TD.stack.trim().match(/\n( *(at )?)/);U=t&&t[1]||""}return"\n"+U+e}var W=!1;function $(e,t){if(!e||W)return"";W=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(Ko){var i=Ko}Reflect.construct(e,[],t)}else{try{t.call()}catch(Ko){i=Ko}e.call(t.prototype)}else{try{throw Error()}catch(Ko){i=Ko}e()}}catch(Ko){if(Ko&&i&&"string"==typeof Ko.stack){for(var r=Ko.stack.split("\n"),o=i.stack.split("\n"),s=r.length-1,a=o.length-1;1<=s&&0<=a&&r[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(r[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||r[s]!==o[a]){var l="\n"+r[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=a);break}}}finally{W=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?H(e):""}function G(e){switch(e.tag){case 5:return H(e.type);case 16:return H("Lazy");case 13:return H("Suspense");case 19:return H("SuspenseList");case 0:case 2:case 15:return $(e.type,!1);case 11:return $(e.type.render,!1);case 1:return $(e.type,!0);default:return""}}function j(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case x:return"Fragment";case b:return"Portal";case T:return"Profiler";case w:return"StrictMode";case M:return"Suspense";case D:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case k:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case N:return null!==(t=e.displayName||null)?t:j(e.type)||"Memo";case F:t=e._payload,e=e._init;try{return j(e(t))}catch(TD){}}return null}function Y(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j(t);case 8:return t===w?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function X(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=X(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var r=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){i=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Z(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=X(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function Q(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function J(e,t){var n=t.checked;return V({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function ee(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&g(e,"checked",t,!1)}function ne(e,t){te(e,t);var n=q(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?re(e,t.type,n):t.hasOwnProperty("defaultValue")&&re(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function ie(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function re(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var oe=Array.isArray;function se(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ae(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(n(91));return V({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function le(e,t){var i=t.value;if(null==i){if(i=t.children,t=t.defaultValue,null!=i){if(null!=t)throw Error(n(92));if(oe(i)){if(1<i.length)throw Error(n(93));i=i[0]}t=i}null==t&&(t=""),i=t}e._wrapperState={initialValue:q(i)}}function ce(e,t){var n=q(t.value),i=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function ue(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function de(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function he(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?de(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var fe,pe,me=(pe=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((fe=fe||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=fe.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction(function(){return pe(e,t)})}:pe);function ge(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var _e={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ye=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||_e.hasOwnProperty(e)&&_e[e]?(""+t).trim():t+"px"}function be(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=ve(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,r):e[n]=r}}Object.keys(_e).forEach(function(e){ye.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_e[t]=_e[e]})});var xe=V({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function we(e,t){if(t){if(xe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(n(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(n(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(n(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(n(62))}}function Se(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ee=null;function Ce(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Te=null,ke=null,Ie=null;function Ae(e){if(e=kr(e)){if("function"!=typeof Te)throw Error(n(280));var t=e.stateNode;t&&(t=Ar(t),Te(e.stateNode,e.type,t))}}function Le(e){ke?Ie?Ie.push(e):Ie=[e]:ke=e}function Re(){if(ke){var e=ke,t=Ie;if(Ie=ke=null,Ae(e),t)for(e=0;e<t.length;e++)Ae(t[e])}}function Pe(e,t){return e(t)}function Me(){}var De=!1;function Ne(e,t,n){if(De)return e(t,n);De=!0;try{return Pe(e,t,n)}finally{De=!1,(null!==ke||null!==Ie)&&(Me(),Re())}}function Fe(e,t){var i=e.stateNode;if(null===i)return null;var r=Ar(i);if(null===r)return null;i=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(i&&"function"!=typeof i)throw Error(n(231,t,typeof i));return i}var Oe=!1;if(a)try{var Be={};Object.defineProperty(Be,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Be,Be),window.removeEventListener("test",Be,Be)}catch(pe){Oe=!1}function ze(e,t,n,i,r,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Ue=!1,Ve=null,He=!1,We=null,$e={onError:function(e){Ue=!0,Ve=e}};function Ge(e,t,n,i,r,o,s,a,l){Ue=!1,Ve=null,ze.apply($e,arguments)}function je(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ye(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function Xe(e){if(je(e)!==e)throw Error(n(188))}function Ke(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=je(e)))throw Error(n(188));return t!==e?null:e}for(var i=e,r=t;;){var o=i.return;if(null===o)break;var s=o.alternate;if(null===s){if(null!==(r=o.return)){i=r;continue}break}if(o.child===s.child){for(s=o.child;s;){if(s===i)return Xe(o),e;if(s===r)return Xe(o),t;s=s.sibling}throw Error(n(188))}if(i.return!==r.return)i=o,r=s;else{for(var a=!1,l=o.child;l;){if(l===i){a=!0,i=o,r=s;break}if(l===r){a=!0,r=o,i=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===i){a=!0,i=s,r=o;break}if(l===r){a=!0,r=s,i=o;break}l=l.sibling}if(!a)throw Error(n(189))}}if(i.alternate!==r)throw Error(n(190))}if(3!==i.tag)throw Error(n(188));return i.stateNode.current===i?e:t}(e))?Ze(e):null}function Ze(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ze(e);if(null!==t)return t;e=e.sibling}return null}var Qe=t.unstable_scheduleCallback,Je=t.unstable_cancelCallback,et=t.unstable_shouldYield,tt=t.unstable_requestPaint,nt=t.unstable_now,it=t.unstable_getCurrentPriorityLevel,rt=t.unstable_ImmediatePriority,ot=t.unstable_UserBlockingPriority,st=t.unstable_NormalPriority,at=t.unstable_LowPriority,lt=t.unstable_IdlePriority,ct=null,ut=null,dt=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ht(e)/ft|0)|0},ht=Math.log,ft=Math.LN2,pt=64,mt=4194304;function gt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function _t(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,o=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~r;0!==a?i=gt(a):0!==(o&=s)&&(i=gt(o))}else 0!==(s=n&~r)?i=gt(s):0!==o&&(i=gt(o));if(0===i)return 0;if(0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(o=t&-t)||16===r&&4194240&o))return t;if(4&i&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)r=1<<(n=31-dt(t)),i|=e[n],t&=~r;return i}function yt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function vt(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function bt(){var e=pt;return!(4194240&(pt<<=1))&&(pt=64),e}function xt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function wt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-dt(t)]=n}function St(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-dt(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}var Et=0;function Ct(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var Tt,kt,It,At,Lt,Rt=!1,Pt=[],Mt=null,Dt=null,Nt=null,Ot=new Map,Bt=new Map,zt=[],Ut="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vt(e,t){switch(e){case"focusin":case"focusout":Mt=null;break;case"dragenter":case"dragleave":Dt=null;break;case"mouseover":case"mouseout":Nt=null;break;case"pointerover":case"pointerout":Ot.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bt.delete(t.pointerId)}}function Ht(e,t,n,i,r,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},null!==t&&null!==(t=kr(t))&&kt(t),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Wt(e){var t=Tr(e.target);if(null!==t){var n=je(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ye(n)))return e.blockedOn=t,void Lt(e.priority,function(){It(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function $t(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=tn(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=kr(n))&&kt(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);Ee=i,n.target.dispatchEvent(i),Ee=null,t.shift()}return!0}function Gt(e,t,n){$t(e)&&n.delete(t)}function jt(){Rt=!1,null!==Mt&&$t(Mt)&&(Mt=null),null!==Dt&&$t(Dt)&&(Dt=null),null!==Nt&&$t(Nt)&&(Nt=null),Ot.forEach(Gt),Bt.forEach(Gt)}function Yt(e,n){e.blockedOn===n&&(e.blockedOn=null,Rt||(Rt=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,jt)))}function qt(e){function t(t){return Yt(t,e)}if(0<Pt.length){Yt(Pt[0],e);for(var n=1;n<Pt.length;n++){var i=Pt[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Mt&&Yt(Mt,e),null!==Dt&&Yt(Dt,e),null!==Nt&&Yt(Nt,e),Ot.forEach(t),Bt.forEach(t),n=0;n<zt.length;n++)(i=zt[n]).blockedOn===e&&(i.blockedOn=null);for(;0<zt.length&&null===(n=zt[0]).blockedOn;)Wt(n),null===n.blockedOn&&zt.shift()}var Xt=_.ReactCurrentBatchConfig,Kt=!0;function Zt(e,t,n,i){var r=Et,o=Xt.transition;Xt.transition=null;try{Et=1,Jt(e,t,n,i)}finally{Et=r,Xt.transition=o}}function Qt(e,t,n,i){var r=Et,o=Xt.transition;Xt.transition=null;try{Et=4,Jt(e,t,n,i)}finally{Et=r,Xt.transition=o}}function Jt(e,t,n,i){if(Kt){var r=tn(e,t,n,i);if(null===r)Qi(e,t,i,en,n),Vt(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Mt=Ht(Mt,e,t,n,i,r),!0;case"dragenter":return Dt=Ht(Dt,e,t,n,i,r),!0;case"mouseover":return Nt=Ht(Nt,e,t,n,i,r),!0;case"pointerover":var o=r.pointerId;return Ot.set(o,Ht(Ot.get(o)||null,e,t,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,Bt.set(o,Ht(Bt.get(o)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Vt(e,i),4&t&&-1<Ut.indexOf(e)){for(;null!==r;){var o=kr(r);if(null!==o&&Tt(o),null===(o=tn(e,t,n,i))&&Qi(e,t,i,en,n),o===r)break;r=o}null!==r&&i.stopPropagation()}else Qi(e,t,i,null,n)}}var en=null;function tn(e,t,n,i){if(en=null,null!==(e=Tr(e=Ce(i))))if(null===(t=je(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ye(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return en=e,null}function nn(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(it()){case rt:return 1;case ot:return 4;case st:case at:return 16;case lt:return 536870912;default:return 16}default:return 16}}var rn=null,on=null,sn=null;function an(){if(sn)return sn;var e,t,n=on,i=n.length,r="value"in rn?rn.value:rn.textContent,o=r.length;for(e=0;e<i&&n[e]===r[e];e++);var s=i-e;for(t=1;t<=s&&n[i-t]===r[o-t];t++);return sn=r.slice(e,1<t?1-t:void 0)}function ln(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function cn(){return!0}function un(){return!1}function hn(e){function t(t,n,i,r,o){for(var s in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?cn:un,this.isPropagationStopped=un,this}return V(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=cn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=cn)},persist:function(){},isPersistent:cn}),t}var fn,pn,mn,gn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_n=hn(gn),yn=V({},gn,{view:0,detail:0}),vn=hn(yn),bn=V({},yn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==mn&&(mn&&"mousemove"===e.type?(fn=e.screenX-mn.screenX,pn=e.screenY-mn.screenY):pn=fn=0,mn=e),fn)},movementY:function(e){return"movementY"in e?e.movementY:pn}}),xn=hn(bn),wn=hn(V({},bn,{dataTransfer:0})),Sn=hn(V({},yn,{relatedTarget:0})),En=hn(V({},gn,{animationName:0,elapsedTime:0,pseudoElement:0})),Cn=V({},gn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),kn=hn(Cn),In=hn(V({},gn,{data:0})),An={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ln={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Rn[e])&&!!t[e]}function Mn(){return Pn}var Dn=V({},yn,{key:function(e){if(e.key){var t=An[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ln(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Ln[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mn,charCode:function(e){return"keypress"===e.type?ln(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ln(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Nn=hn(Dn),Fn=hn(V({},bn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),On=hn(V({},yn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mn})),Bn=hn(V({},gn,{propertyName:0,elapsedTime:0,pseudoElement:0})),zn=V({},bn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Un=hn(zn),Vn=[9,13,27,32],Hn=a&&"CompositionEvent"in window,Wn=null;a&&"documentMode"in document&&(Wn=document.documentMode);var $n=a&&"TextEvent"in window&&!Wn,Gn=a&&(!Hn||Wn&&8<Wn&&11>=Wn),jn=String.fromCharCode(32),Yn=!1;function qn(e,t){switch(e){case"keyup":return-1!==Vn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Kn=!1,Zn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Zn[e.type]:"textarea"===t}function Jn(e,t,n,i){Le(i),0<(t=er(t,"onChange")).length&&(n=new _n("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var ei=null,ti=null;function ni(e){ji(e,0)}function ii(e){if(Z(Ir(e)))return e}function ri(e,t){if("change"===e)return t}var oi=!1;if(a){var si;if(a){var ai="oninput"in document;if(!ai){var li=document.createElement("div");li.setAttribute("oninput","return;"),ai="function"==typeof li.oninput}si=ai}else si=!1;oi=si&&(!document.documentMode||9<document.documentMode)}function ci(){ei&&(ei.detachEvent("onpropertychange",ui),ti=ei=null)}function ui(e){if("value"===e.propertyName&&ii(ti)){var t=[];Jn(t,ti,e,Ce(e)),Ne(ni,t)}}function di(e,t,n){"focusin"===e?(ci(),ti=n,(ei=t).attachEvent("onpropertychange",ui)):"focusout"===e&&ci()}function hi(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return ii(ti)}function fi(e,t){if("click"===e)return ii(t)}function pi(e,t){if("input"===e||"change"===e)return ii(t)}var mi="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function gi(e,t){if(mi(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!l.call(t,r)||!mi(e[r],t[r]))return!1}return!0}function _i(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function yi(e,t){var n,i=_i(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=_i(i)}}function vi(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?vi(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function bi(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function xi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function wi(e){var t=bi(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&vi(n.ownerDocument.documentElement,n)){if(null!==i&&xi(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,o=Math.min(i.start,r);i=void 0===i.end?o:Math.min(i.end,r),!e.extend&&o>i&&(r=i,i=o,o=r),r=yi(n,o);var s=yi(n,i);r&&s&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),o>i?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Si=a&&"documentMode"in document&&11>=document.documentMode,Ei=null,Ci=null,Ti=null,ki=!1;function Ii(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;ki||null==Ei||Ei!==Q(i)||(i="selectionStart"in(i=Ei)&&xi(i)?{start:i.selectionStart,end:i.selectionEnd}:{anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},Ti&&gi(Ti,i)||(Ti=i,0<(i=er(Ci,"onSelect")).length&&(t=new _n("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=Ei)))}function Ai(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Li={animationend:Ai("Animation","AnimationEnd"),animationiteration:Ai("Animation","AnimationIteration"),animationstart:Ai("Animation","AnimationStart"),transitionend:Ai("Transition","TransitionEnd")},Ri={},Pi={};function Mi(e){if(Ri[e])return Ri[e];if(!Li[e])return e;var t,n=Li[e];for(t in n)if(n.hasOwnProperty(t)&&t in Pi)return Ri[e]=n[t];return e}a&&(Pi=document.createElement("div").style,"AnimationEvent"in window||(delete Li.animationend.animation,delete Li.animationiteration.animation,delete Li.animationstart.animation),"TransitionEvent"in window||delete Li.transitionend.transition);var Di=Mi("animationend"),Ni=Mi("animationiteration"),Fi=Mi("animationstart"),Oi=Mi("transitionend"),Bi=new Map,zi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ui(e,t){Bi.set(e,t),o(t,[e])}for(var Vi=0;Vi<zi.length;Vi++){var Hi=zi[Vi];Ui(Hi.toLowerCase(),"on"+(Hi[0].toUpperCase()+Hi.slice(1)))}Ui(Di,"onAnimationEnd"),Ui(Ni,"onAnimationIteration"),Ui(Fi,"onAnimationStart"),Ui("dblclick","onDoubleClick"),Ui("focusin","onFocus"),Ui("focusout","onBlur"),Ui(Oi,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$i=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wi));function Gi(e,t,i){var r=e.type||"unknown-event";e.currentTarget=i,function(e,t,i,r,o,s,a,l,c){if(Ge.apply(this,arguments),Ue){if(!Ue)throw Error(n(198));var u=Ve;Ue=!1,Ve=null,He||(He=!0,We=u)}}(r,t,void 0,e),e.currentTarget=null}function ji(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var o=void 0;if(t)for(var s=i.length-1;0<=s;s--){var a=i[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&r.isPropagationStopped())break e;Gi(r,a,c),o=l}else for(s=0;s<i.length;s++){if(l=(a=i[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&r.isPropagationStopped())break e;Gi(r,a,c),o=l}}}if(He)throw e=We,He=!1,We=null,e}function Yi(e,t){var n=t[Sr];void 0===n&&(n=t[Sr]=new Set);var i=e+"__bubble";n.has(i)||(Zi(t,e,2,!1),n.add(i))}function qi(e,t,n){var i=0;t&&(i|=4),Zi(n,e,i,t)}var Xi="_reactListening"+Math.random().toString(36).slice(2);function Ki(e){if(!e[Xi]){e[Xi]=!0,i.forEach(function(t){"selectionchange"!==t&&($i.has(t)||qi(t,!1,e),qi(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Xi]||(t[Xi]=!0,qi("selectionchange",!1,t))}}function Zi(e,t,n,i){switch(nn(t)){case 1:var r=Zt;break;case 4:r=Qt;break;default:r=Jt}n=r.bind(null,t,n,e),r=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Qi(e,t,n,i,r){var o=i;if(!(1&t||2&t||null===i))e:for(;;){if(null===i)return;var s=i.tag;if(3===s||4===s){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===s)for(s=i.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;s=s.return}for(;null!==a;){if(null===(s=Tr(a)))return;if(5===(l=s.tag)||6===l){i=o=s;continue e}a=a.parentNode}}i=i.return}Ne(function(){var i=o,r=Ce(n),s=[];e:{var a=Bi.get(e);if(void 0!==a){var l=_n,c=e;switch(e){case"keypress":if(0===ln(n))break e;case"keydown":case"keyup":l=Nn;break;case"focusin":c="focus",l=Sn;break;case"focusout":c="blur",l=Sn;break;case"beforeblur":case"afterblur":l=Sn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=xn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=wn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=On;break;case Di:case Ni:case Fi:l=En;break;case Oi:l=Bn;break;case"scroll":l=vn;break;case"wheel":l=Un;break;case"copy":case"cut":case"paste":l=kn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Fn}var u=!!(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=i;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==h&&null!=(m=Fe(p,h))&&u.push(Ji(p,m,f))),d)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,r),s.push({event:a,listeners:u}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===Ee||!(c=n.relatedTarget||n.fromElement)||!Tr(c)&&!c[wr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?Tr(c):null)&&(c!==(d=je(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(u=xn,m="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Fn,m="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?a:Ir(l),f=null==c?a:Ir(c),(a=new u(m,p+"leave",l,n,r)).target=d,a.relatedTarget=f,m=null,Tr(r)===i&&((u=new u(h,p+"enter",c,n,r)).target=f,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,p=0,f=u=l;f;f=tr(f))p++;for(f=0,m=h;m;m=tr(m))f++;for(;0<p-f;)u=tr(u),p--;for(;0<f-p;)h=tr(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=tr(u),h=tr(h)}u=null}else u=null;null!==l&&nr(s,a,l,u,!1),null!==c&&null!==d&&nr(s,d,c,u,!0)}if("select"===(l=(a=i?Ir(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=ri;else if(Qn(a))if(oi)g=pi;else{g=hi;var _=di}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=fi);switch(g&&(g=g(e,i))?Jn(s,g,n,r):(_&&_(e,a,i),"focusout"===e&&(_=a._wrapperState)&&_.controlled&&"number"===a.type&&re(a,"number",a.value)),_=i?Ir(i):window,e){case"focusin":(Qn(_)||"true"===_.contentEditable)&&(Ei=_,Ci=i,Ti=null);break;case"focusout":Ti=Ci=Ei=null;break;case"mousedown":ki=!0;break;case"contextmenu":case"mouseup":case"dragend":ki=!1,Ii(s,n,r);break;case"selectionchange":if(Si)break;case"keydown":case"keyup":Ii(s,n,r)}var y;if(Hn)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Kn?qn(e,n)&&(v="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(v="onCompositionStart");v&&(Gn&&"ko"!==n.locale&&(Kn||"onCompositionStart"!==v?"onCompositionEnd"===v&&Kn&&(y=an()):(on="value"in(rn=r)?rn.value:rn.textContent,Kn=!0)),0<(_=er(i,v)).length&&(v=new In(v,e,null,n,r),s.push({event:v,listeners:_}),(y||null!==(y=Xn(n)))&&(v.data=y))),(y=$n?function(e,t){switch(e){case"compositionend":return Xn(t);case"keypress":return 32!==t.which?null:(Yn=!0,jn);case"textInput":return(e=t.data)===jn&&Yn?null:e;default:return null}}(e,n):function(e,t){if(Kn)return"compositionend"===e||!Hn&&qn(e,t)?(e=an(),sn=on=rn=null,Kn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Gn&&"ko"!==t.locale?null:t.data}}(e,n))&&0<(i=er(i,"onBeforeInput")).length&&(r=new In("onBeforeInput","beforeinput",null,n,r),s.push({event:r,listeners:i}),r.data=y)}ji(s,t)})}function Ji(e,t,n){return{instance:e,listener:t,currentTarget:n}}function er(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,o=r.stateNode;5===r.tag&&null!==o&&(r=o,null!=(o=Fe(e,n))&&i.unshift(Ji(e,o,r)),null!=(o=Fe(e,t))&&i.push(Ji(e,o,r))),e=e.return}return i}function tr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function nr(e,t,n,i,r){for(var o=t._reactName,s=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=Fe(n,o))&&s.unshift(Ji(n,l,a)):r||null!=(l=Fe(n,o))&&s.push(Ji(n,l,a))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var ir=/\r\n?/g,rr=/\u0000|\uFFFD/g;function or(e){return("string"==typeof e?e:""+e).replace(ir,"\n").replace(rr,"")}function sr(e,t,i){if(t=or(t),or(e)!==t&&i)throw Error(n(425))}function ar(){}var lr=null,cr=null;function ur(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var dr="function"==typeof setTimeout?setTimeout:void 0,hr="function"==typeof clearTimeout?clearTimeout:void 0,fr="function"==typeof Promise?Promise:void 0,pr="function"==typeof queueMicrotask?queueMicrotask:void 0!==fr?function(e){return fr.resolve(null).then(e).catch(mr)}:dr;function mr(e){setTimeout(function(){throw e})}function gr(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return e.removeChild(r),void qt(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);qt(t)}function _r(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function yr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var vr=Math.random().toString(36).slice(2),br="__reactFiber$"+vr,xr="__reactProps$"+vr,wr="__reactContainer$"+vr,Sr="__reactEvents$"+vr,Er="__reactListeners$"+vr,Cr="__reactHandles$"+vr;function Tr(e){var t=e[br];if(t)return t;for(var n=e.parentNode;n;){if(t=n[wr]||n[br]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=yr(e);null!==e;){if(n=e[br])return n;e=yr(e)}return t}n=(e=n).parentNode}return null}function kr(e){return!(e=e[br]||e[wr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Ir(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(n(33))}function Ar(e){return e[xr]||null}var Lr=[],Rr=-1;function Pr(e){return{current:e}}function Mr(e){0>Rr||(e.current=Lr[Rr],Lr[Rr]=null,Rr--)}function Dr(e,t){Rr++,Lr[Rr]=e.current,e.current=t}var Nr={},Fr=Pr(Nr),Or=Pr(!1),Br=Nr;function zr(e,t){var n=e.type.contextTypes;if(!n)return Nr;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in n)o[r]=t[r];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ur(e){return null!=e.childContextTypes}function Vr(){Mr(Or),Mr(Fr)}function Hr(e,t,i){if(Fr.current!==Nr)throw Error(n(168));Dr(Fr,t),Dr(Or,i)}function Wr(e,t,i){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return i;for(var o in r=r.getChildContext())if(!(o in t))throw Error(n(108,Y(e)||"Unknown",o));return V({},i,r)}function $r(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Nr,Br=Fr.current,Dr(Fr,e),Dr(Or,Or.current),!0}function Gr(e,t,i){var r=e.stateNode;if(!r)throw Error(n(169));i?(e=Wr(e,t,Br),r.__reactInternalMemoizedMergedChildContext=e,Mr(Or),Mr(Fr),Dr(Fr,e)):Mr(Or),Dr(Or,i)}var jr=null,Yr=!1,qr=!1;function Xr(e){null===jr?jr=[e]:jr.push(e)}function Kr(){if(!qr&&null!==jr){qr=!0;var e=0,t=Et;try{var n=jr;for(Et=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}jr=null,Yr=!1}catch(qe){throw null!==jr&&(jr=jr.slice(e+1)),Qe(rt,Kr),qe}finally{Et=t,qr=!1}}return null}var Zr=[],Qr=0,Jr=null,eo=0,to=[],no=0,io=null,ro=1,oo="";function so(e,t){Zr[Qr++]=eo,Zr[Qr++]=Jr,Jr=e,eo=t}function ao(e,t,n){to[no++]=ro,to[no++]=oo,to[no++]=io,io=e;var i=ro;e=oo;var r=32-dt(i)-1;i&=~(1<<r),n+=1;var o=32-dt(t)+r;if(30<o){var s=r-r%5;o=(i&(1<<s)-1).toString(32),i>>=s,r-=s,ro=1<<32-dt(t)+r|n<<r|i,oo=o+e}else ro=1<<o|n<<r|i,oo=e}function lo(e){null!==e.return&&(so(e,1),ao(e,1,0))}function co(e){for(;e===Jr;)Jr=Zr[--Qr],Zr[Qr]=null,eo=Zr[--Qr],Zr[Qr]=null;for(;e===io;)io=to[--no],to[no]=null,oo=to[--no],to[no]=null,ro=to[--no],to[no]=null}var uo=null,ho=null,fo=!1,po=null;function mo(e,t){var n=zc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function go(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,uo=e,ho=_r(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,uo=e,ho=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==io?{id:ro,overflow:oo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=zc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,uo=e,ho=null,!0);default:return!1}}function _o(e){return!(!(1&e.mode)||128&e.flags)}function yo(e){if(fo){var t=ho;if(t){var i=t;if(!go(e,t)){if(_o(e))throw Error(n(418));t=_r(i.nextSibling);var r=uo;t&&go(e,t)?mo(r,i):(e.flags=-4097&e.flags|2,fo=!1,uo=e)}}else{if(_o(e))throw Error(n(418));e.flags=-4097&e.flags|2,fo=!1,uo=e}}}function vo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;uo=e}function bo(e){if(e!==uo)return!1;if(!fo)return vo(e),fo=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ur(e.type,e.memoizedProps)),t&&(t=ho)){if(_o(e))throw xo(),Error(n(418));for(;t;)mo(e,t),t=_r(t.nextSibling)}if(vo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(n(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var i=e.data;if("/$"===i){if(0===t){ho=_r(e.nextSibling);break e}t--}else"$"!==i&&"$!"!==i&&"$?"!==i||t++}e=e.nextSibling}ho=null}}else ho=uo?_r(e.stateNode.nextSibling):null;return!0}function xo(){for(var e=ho;e;)e=_r(e.nextSibling)}function wo(){ho=uo=null,fo=!1}function So(e){null===po?po=[e]:po.push(e)}var Eo=_.ReactCurrentBatchConfig;function Co(e,t,i){if(null!==(e=i.ref)&&"function"!=typeof e&&"object"!=typeof e){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(n(309));var r=i.stateNode}if(!r)throw Error(n(147,e));var o=r,s=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===s?t.ref:((t=function(e){var t=o.refs;null===e?delete t[s]:t[s]=e})._stringRef=s,t)}if("string"!=typeof e)throw Error(n(284));if(!i._owner)throw Error(n(290,e))}return e}function To(e,t){throw e=Object.prototype.toString.call(t),Error(n(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ko(e){return(0,e._init)(e._payload)}function Io(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function i(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Vc(e,t)).index=0,e.sibling=null,e}function s(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=Gc(n,e.mode,i)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,i){var r=n.type;return r===x?d(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===r||"object"==typeof r&&null!==r&&r.$$typeof===F&&ko(r)===t.type)?((i=o(t,n.props)).ref=Co(e,t,n),i.return=e,i):((i=Hc(n.type,n.key,n.props,null,e.mode,i)).ref=Co(e,t,n),i.return=e,i)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=jc(n,e.mode,i)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,i,r){return null===t||7!==t.tag?((t=Wc(n,e.mode,i,r)).return=e,t):((t=o(t,n)).return=e,t)}function h(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Gc(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case v:return(n=Hc(t.type,t.key,t.props,null,e.mode,n)).ref=Co(e,null,t),n.return=e,n;case b:return(t=jc(t,e.mode,n)).return=e,t;case F:return h(e,(0,t._init)(t._payload),n)}if(oe(t)||z(t))return(t=Wc(t,e.mode,n,null)).return=e,t;To(e,t)}return null}function f(e,t,n,i){var r=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==r?null:l(e,t,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case v:return n.key===r?c(e,t,n,i):null;case b:return n.key===r?u(e,t,n,i):null;case F:return f(e,t,(r=n._init)(n._payload),i)}if(oe(n)||z(n))return null!==r?null:d(e,t,n,i,null);To(e,n)}return null}function p(e,t,n,i,r){if("string"==typeof i&&""!==i||"number"==typeof i)return l(t,e=e.get(n)||null,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case v:return c(t,e=e.get(null===i.key?n:i.key)||null,i,r);case b:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case F:return p(e,t,n,(0,i._init)(i._payload),r)}if(oe(i)||z(i))return d(t,e=e.get(n)||null,i,r,null);To(t,i)}return null}return function l(c,u,d,m){if("object"==typeof d&&null!==d&&d.type===x&&null===d.key&&(d=d.props.children),"object"==typeof d&&null!==d){switch(d.$$typeof){case v:e:{for(var g=d.key,_=u;null!==_;){if(_.key===g){if((g=d.type)===x){if(7===_.tag){i(c,_.sibling),(u=o(_,d.props.children)).return=c,c=u;break e}}else if(_.elementType===g||"object"==typeof g&&null!==g&&g.$$typeof===F&&ko(g)===_.type){i(c,_.sibling),(u=o(_,d.props)).ref=Co(c,_,d),u.return=c,c=u;break e}i(c,_);break}t(c,_),_=_.sibling}d.type===x?((u=Wc(d.props.children,c.mode,m,d.key)).return=c,c=u):((m=Hc(d.type,d.key,d.props,null,c.mode,m)).ref=Co(c,u,d),m.return=c,c=m)}return a(c);case b:e:{for(_=d.key;null!==u;){if(u.key===_){if(4===u.tag&&u.stateNode.containerInfo===d.containerInfo&&u.stateNode.implementation===d.implementation){i(c,u.sibling),(u=o(u,d.children||[])).return=c,c=u;break e}i(c,u);break}t(c,u),u=u.sibling}(u=jc(d,c.mode,m)).return=c,c=u}return a(c);case F:return l(c,u,(_=d._init)(d._payload),m)}if(oe(d))return function(n,o,a,l){for(var c=null,u=null,d=o,m=o=0,g=null;null!==d&&m<a.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var _=f(n,d,a[m],l);if(null===_){null===d&&(d=g);break}e&&d&&null===_.alternate&&t(n,d),o=s(_,o,m),null===u?c=_:u.sibling=_,u=_,d=g}if(m===a.length)return i(n,d),fo&&so(n,m),c;if(null===d){for(;m<a.length;m++)null!==(d=h(n,a[m],l))&&(o=s(d,o,m),null===u?c=d:u.sibling=d,u=d);return fo&&so(n,m),c}for(d=r(n,d);m<a.length;m++)null!==(g=p(d,n,m,a[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),o=s(g,o,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(n,e)}),fo&&so(n,m),c}(c,u,d,m);if(z(d))return function(o,a,l,c){var u=z(l);if("function"!=typeof u)throw Error(n(150));if(null==(l=u.call(l)))throw Error(n(151));for(var d=u=null,m=a,g=a=0,_=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(_=m,m=null):_=m.sibling;var v=f(o,m,y.value,c);if(null===v){null===m&&(m=_);break}e&&m&&null===v.alternate&&t(o,m),a=s(v,a,g),null===d?u=v:d.sibling=v,d=v,m=_}if(y.done)return i(o,m),fo&&so(o,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=h(o,y.value,c))&&(a=s(y,a,g),null===d?u=y:d.sibling=y,d=y);return fo&&so(o,g),u}for(m=r(o,m);!y.done;g++,y=l.next())null!==(y=p(m,o,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),a=s(y,a,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach(function(e){return t(o,e)}),fo&&so(o,g),u}(c,u,d,m);To(c,d)}return"string"==typeof d&&""!==d||"number"==typeof d?(d=""+d,null!==u&&6===u.tag?(i(c,u.sibling),(u=o(u,d)).return=c,c=u):(i(c,u),(u=Gc(d,c.mode,m)).return=c,c=u),a(c)):i(c,u)}}var Ao=Io(!0),Lo=Io(!1),Ro=Pr(null),Po=null,Mo=null,Do=null;function No(){Do=Mo=Po=null}function Fo(e){var t=Ro.current;Mr(Ro),e._currentValue=t}function Oo(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Bo(e,t){Po=e,Do=Mo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ka=!0),e.firstContext=null)}function zo(e){var t=e._currentValue;if(Do!==e)if(e={context:e,memoizedValue:t,next:null},null===Mo){if(null===Po)throw Error(n(308));Mo=e,Po.dependencies={lanes:0,firstContext:e}}else Mo=Mo.next=e;return t}var Uo=null;function Vo(e){null===Uo?Uo=[e]:Uo.push(e)}function Ho(e,t,n,i){var r=t.interleaved;return null===r?(n.next=n,Vo(t)):(n.next=r.next,r.next=n),t.interleaved=n,Wo(e,i)}function Wo(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var $o=!1;function Go(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Yo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function qo(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,2&Fl){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,Wo(e,n)}return null===(r=i.interleaved)?(t.next=t,Vo(i)):(t.next=r.next,r.next=t),i.interleaved=t,Wo(e,n)}function Xo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,St(e,n)}}function Zo(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?r=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?r=o=t:o=o.next=t}else r=o=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Qo(e,t,n,i){var r=e.updateQueue;$o=!1;var o=r.firstBaseUpdate,s=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&(a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l)}if(null!==o){var d=r.baseState;for(s=0,u=c=l=null,a=o;;){var h=a.lane,f=a.eventTime;if((i&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(h=t,f=n,m.tag){case 1:if("function"==typeof(p=m.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null==(h="function"==typeof(p=m.payload)?p.call(f,d,h):p))break e;d=V({},d,h);break e;case 2:$o=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,s|=h;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(h=a).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===u&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{s|=r.lane,r=r.next}while(r!==t)}else null===o&&(r.shared.lanes=0);$l|=s,e.lanes=s,e.memoizedState=d}}function Jo(e,t,i){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=i,"function"!=typeof o)throw Error(n(191,o));o.call(r)}}}var es={},ts=Pr(es),ns=Pr(es),is=Pr(es);function rs(e){if(e===es)throw Error(n(174));return e}function os(e,t){switch(Dr(is,t),Dr(ns,e),Dr(ts,es),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:he(null,"");break;default:t=he(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Mr(ts),Dr(ts,t)}function ss(){Mr(ts),Mr(ns),Mr(is)}function as(e){rs(is.current);var t=rs(ts.current),n=he(t,e.type);t!==n&&(Dr(ns,e),Dr(ts,n))}function ls(e){ns.current===e&&(Mr(ts),Mr(ns))}var cs=Pr(0);function us(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ds=[];function hs(){for(var e=0;e<ds.length;e++)ds[e]._workInProgressVersionPrimary=null;ds.length=0}var fs=_.ReactCurrentDispatcher,ps=_.ReactCurrentBatchConfig,ms=0,gs=null,_s=null,ys=null,vs=!1,bs=!1,xs=0,ws=0;function Ss(){throw Error(n(321))}function Es(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!mi(e[n],t[n]))return!1;return!0}function Cs(e,t,i,r,o,s){if(ms=s,gs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fs.current=null===e||null===e.memoizedState?la:ca,e=i(r,o),bs){s=0;do{if(bs=!1,xs=0,25<=s)throw Error(n(301));s+=1,ys=_s=null,t.updateQueue=null,fs.current=ua,e=i(r,o)}while(bs)}if(fs.current=aa,t=null!==_s&&null!==_s.next,ms=0,ys=_s=gs=null,vs=!1,t)throw Error(n(300));return e}function Ts(){var e=0!==xs;return xs=0,e}function ks(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ys?gs.memoizedState=ys=e:ys=ys.next=e,ys}function Is(){if(null===_s){var e=gs.alternate;e=null!==e?e.memoizedState:null}else e=_s.next;var t=null===ys?gs.memoizedState:ys.next;if(null!==t)ys=t,_s=e;else{if(null===e)throw Error(n(310));e={memoizedState:(_s=e).memoizedState,baseState:_s.baseState,baseQueue:_s.baseQueue,queue:_s.queue,next:null},null===ys?gs.memoizedState=ys=e:ys=ys.next=e}return ys}function As(e,t){return"function"==typeof t?t(e):t}function Ls(e){var t=Is(),i=t.queue;if(null===i)throw Error(n(311));i.lastRenderedReducer=e;var r=_s,o=r.baseQueue,s=i.pending;if(null!==s){if(null!==o){var a=o.next;o.next=s.next,s.next=a}r.baseQueue=o=s,i.pending=null}if(null!==o){s=o.next,r=r.baseState;var l=a=null,c=null,u=s;do{var d=u.lane;if((ms&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,a=r):c=c.next=h,gs.lanes|=d,$l|=d}u=u.next}while(null!==u&&u!==s);null===c?a=r:c.next=l,mi(r,t.memoizedState)||(ka=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,i.lastRenderedState=r}if(null!==(e=i.interleaved)){o=e;do{s=o.lane,gs.lanes|=s,$l|=s,o=o.next}while(o!==e)}else null===o&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function Rs(e){var t=Is(),i=t.queue;if(null===i)throw Error(n(311));i.lastRenderedReducer=e;var r=i.dispatch,o=i.pending,s=t.memoizedState;if(null!==o){i.pending=null;var a=o=o.next;do{s=e(s,a.action),a=a.next}while(a!==o);mi(s,t.memoizedState)||(ka=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),i.lastRenderedState=s}return[s,r]}function Ps(){}function Ms(e,t){var i=gs,r=Is(),o=t(),s=!mi(r.memoizedState,o);if(s&&(r.memoizedState=o,ka=!0),r=r.queue,Gs(Fs.bind(null,i,r,e),[e]),r.getSnapshot!==t||s||null!==ys&&1&ys.memoizedState.tag){if(i.flags|=2048,Us(9,Ns.bind(null,i,r,o,t),void 0,null),null===Ol)throw Error(n(349));30&ms||Ds(i,t,o)}return o}function Ds(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=gs.updateQueue)?(t={lastEffect:null,stores:null},gs.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ns(e,t,n,i){t.value=n,t.getSnapshot=i,Os(t)&&Bs(e)}function Fs(e,t,n){return n(function(){Os(t)&&Bs(e)})}function Os(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!mi(e,n)}catch(i){return!0}}function Bs(e){var t=Wo(e,1);null!==t&&uc(t,e,1,-1)}function zs(e){var t=ks();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:As,lastRenderedState:e},t.queue=e,e=e.dispatch=ia.bind(null,gs,e),[t.memoizedState,e]}function Us(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=gs.updateQueue)?(t={lastEffect:null,stores:null},gs.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Vs(){return Is().memoizedState}function Hs(e,t,n,i){var r=ks();gs.flags|=e,r.memoizedState=Us(1|t,n,void 0,void 0===i?null:i)}function Ws(e,t,n,i){var r=Is();i=void 0===i?null:i;var o=void 0;if(null!==_s){var s=_s.memoizedState;if(o=s.destroy,null!==i&&Es(i,s.deps))return void(r.memoizedState=Us(t,n,o,i))}gs.flags|=e,r.memoizedState=Us(1|t,n,o,i)}function $s(e,t){return Hs(8390656,8,e,t)}function Gs(e,t){return Ws(2048,8,e,t)}function js(e,t){return Ws(4,2,e,t)}function Ys(e,t){return Ws(4,4,e,t)}function qs(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Xs(e,t,n){return n=null!=n?n.concat([e]):null,Ws(4,4,qs.bind(null,t,e),n)}function Ks(){}function Zs(e,t){var n=Is();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Es(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Qs(e,t){var n=Is();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&Es(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Js(e,t,n){return 21&ms?(mi(n,t)||(n=bt(),gs.lanes|=n,$l|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ka=!0),e.memoizedState=n)}function ea(e,t){var n=Et;Et=0!==n&&4>n?n:4,e(!0);var i=ps.transition;ps.transition={};try{e(!1),t()}finally{Et=n,ps.transition=i}}function ta(){return Is().memoizedState}function na(e,t,n){var i=cc(e);n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},ra(e)?oa(t,n):null!==(n=Ho(e,t,n,i))&&(uc(n,e,i,lc()),sa(n,t,i))}function ia(e,t,n){var i=cc(e),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(ra(e))oa(t,r);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,n);if(r.hasEagerState=!0,r.eagerState=a,mi(a,s)){var l=t.interleaved;return null===l?(r.next=r,Vo(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(Ko){}null!==(n=Ho(e,t,r,i))&&(uc(n,e,i,r=lc()),sa(n,t,i))}}function ra(e){var t=e.alternate;return e===gs||null!==t&&t===gs}function oa(e,t){bs=vs=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function sa(e,t,n){if(4194240&n){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,St(e,n)}}var aa={readContext:zo,useCallback:Ss,useContext:Ss,useEffect:Ss,useImperativeHandle:Ss,useInsertionEffect:Ss,useLayoutEffect:Ss,useMemo:Ss,useReducer:Ss,useRef:Ss,useState:Ss,useDebugValue:Ss,useDeferredValue:Ss,useTransition:Ss,useMutableSource:Ss,useSyncExternalStore:Ss,useId:Ss,unstable_isNewReconciler:!1},la={readContext:zo,useCallback:function(e,t){return ks().memoizedState=[e,void 0===t?null:t],e},useContext:zo,useEffect:$s,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Hs(4194308,4,qs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Hs(4194308,4,e,t)},useInsertionEffect:function(e,t){return Hs(4,2,e,t)},useMemo:function(e,t){var n=ks();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=ks();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=na.bind(null,gs,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},ks().memoizedState=e},useState:zs,useDebugValue:Ks,useDeferredValue:function(e){return ks().memoizedState=e},useTransition:function(){var e=zs(!1),t=e[0];return e=ea.bind(null,e[1]),ks().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var r=gs,o=ks();if(fo){if(void 0===i)throw Error(n(407));i=i()}else{if(i=t(),null===Ol)throw Error(n(349));30&ms||Ds(r,t,i)}o.memoizedState=i;var s={value:i,getSnapshot:t};return o.queue=s,$s(Fs.bind(null,r,s,e),[e]),r.flags|=2048,Us(9,Ns.bind(null,r,s,i,t),void 0,null),i},useId:function(){var e=ks(),t=Ol.identifierPrefix;if(fo){var n=oo;t=":"+t+"R"+(n=(ro&~(1<<32-dt(ro)-1)).toString(32)+n),0<(n=xs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ws++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ca={readContext:zo,useCallback:Zs,useContext:zo,useEffect:Gs,useImperativeHandle:Xs,useInsertionEffect:js,useLayoutEffect:Ys,useMemo:Qs,useReducer:Ls,useRef:Vs,useState:function(){return Ls(As)},useDebugValue:Ks,useDeferredValue:function(e){return Js(Is(),_s.memoizedState,e)},useTransition:function(){return[Ls(As)[0],Is().memoizedState]},useMutableSource:Ps,useSyncExternalStore:Ms,useId:ta,unstable_isNewReconciler:!1},ua={readContext:zo,useCallback:Zs,useContext:zo,useEffect:Gs,useImperativeHandle:Xs,useInsertionEffect:js,useLayoutEffect:Ys,useMemo:Qs,useReducer:Rs,useRef:Vs,useState:function(){return Rs(As)},useDebugValue:Ks,useDeferredValue:function(e){var t=Is();return null===_s?t.memoizedState=e:Js(t,_s.memoizedState,e)},useTransition:function(){return[Rs(As)[0],Is().memoizedState]},useMutableSource:Ps,useSyncExternalStore:Ms,useId:ta,unstable_isNewReconciler:!1};function da(e,t){if(e&&e.defaultProps){for(var n in t=V({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ha(e,t,n,i){n=null==(n=n(i,t=e.memoizedState))?t:V({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var fa={isMounted:function(e){return!!(e=e._reactInternals)&&je(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=lc(),r=cc(e),o=Yo(i,r);o.payload=t,null!=n&&(o.callback=n),null!==(t=qo(e,o,r))&&(uc(t,e,r,i),Xo(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=lc(),r=cc(e),o=Yo(i,r);o.tag=1,o.payload=t,null!=n&&(o.callback=n),null!==(t=qo(e,o,r))&&(uc(t,e,r,i),Xo(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=lc(),i=cc(e),r=Yo(n,i);r.tag=2,null!=t&&(r.callback=t),null!==(t=qo(e,r,i))&&(uc(t,e,i,n),Xo(t,e,i))}};function pa(e,t,n,i,r,o,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,o,s):!(t.prototype&&t.prototype.isPureReactComponent&&gi(n,i)&&gi(r,o))}function ma(e,t,n){var i=!1,r=Nr,o=t.contextType;return"object"==typeof o&&null!==o?o=zo(o):(r=Ur(t)?Br:Fr.current,o=(i=null!=(i=t.contextTypes))?zr(e,r):Nr),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=fa,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=o),t}function ga(e,t,n,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&fa.enqueueReplaceState(t,t.state,null)}function _a(e,t,n,i){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs={},Go(e);var o=t.contextType;"object"==typeof o&&null!==o?r.context=zo(o):(o=Ur(t)?Br:Fr.current,r.context=zr(e,o)),r.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(ha(e,t,o,n),r.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(t=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&fa.enqueueReplaceState(r,r.state,null),Qo(e,n,r,i),r.state=e.memoizedState),"function"==typeof r.componentDidMount&&(e.flags|=4194308)}function ya(e,t){try{var n="",i=t;do{n+=G(i),i=i.return}while(i);var r=n}catch(dn){r="\nError generating stack: "+dn.message+"\n"+dn.stack}return{value:e,source:t,stack:r,digest:null}}function va(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}var ba="function"==typeof WeakMap?WeakMap:Map;function xa(e,t,n){(n=Yo(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Ql||(Ql=!0,Jl=i)},n}function wa(e,t,n){(n=Yo(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"==typeof i){var r=t.value;n.payload=function(){return i(r)},n.callback=function(){}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){"function"!=typeof i&&(null===ec?ec=new Set([this]):ec.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function Sa(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new ba;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(r.add(n),e=Mc.bind(null,e,t,n),t.then(e,e))}function Ea(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function Ca(e,t,n,i,r){return 1&e.mode?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Yo(-1,1)).tag=2,qo(n,t,1))),n.lanes|=1),e)}var Ta=_.ReactCurrentOwner,ka=!1;function Ia(e,t,n,i){t.child=null===e?Lo(t,null,n,i):Ao(t,e.child,n,i)}function Aa(e,t,n,i,r){n=n.render;var o=t.ref;return Bo(t,r),i=Cs(e,t,n,i,o,r),n=Ts(),null===e||ka?(fo&&n&&lo(t),t.flags|=1,Ia(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Qa(e,t,r))}function La(e,t,n,i,r){if(null===e){var o=n.type;return"function"!=typeof o||Uc(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Hc(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Ra(e,t,o,i,r))}if(o=e.child,0===(e.lanes&r)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:gi)(s,i)&&e.ref===t.ref)return Qa(e,t,r)}return t.flags|=1,(e=Vc(o,i)).ref=t.ref,e.return=t,t.child=e}function Ra(e,t,n,i,r){if(null!==e){var o=e.memoizedProps;if(gi(o,i)&&e.ref===t.ref){if(ka=!1,t.pendingProps=i=o,0===(e.lanes&r))return t.lanes=e.lanes,Qa(e,t,r);131072&e.flags&&(ka=!0)}}return Da(e,t,n,i,r)}function Pa(e,t,n){var i=t.pendingProps,r=i.children,o=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(1&t.mode){if(!(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Dr(Vl,Ul),Ul|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==o?o.baseLanes:n,Dr(Vl,Ul),Ul|=i}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Dr(Vl,Ul),Ul|=n;else null!==o?(i=o.baseLanes|n,t.memoizedState=null):i=n,Dr(Vl,Ul),Ul|=i;return Ia(e,t,r,n),t.child}function Ma(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Da(e,t,n,i,r){var o=Ur(n)?Br:Fr.current;return o=zr(t,o),Bo(t,r),n=Cs(e,t,n,i,o,r),i=Ts(),null===e||ka?(fo&&i&&lo(t),t.flags|=1,Ia(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Qa(e,t,r))}function Na(e,t,n,i,r){if(Ur(n)){var o=!0;$r(t)}else o=!1;if(Bo(t,r),null===t.stateNode)Za(e,t),ma(t,n,i),_a(t,n,i,r),i=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var l=s.context,c=n.contextType;c="object"==typeof c&&null!==c?zo(c):zr(t,c=Ur(n)?Br:Fr.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;d||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==i||l!==c)&&ga(t,s,i,c),$o=!1;var h=t.memoizedState;s.state=h,Qo(t,i,s,r),l=t.memoizedState,a!==i||h!==l||Or.current||$o?("function"==typeof u&&(ha(t,n,u,i),l=t.memoizedState),(a=$o||pa(t,n,a,i,h,l,c))?(d||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),s.props=i,s.state=l,s.context=c,i=a):("function"==typeof s.componentDidMount&&(t.flags|=4194308),i=!1)}else{s=t.stateNode,jo(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:da(t.type,a),s.props=c,d=t.pendingProps,h=s.context,l="object"==typeof(l=n.contextType)&&null!==l?zo(l):zr(t,l=Ur(n)?Br:Fr.current);var f=n.getDerivedStateFromProps;(u="function"==typeof f||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==d||h!==l)&&ga(t,s,i,l),$o=!1,h=t.memoizedState,s.state=h,Qo(t,i,s,r);var p=t.memoizedState;a!==d||h!==p||Or.current||$o?("function"==typeof f&&(ha(t,n,f,i),p=t.memoizedState),(c=$o||pa(t,n,c,i,h,p,l)||!1)?(u||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(i,p,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(i,p,l)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),s.props=i,s.state=p,s.context=l,i=c):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return Fa(e,t,n,i,o,r)}function Fa(e,t,n,i,r,o){Ma(e,t);var s=!!(128&t.flags);if(!i&&!s)return r&&Gr(t,n,!1),Qa(e,t,o);i=t.stateNode,Ta.current=t;var a=s&&"function"!=typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&s?(t.child=Ao(t,e.child,null,o),t.child=Ao(t,null,a,o)):Ia(e,t,a,o),t.memoizedState=i.state,r&&Gr(t,n,!0),t.child}function Oa(e){var t=e.stateNode;t.pendingContext?Hr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Hr(0,t.context,!1),os(e,t.containerInfo)}function Ba(e,t,n,i,r){return wo(),So(r),t.flags|=256,Ia(e,t,n,i),t.child}var za,Ua,Va,Ha,Wa={dehydrated:null,treeContext:null,retryLane:0};function $a(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ga(e,t,i){var r,o=t.pendingProps,s=cs.current,a=!1,l=!!(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&!!(2&s)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Dr(cs,1&s),null===e)return yo(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=o.children,e=o.fallback,a?(o=t.mode,a=t.child,l={mode:"hidden",children:l},1&o||null===a?a=$c(l,o,0,null):(a.childLanes=0,a.pendingProps=l),e=Wc(e,o,i,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=$a(i),t.memoizedState=Wa,e):ja(t,l));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,i,r,o,s,a){if(i)return 256&t.flags?(t.flags&=-257,Ya(e,t,a,r=va(Error(n(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,o=t.mode,r=$c({mode:"visible",children:r.children},o,0,null),(s=Wc(s,o,a,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,1&t.mode&&Ao(t,e.child,null,a),t.child.memoizedState=$a(a),t.memoizedState=Wa,s);if(!(1&t.mode))return Ya(e,t,a,null);if("$!"===o.data){if(r=o.nextSibling&&o.nextSibling.dataset)var l=r.dgst;return r=l,Ya(e,t,a,r=va(s=Error(n(419)),r,void 0))}if(l=0!==(a&e.childLanes),ka||l){if(null!==(r=Ol)){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=0!==(o&(r.suspendedLanes|a))?0:o)&&o!==s.retryLane&&(s.retryLane=o,Wo(e,o),uc(r,e,o,-1))}return Sc(),Ya(e,t,a,r=va(Error(n(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=Nc.bind(null,e),o._reactRetry=t,null):(e=s.treeContext,ho=_r(o.nextSibling),uo=t,fo=!0,po=null,null!==e&&(to[no++]=ro,to[no++]=oo,to[no++]=io,ro=e.id,oo=e.overflow,io=t),(t=ja(t,r.children)).flags|=4096,t)}(e,t,l,o,r,s,i);if(a){a=o.fallback,l=t.mode,r=(s=e.child).sibling;var c={mode:"hidden",children:o.children};return 1&l||t.child===s?(o=Vc(s,c)).subtreeFlags=14680064&s.subtreeFlags:((o=t.child).childLanes=0,o.pendingProps=c,t.deletions=null),null!==r?a=Vc(r,a):(a=Wc(a,l,i,null)).flags|=2,a.return=t,o.return=t,o.sibling=a,t.child=o,o=a,a=t.child,l=null===(l=e.child.memoizedState)?$a(i):{baseLanes:l.baseLanes|i,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~i,t.memoizedState=Wa,o}return e=(a=e.child).sibling,o=Vc(a,{mode:"visible",children:o.children}),!(1&t.mode)&&(o.lanes=i),o.return=t,o.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=o,t.memoizedState=null,o}function ja(e,t){return(t=$c({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ya(e,t,n,i){return null!==i&&So(i),Ao(t,e.child,null,n),(e=ja(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function qa(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Oo(e.return,t,n)}function Xa(e,t,n,i,r){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=r)}function Ka(e,t,n){var i=t.pendingProps,r=i.revealOrder,o=i.tail;if(Ia(e,t,i.children,n),2&(i=cs.current))i=1&i|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&qa(e,n,t);else if(19===e.tag)qa(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Dr(cs,i),1&t.mode)switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===us(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Xa(t,!1,r,n,o);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===us(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Xa(t,!0,n,null,o);break;case"together":Xa(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function Za(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Qa(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),$l|=t.lanes,0===(i&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(n(153));if(null!==t.child){for(i=Vc(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=Vc(e,e.pendingProps)).return=t;i.sibling=null}return t.child}function Ja(e,t){if(!fo)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function el(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function tl(e,t,i){var o=t.pendingProps;switch(co(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return el(t),null;case 1:case 17:return Ur(t.type)&&Vr(),el(t),null;case 3:return o=t.stateNode,ss(),Mr(Or),Mr(Fr),hs(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),null!==e&&null!==e.child||(bo(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==po&&(pc(po),po=null))),Ua(e,t),el(t),null;case 5:ls(t);var s=rs(is.current);if(i=t.type,null!==e&&null!=t.stateNode)Va(e,t,i,o,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!o){if(null===t.stateNode)throw Error(n(166));return el(t),null}if(e=rs(ts.current),bo(t)){o=t.stateNode,i=t.type;var a=t.memoizedProps;switch(o[br]=t,o[xr]=a,e=!!(1&t.mode),i){case"dialog":Yi("cancel",o),Yi("close",o);break;case"iframe":case"object":case"embed":Yi("load",o);break;case"video":case"audio":for(s=0;s<Wi.length;s++)Yi(Wi[s],o);break;case"source":Yi("error",o);break;case"img":case"image":case"link":Yi("error",o),Yi("load",o);break;case"details":Yi("toggle",o);break;case"input":ee(o,a),Yi("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!a.multiple},Yi("invalid",o);break;case"textarea":le(o,a),Yi("invalid",o)}for(var l in we(i,a),s=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"==typeof c?o.textContent!==c&&(!0!==a.suppressHydrationWarning&&sr(o.textContent,c,e),s=["children",c]):"number"==typeof c&&o.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&sr(o.textContent,c,e),s=["children",""+c]):r.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Yi("scroll",o)}switch(i){case"input":K(o),ie(o,a,!0);break;case"textarea":K(o),ue(o);break;case"select":case"option":break;default:"function"==typeof a.onClick&&(o.onclick=ar)}o=s,t.updateQueue=o,null!==o&&(t.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=de(i)),"http://www.w3.org/1999/xhtml"===e?"script"===i?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof o.is?e=l.createElement(i,{is:o.is}):(e=l.createElement(i),"select"===i&&(l=e,o.multiple?l.multiple=!0:o.size&&(l.size=o.size))):e=l.createElementNS(e,i),e[br]=t,e[xr]=o,za(e,t,!1,!1),t.stateNode=e;e:{switch(l=Se(i,o),i){case"dialog":Yi("cancel",e),Yi("close",e),s=o;break;case"iframe":case"object":case"embed":Yi("load",e),s=o;break;case"video":case"audio":for(s=0;s<Wi.length;s++)Yi(Wi[s],e);s=o;break;case"source":Yi("error",e),s=o;break;case"img":case"image":case"link":Yi("error",e),Yi("load",e),s=o;break;case"details":Yi("toggle",e),s=o;break;case"input":ee(e,o),s=J(e,o),Yi("invalid",e);break;case"option":default:s=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},s=V({},o,{value:void 0}),Yi("invalid",e);break;case"textarea":le(e,o),s=ae(e,o),Yi("invalid",e)}for(a in we(i,s),c=s)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?be(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&me(e,u):"children"===a?"string"==typeof u?("textarea"!==i||""!==u)&&ge(e,u):"number"==typeof u&&ge(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(r.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Yi("scroll",e):null!=u&&g(e,a,u,l))}switch(i){case"input":K(e),ie(e,o,!1);break;case"textarea":K(e),ue(e);break;case"option":null!=o.value&&e.setAttribute("value",""+q(o.value));break;case"select":e.multiple=!!o.multiple,null!=(a=o.value)?se(e,!!o.multiple,a,!1):null!=o.defaultValue&&se(e,!!o.multiple,o.defaultValue,!0);break;default:"function"==typeof s.onClick&&(e.onclick=ar)}switch(i){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return el(t),null;case 6:if(e&&null!=t.stateNode)Ha(e,t,e.memoizedProps,o);else{if("string"!=typeof o&&null===t.stateNode)throw Error(n(166));if(i=rs(is.current),rs(ts.current),bo(t)){if(o=t.stateNode,i=t.memoizedProps,o[br]=t,(a=o.nodeValue!==i)&&null!==(e=uo))switch(e.tag){case 3:sr(o.nodeValue,i,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&sr(o.nodeValue,i,!!(1&e.mode))}a&&(t.flags|=4)}else(o=(9===i.nodeType?i:i.ownerDocument).createTextNode(o))[br]=t,t.stateNode=o}return el(t),null;case 13:if(Mr(cs),o=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(fo&&null!==ho&&1&t.mode&&!(128&t.flags))xo(),wo(),t.flags|=98560,a=!1;else if(a=bo(t),null!==o&&null!==o.dehydrated){if(null===e){if(!a)throw Error(n(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(n(317));a[br]=t}else wo(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;el(t),a=!1}else null!==po&&(pc(po),po=null),a=!0;if(!a)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=i,t):((o=null!==o)!=(null!==e&&null!==e.memoizedState)&&o&&(t.child.flags|=8192,1&t.mode&&(null===e||1&cs.current?0===Hl&&(Hl=3):Sc())),null!==t.updateQueue&&(t.flags|=4),el(t),null);case 4:return ss(),Ua(e,t),null===e&&Ki(t.stateNode.containerInfo),el(t),null;case 10:return Fo(t.type._context),el(t),null;case 19:if(Mr(cs),null===(a=t.memoizedState))return el(t),null;if(o=!!(128&t.flags),null===(l=a.rendering))if(o)Ja(a,!1);else{if(0!==Hl||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(l=us(e))){for(t.flags|=128,Ja(a,!1),null!==(o=l.updateQueue)&&(t.updateQueue=o,t.flags|=4),t.subtreeFlags=0,o=i,i=t.child;null!==i;)e=o,(a=i).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return Dr(cs,1&cs.current|2),t.child}e=e.sibling}null!==a.tail&&nt()>Kl&&(t.flags|=128,o=!0,Ja(a,!1),t.lanes=4194304)}else{if(!o)if(null!==(e=us(l))){if(t.flags|=128,o=!0,null!==(i=e.updateQueue)&&(t.updateQueue=i,t.flags|=4),Ja(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!fo)return el(t),null}else 2*nt()-a.renderingStartTime>Kl&&1073741824!==i&&(t.flags|=128,o=!0,Ja(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(i=a.last)?i.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=nt(),t.sibling=null,i=cs.current,Dr(cs,o?1&i|2:1&i),t):(el(t),null);case 22:case 23:return vc(),o=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==o&&(t.flags|=8192),o&&1&t.mode?!!(1073741824&Ul)&&(el(t),6&t.subtreeFlags&&(t.flags|=8192)):el(t),null;case 24:case 25:return null}throw Error(n(156,t.tag))}function nl(e,t){switch(co(t),t.tag){case 1:return Ur(t.type)&&Vr(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ss(),Mr(Or),Mr(Fr),hs(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ls(t),null;case 13:if(Mr(cs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(n(340));wo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Mr(cs),null;case 4:return ss(),null;case 10:return Fo(t.type._context),null;case 22:case 23:return vc(),null;default:return null}}za=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ua=function(){},Va=function(e,t,n,i){var o=e.memoizedProps;if(o!==i){e=t.stateNode,rs(ts.current);var s,a=null;switch(n){case"input":o=J(e,o),i=J(e,i),a=[];break;case"select":o=V({},o,{value:void 0}),i=V({},i,{value:void 0}),a=[];break;case"textarea":o=ae(e,o),i=ae(e,i),a=[];break;default:"function"!=typeof o.onClick&&"function"==typeof i.onClick&&(e.onclick=ar)}for(u in we(n,i),n=null,o)if(!i.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var l=o[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(r.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in i){var c=i[u];if(l=null!=o?o[u]:void 0,i.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(r.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Yi("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Ha=function(e,t,n,i){n!==i&&(t.flags|=4)};var il=!1,rl=!1,ol="function"==typeof WeakSet?WeakSet:Set,sl=null;function al(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(i){Pc(e,t,i)}else n.current=null}function ll(e,t,n){try{n()}catch(i){Pc(e,t,i)}}var cl=!1;function ul(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&e)===e){var o=r.destroy;r.destroy=void 0,void 0!==o&&ll(t,n,o)}r=r.next}while(r!==i)}}function dl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function hl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function fl(e){var t=e.alternate;null!==t&&(e.alternate=null,fl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[br],delete t[xr],delete t[Sr],delete t[Er],delete t[Cr]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function pl(e){return 5===e.tag||3===e.tag||4===e.tag}function ml(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||pl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function gl(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=ar));else if(4!==i&&null!==(e=e.child))for(gl(e,t,n),e=e.sibling;null!==e;)gl(e,t,n),e=e.sibling}function _l(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(_l(e,t,n),e=e.sibling;null!==e;)_l(e,t,n),e=e.sibling}var yl=null,vl=!1;function bl(e,t,n){for(n=n.child;null!==n;)xl(e,t,n),n=n.sibling}function xl(e,t,n){if(ut&&"function"==typeof ut.onCommitFiberUnmount)try{ut.onCommitFiberUnmount(ct,n)}catch(a){}switch(n.tag){case 5:rl||al(n,t);case 6:var i=yl,r=vl;yl=null,bl(e,t,n),vl=r,null!==(yl=i)&&(vl?(e=yl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):yl.removeChild(n.stateNode));break;case 18:null!==yl&&(vl?(e=yl,n=n.stateNode,8===e.nodeType?gr(e.parentNode,n):1===e.nodeType&&gr(e,n),qt(e)):gr(yl,n.stateNode));break;case 4:i=yl,r=vl,yl=n.stateNode.containerInfo,vl=!0,bl(e,t,n),yl=i,vl=r;break;case 0:case 11:case 14:case 15:if(!rl&&null!==(i=n.updateQueue)&&null!==(i=i.lastEffect)){r=i=i.next;do{var o=r,s=o.destroy;o=o.tag,void 0!==s&&(2&o||4&o)&&ll(n,t,s),r=r.next}while(r!==i)}bl(e,t,n);break;case 1:if(!rl&&(al(n,t),"function"==typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Pc(n,t,a)}bl(e,t,n);break;case 21:bl(e,t,n);break;case 22:1&n.mode?(rl=(i=rl)||null!==n.memoizedState,bl(e,t,n),rl=i):bl(e,t,n);break;default:bl(e,t,n)}}function wl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ol),t.forEach(function(t){var i=Fc.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))})}}function Sl(e,t){var i=t.deletions;if(null!==i)for(var r=0;r<i.length;r++){var o=i[r];try{var s=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:yl=l.stateNode,vl=!1;break e;case 3:case 4:yl=l.stateNode.containerInfo,vl=!0;break e}l=l.return}if(null===yl)throw Error(n(160));xl(s,a,o),yl=null,vl=!1;var c=o.alternate;null!==c&&(c.return=null),o.return=null}catch(Ko){Pc(o,t,Ko)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)El(t,e),t=t.sibling}function El(e,t){var i=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Sl(t,e),Cl(e),4&r){try{ul(3,e,e.return),dl(3,e)}catch(Tn){Pc(e,e.return,Tn)}try{ul(5,e,e.return)}catch(Tn){Pc(e,e.return,Tn)}}break;case 1:Sl(t,e),Cl(e),512&r&&null!==i&&al(i,i.return);break;case 5:if(Sl(t,e),Cl(e),512&r&&null!==i&&al(i,i.return),32&e.flags){var o=e.stateNode;try{ge(o,"")}catch(Tn){Pc(e,e.return,Tn)}}if(4&r&&null!=(o=e.stateNode)){var s=e.memoizedProps,a=null!==i?i.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&te(o,s),Se(l,a);var u=Se(l,s);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];"style"===d?be(o,h):"dangerouslySetInnerHTML"===d?me(o,h):"children"===d?ge(o,h):g(o,d,h,u)}switch(l){case"input":ne(o,s);break;case"textarea":ce(o,s);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!s.multiple;var p=s.value;null!=p?se(o,!!s.multiple,p,!1):f!==!!s.multiple&&(null!=s.defaultValue?se(o,!!s.multiple,s.defaultValue,!0):se(o,!!s.multiple,s.multiple?[]:"",!1))}o[xr]=s}catch(Tn){Pc(e,e.return,Tn)}}break;case 6:if(Sl(t,e),Cl(e),4&r){if(null===e.stateNode)throw Error(n(162));o=e.stateNode,s=e.memoizedProps;try{o.nodeValue=s}catch(Tn){Pc(e,e.return,Tn)}}break;case 3:if(Sl(t,e),Cl(e),4&r&&null!==i&&i.memoizedState.isDehydrated)try{qt(t.containerInfo)}catch(Tn){Pc(e,e.return,Tn)}break;case 4:default:Sl(t,e),Cl(e);break;case 13:Sl(t,e),Cl(e),8192&(o=e.child).flags&&(s=null!==o.memoizedState,o.stateNode.isHidden=s,!s||null!==o.alternate&&null!==o.alternate.memoizedState||(Xl=nt())),4&r&&wl(e);break;case 22:if(d=null!==i&&null!==i.memoizedState,1&e.mode?(rl=(u=rl)||d,Sl(t,e),rl=u):Sl(t,e),Cl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&1&e.mode)for(sl=e,d=e.child;null!==d;){for(h=sl=d;null!==sl;){switch(p=(f=sl).child,f.tag){case 0:case 11:case 14:case 15:ul(4,f,f.return);break;case 1:al(f,f.return);var m=f.stateNode;if("function"==typeof m.componentWillUnmount){r=f,i=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(Tn){Pc(r,i,Tn)}}break;case 5:al(f,f.return);break;case 22:if(null!==f.memoizedState){Al(h);continue}}null!==p?(p.return=f,sl=p):Al(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{o=h.stateNode,u?"function"==typeof(s=o.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=h.stateNode,a=null!=(c=h.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=ve("display",a))}catch(Tn){Pc(e,e.return,Tn)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(Tn){Pc(e,e.return,Tn)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Sl(t,e),Cl(e),4&r&&wl(e);case 21:}}function Cl(e){var t=e.flags;if(2&t){try{e:{for(var i=e.return;null!==i;){if(pl(i)){var r=i;break e}i=i.return}throw Error(n(160))}switch(r.tag){case 5:var o=r.stateNode;32&r.flags&&(ge(o,""),r.flags&=-33),_l(e,ml(e),o);break;case 3:case 4:var s=r.stateNode.containerInfo;gl(e,ml(e),s);break;default:throw Error(n(161))}}catch(a){Pc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Tl(e,t,n){sl=e,kl(e)}function kl(e,t,n){for(var i=!!(1&e.mode);null!==sl;){var r=sl,o=r.child;if(22===r.tag&&i){var s=null!==r.memoizedState||il;if(!s){var a=r.alternate,l=null!==a&&null!==a.memoizedState||rl;a=il;var c=rl;if(il=s,(rl=l)&&!c)for(sl=r;null!==sl;)l=(s=sl).child,22===s.tag&&null!==s.memoizedState?Ll(r):null!==l?(l.return=s,sl=l):Ll(r);for(;null!==o;)sl=o,kl(o),o=o.sibling;sl=r,il=a,rl=c}Il(e)}else 8772&r.subtreeFlags&&null!==o?(o.return=r,sl=o):Il(e)}}function Il(e){for(;null!==sl;){var t=sl;if(8772&t.flags){var i=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:rl||dl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!rl)if(null===i)r.componentDidMount();else{var o=t.elementType===t.type?i.memoizedProps:da(t.type,i.memoizedProps);r.componentDidUpdate(o,i.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Jo(t,s,r);break;case 3:var a=t.updateQueue;if(null!==a){if(i=null,null!==t.child)switch(t.child.tag){case 5:case 1:i=t.child.stateNode}Jo(t,a,i)}break;case 5:var l=t.stateNode;if(null===i&&4&t.flags){i=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&i.focus();break;case"img":c.src&&(i.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&qt(h)}}}break;default:throw Error(n(163))}rl||512&t.flags&&hl(t)}catch(Ft){Pc(t,t.return,Ft)}}if(t===e){sl=null;break}if(null!==(i=t.sibling)){i.return=t.return,sl=i;break}sl=t.return}}function Al(e){for(;null!==sl;){var t=sl;if(t===e){sl=null;break}var n=t.sibling;if(null!==n){n.return=t.return,sl=n;break}sl=t.return}}function Ll(e){for(;null!==sl;){var t=sl;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{dl(4,t)}catch(l){Pc(t,n,l)}break;case 1:var i=t.stateNode;if("function"==typeof i.componentDidMount){var r=t.return;try{i.componentDidMount()}catch(l){Pc(t,r,l)}}var o=t.return;try{hl(t)}catch(l){Pc(t,o,l)}break;case 5:var s=t.return;try{hl(t)}catch(l){Pc(t,s,l)}}}catch(l){Pc(t,t.return,l)}if(t===e){sl=null;break}var a=t.sibling;if(null!==a){a.return=t.return,sl=a;break}sl=t.return}}var Rl,Pl=Math.ceil,Ml=_.ReactCurrentDispatcher,Dl=_.ReactCurrentOwner,Nl=_.ReactCurrentBatchConfig,Fl=0,Ol=null,Bl=null,zl=0,Ul=0,Vl=Pr(0),Hl=0,Wl=null,$l=0,Gl=0,jl=0,Yl=null,ql=null,Xl=0,Kl=1/0,Zl=null,Ql=!1,Jl=null,ec=null,tc=!1,nc=null,ic=0,rc=0,oc=null,sc=-1,ac=0;function lc(){return 6&Fl?nt():-1!==sc?sc:sc=nt()}function cc(e){return 1&e.mode?2&Fl&&0!==zl?zl&-zl:null!==Eo.transition?(0===ac&&(ac=bt()),ac):0!==(e=Et)?e:e=void 0===(e=window.event)?16:nn(e.type):1}function uc(e,t,i,r){if(50<rc)throw rc=0,oc=null,Error(n(185));wt(e,i,r),2&Fl&&e===Ol||(e===Ol&&(!(2&Fl)&&(Gl|=i),4===Hl&&mc(e,zl)),dc(e,r),1===i&&0===Fl&&!(1&t.mode)&&(Kl=nt()+500,Yr&&Kr()))}function dc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-dt(o),a=1<<s,l=r[s];-1===l?0!==(a&n)&&0===(a&i)||(r[s]=yt(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}}(e,t);var i=_t(e,e===Ol?zl:0);if(0===i)null!==n&&Je(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&Je(n),1===t)0===e.tag?function(e){Yr=!0,Xr(e)}(gc.bind(null,e)):Xr(gc.bind(null,e)),pr(function(){!(6&Fl)&&Kr()}),n=null;else{switch(Ct(i)){case 1:n=rt;break;case 4:n=ot;break;case 16:default:n=st;break;case 536870912:n=lt}n=Oc(n,hc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function hc(e,t){if(sc=-1,ac=0,6&Fl)throw Error(n(327));var i=e.callbackNode;if(Lc()&&e.callbackNode!==i)return null;var r=_t(e,e===Ol?zl:0);if(0===r)return null;if(30&r||0!==(r&e.expiredLanes)||t)t=Ec(e,r);else{t=r;var o=Fl;Fl|=2;var s=wc();for(Ol===e&&zl===t||(Zl=null,Kl=nt()+500,bc(e,t));;)try{Tc();break}catch(l){xc(e,l)}No(),Ml.current=s,Fl=o,null!==Bl?t=0:(Ol=null,zl=0,t=Hl)}if(0!==t){if(2===t&&0!==(o=vt(e))&&(r=o,t=fc(e,o)),1===t)throw i=Wl,bc(e,0),mc(e,r),dc(e,nt()),i;if(6===t)mc(e,r);else{if(o=e.current.alternate,!(30&r||function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],o=r.getSnapshot;r=r.value;try{if(!mi(o(),r))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)||(t=Ec(e,r),2===t&&(s=vt(e),0!==s&&(r=s,t=fc(e,s))),1!==t)))throw i=Wl,bc(e,0),mc(e,r),dc(e,nt()),i;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(n(345));case 2:case 5:Ac(e,ql,Zl);break;case 3:if(mc(e,r),(130023424&r)===r&&10<(t=Xl+500-nt())){if(0!==_t(e,0))break;if(((o=e.suspendedLanes)&r)!==r){lc(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=dr(Ac.bind(null,e,ql,Zl),t);break}Ac(e,ql,Zl);break;case 4:if(mc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,o=-1;0<r;){var a=31-dt(r);s=1<<a,(a=t[a])>o&&(o=a),r&=~s}if(r=o,10<(r=(120>(r=nt()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Pl(r/1960))-r)){e.timeoutHandle=dr(Ac.bind(null,e,ql,Zl),r);break}Ac(e,ql,Zl);break;default:throw Error(n(329))}}}return dc(e,nt()),e.callbackNode===i?hc.bind(null,e):null}function fc(e,t){var n=Yl;return e.current.memoizedState.isDehydrated&&(bc(e,t).flags|=256),2!==(e=Ec(e,t))&&(t=ql,ql=n,null!==t&&pc(t)),e}function pc(e){null===ql?ql=e:ql.push.apply(ql,e)}function mc(e,t){for(t&=~jl,t&=~Gl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-dt(t),i=1<<n;e[n]=-1,t&=~i}}function gc(e){if(6&Fl)throw Error(n(327));Lc();var t=_t(e,0);if(!(1&t))return dc(e,nt()),null;var i=Ec(e,t);if(0!==e.tag&&2===i){var r=vt(e);0!==r&&(t=r,i=fc(e,r))}if(1===i)throw i=Wl,bc(e,0),mc(e,t),dc(e,nt()),i;if(6===i)throw Error(n(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ac(e,ql,Zl),dc(e,nt()),null}function _c(e,t){var n=Fl;Fl|=1;try{return e(t)}finally{0===(Fl=n)&&(Kl=nt()+500,Yr&&Kr())}}function yc(e){null!==nc&&0===nc.tag&&!(6&Fl)&&Lc();var t=Fl;Fl|=1;var n=Nl.transition,i=Et;try{if(Nl.transition=null,Et=1,e)return e()}finally{Et=i,Nl.transition=n,!(6&(Fl=t))&&Kr()}}function vc(){Ul=Vl.current,Mr(Vl)}function bc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,hr(n)),null!==Bl)for(n=Bl.return;null!==n;){var i=n;switch(co(i),i.tag){case 1:null!=(i=i.type.childContextTypes)&&Vr();break;case 3:ss(),Mr(Or),Mr(Fr),hs();break;case 5:ls(i);break;case 4:ss();break;case 13:case 19:Mr(cs);break;case 10:Fo(i.type._context);break;case 22:case 23:vc()}n=n.return}if(Ol=e,Bl=e=Vc(e.current,null),zl=Ul=t,Hl=0,Wl=null,jl=Gl=$l=0,ql=Yl=null,null!==Uo){for(t=0;t<Uo.length;t++)if(null!==(i=(n=Uo[t]).interleaved)){n.interleaved=null;var r=i.next,o=n.pending;if(null!==o){var s=o.next;o.next=r,i.next=s}n.pending=i}Uo=null}return e}function xc(e,t){for(;;){var i=Bl;try{if(No(),fs.current=aa,vs){for(var r=gs.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}vs=!1}if(ms=0,ys=_s=gs=null,bs=!1,xs=0,Dl.current=null,null===i||null===i.return){Hl=1,Wl=t,Bl=null;break}e:{var s=e,a=i.return,l=i,c=t;if(t=zl,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,d=l,h=d.tag;if(!(1&d.mode||0!==h&&11!==h&&15!==h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=Ea(a);if(null!==p){p.flags&=-257,Ca(p,a,l,0,t),1&p.mode&&Sa(s,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(!(1&t)){Sa(s,u,t),Sc();break e}c=Error(n(426))}else if(fo&&1&l.mode){var _=Ea(a);if(null!==_){!(65536&_.flags)&&(_.flags|=256),Ca(_,a,l,0,t),So(ya(c,l));break e}}s=c=ya(c,l),4!==Hl&&(Hl=2),null===Yl?Yl=[s]:Yl.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Zo(s,xa(0,c,t));break e;case 1:l=c;var y=s.type,v=s.stateNode;if(!(128&s.flags||"function"!=typeof y.getDerivedStateFromError&&(null===v||"function"!=typeof v.componentDidCatch||null!==ec&&ec.has(v)))){s.flags|=65536,t&=-t,s.lanes|=t,Zo(s,wa(s,l,t));break e}}s=s.return}while(null!==s)}Ic(i)}catch(b){t=b,Bl===i&&null!==i&&(Bl=i=i.return);continue}break}}function wc(){var e=Ml.current;return Ml.current=aa,null===e?aa:e}function Sc(){0!==Hl&&3!==Hl&&2!==Hl||(Hl=4),null===Ol||!(268435455&$l)&&!(268435455&Gl)||mc(Ol,zl)}function Ec(e,t){var i=Fl;Fl|=2;var r=wc();for(Ol===e&&zl===t||(Zl=null,bc(e,t));;)try{Cc();break}catch(qe){xc(e,qe)}if(No(),Fl=i,Ml.current=r,null!==Bl)throw Error(n(261));return Ol=null,zl=0,Hl}function Cc(){for(;null!==Bl;)kc(Bl)}function Tc(){for(;null!==Bl&&!et();)kc(Bl)}function kc(e){var t=Rl(e.alternate,e,Ul);e.memoizedProps=e.pendingProps,null===t?Ic(e):Bl=t,Dl.current=null}function Ic(e){var t=e;do{var n=t.alternate;if(e=t.return,32768&t.flags){if(null!==(n=nl(n,t)))return n.flags&=32767,void(Bl=n);if(null===e)return Hl=6,void(Bl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(n=tl(n,t,Ul)))return void(Bl=n);if(null!==(t=t.sibling))return void(Bl=t);Bl=t=e}while(null!==t);0===Hl&&(Hl=5)}function Ac(e,t,i){var r=Et,o=Nl.transition;try{Nl.transition=null,Et=1,function(e,t,i,r){do{Lc()}while(null!==nc);if(6&Fl)throw Error(n(327));i=e.finishedWork;var o=e.finishedLanes;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(n(177));e.callbackNode=null,e.callbackPriority=0;var s=i.lanes|i.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-dt(n),o=1<<r;t[r]=0,i[r]=-1,e[r]=-1,n&=~o}}(e,s),e===Ol&&(Bl=Ol=null,zl=0),!(2064&i.subtreeFlags)&&!(2064&i.flags)||tc||(tc=!0,Oc(st,function(){return Lc(),null})),s=!!(15990&i.flags),15990&i.subtreeFlags||s){s=Nl.transition,Nl.transition=null;var a=Et;Et=1;var l=Fl;Fl|=4,Dl.current=null,function(e,t){if(lr=Kt,xi(e=bi())){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(i=(i=e.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(r&&0!==r.rangeCount){i=r.anchorNode;var o=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{i.nodeType,s.nodeType}catch(x){i=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==i||0!==o&&3!==h.nodeType||(l=a+o),h!==s||0!==r&&3!==h.nodeType||(c=a+r),3===h.nodeType&&(a+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===i&&++u===o&&(l=a),f===s&&++d===r&&(c=a),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}i=-1===l||-1===c?null:{start:l,end:c}}else i=null}i=i||{start:0,end:0}}else i=null;for(cr={focusedElem:e,selectionRange:i},Kt=!1,sl=t;null!==sl;)if(e=(t=sl).child,1028&t.subtreeFlags&&null!==e)e.return=t,sl=e;else for(;null!==sl;){t=sl;try{var m=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,_=m.memoizedState,y=t.stateNode,v=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:da(t.type,g),_);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(n(163))}}catch(x){Pc(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,sl=e;break}sl=t.return}m=cl,cl=!1}(e,i),El(i,e),wi(cr),Kt=!!lr,cr=lr=null,e.current=i,Tl(i),tt(),Fl=l,Et=a,Nl.transition=s}else e.current=i;if(tc&&(tc=!1,nc=e,ic=o),0===(s=e.pendingLanes)&&(ec=null),function(e){if(ut&&"function"==typeof ut.onCommitFiberRoot)try{ut.onCommitFiberRoot(ct,e,void 0,!(128&~e.current.flags))}catch(t){}}(i.stateNode),dc(e,nt()),null!==t)for(r=e.onRecoverableError,i=0;i<t.length;i++)r((o=t[i]).value,{componentStack:o.stack,digest:o.digest});if(Ql)throw Ql=!1,e=Jl,Jl=null,e;!!(1&ic)&&0!==e.tag&&Lc(),1&(s=e.pendingLanes)?e===oc?rc++:(rc=0,oc=e):rc=0,Kr()}(e,t,i,r)}finally{Nl.transition=o,Et=r}return null}function Lc(){if(null!==nc){var e=Ct(ic),t=Nl.transition,i=Et;try{if(Nl.transition=null,Et=16>e?16:e,null===nc)var r=!1;else{if(e=nc,nc=null,ic=0,6&Fl)throw Error(n(331));var o=Fl;for(Fl|=4,sl=e.current;null!==sl;){var s=sl,a=s.child;if(16&sl.flags){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(sl=u;null!==sl;){var d=sl;switch(d.tag){case 0:case 11:case 15:ul(8,d,s)}var h=d.child;if(null!==h)h.return=d,sl=h;else for(;null!==sl;){var f=(d=sl).sibling,p=d.return;if(fl(d),d===u){sl=null;break}if(null!==f){f.return=p,sl=f;break}sl=p}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var _=g.sibling;g.sibling=null,g=_}while(null!==g)}}sl=s}}if(2064&s.subtreeFlags&&null!==a)a.return=s,sl=a;else e:for(;null!==sl;){if(2048&(s=sl).flags)switch(s.tag){case 0:case 11:case 15:ul(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,sl=y;break e}sl=s.return}}var v=e.current;for(sl=v;null!==sl;){var b=(a=sl).child;if(2064&a.subtreeFlags&&null!==b)b.return=a,sl=b;else e:for(a=v;null!==sl;){if(2048&(l=sl).flags)try{switch(l.tag){case 0:case 11:case 15:dl(9,l)}}catch(w){Pc(l,l.return,w)}if(l===a){sl=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,sl=x;break e}sl=l.return}}if(Fl=o,Kr(),ut&&"function"==typeof ut.onPostCommitFiberRoot)try{ut.onPostCommitFiberRoot(ct,e)}catch(w){}r=!0}return r}finally{Et=i,Nl.transition=t}}return!1}function Rc(e,t,n){e=qo(e,t=xa(0,t=ya(n,t),1),1),t=lc(),null!==e&&(wt(e,1,t),dc(e,t))}function Pc(e,t,n){if(3===e.tag)Rc(e,e,n);else for(;null!==t;){if(3===t.tag){Rc(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===ec||!ec.has(i))){t=qo(t,e=wa(t,e=ya(n,e),1),1),e=lc(),null!==t&&(wt(t,1,e),dc(t,e));break}}t=t.return}}function Mc(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=lc(),e.pingedLanes|=e.suspendedLanes&n,Ol===e&&(zl&n)===n&&(4===Hl||3===Hl&&(130023424&zl)===zl&&500>nt()-Xl?bc(e,0):jl|=n),dc(e,t)}function Dc(e,t){0===t&&(1&e.mode?(t=mt,!(130023424&(mt<<=1))&&(mt=4194304)):t=1);var n=lc();null!==(e=Wo(e,t))&&(wt(e,t,n),dc(e,n))}function Nc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Dc(e,n)}function Fc(e,t){var i=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(i=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(n(314))}null!==r&&r.delete(t),Dc(e,i)}function Oc(e,t){return Qe(e,t)}function Bc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zc(e,t,n,i){return new Bc(e,t,n,i)}function Uc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Vc(e,t){var n=e.alternate;return null===n?((n=zc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Hc(e,t,i,r,o,s){var a=2;if(r=e,"function"==typeof e)Uc(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case x:return Wc(i.children,o,s,t);case w:a=8,o|=8;break;case T:return(e=zc(12,i,t,2|o)).elementType=T,e.lanes=s,e;case M:return(e=zc(13,i,t,o)).elementType=M,e.lanes=s,e;case D:return(e=zc(19,i,t,o)).elementType=D,e.lanes=s,e;case O:return $c(i,o,s,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case k:a=10;break e;case I:a=9;break e;case A:a=11;break e;case N:a=14;break e;case F:a=16,r=null;break e}throw Error(n(130,null==e?e:typeof e,""))}return(t=zc(a,i,t,o)).elementType=e,t.type=r,t.lanes=s,t}function Wc(e,t,n,i){return(e=zc(7,e,i,t)).lanes=n,e}function $c(e,t,n,i){return(e=zc(22,e,i,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Gc(e,t,n){return(e=zc(6,e,null,t)).lanes=n,e}function jc(e,t,n){return(t=zc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Yc(e,t,n,i,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xt(0),this.expirationTimes=xt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xt(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function qc(e,t,n,i,r,o,s,a,l){return e=new Yc(e,t,n,a,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=zc(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Go(o),e}function Xc(e){if(!e)return Nr;e:{if(je(e=e._reactInternals)!==e||1!==e.tag)throw Error(n(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ur(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(n(171))}if(1===e.tag){var i=e.type;if(Ur(i))return Wr(e,i,t)}return t}function Kc(e,t,n,i,r,o,s,a,l){return(e=qc(n,i,!0,e,0,o,0,a,l)).context=Xc(null),n=e.current,(o=Yo(i=lc(),r=cc(n))).callback=null!=t?t:null,qo(n,o,r),e.current.lanes=r,wt(e,r,i),dc(e,i),e}function Zc(e,t,n,i){var r=t.current,o=lc(),s=cc(r);return n=Xc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Yo(o,s)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),null!==(e=qo(r,t,s))&&(uc(e,r,s,o),Xo(e,r,s)),s}function Qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Jc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function eu(e,t){Jc(e,t),(e=e.alternate)&&Jc(e,t)}Rl=function(e,t,i){if(null!==e)if(e.memoizedProps!==t.pendingProps||Or.current)ka=!0;else{if(0===(e.lanes&i)&&!(128&t.flags))return ka=!1,function(e,t,n){switch(t.tag){case 3:Oa(t),wo();break;case 5:as(t);break;case 1:Ur(t.type)&&$r(t);break;case 4:os(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,r=t.memoizedProps.value;Dr(Ro,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Dr(cs,1&cs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ga(e,t,n):(Dr(cs,1&cs.current),null!==(e=Qa(e,t,n))?e.sibling:null);Dr(cs,1&cs.current);break;case 19:if(i=0!==(n&t.childLanes),128&e.flags){if(i)return Ka(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Dr(cs,cs.current),i)break;return null;case 22:case 23:return t.lanes=0,Pa(e,t,n)}return Qa(e,t,n)}(e,t,i);ka=!!(131072&e.flags)}else ka=!1,fo&&1048576&t.flags&&ao(t,eo,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Za(e,t),e=t.pendingProps;var o=zr(t,Fr.current);Bo(t,i),o=Cs(null,t,r,e,o,i);var s=Ts();return t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ur(r)?(s=!0,$r(t)):s=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,Go(t),o.updater=fa,t.stateNode=o,o._reactInternals=t,_a(t,r,e,i),t=Fa(null,t,r,!0,s,i)):(t.tag=0,fo&&s&&lo(t),Ia(null,t,o,i),t=t.child),t;case 16:r=t.elementType;e:{switch(Za(e,t),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"==typeof e)return Uc(e)?1:0;if(null!=e){if((e=e.$$typeof)===A)return 11;if(e===N)return 14}return 2}(r),e=da(r,e),o){case 0:t=Da(null,t,r,e,i);break e;case 1:t=Na(null,t,r,e,i);break e;case 11:t=Aa(null,t,r,e,i);break e;case 14:t=La(null,t,r,da(r.type,e),i);break e}throw Error(n(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,Da(e,t,r,o=t.elementType===r?o:da(r,o),i);case 1:return r=t.type,o=t.pendingProps,Na(e,t,r,o=t.elementType===r?o:da(r,o),i);case 3:e:{if(Oa(t),null===e)throw Error(n(387));r=t.pendingProps,o=(s=t.memoizedState).element,jo(e,t),Qo(t,r,null,i);var a=t.memoizedState;if(r=a.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ba(e,t,r,i,o=ya(Error(n(423)),t));break e}if(r!==o){t=Ba(e,t,r,i,o=ya(Error(n(424)),t));break e}for(ho=_r(t.stateNode.containerInfo.firstChild),uo=t,fo=!0,po=null,i=Lo(t,null,r,i),t.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(wo(),r===o){t=Qa(e,t,i);break e}Ia(e,t,r,i)}t=t.child}return t;case 5:return as(t),null===e&&yo(t),r=t.type,o=t.pendingProps,s=null!==e?e.memoizedProps:null,a=o.children,ur(r,o)?a=null:null!==s&&ur(r,s)&&(t.flags|=32),Ma(e,t),Ia(e,t,a,i),t.child;case 6:return null===e&&yo(t),null;case 13:return Ga(e,t,i);case 4:return os(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ao(t,null,r,i):Ia(e,t,r,i),t.child;case 11:return r=t.type,o=t.pendingProps,Aa(e,t,r,o=t.elementType===r?o:da(r,o),i);case 7:return Ia(e,t,t.pendingProps,i),t.child;case 8:case 12:return Ia(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,s=t.memoizedProps,a=o.value,Dr(Ro,r._currentValue),r._currentValue=a,null!==s)if(mi(s.value,a)){if(s.children===o.children&&!Or.current){t=Qa(e,t,i);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===s.tag){(c=Yo(-1,i&-i)).tag=2;var u=s.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=i,null!==(c=s.alternate)&&(c.lanes|=i),Oo(s.return,i,t),l.lanes|=i;break}c=c.next}}else if(10===s.tag)a=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(n(341));a.lanes|=i,null!==(l=a.alternate)&&(l.lanes|=i),Oo(a,i,t),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}Ia(e,t,o.children,i),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,Bo(t,i),r=r(o=zo(o)),t.flags|=1,Ia(e,t,r,i),t.child;case 14:return o=da(r=t.type,t.pendingProps),La(e,t,r,o=da(r.type,o),i);case 15:return Ra(e,t,t.type,t.pendingProps,i);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:da(r,o),Za(e,t),t.tag=1,Ur(r)?(e=!0,$r(t)):e=!1,Bo(t,i),ma(t,r,o),_a(t,r,o,i),Fa(null,t,r,!0,e,i);case 19:return Ka(e,t,i);case 22:return Pa(e,t,i)}throw Error(n(156,t.tag))};var tu="function"==typeof reportError?reportError:function(e){};function nu(e){this._internalRoot=e}function iu(e){this._internalRoot=e}function ru(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function ou(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function su(){}function au(e,t,n,i,r){var o=n._reactRootContainer;if(o){var s=o;if("function"==typeof r){var a=r;r=function(){var e=Qc(s);a.call(e)}}Zc(t,s,e,r)}else s=function(e,t,n,i,r){if(r){if("function"==typeof i){var o=i;i=function(){var e=Qc(s);o.call(e)}}var s=Kc(t,i,e,0,null,!1,0,"",su);return e._reactRootContainer=s,e[wr]=s.current,Ki(8===e.nodeType?e.parentNode:e),yc(),s}for(;r=e.lastChild;)e.removeChild(r);if("function"==typeof i){var a=i;i=function(){var e=Qc(l);a.call(e)}}var l=qc(e,0,!1,null,0,!1,0,"",su);return e._reactRootContainer=l,e[wr]=l.current,Ki(8===e.nodeType?e.parentNode:e),yc(function(){Zc(t,l,n,i)}),l}(n,t,e,r,i);return Qc(s)}iu.prototype.render=nu.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(n(409));Zc(e,t,null,null)},iu.prototype.unmount=nu.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;yc(function(){Zc(null,e,null,null)}),t[wr]=null}},iu.prototype.unstable_scheduleHydration=function(e){if(e){var t=At();e={blockedOn:null,target:e,priority:t};for(var n=0;n<zt.length&&0!==t&&t<zt[n].priority;n++);zt.splice(n,0,e),0===n&&Wt(e)}},Tt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=gt(t.pendingLanes);0!==n&&(St(t,1|n),dc(t,nt()),!(6&Fl)&&(Kl=nt()+500,Kr()))}break;case 13:yc(function(){var t=Wo(e,1);if(null!==t){var n=lc();uc(t,e,1,n)}}),eu(e,1)}},kt=function(e){if(13===e.tag){var t=Wo(e,134217728);null!==t&&uc(t,e,134217728,lc()),eu(e,134217728)}},It=function(e){if(13===e.tag){var t=cc(e),n=Wo(e,t);null!==n&&uc(n,e,t,lc()),eu(e,t)}},At=function(){return Et},Lt=function(e,t){var n=Et;try{return Et=e,t()}finally{Et=n}},Te=function(e,t,i){switch(t){case"input":if(ne(e,i),t=i.name,"radio"===i.type&&null!=t){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var r=i[t];if(r!==e&&r.form===e.form){var o=Ar(r);if(!o)throw Error(n(90));Z(r),ne(r,o)}}}break;case"textarea":ce(e,i);break;case"select":null!=(t=i.value)&&se(e,!!i.multiple,t,!1)}},Pe=_c,Me=yc;var lu={usingClientEntryPoint:!1,Events:[kr,Ir,Ar,Le,Re,_c]},cu={findFiberByHostInstance:Tr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},uu={bundleType:cu.bundleType,version:cu.version,rendererPackageName:cu.rendererPackageName,rendererConfig:cu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ke(e))?null:e.stateNode},findFiberByHostInstance:cu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var du=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!du.isDisabled&&du.supportsFiber)try{ct=du.inject(uu),ut=du}catch(pe){}}return L.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lu,L.createPortal=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!ru(t))throw Error(n(200));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:b,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,i)},L.createRoot=function(e,t){if(!ru(e))throw Error(n(299));var i=!1,r="",o=tu;return null!=t&&(!0===t.unstable_strictMode&&(i=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=qc(e,1,!1,null,0,i,0,r,o),e[wr]=t.current,Ki(8===e.nodeType?e.parentNode:e),new nu(t)},L.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(n(188));throw e=Object.keys(e).join(","),Error(n(268,e))}return null===(e=Ke(t))?null:e.stateNode},L.flushSync=function(e){return yc(e)},L.hydrate=function(e,t,i){if(!ou(t))throw Error(n(200));return au(null,e,t,!0,i)},L.hydrateRoot=function(e,t,i){if(!ru(e))throw Error(n(405));var r=null!=i&&i.hydratedSources||null,o=!1,s="",a=tu;if(null!=i&&(!0===i.unstable_strictMode&&(o=!0),void 0!==i.identifierPrefix&&(s=i.identifierPrefix),void 0!==i.onRecoverableError&&(a=i.onRecoverableError)),t=Kc(t,null,e,1,null!=i?i:null,o,0,s,a),e[wr]=t.current,Ki(e),r)for(e=0;e<r.length;e++)o=(o=(i=r[e])._getVersion)(i._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[i,o]:t.mutableSourceEagerHydrationData.push(i,o);return new iu(t)},L.render=function(e,t,i){if(!ou(t))throw Error(n(200));return au(null,e,t,!1,i)},L.unmountComponentAtNode=function(e){if(!ou(e))throw Error(n(40));return!!e._reactRootContainer&&(yc(function(){au(null,null,e,!1,function(){e._reactRootContainer=null,e[wr]=null})}),!0)},L.unstable_batchedUpdates=_c,L.unstable_renderSubtreeIntoContainer=function(e,t,i,r){if(!ou(i))throw Error(n(200));if(null==e||void 0===e._reactInternals)throw Error(n(38));return au(e,t,i,!1,r)},L.version="18.3.1-next-f1338f8080-20240426",L}function D(){return T||(T=1,function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){}}(),A.exports=M()),A.exports}var N=function(){if(k)return I;k=1;var e=D();return I.createRoot=e.createRoot,I.hydrateRoot=e.hydrateRoot,I}(),F=D();const O={},B=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),r=(null==n?void 0:n.nonce)||(null==n?void 0:n.getAttribute("nonce"));i=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in O)return;O[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const i=document.createElement("link");return i.rel=t?"stylesheet":"modulepreload",t||(i.as="script"),i.crossOrigin="",i.href=e,r&&i.setAttribute("nonce",r),document.head.appendChild(i),t?new Promise((t,n)=>{i.addEventListener("load",t),i.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return i.then(t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})},z="undefined"!=typeof document?x.useLayoutEffect:()=>{},U=e=>{var t;return null!==(t=null==e?void 0:e.ownerDocument)&&void 0!==t?t:document},V=e=>e&&"window"in e&&e.window===e?e:U(e).defaultView||window;function H(e,t){return!(!t||!e)&&e.contains(t)}const W=(e=document)=>e.activeElement;function $(e){return e.target}function G(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=G(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function j(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=G(e))&&(i&&(i+=" "),i+=t);return i}let Y=null;function q(e){var t;if("undefined"==typeof window||null==window.navigator)return!1;let n=null===(t=window.navigator.userAgentData)||void 0===t?void 0:t.brands;return Array.isArray(n)&&n.some(t=>e.test(t.brand))||e.test(window.navigator.userAgent)}function X(e){var t;return"undefined"!=typeof window&&null!=window.navigator&&e.test((null===(t=window.navigator.userAgentData)||void 0===t?void 0:t.platform)||window.navigator.platform)}function K(e){let t=null;return()=>(null==t&&(t=e()),t)}const Z=K(function(){return X(/^Mac/i)}),Q=K(function(){return X(/^iPad/i)||Z()&&navigator.maxTouchPoints>1}),J=K(function(){return q(/AppleWebKit/i)&&!ee()}),ee=K(function(){return q(/Chrome/i)}),te=K(function(){return q(/Android/i)}),ne=K(function(){return q(/Firefox/i)});function ie(e,t,n=!0){var i,r;let{metaKey:o,ctrlKey:s,altKey:a,shiftKey:l}=t;ne()&&(null===(r=window.event)||void 0===r||null===(i=r.type)||void 0===i?void 0:i.startsWith("key"))&&"_blank"===e.target&&(Z()?o=!0:s=!0);let c=J()&&Z()&&!Q()?new KeyboardEvent("keydown",{keyIdentifier:"Enter",metaKey:o,ctrlKey:s,altKey:a,shiftKey:l}):new MouseEvent("click",{metaKey:o,ctrlKey:s,altKey:a,shiftKey:l,detail:1,bubbles:!0,cancelable:!0});ie.isOpening=n,function(e){if(function(){if(null==Y){Y=!1;try{document.createElement("div").focus({get preventScroll(){return Y=!0,!0}})}catch{}}return Y}())e.focus({preventScroll:!0});else{let t=function(e){let t=e.parentNode,n=[],i=document.scrollingElement||document.documentElement;for(;t instanceof HTMLElement&&t!==i;)(t.offsetHeight<t.scrollHeight||t.offsetWidth<t.scrollWidth)&&n.push({element:t,scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}),t=t.parentNode;return i instanceof HTMLElement&&n.push({element:i,scrollTop:i.scrollTop,scrollLeft:i.scrollLeft}),n}(e);e.focus(),function(e){for(let{element:t,scrollTop:n,scrollLeft:i}of e)t.scrollTop=n,t.scrollLeft=i}(t)}}(e),e.dispatchEvent(c),ie.isOpening=!1}function re(){let e=b.useRef(new Map),t=b.useCallback((t,n,i,r)=>{let o=(null==r?void 0:r.once)?(...t)=>{e.current.delete(i),i(...t)}:i;e.current.set(i,{type:n,eventTarget:t,fn:o,options:r}),t.addEventListener(n,o,r)},[]),n=b.useCallback((t,n,i,r)=>{var o;let s=(null===(o=e.current.get(i))||void 0===o?void 0:o.fn)||i;t.removeEventListener(n,s,r),e.current.delete(i)},[]),i=b.useCallback(()=>{e.current.forEach((e,t)=>{n(e.eventTarget,e.type,t,e.options)})},[n]);return b.useEffect(()=>i,[i]),{addGlobalListener:t,removeGlobalListener:n,removeAllGlobalListeners:i}}function oe(e){let t=e;return t.nativeEvent=e,t.isDefaultPrevented=()=>t.defaultPrevented,t.isPropagationStopped=()=>t.cancelBubble,t.persist=()=>{},t}function se(e){let t=b.useRef({isFocused:!1,observer:null});return z(()=>{const e=t.current;return()=>{e.observer&&(e.observer.disconnect(),e.observer=null)}},[]),b.useCallback(n=>{if(n.target instanceof HTMLButtonElement||n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLSelectElement){t.current.isFocused=!0;let i=n.target,r=n=>{if(t.current.isFocused=!1,i.disabled){let t=oe(n);null==e||e(t)}t.current.observer&&(t.current.observer.disconnect(),t.current.observer=null)};i.addEventListener("focusout",r,{once:!0}),t.current.observer=new MutationObserver(()=>{if(t.current.isFocused&&i.disabled){var e;null===(e=t.current.observer)||void 0===e||e.disconnect();let n=i===document.activeElement?null:document.activeElement;i.dispatchEvent(new FocusEvent("blur",{relatedTarget:n})),i.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:n}))}}),t.current.observer.observe(i,{attributes:!0,attributeFilter:["disabled"]})}},[e])}ie.isOpening=!1;let ae=null,le=new Set,ce=new Map,ue=!1,de=!1;const he={Tab:!0,Escape:!0};function fe(e,t){for(let n of le)n(e,t)}function pe(e){ue=!0,!ie.isOpening&&function(e){return!(e.metaKey||!Z()&&e.altKey||e.ctrlKey||"Control"===e.key||"Shift"===e.key||"Meta"===e.key)}(e)&&(ae="keyboard",fe("keyboard",e))}function me(e){ae="pointer",!("pointerType"in e)||e.pointerType,"mousedown"!==e.type&&"pointerdown"!==e.type||(ue=!0,fe("pointer",e))}function ge(e){var t;!ie.isOpening&&(""===(t=e).pointerType&&t.isTrusted||(te()&&t.pointerType?"click"===t.type&&1===t.buttons:0===t.detail&&!t.pointerType))&&(ue=!0,ae="virtual")}function _e(e){e.target!==window&&e.target!==document&&e.isTrusted&&(ue||de||(ae="virtual",fe("virtual",e)),ue=!1,de=!1)}function ye(){ue=!1,de=!0}function ve(e){if("undefined"==typeof window||"undefined"==typeof document||ce.get(V(e)))return;const t=V(e),n=U(e);let i=t.HTMLElement.prototype.focus;t.HTMLElement.prototype.focus=function(){ue=!0,i.apply(this,arguments)},n.addEventListener("keydown",pe,!0),n.addEventListener("keyup",pe,!0),n.addEventListener("click",ge,!0),t.addEventListener("focus",_e,!0),t.addEventListener("blur",ye,!1),"undefined"!=typeof PointerEvent&&(n.addEventListener("pointerdown",me,!0),n.addEventListener("pointermove",me,!0),n.addEventListener("pointerup",me,!0)),t.addEventListener("beforeunload",()=>{be(e)},{once:!0}),ce.set(t,{focus:i})}const be=(e,t)=>{const n=V(e),i=U(e);t&&i.removeEventListener("DOMContentLoaded",t),ce.has(n)&&(n.HTMLElement.prototype.focus=ce.get(n).focus,i.removeEventListener("keydown",pe,!0),i.removeEventListener("keyup",pe,!0),i.removeEventListener("click",ge,!0),n.removeEventListener("focus",_e,!0),n.removeEventListener("blur",ye,!1),"undefined"!=typeof PointerEvent&&(i.removeEventListener("pointerdown",me,!0),i.removeEventListener("pointermove",me,!0),i.removeEventListener("pointerup",me,!0)),ce.delete(n))};function xe(){return"pointer"!==ae}"undefined"!=typeof document&&function(e){const t=U(e);let n;"loading"!==t.readyState?ve(e):(n=()=>{ve(e)},t.addEventListener("DOMContentLoaded",n))}();const we=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let Se=!1,Ee=0;function Ce(e){"touch"===e.pointerType&&(Se=!0,setTimeout(()=>{Se=!1},50))}function Te(){if("undefined"!=typeof document)return 0===Ee&&"undefined"!=typeof PointerEvent&&document.addEventListener("pointerup",Ce),Ee++,()=>{Ee--,Ee>0||"undefined"!=typeof PointerEvent&&document.removeEventListener("pointerup",Ce)}}function ke(e){let{onHoverStart:t,onHoverChange:n,onHoverEnd:i,isDisabled:r}=e,[o,s]=b.useState(!1),a=b.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;b.useEffect(Te,[]);let{addGlobalListener:l,removeAllGlobalListeners:c}=re(),{hoverProps:u,triggerHoverEnd:d}=b.useMemo(()=>{let e=(e,t)=>{let r=a.target;a.pointerType="",a.target=null,"touch"!==t&&a.isHovered&&r&&(a.isHovered=!1,c(),i&&i({type:"hoverend",target:r,pointerType:t}),n&&n(!1),s(!1))},o={};return"undefined"!=typeof PointerEvent&&(o.onPointerEnter=i=>{Se&&"mouse"===i.pointerType||((i,o)=>{if(a.pointerType=o,r||"touch"===o||a.isHovered||!i.currentTarget.contains(i.target))return;a.isHovered=!0;let c=i.currentTarget;a.target=c,l(U(i.target),"pointerover",t=>{a.isHovered&&a.target&&!H(a.target,t.target)&&e(0,t.pointerType)},{capture:!0}),t&&t({type:"hoverstart",target:c,pointerType:o}),n&&n(!0),s(!0)})(i,i.pointerType)},o.onPointerLeave=t=>{!r&&t.currentTarget.contains(t.target)&&e(0,t.pointerType)}),{hoverProps:o,triggerHoverEnd:e}},[t,n,i,r,a,l,c]);return b.useEffect(()=>{r&&d({currentTarget:a.target},a.pointerType)},[r]),{hoverProps:u,isHovered:o}}function Ie(e={}){let{autoFocus:t=!1,isTextInput:n,within:i}=e,r=b.useRef({isFocused:!1,isFocusVisible:t||xe()}),[o,s]=b.useState(!1),[a,l]=b.useState(()=>r.current.isFocused&&r.current.isFocusVisible),c=b.useCallback(()=>l(r.current.isFocused&&r.current.isFocusVisible),[]),u=b.useCallback(e=>{r.current.isFocused=e,s(e),c()},[c]);var d,h,f;d=e=>{r.current.isFocusVisible=e,c()},h=[],f={isTextInput:n},ve(),b.useEffect(()=>{let e=(e,t)=>{(function(e,t,n){let i=U(null==n?void 0:n.target);const r="undefined"!=typeof window?V(null==n?void 0:n.target).HTMLInputElement:HTMLInputElement,o="undefined"!=typeof window?V(null==n?void 0:n.target).HTMLTextAreaElement:HTMLTextAreaElement,s="undefined"!=typeof window?V(null==n?void 0:n.target).HTMLElement:HTMLElement,a="undefined"!=typeof window?V(null==n?void 0:n.target).KeyboardEvent:KeyboardEvent;return!((e=e||i.activeElement instanceof r&&!we.has(i.activeElement.type)||i.activeElement instanceof o||i.activeElement instanceof s&&i.activeElement.isContentEditable)&&"keyboard"===t&&n instanceof a&&!he[n.key])})(!!(null==f?void 0:f.isTextInput),e,t)&&d(xe())};return le.add(e),()=>{le.delete(e)}},h);let{focusProps:p}=function(e){let{isDisabled:t,onFocus:n,onBlur:i,onFocusChange:r}=e;const o=b.useCallback(e=>{if(e.target===e.currentTarget)return i&&i(e),r&&r(!1),!0},[i,r]),s=se(o),a=b.useCallback(e=>{const t=U(e.target),i=t?W(t):W();e.target===e.currentTarget&&i===$(e.nativeEvent)&&(n&&n(e),r&&r(!0),s(e))},[r,n,s]);return{focusProps:{onFocus:!t&&(n||r||i)?a:void 0,onBlur:t||!i&&!r?void 0:o}}}({isDisabled:i,onFocusChange:u}),{focusWithinProps:m}=function(e){let{isDisabled:t,onBlurWithin:n,onFocusWithin:i,onFocusWithinChange:r}=e,o=b.useRef({isFocusWithin:!1}),{addGlobalListener:s,removeAllGlobalListeners:a}=re(),l=b.useCallback(e=>{e.currentTarget.contains(e.target)&&o.current.isFocusWithin&&!e.currentTarget.contains(e.relatedTarget)&&(o.current.isFocusWithin=!1,a(),n&&n(e),r&&r(!1))},[n,r,o,a]),c=se(l),u=b.useCallback(e=>{if(!e.currentTarget.contains(e.target))return;const t=U(e.target),n=W(t);if(!o.current.isFocusWithin&&n===$(e.nativeEvent)){i&&i(e),r&&r(!0),o.current.isFocusWithin=!0,c(e);let n=e.currentTarget;s(t,"focus",e=>{if(o.current.isFocusWithin&&!H(n,e.target)){let i=new t.defaultView.FocusEvent("blur",{relatedTarget:e.target});!function(e,t){Object.defineProperty(e,"target",{value:t}),Object.defineProperty(e,"currentTarget",{value:t})}(i,n);let r=oe(i);l(r)}},{capture:!0})}},[i,r,c,s,l]);return t?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:u,onBlur:l}}}({isDisabled:!i,onFocusWithinChange:u});return{isFocused:o,isFocusVisible:a,focusProps:i?m:p}}var Ae=Object.defineProperty,Le=(e,t,n)=>(((e,t,n)=>{t in e?Ae(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);let Re=new class{constructor(){Le(this,"current",this.detect()),Le(this,"handoffState","pending"),Le(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return"server"===this.current}get isClient(){return"client"===this.current}detect(){return"undefined"==typeof window||"undefined"==typeof document?"server":"client"}handoff(){"pending"===this.handoffState&&(this.handoffState="complete")}get isHandoffComplete(){return"complete"===this.handoffState}};function Pe(e){var t;return Re.isServer?null:null==e?document:null!=(t=null==e?void 0:e.ownerDocument)?t:document}function Me(e){var t,n;return Re.isServer?null:null==e?document:null!=(n=null==(t=null==e?void 0:e.getRootNode)?void 0:t.call(e))?n:document}function De(e){var t,n;return null!=(n=null==(t=Me(e))?void 0:t.activeElement)?n:null}function Ne(e){return De(e)===e}function Fe(e){"function"==typeof queueMicrotask?queueMicrotask(e):Promise.resolve().then(e).catch(e=>setTimeout(()=>{throw e}))}function Oe(){let e=[],t={addEventListener:(e,n,i,r)=>(e.addEventListener(n,i,r),t.add(()=>e.removeEventListener(n,i,r))),requestAnimationFrame(...e){let n=requestAnimationFrame(...e);return t.add(()=>cancelAnimationFrame(n))},nextFrame:(...e)=>t.requestAnimationFrame(()=>t.requestAnimationFrame(...e)),setTimeout(...e){let n=setTimeout(...e);return t.add(()=>clearTimeout(n))},microTask(...e){let n={current:!0};return Fe(()=>{n.current&&e[0]()}),t.add(()=>{n.current=!1})},style(e,t,n){let i=e.style.getPropertyValue(t);return Object.assign(e.style,{[t]:n}),this.add(()=>{Object.assign(e.style,{[t]:i})})},group(e){let t=Oe();return e(t),this.add(()=>t.dispose())},add:t=>(e.includes(t)||e.push(t),()=>{let n=e.indexOf(t);if(n>=0)for(let t of e.splice(n,1))t()}),dispose(){for(let t of e.splice(0))t()}};return t}function Be(){let[e]=b.useState(Oe);return b.useEffect(()=>()=>e.dispose(),[e]),e}let ze=(e,t)=>{Re.isServer?b.useEffect(e,t):b.useLayoutEffect(e,t)};function Ue(e){let t=b.useRef(e);return ze(()=>{t.current=e},[e]),t}let Ve=function(e){let t=Ue(e);return x.useCallback((...e)=>t.current(...e),[t])};function He({disabled:e=!1}={}){let t=b.useRef(null),[n,i]=b.useState(!1),r=Be(),o=Ve(()=>{t.current=null,i(!1),r.dispose()}),s=Ve(e=>{if(r.dispose(),null===t.current){t.current=e.currentTarget,i(!0);{let n=Pe(e.currentTarget);r.addEventListener(n,"pointerup",o,!1),r.addEventListener(n,"pointermove",e=>{if(t.current){let n=function(e){let t=e.width/2,n=e.height/2;return{top:e.clientY-n,right:e.clientX+t,bottom:e.clientY+n,left:e.clientX-t}}(e);i(function(e,t){return!(!e||!t||e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom)}(n,t.current.getBoundingClientRect()))}},!1),r.addEventListener(n,"pointercancel",o,!1)}}});return{pressed:n,pressProps:e?{}:{onPointerDown:s,onPointerUp:o,onClick:o}}}function We(e){return b.useMemo(()=>e,Object.values(e))}let $e=b.createContext(void 0);function Ge(){return b.useContext($e)}function je(...e){return Array.from(new Set(e.flatMap(e=>"string"==typeof e?e.split(" "):[]))).filter(Boolean).join(" ")}function Ye(e,t,...n){if(e in t){let i=t[e];return"function"==typeof i?i(...n):i}let i=new Error(`Tried to handle "${e}" but there is no handler defined. Only defined handlers are: ${Object.keys(t).map(e=>`"${e}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,Ye),i}var qe,Xe,Ke=((Xe=Ke||{})[Xe.None=0]="None",Xe[Xe.RenderStrategy=1]="RenderStrategy",Xe[Xe.Static=2]="Static",Xe),Ze=((qe=Ze||{})[qe.Unmount=0]="Unmount",qe[qe.Hidden=1]="Hidden",qe);function Qe(){let e=function(){let e=b.useRef([]),t=b.useCallback(t=>{for(let n of e.current)null!=n&&("function"==typeof n?n(t):n.current=t)},[]);return(...n)=>{if(!n.every(e=>null==e))return e.current=n,t}}();return b.useCallback(t=>function({ourProps:e,theirProps:t,slot:n,defaultTag:i,features:r,visible:o=!0,name:s,mergeRefs:a}){a=null!=a?a:et;let l=tt(t,e);if(o)return Je(l,n,i,s,a);let c=null!=r?r:0;if(2&c){let{static:e=!1,...t}=l;if(e)return Je(t,n,i,s,a)}if(1&c){let{unmount:e=!0,...t}=l;return Ye(e?0:1,{0:()=>null,1:()=>Je({...t,hidden:!0,style:{display:"none"}},n,i,s,a)})}return Je(l,n,i,s,a)}({mergeRefs:e,...t}),[e])}function Je(e,t={},n,i,r){let{as:o=n,children:s,refName:a="ref",...l}=ot(e,["unmount","static"]),c=void 0!==e.ref?{[a]:e.ref}:{},u="function"==typeof s?s(t):s;"className"in l&&l.className&&"function"==typeof l.className&&(l.className=l.className(t)),l["aria-labelledby"]&&l["aria-labelledby"]===l.id&&(l["aria-labelledby"]=void 0);let d={};if(t){let e=!1,n=[];for(let[i,r]of Object.entries(t))"boolean"==typeof r&&(e=!0),!0===r&&n.push(i.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`));if(e){d["data-headlessui-state"]=n.join(" ");for(let e of n)d[`data-${e}`]=""}}if(at(o)&&(Object.keys(rt(l)).length>0||Object.keys(rt(d)).length>0)){if(!(!b.isValidElement(u)||Array.isArray(u)&&u.length>1||function(e){return at(e.type)}(u))){let e=u.props,t=null==e?void 0:e.className,n="function"==typeof t?(...e)=>je(t(...e),l.className):je(t,l.className),i=n?{className:n}:{},o=tt(u.props,rt(ot(l,["ref"])));for(let r in d)r in o&&delete d[r];return b.cloneElement(u,Object.assign({},o,d,c,{ref:r(st(u),c.ref)},i))}if(Object.keys(rt(l)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${i} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(rt(l)).concat(Object.keys(rt(d))).map(e=>`  - ${e}`).join("\n"),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(e=>`  - ${e}`).join("\n")].join("\n"))}return b.createElement(o,Object.assign({},ot(l,["ref"]),!at(o)&&c,!at(o)&&d),u)}function et(...e){return e.every(e=>null==e)?void 0:t=>{for(let n of e)null!=n&&("function"==typeof n?n(t):n.current=t)}}function tt(...e){if(0===e.length)return{};if(1===e.length)return e[0];let t={},n={};for(let i of e)for(let e in i)e.startsWith("on")&&"function"==typeof i[e]?(null!=n[e]||(n[e]=[]),n[e].push(i[e])):t[e]=i[e];if(t.disabled||t["aria-disabled"])for(let i in n)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(i)&&(n[i]=[e=>{var t;return null==(t=null==e?void 0:e.preventDefault)?void 0:t.call(e)}]);for(let i in n)Object.assign(t,{[i](e,...t){let r=n[i];for(let n of r){if((e instanceof Event||(null==e?void 0:e.nativeEvent)instanceof Event)&&e.defaultPrevented)return;n(e,...t)}}});return t}function nt(...e){if(0===e.length)return{};if(1===e.length)return e[0];let t={},n={};for(let i of e)for(let e in i)e.startsWith("on")&&"function"==typeof i[e]?(null!=n[e]||(n[e]=[]),n[e].push(i[e])):t[e]=i[e];for(let i in n)Object.assign(t,{[i](...e){let t=n[i];for(let n of t)null==n||n(...e)}});return t}function it(e){var t;return Object.assign(b.forwardRef(e),{displayName:null!=(t=e.displayName)?t:e.name})}function rt(e){let t=Object.assign({},e);for(let n in t)void 0===t[n]&&delete t[n];return t}function ot(e,t=[]){let n=Object.assign({},e);for(let i of t)i in n&&delete n[i];return n}function st(e){return x.version.split(".")[0]>="19"?e.props.ref:e.ref}function at(e){return e===b.Fragment||e===Symbol.for("react.fragment")}let lt=it(function(e,t){var n;let i=Ge(),{disabled:r=i||!1,autoFocus:o=!1,...s}=e,{isFocusVisible:a,focusProps:l}=Ie({autoFocus:o}),{isHovered:c,hoverProps:u}=ke({isDisabled:r}),{pressed:d,pressProps:h}=He({disabled:r}),f=nt({ref:t,type:null!=(n=s.type)?n:"button",disabled:r||void 0,autoFocus:o},l,u,h),p=We({disabled:r,hover:c,focus:a,active:d,autofocus:o});return Qe()({ourProps:f,theirProps:s,slot:p,defaultTag:"button",name:"Button"})});function ct(e={},t=null,n=[]){for(let[i,r]of Object.entries(e))dt(n,ut(t,i),r);return n}function ut(e,t){return e?e+"["+t+"]":t}function dt(e,t,n){if(Array.isArray(n))for(let[i,r]of n.entries())dt(e,ut(t,i.toString()),r);else n instanceof Date?e.push([t,n.toISOString()]):"boolean"==typeof n?e.push([t,n?"1":"0"]):"string"==typeof n?e.push([t,n]):"number"==typeof n?e.push([t,`${n}`]):null==n?e.push([t,""]):function(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;let t=Object.getPrototypeOf(e);return null===t||null===Object.getPrototypeOf(t)}(n)&&!b.isValidElement(n)&&ct(n,t,e)}var ht=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(ht||{});let ft=it(function(e,t){var n;let{features:i=1,...r}=e,o={ref:t,"aria-hidden":!(2&~i)||(null!=(n=r["aria-hidden"])?n:void 0),hidden:!(4&~i)||void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...!(4&~i)&&!!(2&~i)&&{display:"none"}}};return Qe()({ourProps:o,theirProps:r,slot:{},defaultTag:"span",name:"Hidden"})}),pt=b.createContext(null);function mt({children:e}){let t=b.useContext(pt);if(!t)return x.createElement(x.Fragment,null,e);let{target:n}=t;return n?F.createPortal(x.createElement(x.Fragment,null,e),n):null}function gt({data:e,form:t,disabled:n,onReset:i,overrides:r}){let[o,s]=b.useState(null),a=Be();return b.useEffect(()=>{if(i&&o)return a.addEventListener(o,"reset",i)},[o,t,i]),x.createElement(mt,null,x.createElement(_t,{setForm:s,formId:t}),ct(e).map(([e,i])=>x.createElement(ft,{features:ht.Hidden,...rt({key:e,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:t,disabled:n,name:e,value:i,...r})})))}function _t({setForm:e,formId:t}){return b.useEffect(()=>{if(t){let n=document.getElementById(t);n&&e(n)}},[e,t]),t?null:x.createElement(ft,{features:ht.Hidden,as:"input",type:"hidden",hidden:!0,readOnly:!0,ref:t=>{if(!t)return;let n=t.closest("form");n&&e(n)}})}let yt=b.createContext(void 0);function vt(){return b.useContext(yt)}function bt(e){return"object"==typeof e&&null!==e&&"nodeType"in e}function xt(e){return bt(e)&&"tagName"in e}function wt(e){return xt(e)&&"accessKey"in e}function St(e){return xt(e)&&"tabIndex"in e}function Et(e){return wt(e)&&"INPUT"===e.nodeName}function Ct(e){return wt(e)&&"LABEL"===e.nodeName}function Tt(e){return wt(e)&&"FIELDSET"===e.nodeName}function kt(e){return wt(e)&&"LEGEND"===e.nodeName}function It(e){let t=e.parentElement,n=null;for(;t&&!Tt(t);)kt(t)&&(n=t),t=t.parentElement;let i=""===(null==t?void 0:t.getAttribute("disabled"));return(!i||!function(e){if(!e)return!1;let t=e.previousElementSibling;for(;null!==t;){if(kt(t))return!1;t=t.previousElementSibling}return!0}(n))&&i}let At=Symbol();function Lt(e,t=!0){return Object.assign(e,{[At]:t})}function Rt(...e){let t=b.useRef(e);b.useEffect(()=>{t.current=e},[e]);let n=Ve(e=>{for(let n of t.current)null!=n&&("function"==typeof n?n(e):n.current=e)});return e.every(e=>null==e||(null==e?void 0:e[At]))?void 0:n}let Pt=b.createContext(null);function Mt(){let e=b.useContext(Pt);if(null===e){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,Mt),e}return e}Pt.displayName="DescriptionContext";let Dt=it(function(e,t){let n=b.useId(),i=Ge(),{id:r=`headlessui-description-${n}`,...o}=e,s=Mt(),a=Rt(t);ze(()=>s.register(r),[r,s.register]);let l=We({...s.slot,disabled:i||!1}),c={ref:a,...s.props,id:r};return Qe()({ourProps:c,theirProps:o,slot:l,defaultTag:"p",name:s.name||"Description"})}),Nt=Object.assign(Dt,{});var Ft,Ot=((Ft=Ot||{}).Space=" ",Ft.Enter="Enter",Ft.Escape="Escape",Ft.Backspace="Backspace",Ft.Delete="Delete",Ft.ArrowLeft="ArrowLeft",Ft.ArrowUp="ArrowUp",Ft.ArrowRight="ArrowRight",Ft.ArrowDown="ArrowDown",Ft.Home="Home",Ft.End="End",Ft.PageUp="PageUp",Ft.PageDown="PageDown",Ft.Tab="Tab",Ft);let Bt=b.createContext(null);function zt(){let e=b.useContext(Bt);if(null===e){let e=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,zt),e}return e}function Ut(e){var t,n,i;let r=null!=(n=null==(t=b.useContext(Bt))?void 0:t.value)?n:void 0;return(null!=(i=null==e?void 0:e.length)?i:0)>0?[r,...e].filter(Boolean).join(" "):r}Bt.displayName="LabelContext";let Vt=it(function(e,t){var n;let i=b.useId(),r=zt(),o=vt(),s=Ge(),{id:a=`headlessui-label-${i}`,htmlFor:l=(null!=o?o:null==(n=r.props)?void 0:n.htmlFor),passive:c=!1,...u}=e,d=Rt(t);ze(()=>r.register(a),[a,r.register]);let h=Ve(e=>{let t=e.currentTarget;if((e.target===e.currentTarget||!function(e){return!!xt(e)&&e.matches('a[href],audio[controls],button,details,embed,iframe,img[usemap],input:not([type="hidden"]),label,select,textarea,video[controls]')}(e.target))&&(Ct(t)&&e.preventDefault(),r.props&&"onClick"in r.props&&"function"==typeof r.props.onClick&&r.props.onClick(e),Ct(t))){let e=document.getElementById(t.htmlFor);if(e){let t=e.getAttribute("disabled");if("true"===t||""===t)return;let n=e.getAttribute("aria-disabled");if("true"===n||""===n)return;(Et(e)&&("file"===e.type||"radio"===e.type||"checkbox"===e.type)||"radio"===e.role||"checkbox"===e.role||"switch"===e.role)&&e.click(),e.focus({preventScroll:!0})}}}),f=We({...r.slot,disabled:s||!1}),p={ref:d,...r.props,id:a,htmlFor:l,onClick:h};return c&&("onClick"in p&&(delete p.htmlFor,delete p.onClick),"onClick"in u&&delete u.onClick),Qe()({ourProps:p,theirProps:u,slot:f,defaultTag:l?"label":"div",name:r.name||"Label"})}),Ht=Object.assign(Vt,{}),Wt=b.createContext(()=>{});function $t({value:e,children:t}){return x.createElement(Wt.Provider,{value:e},t)}let Gt=it(function(e,t){let n=b.useContext(Wt);return x.createElement(lt,{ref:t,...nt({onClick:n},e)})});function jt(e,t,n){let i,r=n.initialDeps??[],o=!0;function s(){var s,a,l;let c;n.key&&(null==(s=n.debug)?void 0:s.call(n))&&(c=Date.now());const u=e();if(u.length===r.length&&!u.some((e,t)=>r[t]!==e))return i;let d;return r=u,n.key&&(null==(a=n.debug)?void 0:a.call(n))&&(d=Date.now()),i=t(...u),n.key&&(null==(l=n.debug)?void 0:l.call(n))&&(Math.round(100*(Date.now()-c)),Math.round(100*(Date.now()-d))),!(null==n?void 0:n.onChange)||o&&n.skipInitialOnChange||n.onChange(i),o=!1,i}return s.updateDeps=e=>{r=e},s}function Yt(e,t){if(void 0===e)throw new Error("Unexpected undefined");return e}const qt=(e,t,n)=>{let i;return function(...r){e.clearTimeout(i),i=e.setTimeout(()=>t.apply(this,r),n)}},Xt=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},Kt=e=>e,Zt=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),i=[];for(let r=t;r<=n;r++)i.push(r);return i},Qt=(e,t)=>{const n=e.scrollElement;if(!n)return;const i=e.targetWindow;if(!i)return;const r=e=>{const{width:n,height:i}=e;t({width:Math.round(n),height:Math.round(i)})};if(r(Xt(n)),!i.ResizeObserver)return()=>{};const o=new i.ResizeObserver(t=>{const i=()=>{const e=t[0];if(null==e?void 0:e.borderBoxSize){const t=e.borderBoxSize[0];if(t)return void r({width:t.inlineSize,height:t.blockSize})}r(Xt(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(i):i()});return o.observe(n,{box:"border-box"}),()=>{o.unobserve(n)}},Jt={passive:!0},en="undefined"==typeof window||"onscrollend"in window,tn=(e,t)=>{const n=e.scrollElement;if(!n)return;const i=e.targetWindow;if(!i)return;let r=0;const o=e.options.useScrollendEvent&&en?()=>{}:qt(i,()=>{t(r,!1)},e.options.isScrollingResetDelay),s=i=>()=>{const{horizontal:s,isRtl:a}=e.options;r=s?n.scrollLeft*(a?-1:1):n.scrollTop,o(),t(r,i)},a=s(!0),l=s(!1);n.addEventListener("scroll",a,Jt);const c=e.options.useScrollendEvent&&en;return c&&n.addEventListener("scrollend",l,Jt),()=>{n.removeEventListener("scroll",a),c&&n.removeEventListener("scrollend",l)}},nn=(e,t,n)=>{if(null==t?void 0:t.borderBoxSize){const e=t.borderBoxSize[0];if(e)return Math.round(e[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},rn=(e,{adjustments:t=0,behavior:n},i)=>{var r,o;const s=e+t;null==(o=null==(r=i.scrollElement)?void 0:r.scrollTo)||o.call(r,{[i.options.horizontal?"left":"top"]:s,behavior:n})};class on{constructor(e){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.currentScrollToIndex=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null;const t=()=>e||(this.targetWindow&&this.targetWindow.ResizeObserver?e=new this.targetWindow.ResizeObserver(e=>{e.forEach(e=>{const t=()=>{this._measureElement(e.target,e)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(t):t()})}):null);return{disconnect:()=>{var n;null==(n=t())||n.disconnect(),e=null},observe:e=>{var n;return null==(n=t())?void 0:n.observe(e,{box:"border-box"})},unobserve:e=>{var n;return null==(n=t())?void 0:n.unobserve(e)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([t,n])=>{void 0===n&&delete e[t]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Kt,rangeExtractor:Zt,onChange:()=>{},measureElement:nn,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...e}},this.notify=e=>{var t,n;null==(n=(t=this.options).onChange)||n.call(t,this,e)},this.maybeNotify=jt(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;const t=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==t){if(this.cleanup(),!t)return void this.maybeNotify();this.scrollElement=t,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=(null==(e=this.scrollElement)?void 0:e.window)??null,this.elementsCache.forEach(e=>{this.observer.observe(e)}),this.unsubs.push(this.options.observeElementRect(this,e=>{this.scrollRect=e,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(e,t)=>{this.scrollAdjustments=0,this.scrollDirection=t?this.getScrollOffset()<e?"forward":"backward":null,this.scrollOffset=e,this.isScrolling=t,this.maybeNotify()})),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0})}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??("function"==typeof this.options.initialOffset?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,t)=>{const n=new Map,i=new Map;for(let r=t-1;r>=0;r--){const t=e[r];if(n.has(t.lane))continue;const o=i.get(t.lane);if(null==o||t.end>o.end?i.set(t.lane,t):t.end<o.end&&n.set(t.lane,!0),n.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((e,t)=>e.end===t.end?e.index-t.index:e.end-t.end)[0]:void 0},this.getMeasurementOptions=jt(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(e,t,n,i,r,o)=>(void 0!==this.prevLanes&&this.prevLanes!==o&&(this.lanesChangedFlag=!0),this.prevLanes=o,this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:n,getItemKey:i,enabled:r,lanes:o}),{key:!1}),this.getMeasurements=jt(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:t,scrollMargin:n,getItemKey:i,enabled:r,lanes:o},s)=>{if(!r)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>e)for(const u of this.laneAssignments.keys())u>=e&&this.laneAssignments.delete(u);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),0!==this.measurementsCache.length||this.lanesSettling||(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(e=>{this.itemSizeCache.set(e.key,e.size)}));const a=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===e&&(this.lanesSettling=!1);const l=this.measurementsCache.slice(0,a),c=new Array(o).fill(void 0);for(let u=0;u<a;u++){const e=l[u];e&&(c[e.lane]=u)}for(let u=a;u<e;u++){const e=i(u),r=this.laneAssignments.get(u);let o,a;if(void 0!==r&&this.options.lanes>1){o=r;const e=c[o],i=void 0!==e?l[e]:void 0;a=i?i.end+this.options.gap:t+n}else{const e=1===this.options.lanes?l[u-1]:this.getFurthestMeasurement(l,u);a=e?e.end+this.options.gap:t+n,o=e?e.lane:u%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(u,o)}const d=s.get(e),h="number"==typeof d?d:this.options.estimateSize(u),f=a+h;l[u]={index:u,start:a,size:h,end:f,key:e,lane:o},c[o]=u}return this.measurementsCache=l,l},{key:!1,debug:()=>this.options.debug}),this.calculateRange=jt(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(e,t,n,i)=>this.range=e.length>0&&t>0?function({measurements:e,outerSize:t,scrollOffset:n,lanes:i}){const r=e.length-1;if(e.length<=i)return{startIndex:0,endIndex:r};let o=sn(0,r,t=>e[t].start,n),s=o;if(1===i)for(;s<r&&e[s].end<n+t;)s++;else if(i>1){const a=Array(i).fill(0);for(;s<r&&a.some(e=>e<n+t);){const t=e[s];a[t.lane]=t.end,s++}const l=Array(i).fill(n+t);for(;o>=0&&l.some(e=>e>=n);){const t=e[o];l[t.lane]=t.start,o--}o=Math.max(0,o-o%i),s=Math.min(r,s+(i-1-s%i))}return{startIndex:o,endIndex:s}}({measurements:e,outerSize:t,scrollOffset:n,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=jt(()=>{let e=null,t=null;const n=this.calculateRange();return n&&(e=n.startIndex,t=n.endIndex),this.maybeNotify.updateDeps([this.isScrolling,e,t]),[this.options.rangeExtractor,this.options.overscan,this.options.count,e,t]},(e,t,n,i,r)=>null===i||null===r?[]:e({startIndex:i,endIndex:r,overscan:t,count:n}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const t=this.options.indexAttribute,n=e.getAttribute(t);return n?parseInt(n,10):-1},this._measureElement=(e,t)=>{const n=this.indexFromElement(e),i=this.measurementsCache[n];if(!i)return;const r=i.key,o=this.elementsCache.get(r);o!==e&&(o&&this.observer.unobserve(o),this.observer.observe(e),this.elementsCache.set(r,e)),e.isConnected&&this.resizeItem(n,this.options.measureElement(e,t,this))},this.resizeItem=(e,t)=>{const n=this.measurementsCache[e];if(!n)return;const i=t-(this.itemSizeCache.get(n.key)??n.size);0!==i&&((void 0!==this.shouldAdjustScrollPositionOnItemSizeChange?this.shouldAdjustScrollPositionOnItemSizeChange(n,i,this):n.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=i,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(n.index),this.itemSizeCache=new Map(this.itemSizeCache.set(n.key,t)),this.notify(!1))},this.measureElement=e=>{e?this._measureElement(e,void 0):this.elementsCache.forEach((e,t)=>{e.isConnected||(this.observer.unobserve(e),this.elementsCache.delete(t))})},this.getVirtualItems=jt(()=>[this.getVirtualIndexes(),this.getMeasurements()],(e,t)=>{const n=[];for(let i=0,r=e.length;i<r;i++){const r=t[e[i]];n.push(r)}return n},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const t=this.getMeasurements();if(0!==t.length)return Yt(t[sn(0,t.length-1,e=>Yt(t[e]).start,e)])},this.getMaxScrollOffset=()=>{if(!this.scrollElement)return 0;if("scrollHeight"in this.scrollElement)return this.options.horizontal?this.scrollElement.scrollWidth-this.scrollElement.clientWidth:this.scrollElement.scrollHeight-this.scrollElement.clientHeight;{const e=this.scrollElement.document.documentElement;return this.options.horizontal?e.scrollWidth-this.scrollElement.innerWidth:e.scrollHeight-this.scrollElement.innerHeight}},this.getOffsetForAlignment=(e,t,n=0)=>{if(!this.scrollElement)return 0;const i=this.getSize(),r=this.getScrollOffset();"auto"===t&&(t=e>=r+i?"end":"start"),"center"===t?e+=(n-i)/2:"end"===t&&(e-=i);const o=this.getMaxScrollOffset();return Math.max(Math.min(o,e),0)},this.getOffsetForIndex=(e,t="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const n=this.measurementsCache[e];if(!n)return;const i=this.getSize(),r=this.getScrollOffset();if("auto"===t)if(n.end>=r+i-this.options.scrollPaddingEnd)t="end";else{if(!(n.start<=r+this.options.scrollPaddingStart))return[r,t];t="start"}if("end"===t&&e===this.options.count-1)return[this.getMaxScrollOffset(),t];const o="end"===t?n.end+this.options.scrollPaddingEnd:n.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,t,n.size),t]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(e,{align:t="start",behavior:n}={})=>{"smooth"===n&&this.isDynamicMode(),this._scrollToOffset(this.getOffsetForAlignment(e,t),{adjustments:void 0,behavior:n})},this.scrollToIndex=(e,{align:t="auto",behavior:n}={})=>{"smooth"===n&&this.isDynamicMode(),e=Math.max(0,Math.min(e,this.options.count-1)),this.currentScrollToIndex=e;let i=0;const r=t=>{if(!this.targetWindow)return;const i=this.getOffsetForIndex(e,t);if(!i)return;const[r,s]=i;this._scrollToOffset(r,{adjustments:void 0,behavior:n}),this.targetWindow.requestAnimationFrame(()=>{const t=()=>{if(this.currentScrollToIndex!==e)return;const t=this.getScrollOffset(),n=this.getOffsetForIndex(e,s);n&&(((e,t)=>Math.abs(e-t)<1.01)(n[0],t)||o(s))};this.isDynamicMode()?this.targetWindow.requestAnimationFrame(t):t()})},o=t=>{this.targetWindow&&this.currentScrollToIndex===e&&(i++,i<10&&this.targetWindow.requestAnimationFrame(()=>r(t)))};r(t)},this.scrollBy=(e,{behavior:t}={})=>{"smooth"===t&&this.isDynamicMode(),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:t})},this.getTotalSize=()=>{var e;const t=this.getMeasurements();let n;if(0===t.length)n=this.options.paddingStart;else if(1===this.options.lanes)n=(null==(e=t[t.length-1])?void 0:e.end)??0;else{const e=Array(this.options.lanes).fill(null);let i=t.length-1;for(;i>=0&&e.some(e=>null===e);){const n=t[i];null===e[n.lane]&&(e[n.lane]=n.end),i--}n=Math.max(...e.filter(e=>null!==e))}return Math.max(n-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(e,{adjustments:t,behavior:n})=>{this.options.scrollToFn(e,{behavior:n,adjustments:t},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(e)}}const sn=(e,t,n,i)=>{for(;e<=t;){const r=(e+t)/2|0,o=n(r);if(o<i)e=r+1;else{if(!(o>i))return r;t=r-1}}return e>0?e-1:0},an="undefined"!=typeof document?b.useLayoutEffect:b.useEffect;function ln(e,t){return null!==e&&null!==t&&"object"==typeof e&&"object"==typeof t&&"id"in e&&"id"in t?e.id===t.id:e===t}function cn(e){if(null===e)return{width:0,height:0};let{width:t,height:n}=e.getBoundingClientRect();return{width:t,height:n}}function un(e,t,n=!1){let[i,r]=b.useState(()=>cn(t));return ze(()=>{if(!t||!e)return;let n=Oe();return n.requestAnimationFrame(function e(){n.requestAnimationFrame(e),r(e=>{let n=cn(t);return n.width===e.width&&n.height===e.height?e:n})}),()=>{n.dispose()}},[t,e]),n?{width:`${i.width}px`,height:`${i.height}px`}:i}var dn,hn=((dn=hn||{})[dn.Left=0]="Left",dn[dn.Right=2]="Right",dn);let fn=class extends Map{constructor(e){super(),this.factory=e}get(e){let t=super.get(e);return void 0===t&&(t=this.factory(e),this.set(e,t)),t}};var pn,mn,gn,_n=Object.defineProperty,yn=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},vn=(e,t,n)=>(yn(e,t,"read from private field"),n?n.call(e):t.get(e)),bn=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},xn=(e,t,n,i)=>(yn(e,t,"write to private field"),t.set(e,n),n);let wn=class{constructor(e){bn(this,pn,{}),bn(this,mn,new fn(()=>new Set)),bn(this,gn,new Set),((e,t,n)=>{((e,t,n)=>{t in e?_n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,t+"",n)})(this,"disposables",Oe()),xn(this,pn,e),Re.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return vn(this,pn)}subscribe(e,t){if(Re.isServer)return()=>{};let n={selector:e,callback:t,current:e(vn(this,pn))};return vn(this,gn).add(n),this.disposables.add(()=>{vn(this,gn).delete(n)})}on(e,t){return Re.isServer?()=>{}:(vn(this,mn).get(e).add(t),this.disposables.add(()=>{vn(this,mn).get(e).delete(t)}))}send(e){let t=this.reduce(vn(this,pn),e);if(t!==vn(this,pn)){xn(this,pn,t);for(let e of vn(this,gn)){let t=e.selector(vn(this,pn));Sn(e.current,t)||(e.current=t,e.callback(t))}for(let t of vn(this,mn).get(e.type))t(vn(this,pn),e)}}};function Sn(e,t){return!!Object.is(e,t)||"object"==typeof e&&null!==e&&"object"==typeof t&&null!==t&&(Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&En(e[Symbol.iterator](),t[Symbol.iterator]()):e instanceof Map&&t instanceof Map||e instanceof Set&&t instanceof Set?e.size===t.size&&En(e.entries(),t.entries()):!(!Cn(e)||!Cn(t))&&En(Object.entries(e)[Symbol.iterator](),Object.entries(t)[Symbol.iterator]()))}function En(e,t){for(;;){let n=e.next(),i=t.next();if(n.done&&i.done)return!0;if(n.done||i.done||!Object.is(n.value,i.value))return!1}}function Cn(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;let t=Object.getPrototypeOf(e);return null===t||null===Object.getPrototypeOf(t)}pn=new WeakMap,mn=new WeakMap,gn=new WeakMap;var Tn,kn=Object.defineProperty,In=(e,t,n)=>(((e,t,n)=>{t in e?kn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),An=((Tn=An||{})[Tn.Push=0]="Push",Tn[Tn.Pop=1]="Pop",Tn);let Ln={0(e,t){let n=t.id,i=e.stack,r=e.stack.indexOf(n);if(-1!==r){let t=e.stack.slice();return t.splice(r,1),t.push(n),i=t,{...e,stack:i}}return{...e,stack:[...e.stack,n]}},1(e,t){let n=t.id,i=e.stack.indexOf(n);if(-1===i)return e;let r=e.stack.slice();return r.splice(i,1),{...e,stack:r}}},Rn=class e extends wn{constructor(){super(...arguments),In(this,"actions",{push:e=>this.send({type:0,id:e}),pop:e=>this.send({type:1,id:e})}),In(this,"selectors",{isTop:(e,t)=>e.stack[e.stack.length-1]===t,inStack:(e,t)=>e.stack.includes(t)})}static new(){return new e({stack:[]})}reduce(e,t){return Ye(t.type,Ln,e,t)}};const Pn=new fn(()=>Rn.new());var Mn,Dn,Nn={exports:{}},Fn={},On=(Dn||(Dn=1,Nn.exports=function(){if(Mn)return Fn;Mn=1;var e=y(),t="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},n=e.useSyncExternalStore,i=e.useRef,r=e.useEffect,o=e.useMemo,s=e.useDebugValue;return Fn.useSyncExternalStoreWithSelector=function(e,a,l,c,u){var d=i(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;d=o(function(){function e(e){if(!r){if(r=!0,n=e,e=c(e),void 0!==u&&h.hasValue){var o=h.value;if(u(o,e))return i=o}return i=e}if(o=i,t(n,e))return o;var s=c(e);return void 0!==u&&u(o,s)?(n=e,o):(n=e,i=s)}var n,i,r=!1,o=void 0===l?null:l;return[function(){return e(a())},null===o?void 0:function(){return e(o())}]},[a,l,c,u]);var f=n(e,d[0],d[1]);return r(function(){h.hasValue=!0,h.value=f},[f]),s(f),f},Fn}()),Nn.exports);function Bn(e,t,n=Sn){return On.useSyncExternalStoreWithSelector(Ve(t=>e.subscribe(zn,t)),Ve(()=>e.state),Ve(()=>e.state),Ve(t),n)}function zn(e){return e}function Un(e,t){let n=b.useId(),i=Pn.get(t),[r,o]=Bn(i,b.useCallback(e=>[i.selectors.isTop(e,n),i.selectors.inStack(e,n)],[i,n]));return ze(()=>{if(e)return i.actions.push(n),()=>i.actions.pop(n)},[i,e,n]),!!e&&(!o||r)}let Vn=new Map,Hn=new Map;function Wn(e){var t;let n=null!=(t=Hn.get(e))?t:0;return Hn.set(e,n+1),0!==n||(Vn.set(e,{"aria-hidden":e.getAttribute("aria-hidden"),inert:e.inert}),e.setAttribute("aria-hidden","true"),e.inert=!0),()=>function(e){var t;let n=null!=(t=Hn.get(e))?t:1;if(1===n?Hn.delete(e):Hn.set(e,n-1),1!==n)return;let i=Vn.get(e);i&&(null===i["aria-hidden"]?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden",i["aria-hidden"]),e.inert=i.inert,Vn.delete(e))}(e)}function $n(e,{allowed:t,disallowed:n}={}){let i=Un(e,"inert-others");ze(()=>{var e,r;if(!i)return;let o=Oe();for(let t of null!=(e=null==n?void 0:n())?e:[])t&&o.add(Wn(t));let s=null!=(r=null==t?void 0:t())?r:[];for(let t of s){if(!t)continue;let e=Pe(t);if(!e)continue;let n=t.parentElement;for(;n&&n!==e.body;){for(let e of n.children)s.some(t=>e.contains(t))||o.add(Wn(e));n=n.parentElement}}return o.dispose},[i,t,n])}function Gn(e,t,n){let i=Ue(e=>{let t=e.getBoundingClientRect();0===t.x&&0===t.y&&0===t.width&&0===t.height&&n()});b.useEffect(()=>{if(!e)return;let n=null===t?null:wt(t)?t:t.current;if(!n)return;let r=Oe();if("undefined"!=typeof ResizeObserver){let e=new ResizeObserver(()=>i.current(n));e.observe(n),r.add(()=>e.disconnect())}if("undefined"!=typeof IntersectionObserver){let e=new IntersectionObserver(()=>i.current(n));e.observe(n),r.add(()=>e.disconnect())}return()=>r.dispose()},[t,i,e])}let jn=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","details>summary","textarea:not([disabled])"].map(e=>`${e}:not([tabindex='-1'])`).join(","),Yn=["[data-autofocus]"].map(e=>`${e}:not([tabindex='-1'])`).join(",");var qn,Xn,Kn=((Xn=Kn||{})[Xn.First=1]="First",Xn[Xn.Previous=2]="Previous",Xn[Xn.Next=4]="Next",Xn[Xn.Last=8]="Last",Xn[Xn.WrapAround=16]="WrapAround",Xn[Xn.NoScroll=32]="NoScroll",Xn[Xn.AutoFocus=64]="AutoFocus",Xn),Zn=((qn=Zn||{})[qn.Error=0]="Error",qn[qn.Overflow=1]="Overflow",qn[qn.Success=2]="Success",qn[qn.Underflow=3]="Underflow",qn),Qn=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(Qn||{}),Jn=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Jn||{}),ei=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(ei||{});function ti(e){null==e||e.focus({preventScroll:!0})}"undefined"!=typeof window&&"undefined"!=typeof document&&(document.addEventListener("keydown",e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",e=>{1===e.detail?delete document.documentElement.dataset.headlessuiFocusVisible:0===e.detail&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));let ni=["textarea","input"].join(",");function ii(e,t=e=>e){return e.slice().sort((e,n)=>{let i=t(e),r=t(n);if(null===i||null===r)return 0;let o=i.compareDocumentPosition(r);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function ri(e,t,{sorted:n=!0,relativeTo:i=null,skipElements:r=[]}={}){let o=Array.isArray(e)?e.length>0?Me(e[0]):document:Me(e),s=Array.isArray(e)?n?ii(e):e:64&t?function(e=document.body){return null==e?[]:Array.from(e.querySelectorAll(Yn)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}(e):function(e=document.body){return null==e?[]:Array.from(e.querySelectorAll(jn)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}(e);r.length>0&&s.length>1&&(s=s.filter(e=>!r.some(t=>null!=t&&"current"in t?(null==t?void 0:t.current)===e:t===e))),i=null!=i?i:null==o?void 0:o.activeElement;let a,l=(()=>{if(5&t)return 1;if(10&t)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(1&t)return 0;if(2&t)return Math.max(0,s.indexOf(i))-1;if(4&t)return Math.max(0,s.indexOf(i))+1;if(8&t)return s.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=32&t?{preventScroll:!0}:{},d=0,h=s.length;do{if(d>=h||d+h<=0)return 0;let e=c+d;if(16&t)e=(e+h)%h;else{if(e<0)return 3;if(e>=h)return 1}a=s[e],null==a||a.focus(u),d+=l}while(a!==De(a));return 6&t&&function(e){var t,n;return null!=(n=null==(t=null==e?void 0:e.matches)?void 0:t.call(e,ni))&&n}(a)&&a.select(),2}function oi(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function si(){return oi()||/Android/gi.test(window.navigator.userAgent)}function ai(e,t,n,i){let r=Ue(n);b.useEffect(()=>{if(e)return document.addEventListener(t,n,i),()=>document.removeEventListener(t,n,i);function n(e){r.current(e)}},[e,t,i])}function li(e,t,n,i){let r=Ue(n);b.useEffect(()=>{if(e)return window.addEventListener(t,n,i),()=>window.removeEventListener(t,n,i);function n(e){r.current(e)}},[e,t,i])}function ci(e,t,n){let i=Ue(n),r=b.useCallback(function(e,n){if(e.defaultPrevented)return;let r=n(e);if(null===r||!r.getRootNode().contains(r)||!r.isConnected)return;let o=function e(t){return"function"==typeof t?e(t()):Array.isArray(t)||t instanceof Set?t:[t]}(t);for(let t of o)if(null!==t&&(t.contains(r)||e.composed&&e.composedPath().includes(t)))return;return!function(e,t=0){var n;return e!==(null==(n=Pe(e))?void 0:n.body)&&Ye(t,{0:()=>e.matches(jn),1(){let t=e;for(;null!==t;){if(t.matches(jn))return!0;t=t.parentElement}return!1}})}(r,Jn.Loose)&&-1!==r.tabIndex&&e.preventDefault(),i.current(e,r)},[i,t]),o=b.useRef(null);ai(e,"pointerdown",e=>{var t,n;si()||(o.current=(null==(n=null==(t=e.composedPath)?void 0:t.call(e))?void 0:n[0])||e.target)},!0),ai(e,"pointerup",e=>{if(si()||!o.current)return;let t=o.current;return o.current=null,r(e,()=>t)},!0);let s=b.useRef({x:0,y:0});ai(e,"touchstart",e=>{s.current.x=e.touches[0].clientX,s.current.y=e.touches[0].clientY},!0),ai(e,"touchend",e=>{let t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY;if(!(Math.abs(t-s.current.x)>=30||Math.abs(n-s.current.y)>=30))return r(e,()=>St(e.target)?e.target:null)},!0),li(e,"blur",e=>r(e,()=>function(e){return wt(e)&&"IFRAME"===e.nodeName}(window.document.activeElement)?window.document.activeElement:null),!0)}function ui(...e){return b.useMemo(()=>Pe(...e),[...e])}var di=(e=>(e[e.Ignore=0]="Ignore",e[e.Select=1]="Select",e[e.Close=2]="Close",e))(di||{});const hi={Ignore:{kind:0},Select:e=>({kind:1,target:e}),Close:{kind:2}};function fi(e,t,n,i){let r=Ue(n);b.useEffect(()=>{function n(e){r.current(e)}return(e=null!=e?e:window).addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)},[e,t,i])}function pi(e){let t=b.useRef({value:"",selectionStart:null,selectionEnd:null});return fi(e,"blur",e=>{let n=e.target;Et(n)&&(t.current={value:n.value,selectionStart:n.selectionStart,selectionEnd:n.selectionEnd})}),Ve(()=>{if(!Ne(e)&&Et(e)&&e.isConnected){if(e.focus({preventScroll:!0}),e.value!==t.current.value)e.setSelectionRange(e.value.length,e.value.length);else{let{selectionStart:n,selectionEnd:i}=t.current;null!==n&&null!==i&&e.setSelectionRange(n,i)}t.current={value:"",selectionStart:null,selectionEnd:null}}})}function mi(e,t){return b.useMemo(()=>{var n;if(e.type)return e.type;let i=null!=(n=e.as)?n:"button";return"string"==typeof i&&"button"===i.toLowerCase()||"BUTTON"===(null==t?void 0:t.tagName)&&!t.hasAttribute("type")?"button":void 0},[e.type,e.as,t])}function gi(){let e;return{before({doc:t}){var n;let i=t.documentElement,r=null!=(n=t.defaultView)?n:window;e=Math.max(0,r.innerWidth-i.clientWidth)},after({doc:t,d:n}){let i=t.documentElement,r=Math.max(0,i.clientWidth-i.offsetWidth),o=Math.max(0,e-r);n.style(i,"paddingRight",`${o}px`)}}}function _i(e){let t={};for(let n of e)Object.assign(t,n(t));return t}let yi=function(e,t){let n=new Map,i=new Set;return{getSnapshot:()=>n,subscribe:e=>(i.add(e),()=>i.delete(e)),dispatch(e,...r){let o=t[e].call(n,...r);o&&(n=o,i.forEach(e=>e()))}}}(0,{PUSH(e,t){var n;let i=null!=(n=this.get(e))?n:{doc:e,count:0,d:Oe(),meta:new Set,computedMeta:{}};return i.count++,i.meta.add(t),i.computedMeta=_i(i.meta),this.set(e,i),this},POP(e,t){let n=this.get(e);return n&&(n.count--,n.meta.delete(t),n.computedMeta=_i(n.meta)),this},SCROLL_PREVENT(e){let t={doc:e.doc,d:e.d,meta:()=>e.computedMeta},n=[oi()?{before({doc:e,d:t,meta:n}){function i(e){for(let t of n().containers)for(let n of t())if(n.contains(e))return!0;return!1}t.microTask(()=>{var n;if("auto"!==window.getComputedStyle(e.documentElement).scrollBehavior){let n=Oe();n.style(e.documentElement,"scrollBehavior","auto"),t.add(()=>t.microTask(()=>n.dispose()))}let r=null!=(n=window.scrollY)?n:window.pageYOffset,o=null;t.addEventListener(e,"click",t=>{if(St(t.target))try{let n=t.target.closest("a");if(!n)return;let{hash:r}=new URL(n.href),s=e.querySelector(r);St(s)&&!i(s)&&(o=s)}catch{}},!0),t.group(n=>{t.addEventListener(e,"touchstart",e=>{if(n.dispose(),St(e.target)&&function(e){return xt(e)&&"style"in e}(e.target))if(i(e.target)){let t=e.target;for(;t.parentElement&&i(t.parentElement);)t=t.parentElement;n.style(t,"overscrollBehavior","contain")}else n.style(e.target,"touchAction","none")})}),t.addEventListener(e,"touchmove",e=>{if(St(e.target)){if(Et(e.target))return;if(i(e.target)){let t=e.target;for(;t.parentElement&&""!==t.dataset.headlessuiPortal&&!(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth);)t=t.parentElement;""===t.dataset.headlessuiPortal&&e.preventDefault()}else e.preventDefault()}},{passive:!1}),t.add(()=>{var e;let t=null!=(e=window.scrollY)?e:window.pageYOffset;r!==t&&window.scrollTo(0,r),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}:{},gi(),{before({doc:e,d:t}){t.style(e.documentElement,"overflow","hidden")}}];n.forEach(({before:e})=>null==e?void 0:e(t)),n.forEach(({after:e})=>null==e?void 0:e(t))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});function vi(e,t,n=()=>[document.body]){!function(e,t,n=()=>({containers:[]})){let i=function(e){return b.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getSnapshot)}(yi),r=t?i.get(t):void 0,o=!!r&&r.count>0;ze(()=>{if(t&&e)return yi.dispatch("PUSH",t,n),()=>yi.dispatch("POP",t,n)},[e,t])}(Un(e,"scroll-lock"),t,e=>{var t;return{containers:[...null!=(t=e.containers)?t:[],n]}})}function bi(e){return[e.screenX,e.screenY]}var xi,wi;yi.subscribe(()=>{let e=yi.getSnapshot(),t=new Map;for(let[n]of e)t.set(n,n.documentElement.style.overflow);for(let n of e.values()){let e="hidden"===t.get(n.doc),i=0!==n.count;(i&&!e||!i&&e)&&yi.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),0===n.count&&yi.dispatch("TEARDOWN",n)}}),"undefined"!=typeof process&&"undefined"!=typeof globalThis&&"undefined"!=typeof Element&&"test"===(null==(xi=null==process?void 0:{})?void 0:xi.NODE_ENV)&&void 0===(null==(wi=null==Element?void 0:Element.prototype)?void 0:wi.getAnimations)&&(Element.prototype.getAnimations=function(){return[]});var Si,Ei=((Si=Ei||{})[Si.None=0]="None",Si[Si.Closed=1]="Closed",Si[Si.Enter=2]="Enter",Si[Si.Leave=4]="Leave",Si);function Ci(e){let t={};for(let n in e)!0===e[n]&&(t[`data-${n}`]="");return t}function Ti(e,t,n,i){let[r,o]=b.useState(n),{hasFlag:s,addFlag:a,removeFlag:l}=function(e=0){let[t,n]=b.useState(e),i=b.useCallback(e=>n(e),[]),r=b.useCallback(e=>n(t=>t|e),[]),o=b.useCallback(e=>(t&e)===e,[t]),s=b.useCallback(e=>n(t=>t&~e),[]),a=b.useCallback(e=>n(t=>t^e),[]);return{flags:t,setFlag:i,addFlag:r,hasFlag:o,removeFlag:s,toggleFlag:a}}(e&&r?3:0),c=b.useRef(!1),u=b.useRef(!1),d=Be();return ze(()=>{var r;if(e)return n&&o(!0),t?(null==(r=null==i?void 0:i.start)||r.call(i,n),function(e,{prepare:t,run:n,done:i,inFlight:r}){let o=Oe();return function(e,{inFlight:t,prepare:n}){if(null!=t&&t.current)return void n();let i=e.style.transition;e.style.transition="none",n(),e.offsetHeight,e.style.transition=i}(e,{prepare:t,inFlight:r}),o.nextFrame(()=>{n(),o.requestAnimationFrame(()=>{o.add(function(e,t){var n,i;let r=Oe();if(!e)return r.dispose;let o=!1;r.add(()=>{o=!0});let s=null!=(i=null==(n=e.getAnimations)?void 0:n.call(e).filter(e=>e instanceof CSSTransition))?i:[];return 0===s.length?(t(),r.dispose):(Promise.allSettled(s.map(e=>e.finished)).then(()=>{o||t()}),r.dispose)}(e,i))})}),o.dispose}(t,{inFlight:c,prepare(){u.current?u.current=!1:u.current=c.current,c.current=!0,!u.current&&(n?(a(3),l(4)):(a(4),l(2)))},run(){u.current?n?(l(3),a(4)):(l(4),a(3)):n?l(1):a(1)},done(){var e;u.current&&function(e){var t,n;return(null!=(n=null==(t=e.getAnimations)?void 0:t.call(e))?n:[]).some(e=>e instanceof CSSTransition&&"finished"!==e.playState)}(t)||(c.current=!1,l(7),n||o(!1),null==(e=null==i?void 0:i.end)||e.call(i,n))}})):void(n&&a(3))},[e,n,t,d]),e?[r,{closed:s(1),enter:s(2),leave:s(4),transition:s(2)||s(4)}]:[n,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function ki(e,t){let n=b.useRef([]),i=Ve(e);b.useEffect(()=>{let e=[...n.current];for(let[r,o]of t.entries())if(n.current[r]!==o){let r=i(t,e);return n.current=t,r}},[i,...t])}function Ii(){return"undefined"!=typeof window}function Ai(e){return Pi(e)?(e.nodeName||"").toLowerCase():"#document"}function Li(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function Ri(e){var t;return null==(t=(Pi(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function Pi(e){return!!Ii()&&(e instanceof Node||e instanceof Li(e).Node)}function Mi(e){return!!Ii()&&(e instanceof Element||e instanceof Li(e).Element)}function Di(e){return!!Ii()&&(e instanceof HTMLElement||e instanceof Li(e).HTMLElement)}function Ni(e){return!(!Ii()||"undefined"==typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof Li(e).ShadowRoot)}const Fi=new Set(["inline","contents"]);function Oi(e){const{overflow:t,overflowX:n,overflowY:i,display:r}=Xi(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!Fi.has(r)}const Bi=new Set(["table","td","th"]);function zi(e){return Bi.has(Ai(e))}const Ui=[":popover-open",":modal"];function Vi(e){return Ui.some(t=>{try{return e.matches(t)}catch(n){return!1}})}const Hi=["transform","translate","scale","rotate","perspective"],Wi=["transform","translate","scale","rotate","perspective","filter"],$i=["paint","layout","strict","content"];function Gi(e){const t=ji(),n=Mi(e)?Xi(e):e;return Hi.some(e=>!!n[e]&&"none"!==n[e])||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||Wi.some(e=>(n.willChange||"").includes(e))||$i.some(e=>(n.contain||"").includes(e))}function ji(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const Yi=new Set(["html","body","#document"]);function qi(e){return Yi.has(Ai(e))}function Xi(e){return Li(e).getComputedStyle(e)}function Ki(e){return Mi(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Zi(e){if("html"===Ai(e))return e;const t=e.assignedSlot||e.parentNode||Ni(e)&&e.host||Ri(e);return Ni(t)?t.host:t}function Qi(e){const t=Zi(e);return qi(t)?e.ownerDocument?e.ownerDocument.body:e.body:Di(t)&&Oi(t)?t:Qi(t)}function Ji(e,t,n){var i;void 0===t&&(t=[]),void 0===n&&(n=!0);const r=Qi(e),o=r===(null==(i=e.ownerDocument)?void 0:i.body),s=Li(r);if(o){const e=er(s);return t.concat(s,s.visualViewport||[],Oi(r)?r:[],e&&n?Ji(e):[])}return t.concat(r,Ji(r,[],n))}function er(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const tr=Math.min,nr=Math.max,ir=Math.round,rr=Math.floor,or=e=>({x:e,y:e}),sr={left:"right",right:"left",bottom:"top",top:"bottom"},ar={start:"end",end:"start"};function lr(e,t,n){return nr(e,tr(t,n))}function cr(e,t){return"function"==typeof e?e(t):e}function ur(e){return e.split("-")[0]}function dr(e){return e.split("-")[1]}function hr(e){return"x"===e?"y":"x"}function fr(e){return"y"===e?"height":"width"}const pr=new Set(["top","bottom"]);function mr(e){return pr.has(ur(e))?"y":"x"}function gr(e){return hr(mr(e))}function _r(e){return e.replace(/start|end/g,e=>ar[e])}const yr=["left","right"],vr=["right","left"],br=["top","bottom"],xr=["bottom","top"];function wr(e){return e.replace(/left|right|bottom|top/g,e=>sr[e])}function Sr(e){const{x:t,y:n,width:i,height:r}=e;return{width:i,height:r,top:n,left:t,right:t+i,bottom:n+r,x:t,y:n}}function Er(e,t,n){let{reference:i,floating:r}=e;const o=mr(t),s=gr(t),a=fr(s),l=ur(t),c="y"===o,u=i.x+i.width/2-r.width/2,d=i.y+i.height/2-r.height/2,h=i[a]/2-r[a]/2;let f;switch(l){case"top":f={x:u,y:i.y-r.height};break;case"bottom":f={x:u,y:i.y+i.height};break;case"right":f={x:i.x+i.width,y:d};break;case"left":f={x:i.x-r.width,y:d};break;default:f={x:i.x,y:i.y}}switch(dr(t)){case"start":f[s]-=h*(n&&c?-1:1);break;case"end":f[s]+=h*(n&&c?-1:1)}return f}async function Cr(e,t){var n;void 0===t&&(t={});const{x:i,y:r,platform:o,rects:s,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=cr(t,e),p=function(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}(f),m=a[h?"floating"===d?"reference":"floating":d],g=Sr(await o.getClippingRect({element:null==(n=await(null==o.isElement?void 0:o.isElement(m)))||n?m:m.contextElement||await(null==o.getDocumentElement?void 0:o.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),_="floating"===d?{x:i,y:r,width:s.floating.width,height:s.floating.height}:s.reference,y=await(null==o.getOffsetParent?void 0:o.getOffsetParent(a.floating)),v=await(null==o.isElement?void 0:o.isElement(y))&&await(null==o.getScale?void 0:o.getScale(y))||{x:1,y:1},b=Sr(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:_,offsetParent:y,strategy:l}):_);return{top:(g.top-b.top+p.top)/v.y,bottom:(b.bottom-g.bottom+p.bottom)/v.y,left:(g.left-b.left+p.left)/v.x,right:(b.right-g.right+p.right)/v.x}}const Tr=new Set(["left","top"]);function kr(e){const t=Xi(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const r=Di(e),o=r?e.offsetWidth:n,s=r?e.offsetHeight:i,a=ir(n)!==o||ir(i)!==s;return a&&(n=o,i=s),{width:n,height:i,$:a}}function Ir(e){return Mi(e)?e:e.contextElement}function Ar(e){const t=Ir(e);if(!Di(t))return or(1);const n=t.getBoundingClientRect(),{width:i,height:r,$:o}=kr(t);let s=(o?ir(n.width):n.width)/i,a=(o?ir(n.height):n.height)/r;return s&&Number.isFinite(s)||(s=1),a&&Number.isFinite(a)||(a=1),{x:s,y:a}}const Lr=or(0);function Rr(e){const t=Li(e);return ji()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Lr}function Pr(e,t,n,i){void 0===t&&(t=!1),void 0===n&&(n=!1);const r=e.getBoundingClientRect(),o=Ir(e);let s=or(1);t&&(i?Mi(i)&&(s=Ar(i)):s=Ar(e));const a=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==Li(e))&&t}(o,n,i)?Rr(o):or(0);let l=(r.left+a.x)/s.x,c=(r.top+a.y)/s.y,u=r.width/s.x,d=r.height/s.y;if(o){const e=Li(o),t=i&&Mi(i)?Li(i):i;let n=e,r=er(n);for(;r&&i&&t!==n;){const e=Ar(r),t=r.getBoundingClientRect(),i=Xi(r),o=t.left+(r.clientLeft+parseFloat(i.paddingLeft))*e.x,s=t.top+(r.clientTop+parseFloat(i.paddingTop))*e.y;l*=e.x,c*=e.y,u*=e.x,d*=e.y,l+=o,c+=s,n=Li(r),r=er(n)}}return Sr({width:u,height:d,x:l,y:c})}function Mr(e,t){const n=Ki(e).scrollLeft;return t?t.left+n:Pr(Ri(e)).left+n}function Dr(e,t){const n=e.getBoundingClientRect();return{x:n.left+t.scrollLeft-Mr(e,n),y:n.top+t.scrollTop}}const Nr=new Set(["absolute","fixed"]);function Fr(e,t,n){let i;if("viewport"===t)i=function(e,t){const n=Li(e),i=Ri(e),r=n.visualViewport;let o=i.clientWidth,s=i.clientHeight,a=0,l=0;if(r){o=r.width,s=r.height;const e=ji();(!e||e&&"fixed"===t)&&(a=r.offsetLeft,l=r.offsetTop)}const c=Mr(i);if(c<=0){const e=i.ownerDocument,t=e.body,n=getComputedStyle(t),r="CSS1Compat"===e.compatMode&&parseFloat(n.marginLeft)+parseFloat(n.marginRight)||0,s=Math.abs(i.clientWidth-t.clientWidth-r);s<=25&&(o-=s)}else c<=25&&(o+=c);return{width:o,height:s,x:a,y:l}}(e,n);else if("document"===t)i=function(e){const t=Ri(e),n=Ki(e),i=e.ownerDocument.body,r=nr(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),o=nr(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let s=-n.scrollLeft+Mr(e);const a=-n.scrollTop;return"rtl"===Xi(i).direction&&(s+=nr(t.clientWidth,i.clientWidth)-r),{width:r,height:o,x:s,y:a}}(Ri(e));else if(Mi(t))i=function(e,t){const n=Pr(e,!0,"fixed"===t),i=n.top+e.clientTop,r=n.left+e.clientLeft,o=Di(e)?Ar(e):or(1);return{width:e.clientWidth*o.x,height:e.clientHeight*o.y,x:r*o.x,y:i*o.y}}(t,n);else{const n=Rr(e);i={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return Sr(i)}function Or(e,t){const n=Zi(e);return!(n===t||!Mi(n)||qi(n))&&("fixed"===Xi(n).position||Or(n,t))}function Br(e,t,n){const i=Di(t),r=Ri(t),o="fixed"===n,s=Pr(e,!0,o,t);let a={scrollLeft:0,scrollTop:0};const l=or(0);function c(){l.x=Mr(r)}if(i||!i&&!o)if(("body"!==Ai(t)||Oi(r))&&(a=Ki(t)),i){const e=Pr(t,!0,o,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else r&&c();o&&!i&&r&&c();const u=!r||i||o?or(0):Dr(r,a);return{x:s.left+a.scrollLeft-l.x-u.x,y:s.top+a.scrollTop-l.y-u.y,width:s.width,height:s.height}}function zr(e){return"static"===Xi(e).position}function Ur(e,t){if(!Di(e)||"fixed"===Xi(e).position)return null;if(t)return t(e);let n=e.offsetParent;return Ri(e)===n&&(n=n.ownerDocument.body),n}function Vr(e,t){const n=Li(e);if(Vi(e))return n;if(!Di(e)){let t=Zi(e);for(;t&&!qi(t);){if(Mi(t)&&!zr(t))return t;t=Zi(t)}return n}let i=Ur(e,t);for(;i&&zi(i)&&zr(i);)i=Ur(i,t);return i&&qi(i)&&zr(i)&&!Gi(i)?n:i||function(e){let t=Zi(e);for(;Di(t)&&!qi(t);){if(Gi(t))return t;if(Vi(t))return null;t=Zi(t)}return null}(e)||n}const Hr={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:i,strategy:r}=e;const o="fixed"===r,s=Ri(i),a=!!t&&Vi(t.floating);if(i===s||a&&o)return n;let l={scrollLeft:0,scrollTop:0},c=or(1);const u=or(0),d=Di(i);if((d||!d&&!o)&&(("body"!==Ai(i)||Oi(s))&&(l=Ki(i)),Di(i))){const e=Pr(i);c=Ar(i),u.x=e.x+i.clientLeft,u.y=e.y+i.clientTop}const h=!s||d||o?or(0):Dr(s,l);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}},getDocumentElement:Ri,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:i,strategy:r}=e;const o=[..."clippingAncestors"===n?Vi(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let i=Ji(e,[],!1).filter(e=>Mi(e)&&"body"!==Ai(e)),r=null;const o="fixed"===Xi(e).position;let s=o?Zi(e):e;for(;Mi(s)&&!qi(s);){const t=Xi(s),n=Gi(s);n||"fixed"!==t.position||(r=null),(o?!n&&!r:!n&&"static"===t.position&&r&&Nr.has(r.position)||Oi(s)&&!n&&Or(e,s))?i=i.filter(e=>e!==s):r=t,s=Zi(s)}return t.set(e,i),i}(t,this._c):[].concat(n),i],s=o[0],a=o.reduce((e,n)=>{const i=Fr(t,n,r);return e.top=nr(i.top,e.top),e.right=tr(i.right,e.right),e.bottom=tr(i.bottom,e.bottom),e.left=nr(i.left,e.left),e},Fr(t,s,r));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},getOffsetParent:Vr,getElementRects:async function(e){const t=this.getOffsetParent||Vr,n=this.getDimensions,i=await n(e.floating);return{reference:Br(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=kr(e);return{width:t,height:n}},getScale:Ar,isElement:Mi,isRTL:function(e){return"rtl"===Xi(e).direction}};function Wr(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function $r(e,t,n,i){void 0===i&&(i={});const{ancestorScroll:r=!0,ancestorResize:o=!0,elementResize:s="function"==typeof ResizeObserver,layoutShift:a="function"==typeof IntersectionObserver,animationFrame:l=!1}=i,c=Ir(e),u=r||o?[...c?Ji(c):[],...Ji(t)]:[];u.forEach(e=>{r&&e.addEventListener("scroll",n,{passive:!0}),o&&e.addEventListener("resize",n)});const d=c&&a?function(e,t){let n,i=null;const r=Ri(e);function o(){var e;clearTimeout(n),null==(e=i)||e.disconnect(),i=null}return function s(a,l){void 0===a&&(a=!1),void 0===l&&(l=1),o();const c=e.getBoundingClientRect(),{left:u,top:d,width:h,height:f}=c;if(a||t(),!h||!f)return;const p={rootMargin:-rr(d)+"px "+-rr(r.clientWidth-(u+h))+"px "+-rr(r.clientHeight-(d+f))+"px "+-rr(u)+"px",threshold:nr(0,tr(1,l))||1};let m=!0;function g(t){const i=t[0].intersectionRatio;if(i!==l){if(!m)return s();i?s(!1,i):n=setTimeout(()=>{s(!1,1e-7)},1e3)}1!==i||Wr(c,e.getBoundingClientRect())||s(),m=!1}try{i=new IntersectionObserver(g,{...p,root:r.ownerDocument})}catch(_){i=new IntersectionObserver(g,p)}i.observe(e)}(!0),o}(c,n):null;let h,f=-1,p=null;s&&(p=new ResizeObserver(e=>{let[i]=e;i&&i.target===c&&p&&(p.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var e;null==(e=p)||e.observe(t)})),n()}),c&&!l&&p.observe(c),p.observe(t));let m=l?Pr(e):null;return l&&function t(){const i=Pr(e);m&&!Wr(m,i)&&n(),m=i,h=requestAnimationFrame(t)}(),n(),()=>{var e;u.forEach(e=>{r&&e.removeEventListener("scroll",n),o&&e.removeEventListener("resize",n)}),null==d||d(),null==(e=p)||e.disconnect(),p=null,l&&cancelAnimationFrame(h)}}const Gr=Cr,jr=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,i;const{x:r,y:o,placement:s,middlewareData:a}=t,l=await async function(e,t){const{placement:n,platform:i,elements:r}=e,o=await(null==i.isRTL?void 0:i.isRTL(r.floating)),s=ur(n),a=dr(n),l="y"===mr(n),c=Tr.has(s)?-1:1,u=o&&l?-1:1,d=cr(t,e);let{mainAxis:h,crossAxis:f,alignmentAxis:p}="number"==typeof d?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return a&&"number"==typeof p&&(f="end"===a?-1*p:p),l?{x:f*u,y:h*c}:{x:h*c,y:f*u}}(t,e);return s===(null==(n=a.offset)?void 0:n.placement)&&null!=(i=a.arrow)&&i.alignmentOffset?{}:{x:r+l.x,y:o+l.y,data:{...l,placement:s}}}}},Yr=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:i,placement:r}=t,{mainAxis:o=!0,crossAxis:s=!1,limiter:a={fn:e=>{let{x:t,y:n}=e;return{x:t,y:n}}},...l}=cr(e,t),c={x:n,y:i},u=await Cr(t,l),d=mr(ur(r)),h=hr(d);let f=c[h],p=c[d];if(o){const e="y"===h?"bottom":"right";f=lr(f+u["y"===h?"top":"left"],f,f-u[e])}if(s){const e="y"===d?"bottom":"right";p=lr(p+u["y"===d?"top":"left"],p,p-u[e])}const m=a.fn({...t,[h]:f,[d]:p});return{...m,data:{x:m.x-n,y:m.y-i,enabled:{[h]:o,[d]:s}}}}}},qr=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:r,middlewareData:o,rects:s,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:m=!0,...g}=cr(e,t);if(null!=(n=o.arrow)&&n.alignmentOffset)return{};const _=ur(r),y=mr(a),v=ur(a)===a,b=await(null==l.isRTL?void 0:l.isRTL(c.floating)),x=h||(v||!m?[wr(a)]:function(e){const t=wr(e);return[_r(e),t,_r(t)]}(a)),w="none"!==p;!h&&w&&x.push(...function(e,t,n,i){const r=dr(e);let o=function(e,t,n){switch(e){case"top":case"bottom":return n?t?vr:yr:t?yr:vr;case"left":case"right":return t?br:xr;default:return[]}}(ur(e),"start"===n,i);return r&&(o=o.map(e=>e+"-"+r),t&&(o=o.concat(o.map(_r)))),o}(a,m,p,b));const S=[a,...x],E=await Cr(t,g),C=[];let T=(null==(i=o.flip)?void 0:i.overflows)||[];if(u&&C.push(E[_]),d){const e=function(e,t,n){void 0===n&&(n=!1);const i=dr(e),r=gr(e),o=fr(r);let s="x"===r?i===(n?"end":"start")?"right":"left":"start"===i?"bottom":"top";return t.reference[o]>t.floating[o]&&(s=wr(s)),[s,wr(s)]}(r,s,b);C.push(E[e[0]],E[e[1]])}if(T=[...T,{placement:r,overflows:C}],!C.every(e=>e<=0)){var k,I;const e=((null==(k=o.flip)?void 0:k.index)||0)+1,t=S[e];if(t&&("alignment"!==d||y===mr(t)||T.every(e=>mr(e.placement)!==y||e.overflows[0]>0)))return{data:{index:e,overflows:T},reset:{placement:t}};let n=null==(I=T.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:I.placement;if(!n)switch(f){case"bestFit":{var A;const e=null==(A=T.filter(e=>{if(w){const t=mr(e.placement);return t===y||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:A[0];e&&(n=e);break}case"initialPlacement":n=a}if(r!==n)return{reset:{placement:n}}}return{}}}},Xr=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){var n,i;const{placement:r,rects:o,platform:s,elements:a}=t,{apply:l=()=>{},...c}=cr(e,t),u=await Cr(t,c),d=ur(r),h=dr(r),f="y"===mr(r),{width:p,height:m}=o.floating;let g,_;"top"===d||"bottom"===d?(g=d,_=h===(await(null==s.isRTL?void 0:s.isRTL(a.floating))?"start":"end")?"left":"right"):(_=d,g="end"===h?"top":"bottom");const y=m-u.top-u.bottom,v=p-u.left-u.right,b=tr(m-u[g],y),x=tr(p-u[_],v),w=!t.middlewareData.shift;let S=b,E=x;if(null!=(n=t.middlewareData.shift)&&n.enabled.x&&(E=v),null!=(i=t.middlewareData.shift)&&i.enabled.y&&(S=y),w&&!h){const e=nr(u.left,0),t=nr(u.right,0),n=nr(u.top,0),i=nr(u.bottom,0);f?E=p-2*(0!==e||0!==t?e+t:nr(u.left,u.right)):S=m-2*(0!==n||0!==i?n+i:nr(u.top,u.bottom))}await l({...t,availableWidth:E,availableHeight:S});const C=await s.getDimensions(a.floating);return p!==C.width||m!==C.height?{reset:{rects:!0}}:{}}}};var Kr="undefined"!=typeof document?b.useLayoutEffect:function(){};function Zr(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;let n,i,r;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(i=n;0!==i--;)if(!Zr(e[i],t[i]))return!1;return!0}if(r=Object.keys(e),n=r.length,n!==Object.keys(t).length)return!1;for(i=n;0!==i--;)if(!{}.hasOwnProperty.call(t,r[i]))return!1;for(i=n;0!==i--;){const n=r[i];if(!("_owner"===n&&e.$$typeof||Zr(e[n],t[n])))return!1}return!0}return e!=e&&t!=t}function Qr(e){return"undefined"==typeof window?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Jr(e,t){const n=Qr(e);return Math.round(t*n)/n}function eo(e){const t=b.useRef(e);return Kr(()=>{t.current=e}),t}const to=(e,t)=>({...jr(e),options:[e,t]}),no=(e,t)=>({...qr(e),options:[e,t]}),io=(e,t)=>({...Xr(e),options:[e,t]}),ro={...w},oo=ro.useInsertionEffect||(e=>e());function so(e){const t=b.useRef(()=>{});return oo(()=>{t.current=e}),b.useCallback(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return null==t.current?void 0:t.current(...n)},[])}var ao="undefined"!=typeof document?b.useLayoutEffect:b.useEffect;let lo=!1,co=0;const uo=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+co++,ho=ro.useId||function(){const[e,t]=b.useState(()=>lo?uo():void 0);return ao(()=>{null==e&&t(uo())},[]),b.useEffect(()=>{lo=!0},[]),e},fo=b.createContext(null),po=b.createContext(null),mo="data-floating-ui-focusable";function go(e){void 0===e&&(e={});const{nodeId:t}=e,n=function(e){const{open:t=!1,onOpenChange:n,elements:i}=e,r=ho(),o=b.useRef({}),[s]=b.useState(()=>function(){const e=new Map;return{emit(t,n){var i;null==(i=e.get(t))||i.forEach(e=>e(n))},on(t,n){e.set(t,[...e.get(t)||[],n])},off(t,n){var i;e.set(t,(null==(i=e.get(t))?void 0:i.filter(e=>e!==n))||[])}}}()),a=null!=((null==(l=b.useContext(fo))?void 0:l.id)||null);var l;const[c,u]=b.useState(i.reference),d=so((e,t,i)=>{o.current.openEvent=e?t:void 0,s.emit("openchange",{open:e,event:t,reason:i,nested:a}),null==n||n(e,t,i)}),h=b.useMemo(()=>({setPositionReference:u}),[]),f=b.useMemo(()=>({reference:c||i.reference||null,floating:i.floating||null,domReference:i.reference}),[c,i.reference,i.floating]);return b.useMemo(()=>({dataRef:o,open:t,onOpenChange:d,elements:f,events:s,floatingId:r,refs:h}),[t,d,f,s,r,h])}({...e,elements:{reference:null,floating:null,...e.elements}}),i=e.rootContext||n,r=i.elements,[o,s]=b.useState(null),[a,l]=b.useState(null),c=(null==r?void 0:r.domReference)||o,u=b.useRef(null),d=b.useContext(po);ao(()=>{c&&(u.current=c)},[c]);const h=function(e){void 0===e&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:i=[],platform:r,elements:{reference:o,floating:s}={},transform:a=!0,whileElementsMounted:l,open:c}=e,[u,d]=b.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[h,f]=b.useState(i);Zr(h,i)||f(i);const[p,m]=b.useState(null),[g,_]=b.useState(null),y=b.useCallback(e=>{e!==S.current&&(S.current=e,m(e))},[]),v=b.useCallback(e=>{e!==E.current&&(E.current=e,_(e))},[]),x=o||p,w=s||g,S=b.useRef(null),E=b.useRef(null),C=b.useRef(u),T=null!=l,k=eo(l),I=eo(r),A=eo(c),L=b.useCallback(()=>{if(!S.current||!E.current)return;const e={placement:t,strategy:n,middleware:h};I.current&&(e.platform=I.current),((e,t,n)=>{const i=new Map,r={platform:Hr,...n},o={...r.platform,_c:i};return(async(e,t,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:o=[],platform:s}=n,a=o.filter(Boolean),l=await(null==s.isRTL?void 0:s.isRTL(t));let c=await s.getElementRects({reference:e,floating:t,strategy:r}),{x:u,y:d}=Er(c,i,l),h=i,f={},p=0;for(let m=0;m<a.length;m++){const{name:n,fn:o}=a[m],{x:g,y:_,data:y,reset:v}=await o({x:u,y:d,initialPlacement:i,placement:h,strategy:r,middlewareData:f,rects:c,platform:s,elements:{reference:e,floating:t}});u=null!=g?g:u,d=null!=_?_:d,f={...f,[n]:{...f[n],...y}},v&&p<=50&&(p++,"object"==typeof v&&(v.placement&&(h=v.placement),v.rects&&(c=!0===v.rects?await s.getElementRects({reference:e,floating:t,strategy:r}):v.rects),({x:u,y:d}=Er(c,h,l))),m=-1)}return{x:u,y:d,placement:h,strategy:r,middlewareData:f}})(e,t,{...r,platform:o})})(S.current,E.current,e).then(e=>{const t={...e,isPositioned:!1!==A.current};R.current&&!Zr(C.current,t)&&(C.current=t,F.flushSync(()=>{d(t)}))})},[h,t,n,I,A]);Kr(()=>{!1===c&&C.current.isPositioned&&(C.current.isPositioned=!1,d(e=>({...e,isPositioned:!1})))},[c]);const R=b.useRef(!1);Kr(()=>(R.current=!0,()=>{R.current=!1}),[]),Kr(()=>{if(x&&(S.current=x),w&&(E.current=w),x&&w){if(k.current)return k.current(x,w,L);L()}},[x,w,L,k,T]);const P=b.useMemo(()=>({reference:S,floating:E,setReference:y,setFloating:v}),[y,v]),M=b.useMemo(()=>({reference:x,floating:w}),[x,w]),D=b.useMemo(()=>{const e={position:n,left:0,top:0};if(!M.floating)return e;const t=Jr(M.floating,u.x),i=Jr(M.floating,u.y);return a?{...e,transform:"translate("+t+"px, "+i+"px)",...Qr(M.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:t,top:i}},[n,a,M.floating,u.x,u.y]);return b.useMemo(()=>({...u,update:L,refs:P,elements:M,floatingStyles:D}),[u,L,P,M,D])}({...e,elements:{...r,...a&&{reference:a}}}),f=b.useCallback(e=>{const t=Mi(e)?{getBoundingClientRect:()=>e.getBoundingClientRect(),contextElement:e}:e;l(t),h.refs.setReference(t)},[h.refs]),p=b.useCallback(e=>{(Mi(e)||null===e)&&(u.current=e,s(e)),(Mi(h.refs.reference.current)||null===h.refs.reference.current||null!==e&&!Mi(e))&&h.refs.setReference(e)},[h.refs]),m=b.useMemo(()=>({...h.refs,setReference:p,setPositionReference:f,domReference:u}),[h.refs,p,f]),g=b.useMemo(()=>({...h.elements,domReference:c}),[h.elements,c]),_=b.useMemo(()=>({...h,...i,refs:m,elements:g,nodeId:t}),[h,m,g,t,i]);return ao(()=>{i.dataRef.current.floatingContext=_;const e=null==d?void 0:d.nodesRef.current.find(e=>e.id===t);e&&(e.context=_)}),b.useMemo(()=>({...h,context:_,refs:m,elements:g}),[h,m,g,_])}const _o="active",yo="selected";function vo(e,t,n){const i=new Map,r="item"===n;let o=e;if(r&&e){const{[_o]:t,[yo]:n,...i}=e;o=i}return{..."floating"===n&&{tabIndex:-1,[mo]:""},...o,...t.map(t=>{const i=t?t[n]:null;return"function"==typeof i?e?i(e):null:i}).concat(e).reduce((e,t)=>t?(Object.entries(t).forEach(t=>{let[n,o]=t;var s;r&&[_o,yo].includes(n)||(0===n.indexOf("on")?(i.has(n)||i.set(n,[]),"function"==typeof o&&(null==(s=i.get(n))||s.push(o),e[n]=function(){for(var e,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return null==(e=i.get(n))?void 0:e.map(e=>e(...r)).find(e=>void 0!==e)})):e[n]=o)}),e):e,{})}}function bo(e,t){return{...e,rects:{...e.rects,floating:{...e.rects.floating,height:t}}}}let xo=b.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});xo.displayName="FloatingContext";let wo=b.createContext(null);function So({children:e,enabled:t=!0}){let[n,i]=b.useState(null),[r,o]=b.useState(0),s=b.useRef(null),[a,l]=b.useState(null);!function(e){ze(()=>{if(!e)return;let t=new MutationObserver(()=>{let t=window.getComputedStyle(e).maxHeight,n=parseFloat(t);if(isNaN(n))return;let i=parseInt(t);isNaN(i)||n!==i&&(e.style.maxHeight=`${Math.ceil(n)}px`)});return t.observe(e,{attributes:!0,attributeFilter:["style"]}),()=>{t.disconnect()}},[e])}(a);let c=t&&null!==n&&null!==a,{to:u="bottom",gap:d=0,offset:h=0,padding:f=0,inner:p}=function(e,t){var n,i,r;let o=Eo(null!=(n=null==e?void 0:e.gap)?n:"var(--anchor-gap, 0)",t),s=Eo(null!=(i=null==e?void 0:e.offset)?i:"var(--anchor-offset, 0)",t),a=Eo(null!=(r=null==e?void 0:e.padding)?r:"var(--anchor-padding, 0)",t);return{...e,gap:o,offset:s,padding:a}}(n,a),[m,g="center"]=u.split(" ");ze(()=>{c&&o(0)},[c]);let{refs:_,floatingStyles:y,context:v}=go({open:c,placement:"selection"===m?"center"===g?"bottom":`bottom-${g}`:"center"===g?`${m}`:`${m}-${g}`,strategy:"absolute",transform:!1,middleware:[to({mainAxis:"selection"===m?0:d,crossAxis:h}),(E={padding:f},{...Yr(E),options:[E,undefined]}),"selection"!==m&&no({padding:f}),"selection"===m&&p?(S={...p,padding:f,overflowRef:s,offset:r,minItemsVisible:4,referenceOverflowThreshold:f,onFallbackChange(e){var t,n;if(!e)return;let i=v.elements.floating;if(!i)return;let r=parseFloat(getComputedStyle(i).scrollPaddingBottom)||0,s=Math.min(4,i.childElementCount),a=0,l=0;for(let o of null!=(n=null==(t=v.elements.floating)?void 0:t.childNodes)?n:[])if(wt(o)){let e=o.offsetTop,t=e+o.clientHeight+r,n=i.scrollTop,c=n+i.clientHeight;if(!(e>=n&&t<=c)){l=Math.max(0,Math.min(t,c)-Math.max(e,n)),a=o.clientHeight;break}s--}s>=1&&o(e=>{let t=a*s-l+r;return e>=t?e:t})}},{name:"inner",options:S,async fn(e){const{listRef:t,overflowRef:n,onFallbackChange:i,offset:r=0,index:o=0,minItemsVisible:s=4,referenceOverflowThreshold:a=0,scrollRef:l,...c}=cr(S,e),{rects:u,elements:{floating:d}}=e,h=t.current[o],f=(null==l?void 0:l.current)||d,p=d.clientTop||f.clientTop,m=0!==d.clientTop,g=0!==f.clientTop,_=d===f;if(!h)return{};const y={...e,...await to(-h.offsetTop-d.clientTop-u.reference.height/2-h.offsetHeight/2-r).fn(e)},v=await Gr(bo(y,f.scrollHeight+p+d.clientTop),c),b=await Gr(y,{...c,elementContext:"reference"}),x=nr(0,v.top),w=y.y+x,E=(f.scrollHeight>f.clientHeight?e=>e:ir)(nr(0,f.scrollHeight+(m&&_||g?2*p:0)-x-nr(0,v.bottom)));if(f.style.maxHeight=E+"px",f.scrollTop=x,i){const e=f.offsetHeight<h.offsetHeight*tr(s,t.current.length)-1||b.top>=-a||b.bottom>=-a;F.flushSync(()=>i(e))}return n&&(n.current=await Gr(bo({...y,y:w},f.offsetHeight+p+d.clientTop),c)),{y:w}}}):null,io({padding:f,apply({availableWidth:e,availableHeight:t,elements:n}){Object.assign(n.floating.style,{overflow:"auto",maxWidth:`${e}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${t}px)`})}})].filter(Boolean),whileElementsMounted:$r}),[x=m,w=g]=v.placement.split("-");var S,E;"selection"===m&&(x="selection");let C=b.useMemo(()=>({anchor:[x,w].filter(Boolean).join(" ")}),[x,w]),T=function(e,t){const{open:n,elements:i}=e,{enabled:r=!0,overflowRef:o,scrollRef:s,onChange:a}=t,l=so(a),c=b.useRef(!1),u=b.useRef(null),d=b.useRef(null);b.useEffect(()=>{if(!r)return;function e(e){if(e.ctrlKey||!t||null==o.current)return;const n=e.deltaY,i=o.current.top>=-.5,r=o.current.bottom>=-.5,s=t.scrollHeight-t.clientHeight,a=n<0?-1:1,c=n<0?"max":"min";t.scrollHeight<=t.clientHeight||(!i&&n>0||!r&&n<0?(e.preventDefault(),F.flushSync(()=>{l(e=>e+Math[c](n,s*a))})):/firefox/i.test(function(){const e=navigator.userAgentData;return e&&Array.isArray(e.brands)?e.brands.map(e=>{let{brand:t,version:n}=e;return t+"/"+n}).join(" "):navigator.userAgent}())&&(t.scrollTop+=n))}const t=(null==s?void 0:s.current)||i.floating;return n&&t?(t.addEventListener("wheel",e),requestAnimationFrame(()=>{u.current=t.scrollTop,null!=o.current&&(d.current={...o.current})}),()=>{u.current=null,d.current=null,t.removeEventListener("wheel",e)}):void 0},[r,n,i.floating,o,s,l]);const h=b.useMemo(()=>({onKeyDown(){c.current=!0},onWheel(){c.current=!1},onPointerMove(){c.current=!1},onScroll(){const e=(null==s?void 0:s.current)||i.floating;if(o.current&&e&&c.current){if(null!==u.current){const t=e.scrollTop-u.current;(o.current.bottom<-.5&&t<-1||o.current.top<-.5&&t>1)&&F.flushSync(()=>l(e=>e+t))}requestAnimationFrame(()=>{u.current=e.scrollTop})}}}),[i.floating,l,o,s]);return b.useMemo(()=>r?{floating:h}:{},[r,h])}(v,{overflowRef:s,onChange:o}),{getReferenceProps:k,getFloatingProps:I}=function(e){void 0===e&&(e=[]);const t=e.map(e=>null==e?void 0:e.reference),n=e.map(e=>null==e?void 0:e.floating),i=e.map(e=>null==e?void 0:e.item),r=b.useCallback(t=>vo(t,e,"reference"),t),o=b.useCallback(t=>vo(t,e,"floating"),n),s=b.useCallback(t=>vo(t,e,"item"),i);return b.useMemo(()=>({getReferenceProps:r,getFloatingProps:o,getItemProps:s}),[r,o,s])}([T]),A=Ve(e=>{l(e),_.setFloating(e)});return b.createElement(wo.Provider,{value:i},b.createElement(xo.Provider,{value:{setFloating:A,setReference:_.setReference,styles:y,getReferenceProps:k,getFloatingProps:I,slot:C}},e))}function Eo(e,t,n=void 0){let i=Be(),r=Ve((e,t)=>{if(null==e)return[n,null];if("number"==typeof e)return[e,null];if("string"==typeof e){if(!t)return[n,null];let r=To(e,t);return[r,n=>{let o=Co(e);{let s=o.map(e=>window.getComputedStyle(t).getPropertyValue(e));i.requestAnimationFrame(function a(){i.nextFrame(a);let l=!1;for(let[e,n]of o.entries()){let i=window.getComputedStyle(t).getPropertyValue(n);if(s[e]!==i){s[e]=i,l=!0;break}}if(!l)return;let c=To(e,t);r!==c&&(n(c),r=c)})}return i.dispose}]}return[n,null]}),o=b.useMemo(()=>r(e,t)[0],[e,t]),[s=o,a]=b.useState();return ze(()=>{let[n,i]=r(e,t);if(a(n),i)return i(a)},[e,t]),s}function Co(e){let t=/var\((.*)\)/.exec(e);if(t){let e=t[1].indexOf(",");if(-1===e)return[t[1]];let n=t[1].slice(0,e).trim(),i=t[1].slice(e+1).trim();return i?[n,...Co(i)]:[n]}return[]}function To(e,t){let n=document.createElement("div");t.appendChild(n),n.style.setProperty("margin-top","0px","important"),n.style.setProperty("margin-top",e,"important");let i=parseFloat(window.getComputedStyle(n).marginTop)||0;return t.removeChild(n),i}wo.displayName="PlacementContext";const ko=x.forwardRef(function({children:e,freeze:t},n){let i=Io(t,e);return b.isValidElement(i)?b.cloneElement(i,{ref:n}):x.createElement(x.Fragment,null,i)});function Io(e,t){let[n,i]=b.useState(t);return!e&&n!==t&&i(t),e?n:t}let Ao=b.createContext(null);Ao.displayName="OpenClosedContext";var Lo=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(Lo||{});function Ro(){return b.useContext(Ao)}function Po({value:e,children:t}){return x.createElement(Ao.Provider,{value:e},t)}function Mo({children:e}){return x.createElement(Ao.Provider,{value:null},e)}let Do=[];!function(){function e(){"loading"!==document.readyState&&((()=>{function e(e){if(!St(e.target)||e.target===document.body||Do[0]===e.target)return;let t=e.target;t=t.closest(jn),Do.unshift(null!=t?t:e.target),Do=Do.filter(e=>null!=e&&e.isConnected),Do.splice(10)}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})})(),document.removeEventListener("DOMContentLoaded",e))}"undefined"!=typeof window&&"undefined"!=typeof document&&(document.addEventListener("DOMContentLoaded",e),e())}();var No=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(No||{});function Fo(e,t){let n=t.resolveItems();if(n.length<=0)return null;let i=t.resolveActiveIndex(),r=null!=i?i:-1;switch(e.focus){case 0:for(let e=0;e<n.length;++e)if(!t.resolveDisabled(n[e],e,n))return e;return i;case 1:-1===r&&(r=n.length);for(let e=r-1;e>=0;--e)if(!t.resolveDisabled(n[e],e,n))return e;return i;case 2:for(let e=r+1;e<n.length;++e)if(!t.resolveDisabled(n[e],e,n))return e;return i;case 3:for(let e=n.length-1;e>=0;--e)if(!t.resolveDisabled(n[e],e,n))return e;return i;case 4:for(let i=0;i<n.length;++i)if(t.resolveId(n[i],i,n)===e.id)return i;return i;case 5:return null;default:!function(e){throw new Error("Unexpected object: "+e)}(e)}}function Oo(e){let t=Ve(e),n=b.useRef(!1);b.useEffect(()=>(n.current=!1,()=>{n.current=!0,Fe(()=>{n.current&&t()})}),[t])}let Bo=b.createContext(!1);function zo(e){return x.createElement(Bo.Provider,{value:e.force},e.children)}let Uo=b.Fragment,Vo=it(function(e,t){let{ownerDocument:n=null,...i}=e,r=b.useRef(null),o=Rt(Lt(e=>{r.current=e}),t),s=ui(r.current),a=function(e){let t=b.useContext(Bo),n=b.useContext(Wo),[i,r]=b.useState(()=>{var i;if(!t&&null!==n)return null!=(i=n.current)?i:null;if(Re.isServer)return null;let r=null==e?void 0:e.getElementById("headlessui-portal-root");if(r)return r;if(null===e)return null;let o=e.createElement("div");return o.setAttribute("id","headlessui-portal-root"),e.body.appendChild(o)});return b.useEffect(()=>{null!==i&&(null!=e&&e.body.contains(i)||null==e||e.body.appendChild(i))},[i,e]),b.useEffect(()=>{t||null!==n&&r(n.current)},[n,r,t]),i}(null!=n?n:s),l=b.useContext($o),c=Be(),u=Qe();return Oo(()=>{var e;a&&a.childNodes.length<=0&&(null==(e=a.parentElement)||e.removeChild(a))}),a?F.createPortal(x.createElement("div",{"data-headlessui-portal":"",ref:e=>{c.dispose(),l&&e&&c.add(l.register(e))}},u({ourProps:{ref:o},theirProps:i,slot:{},defaultTag:Uo,name:"Portal"})),a):null}),Ho=b.Fragment,Wo=b.createContext(null),$o=b.createContext(null),Go=it(function(e,t){let n=Rt(t),{enabled:i=!0,ownerDocument:r,...o}=e,s=Qe();return i?x.createElement(Vo,{...o,ownerDocument:r,ref:n}):s({ourProps:{ref:n},theirProps:o,slot:{},defaultTag:Uo,name:"Portal"})}),jo=it(function(e,t){let{target:n,...i}=e,r={ref:Rt(t)},o=Qe();return x.createElement(Wo.Provider,{value:n},o({ourProps:r,theirProps:i,defaultTag:Ho,name:"Popover.Group"}))}),Yo=Object.assign(Go,{Group:jo});const qo={Idle:{kind:"Idle"},Tracked:e=>({kind:"Tracked",position:e}),Moved:{kind:"Moved"}};function Xo(e){let t=e.getBoundingClientRect();return`${t.x},${t.y}`}var Ko,Zo=Object.defineProperty,Qo=(e,t,n)=>(((e,t,n)=>{t in e?Zo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),Jo=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Jo||{}),es=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(es||{}),ts=(e=>(e[e.Pointer=0]="Pointer",e[e.Focus=1]="Focus",e[e.Other=2]="Other",e))(ts||{}),ns=((Ko=ns||{})[Ko.OpenCombobox=0]="OpenCombobox",Ko[Ko.CloseCombobox=1]="CloseCombobox",Ko[Ko.GoToOption=2]="GoToOption",Ko[Ko.SetTyping=3]="SetTyping",Ko[Ko.RegisterOption=4]="RegisterOption",Ko[Ko.UnregisterOption=5]="UnregisterOption",Ko[Ko.DefaultToFirstOption=6]="DefaultToFirstOption",Ko[Ko.SetActivationTrigger=7]="SetActivationTrigger",Ko[Ko.UpdateVirtualConfiguration=8]="UpdateVirtualConfiguration",Ko[Ko.SetInputElement=9]="SetInputElement",Ko[Ko.SetButtonElement=10]="SetButtonElement",Ko[Ko.SetOptionsElement=11]="SetOptionsElement",Ko[Ko.MarkInputAsMoved=12]="MarkInputAsMoved",Ko);function is(e,t=e=>e){let n=null!==e.activeOptionIndex?e.options[e.activeOptionIndex]:null,i=t(e.options.slice()),r=i.length>0&&null!==i[0].dataRef.current.order?i.sort((e,t)=>e.dataRef.current.order-t.dataRef.current.order):ii(i,e=>e.dataRef.current.domRef.current),o=n?r.indexOf(n):null;return-1===o&&(o=null),{options:r,activeOptionIndex:o}}let rs={1(e){var t;if(null!=(t=e.dataRef.current)&&t.disabled||1===e.comboboxState)return e;let n=e.inputElement?qo.Tracked(Xo(e.inputElement)):e.inputPositionState;return{...e,activeOptionIndex:null,comboboxState:1,isTyping:!1,activationTrigger:2,inputPositionState:n,__demoMode:!1}},0(e){var t,n;if(null!=(t=e.dataRef.current)&&t.disabled||0===e.comboboxState)return e;if(null!=(n=e.dataRef.current)&&n.value){let t=e.dataRef.current.calculateIndex(e.dataRef.current.value);if(-1!==t)return{...e,activeOptionIndex:t,comboboxState:0,__demoMode:!1,inputPositionState:qo.Idle}}return{...e,comboboxState:0,inputPositionState:qo.Idle,__demoMode:!1}},3:(e,t)=>e.isTyping===t.isTyping?e:{...e,isTyping:t.isTyping},2(e,t){var n,i,r,o;if(null!=(n=e.dataRef.current)&&n.disabled||e.optionsElement&&(null==(i=e.dataRef.current)||!i.optionsPropsRef.current.static)&&1===e.comboboxState)return e;if(e.virtual){let{options:n,disabled:i}=e.virtual,o=t.focus===No.Specific?t.idx:Fo(t,{resolveItems:()=>n,resolveActiveIndex:()=>{var t,r;return null!=(r=null!=(t=e.activeOptionIndex)?t:n.findIndex(e=>!i(e)))?r:null},resolveDisabled:i,resolveId(){throw new Error("Function not implemented.")}}),s=null!=(r=t.trigger)?r:2;return e.activeOptionIndex===o&&e.activationTrigger===s?e:{...e,activeOptionIndex:o,activationTrigger:s,isTyping:!1,__demoMode:!1}}let s=is(e);if(null===s.activeOptionIndex){let e=s.options.findIndex(e=>!e.dataRef.current.disabled);-1!==e&&(s.activeOptionIndex=e)}let a=t.focus===No.Specific?t.idx:Fo(t,{resolveItems:()=>s.options,resolveActiveIndex:()=>s.activeOptionIndex,resolveId:e=>e.id,resolveDisabled:e=>e.dataRef.current.disabled}),l=null!=(o=t.trigger)?o:2;return e.activeOptionIndex===a&&e.activationTrigger===l?e:{...e,...s,isTyping:!1,activeOptionIndex:a,activationTrigger:l,__demoMode:!1}},4:(e,t)=>{var n,i,r,o;if(null!=(n=e.dataRef.current)&&n.virtual)return{...e,options:[...e.options,t.payload]};let s=t.payload,a=is(e,e=>(e.push(s),e));null===e.activeOptionIndex&&null!=(r=(i=e.dataRef.current).isSelected)&&r.call(i,t.payload.dataRef.current.value)&&(a.activeOptionIndex=a.options.indexOf(s));let l={...e,...a,activationTrigger:2};return null!=(o=e.dataRef.current)&&o.__demoMode&&void 0===e.dataRef.current.value&&(l.activeOptionIndex=0),l},5:(e,t)=>{var n;if(null!=(n=e.dataRef.current)&&n.virtual)return{...e,options:e.options.filter(e=>e.id!==t.id)};let i=is(e,e=>{let n=e.findIndex(e=>e.id===t.id);return-1!==n&&e.splice(n,1),e});return{...e,...i,activationTrigger:2}},6:(e,t)=>e.defaultToFirstOption===t.value?e:{...e,defaultToFirstOption:t.value},7:(e,t)=>e.activationTrigger===t.trigger?e:{...e,activationTrigger:t.trigger},8:(e,t)=>{var n,i;if(null===e.virtual)return{...e,virtual:{options:t.options,disabled:null!=(n=t.disabled)?n:()=>!1}};if(e.virtual.options===t.options&&e.virtual.disabled===t.disabled)return e;let r=e.activeOptionIndex;if(null!==e.activeOptionIndex){let n=t.options.indexOf(e.virtual.options[e.activeOptionIndex]);r=-1!==n?n:null}return{...e,activeOptionIndex:r,virtual:{options:t.options,disabled:null!=(i=t.disabled)?i:()=>!1}}},9:(e,t)=>e.inputElement===t.element?e:{...e,inputElement:t.element},10:(e,t)=>e.buttonElement===t.element?e:{...e,buttonElement:t.element},11:(e,t)=>e.optionsElement===t.element?e:{...e,optionsElement:t.element},12:e=>"Tracked"!==e.inputPositionState.kind?e:{...e,inputPositionState:qo.Moved}},os=class e extends wn{constructor(e){super(e),Qo(this,"actions",{onChange:e=>{let{onChange:t,compare:n,mode:i,value:r}=this.state.dataRef.current;return Ye(i,{0:()=>null==t?void 0:t(e),1:()=>{let i=r.slice(),o=i.findIndex(t=>n(t,e));return-1===o?i.push(e):i.splice(o,1),null==t?void 0:t(i)}})},registerOption:(e,t)=>(this.send({type:4,payload:{id:e,dataRef:t}}),()=>{this.state.activeOptionIndex===this.state.dataRef.current.calculateIndex(t.current.value)&&this.send({type:6,value:!0}),this.send({type:5,id:e})}),goToOption:(e,t)=>(this.send({type:6,value:!1}),this.send({type:2,...e,trigger:t})),setIsTyping:e=>{this.send({type:3,isTyping:e})},closeCombobox:()=>{var e,t;this.send({type:1}),this.send({type:6,value:!1}),null==(t=(e=this.state.dataRef.current).onClose)||t.call(e)},openCombobox:()=>{this.send({type:0}),this.send({type:6,value:!0})},setActivationTrigger:e=>{this.send({type:7,trigger:e})},selectActiveOption:()=>{let e=this.selectors.activeOptionIndex(this.state);if(null!==e){if(this.actions.setIsTyping(!1),this.state.virtual)this.actions.onChange(this.state.virtual.options[e]);else{let{dataRef:t}=this.state.options[e];this.actions.onChange(t.current.value)}this.actions.goToOption({focus:No.Specific,idx:e})}},setInputElement:e=>{this.send({type:9,element:e})},setButtonElement:e=>{this.send({type:10,element:e})},setOptionsElement:e=>{this.send({type:11,element:e})}}),Qo(this,"selectors",{activeDescendantId:e=>{var t,n;let i=this.selectors.activeOptionIndex(e);if(null!==i)return e.virtual?null==(n=e.options.find(t=>!t.dataRef.current.disabled&&e.dataRef.current.compare(t.dataRef.current.value,e.virtual.options[i])))?void 0:n.id:null==(t=e.options[i])?void 0:t.id},activeOptionIndex:e=>{if(e.defaultToFirstOption&&null===e.activeOptionIndex&&(e.virtual?e.virtual.options.length>0:e.options.length>0)){if(e.virtual){let{options:t,disabled:n}=e.virtual,i=t.findIndex(e=>{var t;return!(null!=(t=null==n?void 0:n(e))&&t)});if(-1!==i)return i}let t=e.options.findIndex(e=>!e.dataRef.current.disabled);if(-1!==t)return t}return e.activeOptionIndex},activeOption:e=>{var t,n;let i=this.selectors.activeOptionIndex(e);return null===i?null:e.virtual?e.virtual.options[null!=i?i:0]:null!=(n=null==(t=e.options[i])?void 0:t.dataRef.current.value)?n:null},isActive:(e,t,n)=>{var i;let r=this.selectors.activeOptionIndex(e);return null!==r&&(e.virtual?r===e.dataRef.current.calculateIndex(t):(null==(i=e.options[r])?void 0:i.id)===n)},shouldScrollIntoView:(e,t,n)=>!(e.virtual||e.__demoMode||0!==e.comboboxState||0===e.activationTrigger||!this.selectors.isActive(e,t,n)),didInputMove:e=>"Moved"===e.inputPositionState.kind});{let e=this.state.id,t=Pn.get(null);this.disposables.add(t.on(An.Push,n=>{!t.selectors.isTop(n,e)&&0===this.state.comboboxState&&this.actions.closeCombobox()})),this.on(0,()=>t.actions.push(e)),this.on(1,()=>t.actions.pop(e))}this.disposables.group(e=>{this.on(1,t=>{t.inputElement&&(e.dispose(),e.add(function(e,t,n){let i=Oe();if("Tracked"===t.kind){let r=function(){o!==Xo(e)&&(i.dispose(),n())},{position:o}=t,s=new ResizeObserver(r);s.observe(e),i.add(()=>s.disconnect()),i.addEventListener(window,"scroll",r,{passive:!0}),i.addEventListener(window,"resize",r)}return()=>i.dispose()}(t.inputElement,t.inputPositionState,()=>{this.send({type:12})})))})})}static new({id:t,virtual:n=null,__demoMode:i=!1}){var r;return new e({id:t,dataRef:{current:{}},comboboxState:i?0:1,isTyping:!1,options:[],virtual:n?{options:n.options,disabled:null!=(r=n.disabled)?r:()=>!1}:null,activeOptionIndex:null,activationTrigger:2,inputElement:null,buttonElement:null,optionsElement:null,__demoMode:i,inputPositionState:qo.Idle})}reduce(e,t){return Ye(t.type,rs,e,t)}};const ss=b.createContext(null);function as(e){let t=b.useContext(ss);if(null===t){let t=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,ls),t}return t}function ls({id:e,virtual:t=null,__demoMode:n=!1}){let i=b.useMemo(()=>os.new({id:e,virtual:t,__demoMode:n}),[]);return Oo(()=>i.dispose()),i}let cs=b.createContext(null);function us(e){let t=b.useContext(cs);if(null===t){let t=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,us),t}return t}cs.displayName="ComboboxDataContext";let ds=b.createContext(null);function hs(e){let t=as("VirtualProvider"),n=us("VirtualProvider"),{options:i}=n.virtual,r=Bn(t,e=>e.optionsElement),[o,s]=b.useMemo(()=>{let e=r;if(!e)return[0,0];let t=window.getComputedStyle(e);return[parseFloat(t.paddingBlockStart||t.paddingTop),parseFloat(t.paddingBlockEnd||t.paddingBottom)]},[r]),a=(u={enabled:0!==i.length,scrollPaddingStart:o,scrollPaddingEnd:s,count:i.length,estimateSize:()=>40,getScrollElement:()=>t.state.optionsElement,overscan:12},function({useFlushSync:e=!0,...t}){const n=b.useReducer(()=>({}),{})[1],i={...t,onChange:(i,r)=>{var o;e&&r?F.flushSync(n):n(),null==(o=t.onChange)||o.call(t,i,r)}},[r]=b.useState(()=>new on(i));return r.setOptions(i),an(()=>r._didMount(),[]),an(()=>r._willUpdate()),r}({observeElementRect:Qt,observeElementOffset:tn,scrollToFn:rn,...u})),[l,c]=b.useState(0);var u;ze(()=>{c(e=>e+1)},[i]);let d=a.getVirtualItems(),h=Bn(t,e=>e.activationTrigger===ts.Pointer),f=Bn(t,t.selectors.activeOptionIndex);return 0===d.length?null:x.createElement(ds.Provider,{value:a},x.createElement("div",{style:{position:"relative",width:"100%",height:`${a.getTotalSize()}px`},ref:e=>{e&&(h||null!==f&&i.length>f&&a.scrollToIndex(f))}},d.map(t=>{var n;return x.createElement(b.Fragment,{key:t.key},x.cloneElement(null==(n=e.children)?void 0:n.call(e,{...e.slot,option:i[t.index]}),{key:`${l}-${t.key}`,"data-index":t.index,"aria-setsize":i.length,"aria-posinset":t.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${t.start}px)`,overflowAnchor:"none"}}))})))}let fs=b.Fragment,ps=Ke.RenderStrategy|Ke.Static,ms=it(function(e,t){let n=b.useId(),i=Ge(),{value:r,defaultValue:o,onChange:s,form:a,name:l,by:c,invalid:u=!1,disabled:d=i||!1,onClose:h,__demoMode:f=!1,multiple:p=!1,immediate:m=!1,virtual:g=null,nullable:_,...y}=e,v=function(e){let[t]=b.useState(e);return t}(o),[w=(p?[]:void 0),S]=function(e,t,n){let[i,r]=b.useState(n),o=void 0!==e,s=b.useRef(o),a=b.useRef(!1),l=b.useRef(!1);return!o||s.current||a.current?!o&&s.current&&!l.current&&(l.current=!0,s.current=o):(a.current=!0,s.current=o),[o?e:i,Ve(e=>(o||F.flushSync(()=>r(e)),null==t?void 0:t(e)))]}(r,s,v),E=ls({id:n,virtual:g,__demoMode:f}),C=b.useRef({static:!1,hold:!1}),T=function(e=ln){return b.useCallback((t,n)=>{if("string"==typeof e){let i=e;return(null==t?void 0:t[i])===(null==n?void 0:n[i])}return e(t,n)},[e])}(c),k=Ve(e=>g?null===c?g.options.indexOf(e):g.options.findIndex(t=>T(t,e)):E.state.options.findIndex(t=>T(t.dataRef.current.value,e))),I=b.useCallback(e=>Ye(R.mode,{[es.Multi]:()=>w.some(t=>T(t,e)),[es.Single]:()=>T(w,e)}),[w]),A=Bn(E,e=>e.virtual),L=Ve(()=>null==h?void 0:h()),R=b.useMemo(()=>({__demoMode:f,immediate:m,optionsPropsRef:C,value:w,defaultValue:v,disabled:d,invalid:u,mode:p?es.Multi:es.Single,virtual:g?A:null,onChange:S,isSelected:I,calculateIndex:k,compare:T,onClose:L}),[f,m,C,w,v,d,u,p,g,A,S,I,k,T,L]);ze(()=>{var e;g&&E.send({type:ns.UpdateVirtualConfiguration,options:g.options,disabled:null!=(e=g.disabled)?e:null})},[g,null==g?void 0:g.options,null==g?void 0:g.disabled]),ze(()=>{E.state.dataRef.current=R},[R]);let[P,M,D,N]=Bn(E,e=>[e.comboboxState,e.buttonElement,e.inputElement,e.optionsElement]),O=Pn.get(null),B=Bn(O,b.useCallback(e=>O.selectors.isTop(e,n),[O,n]));ci(B,[M,D,N],()=>E.actions.closeCombobox());let z=Bn(E,E.selectors.activeOptionIndex),U=Bn(E,E.selectors.activeOption),V=We({open:P===Jo.Open,disabled:d,invalid:u,activeIndex:z,activeOption:U,value:w}),[H,W]=function({inherit:e=!1}={}){let t=Ut(),[n,i]=b.useState([]),r=e?[t,...n].filter(Boolean):n;return[r.length>0?r.join(" "):void 0,b.useMemo(()=>function(e){let t=Ve(e=>(i(t=>[...t,e]),()=>i(t=>{let n=t.slice(),i=n.indexOf(e);return-1!==i&&n.splice(i,1),n}))),n=b.useMemo(()=>({register:t,slot:e.slot,name:e.name,props:e.props,value:e.value}),[t,e.slot,e.name,e.props,e.value]);return x.createElement(Bt.Provider,{value:n},e.children)},[i])]}(),$=null===t?{}:{ref:t},G=b.useCallback(()=>{if(void 0!==v)return null==S?void 0:S(v)},[S,v]),j=Qe();return x.createElement(W,{value:H,props:{htmlFor:null==D?void 0:D.id},slot:{open:P===Jo.Open,disabled:d}},x.createElement(So,null,x.createElement(cs.Provider,{value:R},x.createElement(ss.Provider,{value:E},x.createElement(Po,{value:Ye(P,{[Jo.Open]:Lo.Open,[Jo.Closed]:Lo.Closed})},null!=l&&x.createElement(gt,{disabled:d,data:null!=w?{[l]:w}:{},form:a,onReset:G}),j({ourProps:$,theirProps:y,slot:V,defaultTag:fs,name:"Combobox"}))))))}),gs=it(function(e,t){let n=as("Combobox.Button"),i=us("Combobox.Button"),[r,o]=b.useState(null),s=Rt(t,o,n.actions.setButtonElement),a=b.useId(),{id:l=`headlessui-combobox-button-${a}`,disabled:c=i.disabled||!1,autoFocus:u=!1,...d}=e,[h,f,p]=Bn(n,e=>[e.comboboxState,e.inputElement,e.optionsElement]),m=pi(f);!function(e,{trigger:t,action:n,close:i,select:r}){let o=b.useRef(null),s=b.useRef(null),a=b.useRef(null);ai(e&&null!==t,"pointerdown",e=>{bt(null==e?void 0:e.target)&&null!=t&&t.contains(e.target)&&(s.current=e.x,a.current=e.y,o.current=e.timeStamp)}),ai(e&&null!==t,"pointerup",e=>{var t,l;let c=o.current;if(null===c||(o.current=null,!St(e.target))||Math.abs(e.x-(null!=(t=s.current)?t:e.x))<5&&Math.abs(e.y-(null!=(l=a.current)?l:e.y))<5)return;let u=n(e);switch(u.kind){case 0:return;case 1:e.timeStamp-c>200&&(r(u.target),i());break;case 2:i()}},{capture:!0})}(h===Jo.Open,{trigger:r,action:b.useCallback(e=>{if(null!=r&&r.contains(e.target))return hi.Ignore;if(null!=f&&f.contains(e.target))return hi.Ignore;let t=e.target.closest('[role="option"]:not([data-disabled])');return wt(t)?hi.Select(t):null!=p&&p.contains(e.target)?hi.Ignore:hi.Close},[r,f,p]),close:n.actions.closeCombobox,select:n.actions.selectActiveOption});let g=Ve(e=>{switch(e.key){case Ot.Space:case Ot.Enter:return e.preventDefault(),e.stopPropagation(),n.state.comboboxState===Jo.Closed&&F.flushSync(()=>n.actions.openCombobox()),void m();case Ot.ArrowDown:return e.preventDefault(),e.stopPropagation(),n.state.comboboxState===Jo.Closed&&(F.flushSync(()=>n.actions.openCombobox()),n.state.dataRef.current.value||n.actions.goToOption({focus:No.First})),void m();case Ot.ArrowUp:return e.preventDefault(),e.stopPropagation(),n.state.comboboxState===Jo.Closed&&(F.flushSync(()=>n.actions.openCombobox()),n.state.dataRef.current.value||n.actions.goToOption({focus:No.Last})),void m();case Ot.Escape:if(n.state.comboboxState!==Jo.Open)return;return e.preventDefault(),n.state.optionsElement&&!i.optionsPropsRef.current.static&&e.stopPropagation(),F.flushSync(()=>n.actions.closeCombobox()),void m();default:return}}),_=function(e){let t=b.useRef(null),n=Ve(n=>{t.current=n.pointerType,!It(n.currentTarget)&&"mouse"===n.pointerType&&n.button===hn.Left&&(n.preventDefault(),e())}),i=Ve(n=>{"mouse"!==t.current&&(It(n.currentTarget)||e())});return{onPointerDown:n,onClick:i}}(()=>{n.state.comboboxState===Jo.Open?n.actions.closeCombobox():n.actions.openCombobox(),m()}),y=Ut([l]),{isFocusVisible:v,focusProps:x}=Ie({autoFocus:u}),{isHovered:w,hoverProps:S}=ke({isDisabled:c}),{pressed:E,pressProps:C}=He({disabled:c}),T=We({open:h===Jo.Open,active:E||h===Jo.Open,disabled:c,invalid:i.invalid,value:i.value,hover:w,focus:v}),k=nt({ref:s,id:l,type:mi(e,r),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":null==p?void 0:p.id,"aria-expanded":h===Jo.Open,"aria-labelledby":y,disabled:c||void 0,autoFocus:u,onKeyDown:g},_,x,S,C);return Qe()({ourProps:k,theirProps:d,slot:T,defaultTag:"button",name:"Combobox.Button"})}),_s=it(function(e,t){var n,i;let r=as("Combobox.Input"),o=us("Combobox.Input"),s=b.useId(),a=vt(),{id:l=a||`headlessui-combobox-input-${s}`,onChange:c,displayValue:u,disabled:d=o.disabled||!1,autoFocus:h=!1,type:f="text",...p}=e,m=b.useRef(null),g=Rt(m,t,b.useContext(xo).setReference,r.actions.setInputElement),[_,y]=Bn(r,e=>[e.comboboxState,e.isTyping]),v=Be(),x=Ve(()=>{r.actions.onChange(null),r.state.optionsElement&&(r.state.optionsElement.scrollTop=0),r.actions.goToOption({focus:No.Nothing})}),w=b.useMemo(()=>{var e;return"function"==typeof u&&void 0!==o.value?null!=(e=u(o.value))?e:"":"string"==typeof o.value?o.value:""},[o.value,u]);ki(([e,t],[n,i])=>{if(r.state.isTyping)return;let o=m.current;o&&((i===Jo.Open&&t===Jo.Closed||e!==n)&&(o.value=e),requestAnimationFrame(()=>{if(r.state.isTyping||!o||Ne(o))return;let{selectionStart:e,selectionEnd:t}=o;0===Math.abs((null!=t?t:0)-(null!=e?e:0))&&0===e&&o.setSelectionRange(o.value.length,o.value.length)}))},[w,_,y]),ki(([e],[t])=>{if(e===Jo.Open&&t===Jo.Closed){if(r.state.isTyping)return;let e=m.current;if(!e)return;let t=e.value,{selectionStart:n,selectionEnd:i,selectionDirection:o}=e;e.value="",e.value=t,null!==o?e.setSelectionRange(n,i,o):e.setSelectionRange(n,i)}},[_]);let S=b.useRef(!1),E=Ve(()=>{S.current=!0}),C=Ve(()=>{v.nextFrame(()=>{S.current=!1})}),T=Ve(e=>{switch(r.actions.setIsTyping(!0),e.key){case Ot.Enter:if(r.state.comboboxState!==Jo.Open||S.current)return;if(e.preventDefault(),e.stopPropagation(),null===r.selectors.activeOptionIndex(r.state))return void r.actions.closeCombobox();r.actions.selectActiveOption(),o.mode===es.Single&&r.actions.closeCombobox();break;case Ot.ArrowDown:return e.preventDefault(),e.stopPropagation(),Ye(r.state.comboboxState,{[Jo.Open]:()=>r.actions.goToOption({focus:No.Next}),[Jo.Closed]:()=>r.actions.openCombobox()});case Ot.ArrowUp:return e.preventDefault(),e.stopPropagation(),Ye(r.state.comboboxState,{[Jo.Open]:()=>r.actions.goToOption({focus:No.Previous}),[Jo.Closed]:()=>{F.flushSync(()=>r.actions.openCombobox()),o.value||r.actions.goToOption({focus:No.Last})}});case Ot.Home:if(r.state.comboboxState===Jo.Closed||e.shiftKey)break;return e.preventDefault(),e.stopPropagation(),r.actions.goToOption({focus:No.First});case Ot.PageUp:return e.preventDefault(),e.stopPropagation(),r.actions.goToOption({focus:No.First});case Ot.End:if(r.state.comboboxState===Jo.Closed||e.shiftKey)break;return e.preventDefault(),e.stopPropagation(),r.actions.goToOption({focus:No.Last});case Ot.PageDown:return e.preventDefault(),e.stopPropagation(),r.actions.goToOption({focus:No.Last});case Ot.Escape:return r.state.comboboxState!==Jo.Open?void 0:(e.preventDefault(),r.state.optionsElement&&!o.optionsPropsRef.current.static&&e.stopPropagation(),o.mode===es.Single&&null===o.value&&x(),r.actions.closeCombobox());case Ot.Tab:if(r.actions.setIsTyping(!1),r.state.comboboxState!==Jo.Open)return;o.mode===es.Single&&r.state.activationTrigger!==ts.Focus&&r.actions.selectActiveOption(),r.actions.closeCombobox()}}),k=Ve(e=>{null==c||c(e),o.mode===es.Single&&""===e.target.value&&x(),r.actions.openCombobox()}),I=Ve(e=>{var t,n,i;let s=null!=(t=e.relatedTarget)?t:Do.find(t=>t!==e.currentTarget);if(!(null!=(n=r.state.optionsElement)&&n.contains(s)||null!=(i=r.state.buttonElement)&&i.contains(s)||r.state.comboboxState!==Jo.Open))return e.preventDefault(),o.mode===es.Single&&null===o.value&&x(),r.actions.closeCombobox()}),A=Ve(e=>{var t,n,i;let s=null!=(t=e.relatedTarget)?t:Do.find(t=>t!==e.currentTarget);null!=(n=r.state.buttonElement)&&n.contains(s)||null!=(i=r.state.optionsElement)&&i.contains(s)||o.disabled||o.immediate&&r.state.comboboxState!==Jo.Open&&v.microTask(()=>{F.flushSync(()=>r.actions.openCombobox()),r.actions.setActivationTrigger(ts.Focus)})}),L=Ut(),R=function(){var e,t;return null!=(t=null==(e=b.useContext(Pt))?void 0:e.value)?t:void 0}(),{isFocused:P,focusProps:M}=Ie({autoFocus:h}),{isHovered:D,hoverProps:N}=ke({isDisabled:d}),O=Bn(r,e=>e.optionsElement),B=We({open:_===Jo.Open,disabled:d,invalid:o.invalid,hover:D,focus:P,autofocus:h}),z=nt({ref:g,id:l,role:"combobox",type:f,"aria-controls":null==O?void 0:O.id,"aria-expanded":_===Jo.Open,"aria-activedescendant":Bn(r,r.selectors.activeDescendantId),"aria-labelledby":L,"aria-describedby":R,"aria-autocomplete":"list",defaultValue:null!=(i=null!=(n=e.defaultValue)?n:void 0!==o.defaultValue?null==u?void 0:u(o.defaultValue):null)?i:o.defaultValue,disabled:d||void 0,autoFocus:h,onCompositionStart:E,onCompositionEnd:C,onKeyDown:T,onChange:k,onFocus:A,onBlur:I},M,N);return Qe()({ourProps:z,theirProps:p,slot:B,defaultTag:"input",name:"Combobox.Input"})}),ys=Ht,vs=it(function(e,t){var n,i,r;let o=b.useId(),{id:s=`headlessui-combobox-options-${o}`,hold:a=!1,anchor:l,portal:c=!1,modal:u=!0,transition:d=!1,...h}=e,f=as("Combobox.Options"),p=us("Combobox.Options"),m=function(e){return b.useMemo(()=>e?"string"==typeof e?{to:e}:e:null,[e])}(l);m&&(c=!0);let[g,_]=function(e=null){!1===e&&(e=null),"string"==typeof e&&(e={to:e});let t=b.useContext(wo),n=b.useMemo(()=>e,[JSON.stringify(e,(e,t)=>{var n;return null!=(n=null==t?void 0:t.outerHTML)?n:t})]);ze(()=>{null==t||t(null!=n?n:null)},[t,n]);let i=b.useContext(xo);return b.useMemo(()=>[i.setFloating,e?i.styles:{}],[i.setFloating,e,i.styles])}(m),[y,v]=b.useState(null),w=function(){let{getFloatingProps:e,slot:t}=b.useContext(xo);return b.useCallback((...n)=>Object.assign({},e(...n),{"data-anchor":t.anchor}),[e,t])}(),S=Rt(t,m?g:null,f.actions.setOptionsElement,v),[E,C,T,k,I]=Bn(f,e=>[e.comboboxState,e.inputElement,e.buttonElement,e.optionsElement,e.activationTrigger]),A=ui(C||T),L=ui(k),R=Ro(),[P,M]=Ti(d,y,null!==R?(R&Lo.Open)===Lo.Open:E===Jo.Open);Gn(P,C,f.actions.closeCombobox),vi(!p.__demoMode&&u&&E===Jo.Open,L),$n(!p.__demoMode&&u&&E===Jo.Open,{allowed:b.useCallback(()=>[C,T,k],[C,T,k])});let D=!Bn(f,f.selectors.didInputMove)&&P;ze(()=>{var t;p.optionsPropsRef.current.static=null!=(t=e.static)&&t},[p.optionsPropsRef,e.static]),ze(()=>{p.optionsPropsRef.current.hold=a},[p.optionsPropsRef,a]),function(e,{container:t,accept:n,walk:i}){let r=b.useRef(n),o=b.useRef(i);b.useEffect(()=>{r.current=n,o.current=i},[n,i]),ze(()=>{if(!t||!e)return;let n=Pe(t);if(!n)return;let i=r.current,s=o.current,a=Object.assign(e=>i(e),{acceptNode:i}),l=n.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,a,!1);for(;l.nextNode();)s(l.currentNode)},[t,e,r,o])}(E===Jo.Open,{container:k,accept:e=>"option"===e.getAttribute("role")?NodeFilter.FILTER_REJECT:e.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT,walk(e){e.setAttribute("role","none")}});let N=Ut([null==T?void 0:T.id]),F=We({open:E===Jo.Open,option:void 0}),O=Ve(()=>{f.actions.setActivationTrigger(ts.Pointer)}),B=Ve(e=>{e.preventDefault(),f.actions.setActivationTrigger(ts.Pointer)}),z=nt(m?w():{},{"aria-labelledby":N,role:"listbox","aria-multiselectable":p.mode===es.Multi||void 0,id:s,ref:S,style:{...h.style,..._,"--input-width":un(P,C,!0).width,"--button-width":un(P,T,!0).width},onWheel:I===ts.Pointer?void 0:O,onMouseDown:B,...Ci(M)}),U=P&&E===Jo.Closed&&!e.static,V=Io(U,null==(n=p.virtual)?void 0:n.options),H=Io(U,p.value),W=b.useCallback(e=>p.compare(H,e),[p.compare,H]),$=b.useMemo(()=>{if(!p.virtual)return p;if(void 0===V)throw new Error("Missing `options` in virtual mode");return V!==p.virtual.options?{...p,virtual:{...p.virtual,options:V}}:p},[p,V,null==(i=p.virtual)?void 0:i.options]);p.virtual&&Object.assign(h,{children:x.createElement(cs.Provider,{value:$},x.createElement(hs,{slot:F},h.children))});let G=Qe(),j=b.useMemo(()=>p.mode===es.Multi?p:{...p,isSelected:W},[p,W]);return x.createElement(Yo,{enabled:!!c&&(e.static||P),ownerDocument:A},x.createElement(cs.Provider,{value:j},G({ourProps:z,theirProps:{...h,children:x.createElement(ko,{freeze:U},"function"==typeof h.children?null==(r=h.children)?void 0:r.call(h,F):h.children)},slot:F,defaultTag:"div",features:ps,visible:D,name:"Combobox.Options"})))}),bs=it(function(e,t){var n,i,r;let o=us("Combobox.Option"),s=as("Combobox.Option"),a=b.useId(),{id:l=`headlessui-combobox-option-${a}`,value:c,disabled:u=null!=(r=null==(i=null==(n=o.virtual)?void 0:n.disabled)?void 0:i.call(n,c))&&r,order:d=null,...h}=e,[f]=Bn(s,e=>[e.inputElement]),p=pi(f),m=Bn(s,b.useCallback(e=>s.selectors.isActive(e,c,l),[c,l])),g=o.isSelected(c),_=b.useRef(null),y=Ue({disabled:u,value:c,domRef:_,order:d}),v=b.useContext(ds),x=Rt(t,_,v?v.measureElement:null),w=Ve(()=>{s.actions.setIsTyping(!1),s.actions.onChange(c)});ze(()=>s.actions.registerOption(l,y),[y,l]);let S=Bn(s,b.useCallback(e=>s.selectors.shouldScrollIntoView(e,c,l),[c,l]));ze(()=>{if(S)return Oe().requestAnimationFrame(()=>{var e,t;null==(t=null==(e=_.current)?void 0:e.scrollIntoView)||t.call(e,{block:"nearest"})})},[S,_]);let E=Ve(e=>{e.preventDefault(),e.button===hn.Left&&(u||(w(),si()||requestAnimationFrame(()=>p()),o.mode===es.Single&&s.actions.closeCombobox()))}),C=Ve(()=>{if(u)return s.actions.goToOption({focus:No.Nothing});let e=o.calculateIndex(c);s.actions.goToOption({focus:No.Specific,idx:e})}),T=function(){let e=b.useRef([-1,-1]);return{wasMoved(t){let n=bi(t);return(e.current[0]!==n[0]||e.current[1]!==n[1])&&(e.current=n,!0)},update(t){e.current=bi(t)}}}(),k=Ve(e=>T.update(e)),I=Ve(e=>{if(!T.wasMoved(e)||u||m&&s.state.activationTrigger===ts.Pointer)return;let t=o.calculateIndex(c);s.actions.goToOption({focus:No.Specific,idx:t},ts.Pointer)}),A=Ve(e=>{T.wasMoved(e)&&(u||m&&(o.optionsPropsRef.current.hold||s.state.activationTrigger===ts.Pointer&&s.actions.goToOption({focus:No.Nothing})))}),L=We({active:m,focus:m,selected:g,disabled:u}),R={id:l,ref:x,role:"option",tabIndex:!0===u?void 0:-1,"aria-disabled":!0===u||void 0,"aria-selected":g,disabled:void 0,onMouseDown:E,onFocus:C,onPointerEnter:k,onMouseEnter:k,onPointerMove:I,onMouseMove:I,onPointerLeave:A,onMouseLeave:A};return Qe()({ourProps:R,theirProps:h,slot:L,defaultTag:"div",name:"Combobox.Option"})}),xs=Object.assign(ms,{Input:_s,Button:gs,Label:ys,Options:vs,Option:bs}),ws=b.Fragment,Ss=it(function(e,t){let{...n}=e,i=!1,{isFocusVisible:r,focusProps:o}=Ie(),{isHovered:s,hoverProps:a}=ke({isDisabled:i}),{pressed:l,pressProps:c}=He({disabled:i}),u=nt({ref:t},o,a,c),d=We({hover:s,focus:r,active:l});return Qe()({ourProps:u,theirProps:n,slot:d,defaultTag:ws,name:"DataInteractive"})}),Es=b.createContext(null);function Cs({children:e,node:t}){let[n,i]=b.useState(null),r=Ts(null!=t?t:n);return x.createElement(Es.Provider,{value:r},e,null===r&&x.createElement(ft,{features:ht.Hidden,ref:e=>{var t,n;if(e)for(let r of null!=(n=null==(t=Pe(e))?void 0:t.querySelectorAll("html > *, body > *"))?n:[])if(r!==document.body&&r!==document.head&&xt(r)&&null!=r&&r.contains(e)){i(r);break}}}))}function Ts(e=null){var t;return null!=(t=b.useContext(Es))?t:e}function ks(){let e=function(){let e="undefined"==typeof document;return"useSyncExternalStore"in w&&w.useSyncExternalStore(()=>()=>{},()=>!1,()=>!e)}(),[t,n]=b.useState(Re.isHandoffComplete);return t&&!1===Re.isHandoffComplete&&n(!1),b.useEffect(()=>{!0!==t&&n(!0)},[t]),b.useEffect(()=>Re.handoff(),[]),!e&&t}function Is(){let e=b.useRef(!1);return ze(()=>(e.current=!0,()=>{e.current=!1}),[]),e}var As=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(As||{});function Ls(e){if(!e)return new Set;if("function"==typeof e)return new Set(e());let t=new Set;for(let n of e.current)xt(n.current)&&t.add(n.current);return t}var Rs=(e=>(e[e.None=0]="None",e[e.InitialFocus=1]="InitialFocus",e[e.TabLock=2]="TabLock",e[e.FocusLock=4]="FocusLock",e[e.RestoreFocus=8]="RestoreFocus",e[e.AutoFocus=16]="AutoFocus",e))(Rs||{});let Ps=it(function(e,t){let n=b.useRef(null),i=Rt(n,t),{initialFocus:r,initialFocusFallback:o,containers:s,features:a=15,...l}=e;ks()||(a=0);let c=ui(n.current);!function(e,{ownerDocument:t}){let n=!!(8&e),i=function(e=!0){let t=b.useRef(Do.slice());return ki(([e],[n])=>{!0===n&&!1===e&&Fe(()=>{t.current.splice(0)}),!1===n&&!0===e&&(t.current=Do.slice())},[e,Do,t]),Ve(()=>{var e;return null!=(e=t.current.find(e=>null!=e&&e.isConnected))?e:null})}(n);ki(()=>{n||Ne(null==t?void 0:t.body)&&ti(i())},[n]),Oo(()=>{n&&ti(i())})}(a,{ownerDocument:c});let u=function(e,{ownerDocument:t,container:n,initialFocus:i,initialFocusFallback:r}){let o=b.useRef(null),s=Un(!!(1&e),"focus-trap#initial-focus"),a=Is();return ki(()=>{if(0===e)return;if(!s)return void(null!=r&&r.current&&ti(r.current));let l=n.current;l&&Fe(()=>{if(!a.current)return;let n=null==t?void 0:t.activeElement;if(null!=i&&i.current){if((null==i?void 0:i.current)===n)return void(o.current=n)}else if(l.contains(n))return void(o.current=n);if(null!=i&&i.current)ti(i.current);else{if(16&e){if(ri(l,Kn.First|Kn.AutoFocus)!==Zn.Error)return}else if(ri(l,Kn.First)!==Zn.Error)return;if(null!=r&&r.current&&(ti(r.current),(null==t?void 0:t.activeElement)===r.current))return}o.current=null==t?void 0:t.activeElement})},[r,s,e]),o}(a,{ownerDocument:c,container:n,initialFocus:r,initialFocusFallback:o});!function(e,{ownerDocument:t,container:n,containers:i,previousActiveElement:r}){let o=Is(),s=!!(4&e);fi(null==t?void 0:t.defaultView,"focus",e=>{if(!s||!o.current)return;let t=Ls(i);wt(n.current)&&t.add(n.current);let a=r.current;if(!a)return;let l=e.target;wt(l)?Ds(t,l)?(r.current=l,ti(l)):(e.preventDefault(),e.stopPropagation(),ti(a)):ti(r.current)},!0)}(a,{ownerDocument:c,container:n,containers:s,previousActiveElement:u});let d=function(){let e=b.useRef(0);return li(!0,"keydown",t=>{"Tab"===t.key&&(e.current=t.shiftKey?1:0)},!0),e}(),h=Ve(e=>{if(!wt(n.current))return;let t=n.current;Ye(d.current,{[As.Forwards]:()=>{ri(t,Kn.First,{skipElements:[e.relatedTarget,o]})},[As.Backwards]:()=>{ri(t,Kn.Last,{skipElements:[e.relatedTarget,o]})}})}),f=Un(!!(2&a),"focus-trap#tab-lock"),p=Be(),m=b.useRef(!1),g={ref:i,onKeyDown(e){"Tab"==e.key&&(m.current=!0,p.requestAnimationFrame(()=>{m.current=!1}))},onBlur(e){if(!(4&a))return;let t=Ls(s);wt(n.current)&&t.add(n.current);let i=e.relatedTarget;St(i)&&"true"!==i.dataset.headlessuiFocusGuard&&(Ds(t,i)||(m.current?ri(n.current,Ye(d.current,{[As.Forwards]:()=>Kn.Next,[As.Backwards]:()=>Kn.Previous})|Kn.WrapAround,{relativeTo:e.target}):St(e.target)&&ti(e.target)))}},_=Qe();return x.createElement(x.Fragment,null,f&&x.createElement(ft,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:h,features:ht.Focusable}),_({ourProps:g,theirProps:l,defaultTag:"div",name:"FocusTrap"}),f&&x.createElement(ft,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:h,features:ht.Focusable}))}),Ms=Object.assign(Ps,{features:Rs});function Ds(e,t){for(let n of e)if(n.contains(t))return!0;return!1}function Ns(e){var t;return!!(e.enter||e.enterFrom||e.enterTo||e.leave||e.leaveFrom||e.leaveTo)||!at(null!=(t=e.as)?t:Vs)||1===x.Children.count(e.children)}let Fs=b.createContext(null);Fs.displayName="TransitionContext";var Os=(e=>(e.Visible="visible",e.Hidden="hidden",e))(Os||{});let Bs=b.createContext(null);function zs(e){return"children"in e?zs(e.children):e.current.filter(({el:e})=>null!==e.current).filter(({state:e})=>"visible"===e).length>0}function Us(e,t){let n=Ue(e),i=b.useRef([]),r=Is(),o=Be(),s=Ve((e,t=Ze.Hidden)=>{let s=i.current.findIndex(({el:t})=>t===e);-1!==s&&(Ye(t,{[Ze.Unmount](){i.current.splice(s,1)},[Ze.Hidden](){i.current[s].state="hidden"}}),o.microTask(()=>{var e;!zs(i)&&r.current&&(null==(e=n.current)||e.call(n))}))}),a=Ve(e=>{let t=i.current.find(({el:t})=>t===e);return t?"visible"!==t.state&&(t.state="visible"):i.current.push({el:e,state:"visible"}),()=>s(e,Ze.Unmount)}),l=b.useRef([]),c=b.useRef(Promise.resolve()),u=b.useRef({enter:[],leave:[]}),d=Ve((e,n,i)=>{l.current.splice(0),t&&(t.chains.current[n]=t.chains.current[n].filter(([t])=>t!==e)),null==t||t.chains.current[n].push([e,new Promise(e=>{l.current.push(e)})]),null==t||t.chains.current[n].push([e,new Promise(e=>{Promise.all(u.current[n].map(([e,t])=>t)).then(()=>e())})]),"enter"===n?c.current=c.current.then(()=>null==t?void 0:t.wait.current).then(()=>i(n)):i(n)}),h=Ve((e,t,n)=>{Promise.all(u.current[t].splice(0).map(([e,t])=>t)).then(()=>{var e;null==(e=l.current.shift())||e()}).then(()=>n(t))});return b.useMemo(()=>({children:i,register:a,unregister:s,onStart:d,onStop:h,wait:c,chains:u}),[a,s,i,d,h,u,c])}Bs.displayName="NestingContext";let Vs=b.Fragment,Hs=Ke.RenderStrategy,Ws=it(function(e,t){let{show:n,appear:i=!1,unmount:r=!0,...o}=e,s=b.useRef(null),a=Rt(...Ns(e)?[s,t]:null===t?[]:[t]);ks();let l=Ro();if(void 0===n&&null!==l&&(n=(l&Lo.Open)===Lo.Open),void 0===n)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[c,u]=b.useState(n?"visible":"hidden"),d=Us(()=>{n||u("hidden")}),[h,f]=b.useState(!0),p=b.useRef([n]);ze(()=>{!1!==h&&p.current[p.current.length-1]!==n&&(p.current.push(n),f(!1))},[p,n]);let m=b.useMemo(()=>({show:n,appear:i,initial:h}),[n,i,h]);ze(()=>{n?u("visible"):!zs(d)&&null!==s.current&&u("hidden")},[n,d]);let g={unmount:r},_=Ve(()=>{var t;h&&f(!1),null==(t=e.beforeEnter)||t.call(e)}),y=Ve(()=>{var t;h&&f(!1),null==(t=e.beforeLeave)||t.call(e)}),v=Qe();return x.createElement(Bs.Provider,{value:d},x.createElement(Fs.Provider,{value:m},v({ourProps:{...g,as:b.Fragment,children:x.createElement($s,{ref:a,...g,...o,beforeEnter:_,beforeLeave:y})},theirProps:{},defaultTag:b.Fragment,features:Hs,visible:"visible"===c,name:"Transition"})))}),$s=it(function(e,t){var n,i;let{transition:r=!0,beforeEnter:o,afterEnter:s,beforeLeave:a,afterLeave:l,enter:c,enterFrom:u,enterTo:d,entered:h,leave:f,leaveFrom:p,leaveTo:m,...g}=e,[_,y]=b.useState(null),v=b.useRef(null),w=Ns(e),S=Rt(...w?[v,t,y]:null===t?[]:[t]),E=null==(n=g.unmount)||n?Ze.Unmount:Ze.Hidden,{show:C,appear:T,initial:k}=function(){let e=b.useContext(Fs);if(null===e)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),[I,A]=b.useState(C?"visible":"hidden"),L=function(){let e=b.useContext(Bs);if(null===e)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),{register:R,unregister:P}=L;ze(()=>R(v),[R,v]),ze(()=>{if(E===Ze.Hidden&&v.current)return C&&"visible"!==I?void A("visible"):Ye(I,{hidden:()=>P(v),visible:()=>R(v)})},[I,v,R,P,C,E]);let M=ks();ze(()=>{if(w&&M&&"visible"===I&&null===v.current)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[v,I,M,w]);let D=k&&!T,N=T&&C&&k,F=b.useRef(!1),O=Us(()=>{F.current||(A("hidden"),P(v))},L),B=Ve(e=>{F.current=!0;let t=e?"enter":"leave";O.onStart(v,t,e=>{"enter"===e?null==o||o():"leave"===e&&(null==a||a())})}),z=Ve(e=>{let t=e?"enter":"leave";F.current=!1,O.onStop(v,t,e=>{"enter"===e?null==s||s():"leave"===e&&(null==l||l())}),"leave"===t&&!zs(O)&&(A("hidden"),P(v))});b.useEffect(()=>{w&&r||(B(C),z(C))},[C,w,r]);let U=(()=>!(!r||!w||!M||D))(),[,V]=Ti(U,_,C,{start:B,end:z}),H=rt({ref:S,className:(null==(i=je(g.className,N&&c,N&&u,V.enter&&c,V.enter&&V.closed&&u,V.enter&&!V.closed&&d,V.leave&&f,V.leave&&!V.closed&&p,V.leave&&V.closed&&m,!V.transition&&C&&h))?void 0:i.trim())||void 0,...Ci(V)}),W=0;"visible"===I&&(W|=Lo.Open),"hidden"===I&&(W|=Lo.Closed),C&&"hidden"===I&&(W|=Lo.Opening),!C&&"visible"===I&&(W|=Lo.Closing);let $=Qe();return x.createElement(Bs.Provider,{value:O},x.createElement(Po,{value:W},$({ourProps:H,theirProps:g,defaultTag:Vs,features:Hs,visible:"visible"===I,name:"Transition.Child"})))}),Gs=it(function(e,t){let n=null!==b.useContext(Fs),i=null!==Ro();return x.createElement(x.Fragment,null,!n&&i?x.createElement(Ws,{ref:t,...e}):x.createElement($s,{ref:t,...e}))}),js=Object.assign(Ws,{Child:Gs,Root:Ws});var Ys=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Ys||{}),qs=(e=>(e[e.SetTitleId=0]="SetTitleId",e))(qs||{});let Xs={0:(e,t)=>e.titleId===t.id?e:{...e,titleId:t.id}},Ks=b.createContext(null);function Zs(e){let t=b.useContext(Ks);if(null===t){let t=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,Zs),t}return t}function Qs(e,t){return Ye(t.type,Xs,e,t)}Ks.displayName="DialogContext";let Js=it(function(e,t){let n=b.useId(),{id:i=`headlessui-dialog-${n}`,open:r,onClose:o,initialFocus:s,role:a="dialog",autoFocus:l=!0,__demoMode:c=!1,unmount:u=!1,...d}=e,h=b.useRef(!1);a="dialog"===a||"alertdialog"===a?a:(h.current||(h.current=!0),"dialog");let f=Ro();void 0===r&&null!==f&&(r=(f&Lo.Open)===Lo.Open);let p=b.useRef(null),m=Rt(p,t),g=ui(p.current),_=r?0:1,[y,v]=b.useReducer(Qs,{titleId:null,descriptionId:null,panelRef:b.createRef()}),w=Ve(()=>o(!1)),S=Ve(e=>v({type:0,id:e})),E=!!ks()&&0===_,[C,T]=function(){let e=b.useContext($o),t=b.useRef([]),n=Ve(n=>(t.current.push(n),e&&e.register(n),()=>i(n))),i=Ve(n=>{let i=t.current.indexOf(n);-1!==i&&t.current.splice(i,1),e&&e.unregister(n)}),r=b.useMemo(()=>({register:n,unregister:i,portals:t}),[n,i,t]);return[t,b.useMemo(()=>function({children:e}){return x.createElement($o.Provider,{value:r},e)},[r])]}(),k={get current(){var e;return null!=(e=y.panelRef.current)?e:p.current}},I=Ts(),{resolveContainers:A}=function({defaultContainers:e=[],portals:t,mainTreeNode:n}={}){let i=Ve(()=>{var i,r;let o=Pe(n),s=[];for(let t of e)null!==t&&(xt(t)?s.push(t):"current"in t&&xt(t.current)&&s.push(t.current));if(null!=t&&t.current)for(let e of t.current)s.push(e);for(let e of null!=(i=null==o?void 0:o.querySelectorAll("html > *, body > *"))?i:[])e!==document.body&&e!==document.head&&xt(e)&&"headlessui-portal-root"!==e.id&&(n&&(e.contains(n)||e.contains(null==(r=null==n?void 0:n.getRootNode())?void 0:r.host))||s.some(t=>e.contains(t))||s.push(e));return s});return{resolveContainers:i,contains:Ve(e=>i().some(t=>t.contains(e)))}}({mainTreeNode:I,portals:C,defaultContainers:[k]}),L=null!==f&&(f&Lo.Closing)===Lo.Closing;$n(!c&&!L&&E,{allowed:Ve(()=>{var e,t;return[null!=(t=null==(e=p.current)?void 0:e.closest("[data-headlessui-portal]"))?t:null]}),disallowed:Ve(()=>{var e;return[null!=(e=null==I?void 0:I.closest("body > *:not(#headlessui-portal-root)"))?e:null]})});let R=Pn.get(null);ze(()=>{if(E)return R.actions.push(i),()=>R.actions.pop(i)},[R,i,E]);let P=Bn(R,b.useCallback(e=>R.selectors.isTop(e,i),[R,i]));ci(P,A,e=>{e.preventDefault(),w()}),function(e,t=("undefined"!=typeof document?document.defaultView:null),n){let i=Un(e,"escape");fi(t,"keydown",e=>{i&&(e.defaultPrevented||e.key===Ot.Escape&&n(e))})}(P,null==g?void 0:g.defaultView,e=>{e.preventDefault(),e.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur(),w()}),vi(!c&&!L&&E,g,A),Gn(E,p,w);let[M,D]=function(){let[e,t]=b.useState([]);return[e.length>0?e.join(" "):void 0,b.useMemo(()=>function(e){let n=Ve(e=>(t(t=>[...t,e]),()=>t(t=>{let n=t.slice(),i=n.indexOf(e);return-1!==i&&n.splice(i,1),n}))),i=b.useMemo(()=>({register:n,slot:e.slot,name:e.name,props:e.props,value:e.value}),[n,e.slot,e.name,e.props,e.value]);return x.createElement(Pt.Provider,{value:i},e.children)},[t])]}(),N=b.useMemo(()=>[{dialogState:_,close:w,setTitleId:S,unmount:u},y],[_,w,S,u,y]),F=We({open:0===_}),O={ref:m,id:i,role:a,tabIndex:-1,"aria-modal":c?void 0:0===_||void 0,"aria-labelledby":y.titleId,"aria-describedby":M,unmount:u},B=!function(){var e;let[t]=b.useState(()=>"undefined"!=typeof window&&"function"==typeof window.matchMedia?window.matchMedia("(pointer: coarse)"):null),[n,i]=b.useState(null!=(e=null==t?void 0:t.matches)&&e);return ze(()=>{if(t)return t.addEventListener("change",e),()=>t.removeEventListener("change",e);function e(e){i(e.matches)}},[t]),n}(),z=Rs.None;E&&!c&&(z|=Rs.RestoreFocus,z|=Rs.TabLock,l&&(z|=Rs.AutoFocus),B&&(z|=Rs.InitialFocus));let U=Qe();return x.createElement(Mo,null,x.createElement(zo,{force:!0},x.createElement(Yo,null,x.createElement(Ks.Provider,{value:N},x.createElement(jo,{target:p},x.createElement(zo,{force:!1},x.createElement(D,{slot:F},x.createElement(T,null,x.createElement(Ms,{initialFocus:s,initialFocusFallback:p,containers:A,features:z},x.createElement($t,{value:w},U({ourProps:O,theirProps:d,slot:F,defaultTag:ea,features:ta,visible:0===_,name:"Dialog"})))))))))))}),ea="div",ta=Ke.RenderStrategy|Ke.Static,na=it(function(e,t){let{transition:n=!1,open:i,...r}=e,o=Ro(),s=e.hasOwnProperty("open")||null!==o,a=e.hasOwnProperty("onClose");if(!s&&!a)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!s)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!a)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!o&&"boolean"!=typeof e.open)throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${e.open}`);if("function"!=typeof e.onClose)throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${e.onClose}`);return void 0===i&&!n||r.static?x.createElement(Cs,null,x.createElement(Js,{ref:t,open:i,...r})):x.createElement(Cs,null,x.createElement(js,{show:i,transition:n,unmount:r.unmount},x.createElement(Js,{ref:t,...r})))}),ia=it(function(e,t){let n=b.useId(),{id:i=`headlessui-dialog-panel-${n}`,transition:r=!1,...o}=e,[{dialogState:s,unmount:a},l]=Zs("Dialog.Panel"),c=Rt(t,l.panelRef),u=We({open:0===s}),d={ref:c,id:i,onClick:Ve(e=>{e.stopPropagation()})},h=r?Gs:b.Fragment,f=r?{unmount:a}:{},p=Qe();return x.createElement(h,{...f},p({ourProps:d,theirProps:o,slot:u,defaultTag:"div",name:"Dialog.Panel"}))});it(function(e,t){let{transition:n=!1,...i}=e,[{dialogState:r,unmount:o}]=Zs("Dialog.Backdrop"),s=We({open:0===r}),a={ref:t,"aria-hidden":!0},l=n?Gs:b.Fragment,c=n?{unmount:o}:{},u=Qe();return x.createElement(l,{...c},u({ourProps:a,theirProps:i,slot:s,defaultTag:"div",name:"Dialog.Backdrop"}))});let ra=it(function(e,t){let n=b.useId(),{id:i=`headlessui-dialog-title-${n}`,...r}=e,[{dialogState:o,setTitleId:s}]=Zs("Dialog.Title"),a=Rt(t);b.useEffect(()=>(s(i),()=>s(null)),[i,s]);let l=We({open:0===o}),c={ref:a,id:i};return Qe()({ourProps:c,theirProps:r,slot:l,defaultTag:"h2",name:"Dialog.Title"})}),oa=Object.assign(na,{Panel:ia,Title:ra,Description:Nt});var sa;let aa=null!=(sa=x.startTransition)?sa:function(e){e()};var la=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(la||{}),ca=(e=>(e[e.ToggleDisclosure=0]="ToggleDisclosure",e[e.CloseDisclosure=1]="CloseDisclosure",e[e.SetButtonId=2]="SetButtonId",e[e.SetPanelId=3]="SetPanelId",e[e.SetButtonElement=4]="SetButtonElement",e[e.SetPanelElement=5]="SetPanelElement",e))(ca||{});let ua={0:e=>({...e,disclosureState:Ye(e.disclosureState,{0:1,1:0})}),1:e=>1===e.disclosureState?e:{...e,disclosureState:1},2:(e,t)=>e.buttonId===t.buttonId?e:{...e,buttonId:t.buttonId},3:(e,t)=>e.panelId===t.panelId?e:{...e,panelId:t.panelId},4:(e,t)=>e.buttonElement===t.element?e:{...e,buttonElement:t.element},5:(e,t)=>e.panelElement===t.element?e:{...e,panelElement:t.element}},da=b.createContext(null);function ha(e){let t=b.useContext(da);if(null===t){let t=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,ha),t}return t}da.displayName="DisclosureContext";let fa=b.createContext(null);function pa(e){let t=b.useContext(fa);if(null===t){let t=new Error(`<${e} /> is missing a parent <Disclosure /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,pa),t}return t}fa.displayName="DisclosureAPIContext";let ma=b.createContext(null);function ga(e,t){return Ye(t.type,ua,e,t)}ma.displayName="DisclosurePanelContext";let _a=b.Fragment,ya=Ke.RenderStrategy|Ke.Static,va=it(function(e,t){let{defaultOpen:n=!1,...i}=e,r=b.useRef(null),o=Rt(t,Lt(e=>{r.current=e},void 0===e.as||at(e.as))),s=b.useReducer(ga,{disclosureState:n?0:1,buttonElement:null,panelElement:null,buttonId:null,panelId:null}),[{disclosureState:a,buttonId:l},c]=s,u=Ve(e=>{c({type:1});let t=Pe(r.current);if(!t||!l)return;let n=e?St(e)?e:"current"in e&&St(e.current)?e.current:t.getElementById(l):t.getElementById(l);null==n||n.focus()}),d=b.useMemo(()=>({close:u}),[u]),h=We({open:0===a,close:u}),f={ref:o},p=Qe();return x.createElement(da.Provider,{value:s},x.createElement(fa.Provider,{value:d},x.createElement($t,{value:u},x.createElement(Po,{value:Ye(a,{0:Lo.Open,1:Lo.Closed})},p({ourProps:f,theirProps:i,slot:h,defaultTag:_a,name:"Disclosure"})))))}),ba=it(function(e,t){let n=b.useId(),{id:i=`headlessui-disclosure-button-${n}`,disabled:r=!1,autoFocus:o=!1,...s}=e,[a,l]=ha("Disclosure.Button"),c=b.useContext(ma),u=null!==c&&c===a.panelId,d=Rt(b.useRef(null),t,Ve(e=>{if(!u)return l({type:4,element:e})}));b.useEffect(()=>{if(!u)return l({type:2,buttonId:i}),()=>{l({type:2,buttonId:null})}},[i,l,u]);let h=Ve(e=>{var t;if(u){if(1===a.disclosureState)return;switch(e.key){case Ot.Space:case Ot.Enter:e.preventDefault(),e.stopPropagation(),l({type:0}),null==(t=a.buttonElement)||t.focus()}}else switch(e.key){case Ot.Space:case Ot.Enter:e.preventDefault(),e.stopPropagation(),l({type:0})}}),f=Ve(e=>{e.key===Ot.Space&&e.preventDefault()}),p=Ve(e=>{var t;It(e.currentTarget)||r||(u?(l({type:0}),null==(t=a.buttonElement)||t.focus()):l({type:0}))}),{isFocusVisible:m,focusProps:g}=Ie({autoFocus:o}),{isHovered:_,hoverProps:y}=ke({isDisabled:r}),{pressed:v,pressProps:x}=He({disabled:r}),w=We({open:0===a.disclosureState,hover:_,active:v,disabled:r,focus:m,autofocus:o}),S=mi(e,a.buttonElement),E=nt(u?{ref:d,type:S,disabled:r||void 0,autoFocus:o,onKeyDown:h,onClick:p}:{ref:d,id:i,type:S,"aria-expanded":0===a.disclosureState,"aria-controls":a.panelElement?a.panelId:void 0,disabled:r||void 0,autoFocus:o,onKeyDown:h,onKeyUp:f,onClick:p},g,y,x);return Qe()({ourProps:E,theirProps:s,slot:w,defaultTag:"button",name:"Disclosure.Button"})}),xa=it(function(e,t){let n=b.useId(),{id:i=`headlessui-disclosure-panel-${n}`,transition:r=!1,...o}=e,[s,a]=ha("Disclosure.Panel"),{close:l}=pa("Disclosure.Panel"),[c,u]=b.useState(null),d=Rt(t,Ve(e=>{aa(()=>a({type:5,element:e}))}),u);b.useEffect(()=>(a({type:3,panelId:i}),()=>{a({type:3,panelId:null})}),[i,a]);let h=Ro(),[f,p]=Ti(r,c,null!==h?(h&Lo.Open)===Lo.Open:0===s.disclosureState),m=We({open:0===s.disclosureState,close:l}),g={ref:d,id:i,...Ci(p)},_=Qe();return x.createElement(Mo,null,x.createElement(ma.Provider,{value:s.panelId},_({ourProps:g,theirProps:o,slot:m,defaultTag:"div",features:ya,visible:f,name:"Disclosure.Panel"})))}),wa=Object.assign(va,{Button:ba,Panel:xa});const Sa=b.createContext(null);function Ea(){return b.useContext(Sa)}var Ca=Object.defineProperty,Ta=(e,t,n)=>((e,t,n)=>t in e?Ca(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n),ka="http://www.w3.org/1999/xhtml";const Ia={svg:"http://www.w3.org/2000/svg",xhtml:ka,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Aa(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),Ia.hasOwnProperty(t)?{space:Ia[t],local:e}:e}function La(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===ka&&t.documentElement.namespaceURI===ka?t.createElement(e):t.createElementNS(n,e)}}function Ra(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Pa(e){var t=Aa(e);return(t.local?Ra:La)(t)}function Ma(){}function Da(e){return null==e?Ma:function(){return this.querySelector(e)}}function Na(){return[]}function Fa(e){return null==e?Na:function(){return this.querySelectorAll(e)}}function Oa(e){return function(){return this.matches(e)}}function Ba(e){return function(t){return t.matches(e)}}var za=Array.prototype.find;function Ua(){return this.firstElementChild}var Va=Array.prototype.filter;function Ha(){return Array.from(this.children)}function Wa(e){return new Array(e.length)}function $a(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function Ga(e,t,n,i,r,o){for(var s,a=0,l=t.length,c=o.length;a<c;++a)(s=t[a])?(s.__data__=o[a],i[a]=s):n[a]=new $a(e,o[a]);for(;a<l;++a)(s=t[a])&&(r[a]=s)}function ja(e,t,n,i,r,o,s){var a,l,c,u=new Map,d=t.length,h=o.length,f=new Array(d);for(a=0;a<d;++a)(l=t[a])&&(f[a]=c=s.call(l,l.__data__,a,t)+"",u.has(c)?r[a]=l:u.set(c,l));for(a=0;a<h;++a)c=s.call(e,o[a],a,o)+"",(l=u.get(c))?(i[a]=l,l.__data__=o[a],u.delete(c)):n[a]=new $a(e,o[a]);for(a=0;a<d;++a)(l=t[a])&&u.get(f[a])===l&&(r[a]=l)}function Ya(e){return e.__data__}function qa(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function Xa(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Ka(e){return function(){this.removeAttribute(e)}}function Za(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Qa(e,t){return function(){this.setAttribute(e,t)}}function Ja(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function el(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function tl(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function nl(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function il(e){return function(){this.style.removeProperty(e)}}function rl(e,t,n){return function(){this.style.setProperty(e,t,n)}}function ol(e,t,n){return function(){var i=t.apply(this,arguments);null==i?this.style.removeProperty(e):this.style.setProperty(e,i,n)}}function sl(e,t){return e.style.getPropertyValue(t)||nl(e).getComputedStyle(e,null).getPropertyValue(t)}function al(e){return function(){delete this[e]}}function ll(e,t){return function(){this[e]=t}}function cl(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function ul(e){return e.trim().split(/^|\s+/)}function dl(e){return e.classList||new hl(e)}function hl(e){this._node=e,this._names=ul(e.getAttribute("class")||"")}function fl(e,t){for(var n=dl(e),i=-1,r=t.length;++i<r;)n.add(t[i])}function pl(e,t){for(var n=dl(e),i=-1,r=t.length;++i<r;)n.remove(t[i])}function ml(e){return function(){fl(this,e)}}function gl(e){return function(){pl(this,e)}}function _l(e,t){return function(){(t.apply(this,arguments)?fl:pl)(this,e)}}function yl(){this.textContent=""}function vl(e){return function(){this.textContent=e}}function bl(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function xl(){this.innerHTML=""}function wl(e){return function(){this.innerHTML=e}}function Sl(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function El(){this.nextSibling&&this.parentNode.appendChild(this)}function Cl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Tl(){return null}function kl(){var e=this.parentNode;e&&e.removeChild(this)}function Il(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Al(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Ll(e){return function(){var t=this.__on;if(t){for(var n,i=0,r=-1,o=t.length;i<o;++i)n=t[i],e.type&&n.type!==e.type||n.name!==e.name?t[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?t.length=r:delete this.__on}}}function Rl(e,t,n){return function(){var i,r=this.__on,o=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(r)for(var s=0,a=r.length;s<a;++s)if((i=r[s]).type===e.type&&i.name===e.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),void(i.value=t);this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Pl(e,t,n){var i=nl(e),r=i.CustomEvent;"function"==typeof r?r=new r(t,n):(r=i.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function Ml(e,t){return function(){return Pl(this,e,t)}}function Dl(e,t){return function(){return Pl(this,e,t.apply(this,arguments))}}$a.prototype={constructor:$a,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}},hl.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var Nl=[null];function Fl(e,t){this._groups=e,this._parents=t}function Ol(){return new Fl([[document.documentElement]],Nl)}function Bl(e){return"string"==typeof e?new Fl([[document.querySelector(e)]],[document.documentElement]):new Fl([[e]],Nl)}function zl(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}Fl.prototype=Ol.prototype={constructor:Fl,select:function(e){"function"!=typeof e&&(e=Da(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o,s,a=t[r],l=a.length,c=i[r]=new Array(l),u=0;u<l;++u)(o=a[u])&&(s=e.call(o,o.__data__,u,a))&&("__data__"in o&&(s.__data__=o.__data__),c[u]=s);return new Fl(i,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){return function(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}(e.apply(this,arguments))}}(e):Fa(e);for(var t=this._groups,n=t.length,i=[],r=[],o=0;o<n;++o)for(var s,a=t[o],l=a.length,c=0;c<l;++c)(s=a[c])&&(i.push(e.call(s,s.__data__,c,a)),r.push(s));return new Fl(i,r)},selectChild:function(e){return this.select(null==e?Ua:function(e){return function(){return za.call(this.children,e)}}("function"==typeof e?e:Ba(e)))},selectChildren:function(e){return this.selectAll(null==e?Ha:function(e){return function(){return Va.call(this.children,e)}}("function"==typeof e?e:Ba(e)))},filter:function(e){"function"!=typeof e&&(e=Oa(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o,s=t[r],a=s.length,l=i[r]=[],c=0;c<a;++c)(o=s[c])&&e.call(o,o.__data__,c,s)&&l.push(o);return new Fl(i,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,Ya);var n=t?ja:Ga,i=this._parents,r=this._groups;"function"!=typeof e&&(e=function(e){return function(){return e}}(e));for(var o=r.length,s=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var u=i[c],d=r[c],h=d.length,f=qa(e.call(u,u&&u.__data__,c,i)),p=f.length,m=a[c]=new Array(p),g=s[c]=new Array(p);n(u,d,m,g,l[c]=new Array(h),f,t);for(var _,y,v=0,b=0;v<p;++v)if(_=m[v]){for(v>=b&&(b=v+1);!(y=g[b])&&++b<p;);_._next=y||null}}return(s=new Fl(s,i))._enter=a,s._exit=l,s},enter:function(){return new Fl(this._enter||this._groups.map(Wa),this._parents)},exit:function(){return new Fl(this._exit||this._groups.map(Wa),this._parents)},join:function(e,t,n){var i=this.enter(),r=this,o=this.exit();return"function"==typeof e?(i=e(i))&&(i=i.selection()):i=i.append(e+""),null!=t&&(r=t(r))&&(r=r.selection()),null==n?o.remove():n(o),i&&r?i.merge(r).order():r},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,i=t._groups,r=n.length,o=i.length,s=Math.min(r,o),a=new Array(r),l=0;l<s;++l)for(var c,u=n[l],d=i[l],h=u.length,f=a[l]=new Array(h),p=0;p<h;++p)(c=u[p]||d[p])&&(f[p]=c);for(;l<r;++l)a[l]=n[l];return new Fl(a,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var i,r=e[t],o=r.length-1,s=r[o];--o>=0;)(i=r[o])&&(s&&4^i.compareDocumentPosition(s)&&s.parentNode.insertBefore(i,s),s=i);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=Xa);for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var s,a=n[o],l=a.length,c=r[o]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(t)}return new Fl(r,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],r=0,o=i.length;r<o;++r){var s=i[r];if(s)return s}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,i=t.length;n<i;++n)for(var r,o=t[n],s=0,a=o.length;s<a;++s)(r=o[s])&&e.call(r,r.__data__,s,o);return this},attr:function(e,t){var n=Aa(e);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==t?n.local?Za:Ka:"function"==typeof t?n.local?tl:el:n.local?Ja:Qa)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?il:"function"==typeof t?ol:rl)(e,t,n??"")):sl(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?al:"function"==typeof t?cl:ll)(e,t)):this.node()[e]},classed:function(e,t){var n=ul(e+"");if(arguments.length<2){for(var i=dl(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof t?_l:t?ml:gl)(n,t))},text:function(e){return arguments.length?this.each(null==e?yl:("function"==typeof e?bl:vl)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?xl:("function"==typeof e?Sl:wl)(e)):this.node().innerHTML},raise:function(){return this.each(El)},lower:function(){return this.each(Cl)},append:function(e){var t="function"==typeof e?e:Pa(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:Pa(e),i=null==t?Tl:"function"==typeof t?t:Da(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function(){return this.each(kl)},clone:function(e){return this.select(e?Al:Il)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var i,r,o=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),s=o.length;if(!(arguments.length<2)){for(a=t?Rl:Ll,i=0;i<s;++i)this.each(a(o[i],t,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(i=0,l=a[c];i<s;++i)if((r=o[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?Dl:Ml)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i,r=e[t],o=0,s=r.length;o<s;++o)(i=r[o])&&(yield i)}};var Ul={value:()=>{}};function Vl(){for(var e,t=0,n=arguments.length,i={};t<n;++t){if(!(e=arguments[t]+"")||e in i||/[\s.]/.test(e))throw new Error("illegal type: "+e);i[e]=[]}return new Hl(i)}function Hl(e){this._=e}function Wl(e,t){for(var n,i=0,r=e.length;i<r;++i)if((n=e[i]).name===t)return n.value}function $l(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=Ul,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=n&&e.push({name:t,value:n}),e}Hl.prototype=Vl.prototype={constructor:Hl,on:function(e,t){var n,i=this._,r=function(e,t){return e.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");if(i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}})}(e+"",i),o=-1,s=r.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<s;)if(n=(e=r[o]).type)i[n]=$l(i[n],e.name,t);else if(null==t)for(n in i)i[n]=$l(i[n],e.name,null);return this}for(;++o<s;)if((n=(e=r[o]).type)&&(n=Wl(i[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Hl(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(i=this._[e]).length;o<n;++o)i[o].value.apply(t,r)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)}};var Gl,jl,Yl=0,ql=0,Xl=0,Kl=0,Zl=0,Ql=0,Jl="object"==typeof performance&&performance.now?performance:Date,ec="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function tc(){return Zl||(ec(nc),Zl=Jl.now()+Ql)}function nc(){Zl=0}function ic(){this._call=this._time=this._next=null}function rc(e,t,n){var i=new ic;return i.restart(e,t,n),i}function oc(){Zl=(Kl=Jl.now())+Ql,Yl=ql=0;try{!function(){tc(),++Yl;for(var e,t=Gl;t;)(e=Zl-t._time)>=0&&t._call.call(null,e),t=t._next;--Yl}()}finally{Yl=0,function(){for(var e,t,n=Gl,i=1/0;n;)n._call?(i>n._time&&(i=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Gl=t);jl=e,ac(i)}(),Zl=0}}function sc(){var e=Jl.now(),t=e-Kl;t>1e3&&(Ql-=t,Kl=e)}function ac(e){Yl||(ql&&(ql=clearTimeout(ql)),e-Zl>24?(e<1/0&&(ql=setTimeout(oc,e-Jl.now()-Ql)),Xl&&(Xl=clearInterval(Xl))):(Xl||(Kl=Jl.now(),Xl=setInterval(sc,1e3)),Yl=1,ec(oc)))}function lc(e,t,n){var i=new ic;return t=null==t?0:+t,i.restart(n=>{i.stop(),e(n+t)},t,n),i}ic.prototype=rc.prototype={constructor:ic,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?tc():+n)+(null==t?0:+t),!this._next&&jl!==this&&(jl?jl._next=this:Gl=this,jl=this),this._call=e,this._time=n,ac()},stop:function(){this._call&&(this._call=null,this._time=1/0,ac())}};var cc=Vl("start","end","cancel","interrupt"),uc=[];function dc(e,t,n,i,r,o){var s=e.__transition;if(s){if(n in s)return}else e.__transition={};!function(e,t,n){var i,r=e.__transition;function o(l){var c,u,d,h;if(1!==n.state)return a();for(c in r)if((h=r[c]).name===n.name){if(3===h.state)return lc(o);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[c]):+c<t&&(h.state=6,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[c])}if(lc(function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(d=n.tween.length),c=0,u=-1;c<d;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(i[++u]=h);i.length=u+1}}function s(t){for(var r=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(a),n.state=5,1),o=-1,s=i.length;++o<s;)i[o].call(e,r);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),a())}function a(){for(var i in n.state=6,n.timer.stop(),delete r[t],r)return;delete e.__transition}r[t]=n,n.timer=rc(function(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)},0,n.time)}(e,n,{name:t,index:i,group:r,on:cc,tween:uc,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function hc(e,t){var n=pc(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function fc(e,t){var n=pc(e,t);if(n.state>3)throw new Error("too late; already running");return n}function pc(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function mc(e,t){var n,i,r,o=e.__transition,s=!0;if(o){for(r in t=null==t?null:t+"",o)(n=o[r]).name===t?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete o[r]):s=!1;s&&delete e.__transition}}function gc(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function _c(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function yc(){}var vc=.7,bc=1/vc,xc="\\s*([+-]?\\d+)\\s*",wc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Sc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ec=/^#([0-9a-f]{3,8})$/,Cc=new RegExp(`^rgb\\(${xc},${xc},${xc}\\)$`),Tc=new RegExp(`^rgb\\(${Sc},${Sc},${Sc}\\)$`),kc=new RegExp(`^rgba\\(${xc},${xc},${xc},${wc}\\)$`),Ic=new RegExp(`^rgba\\(${Sc},${Sc},${Sc},${wc}\\)$`),Ac=new RegExp(`^hsl\\(${wc},${Sc},${Sc}\\)$`),Lc=new RegExp(`^hsla\\(${wc},${Sc},${Sc},${wc}\\)$`),Rc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Pc(){return this.rgb().formatHex()}function Mc(){return this.rgb().formatRgb()}function Dc(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Ec.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Nc(t):3===n?new Bc(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Fc(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Fc(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Cc.exec(e))?new Bc(t[1],t[2],t[3],1):(t=Tc.exec(e))?new Bc(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=kc.exec(e))?Fc(t[1],t[2],t[3],t[4]):(t=Ic.exec(e))?Fc(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Ac.exec(e))?$c(t[1],t[2]/100,t[3]/100,1):(t=Lc.exec(e))?$c(t[1],t[2]/100,t[3]/100,t[4]):Rc.hasOwnProperty(e)?Nc(Rc[e]):"transparent"===e?new Bc(NaN,NaN,NaN,0):null}function Nc(e){return new Bc(e>>16&255,e>>8&255,255&e,1)}function Fc(e,t,n,i){return i<=0&&(e=t=n=NaN),new Bc(e,t,n,i)}function Oc(e,t,n,i){return 1===arguments.length?function(e){return e instanceof yc||(e=Dc(e)),e?new Bc((e=e.rgb()).r,e.g,e.b,e.opacity):new Bc}(e):new Bc(e,t,n,i??1)}function Bc(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function zc(){return`#${Wc(this.r)}${Wc(this.g)}${Wc(this.b)}`}function Uc(){const e=Vc(this.opacity);return`${1===e?"rgb(":"rgba("}${Hc(this.r)}, ${Hc(this.g)}, ${Hc(this.b)}${1===e?")":`, ${e})`}`}function Vc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Hc(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Wc(e){return((e=Hc(e))<16?"0":"")+e.toString(16)}function $c(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new jc(e,t,n,i)}function Gc(e){if(e instanceof jc)return new jc(e.h,e.s,e.l,e.opacity);if(e instanceof yc||(e=Dc(e)),!e)return new jc;if(e instanceof jc)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),s=NaN,a=o-r,l=(o+r)/2;return a?(s=t===o?(n-i)/a+6*(n<i):n===o?(i-t)/a+2:(t-n)/a+4,a/=l<.5?o+r:2-o-r,s*=60):a=l>0&&l<1?0:s,new jc(s,a,l,e.opacity)}function jc(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function Yc(e){return(e=(e||0)%360)<0?e+360:e}function qc(e){return Math.max(0,Math.min(1,e||0))}function Xc(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}gc(yc,Dc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Pc,formatHex:Pc,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Gc(this).formatHsl()},formatRgb:Mc,toString:Mc}),gc(Bc,Oc,_c(yc,{brighter(e){return e=null==e?bc:Math.pow(bc,e),new Bc(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?vc:Math.pow(vc,e),new Bc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Bc(Hc(this.r),Hc(this.g),Hc(this.b),Vc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zc,formatHex:zc,formatHex8:function(){return`#${Wc(this.r)}${Wc(this.g)}${Wc(this.b)}${Wc(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Uc,toString:Uc})),gc(jc,function(e,t,n,i){return 1===arguments.length?Gc(e):new jc(e,t,n,i??1)},_c(yc,{brighter(e){return e=null==e?bc:Math.pow(bc,e),new jc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?vc:Math.pow(vc,e),new jc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new Bc(Xc(e>=240?e-240:e+120,r,i),Xc(e,r,i),Xc(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new jc(Yc(this.h),qc(this.s),qc(this.l),Vc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Vc(this.opacity);return`${1===e?"hsl(":"hsla("}${Yc(this.h)}, ${100*qc(this.s)}%, ${100*qc(this.l)}%${1===e?")":`, ${e})`}`}}));const Kc=e=>()=>e;function Zc(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):Kc(isNaN(e)?t:e)}const Qc=function e(t){var n=function(e){return 1==(e=+e)?Zc:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}(t,n,e):Kc(isNaN(t)?n:t)}}(t);function i(e,t){var i=n((e=Oc(e)).r,(t=Oc(t)).r),r=n(e.g,t.g),o=n(e.b,t.b),s=Zc(e.opacity,t.opacity);return function(t){return e.r=i(t),e.g=r(t),e.b=o(t),e.opacity=s(t),e+""}}return i.gamma=e,i}(1);function Jc(e,t){t||(t=[]);var n,i=e?Math.min(t.length,e.length):0,r=t.slice();return function(o){for(n=0;n<i;++n)r[n]=e[n]*(1-o)+t[n]*o;return r}}function eu(e,t){var n,i=t?t.length:0,r=e?Math.min(i,e.length):0,o=new Array(r),s=new Array(i);for(n=0;n<r;++n)o[n]=au(e[n],t[n]);for(;n<i;++n)s[n]=t[n];return function(e){for(n=0;n<r;++n)s[n]=o[n](e);return s}}function tu(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function nu(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function iu(e,t){var n,i={},r={};for(n in(null===e||"object"!=typeof e)&&(e={}),(null===t||"object"!=typeof t)&&(t={}),t)n in e?i[n]=au(e[n],t[n]):r[n]=t[n];return function(e){for(n in i)r[n]=i[n](e);return r}}var ru=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ou=new RegExp(ru.source,"g");function su(e,t){var n,i,r,o=ru.lastIndex=ou.lastIndex=0,s=-1,a=[],l=[];for(e+="",t+="";(n=ru.exec(e))&&(i=ou.exec(t));)(r=i.index)>o&&(r=t.slice(o,r),a[s]?a[s]+=r:a[++s]=r),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,l.push({i:s,x:nu(n,i)})),o=ou.lastIndex;return o<t.length&&(r=t.slice(o),a[s]?a[s]+=r:a[++s]=r),a.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,i=0;i<t;++i)a[(n=l[i]).i]=n.x(e);return a.join("")})}function au(e,t){var n,i=typeof t;return null==t||"boolean"===i?Kc(t):("number"===i?nu:"string"===i?(n=Dc(t))?(t=n,Qc):su:t instanceof Dc?Qc:t instanceof Date?tu:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?Jc:Array.isArray(t)?eu:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?iu:nu)(e,t)}function lu(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var cu,uu=180/Math.PI,du={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function hu(e,t,n,i,r,o){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*i)&&(n-=e*l,i-=t*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),e*i<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(t,e)*uu,skewX:Math.atan(l)*uu,scaleX:s,scaleY:a}}function fu(e,t,n,i){function r(e){return e.length?e.pop()+" ":""}return function(o,s){var a=[],l=[];return o=e(o),s=e(s),function(e,i,r,o,s,a){if(e!==r||i!==o){var l=s.push("translate(",null,t,null,n);a.push({i:l-4,x:nu(e,r)},{i:l-2,x:nu(i,o)})}else(r||o)&&s.push("translate("+r+t+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(r(n)+"rotate(",null,i)-2,x:nu(e,t)})):t&&n.push(r(n)+"rotate("+t+i)}(o.rotate,s.rotate,a,l),function(e,t,n,o){e!==t?o.push({i:n.push(r(n)+"skewX(",null,i)-2,x:nu(e,t)}):t&&n.push(r(n)+"skewX("+t+i)}(o.skewX,s.skewX,a,l),function(e,t,n,i,o,s){if(e!==n||t!==i){var a=o.push(r(o)+"scale(",null,",",null,")");s.push({i:a-4,x:nu(e,n)},{i:a-2,x:nu(t,i)})}else(1!==n||1!==i)&&o.push(r(o)+"scale("+n+","+i+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(e){for(var t,n=-1,i=l.length;++n<i;)a[(t=l[n]).i]=t.x(e);return a.join("")}}}var pu=fu(function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?du:hu(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),mu=fu(function(e){return null!=e&&(cu||(cu=document.createElementNS("http://www.w3.org/2000/svg","g")),cu.setAttribute("transform",e),e=cu.transform.baseVal.consolidate())?hu((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):du},", ",")",")");function gu(e){return((e=Math.exp(e))+1/e)/2}const _u=function e(t,n,i){function r(e,r){var o,s,a=e[0],l=e[1],c=e[2],u=r[0],d=r[1],h=r[2],f=u-a,p=d-l,m=f*f+p*p;if(m<1e-12)s=Math.log(h/c)/t,o=function(e){return[a+e*f,l+e*p,c*Math.exp(t*e*s)]};else{var g=Math.sqrt(m),_=(h*h-c*c+i*m)/(2*c*n*g),y=(h*h-c*c-i*m)/(2*h*n*g),v=Math.log(Math.sqrt(_*_+1)-_),b=Math.log(Math.sqrt(y*y+1)-y);s=(b-v)/t,o=function(e){var i=e*s,r=gu(v),o=c/(n*g)*(r*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*i+v)-function(e){return((e=Math.exp(e))-1/e)/2}(v));return[a+o*f,l+o*p,c*r/gu(t*i+v)]}}return o.duration=1e3*s*t/Math.SQRT2,o}return r.rho=function(t){var n=Math.max(.001,+t),i=n*n;return e(n,i,i*i)},r}(Math.SQRT2,2,4);function yu(e,t){var n,i;return function(){var r=fc(this,e),o=r.tween;if(o!==n)for(var s=0,a=(i=n=o).length;s<a;++s)if(i[s].name===t){(i=i.slice()).splice(s,1);break}r.tween=i}}function vu(e,t,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var o=fc(this,e),s=o.tween;if(s!==i){r=(i=s).slice();for(var a={name:t,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===t){r[l]=a;break}l===c&&r.push(a)}o.tween=r}}function bu(e,t,n){var i=e._id;return e.each(function(){var e=fc(this,i);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return pc(e,i).value[t]}}function xu(e,t){var n;return("number"==typeof t?nu:t instanceof Dc?Qc:(n=Dc(t))?(t=n,Qc):su)(e,t)}function wu(e){return function(){this.removeAttribute(e)}}function Su(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Eu(e,t,n){var i,r,o=n+"";return function(){var s=this.getAttribute(e);return s===o?null:s===i?r:r=t(i=s,n)}}function Cu(e,t,n){var i,r,o=n+"";return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===i?r:r=t(i=s,n)}}function Tu(e,t,n){var i,r,o;return function(){var s,a,l=n(this);return null==l?void this.removeAttribute(e):(s=this.getAttribute(e))===(a=l+"")?null:s===i&&a===r?o:(r=a,o=t(i=s,l))}}function ku(e,t,n){var i,r,o;return function(){var s,a,l=n(this);return null==l?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local))===(a=l+"")?null:s===i&&a===r?o:(r=a,o=t(i=s,l))}}function Iu(e,t){var n,i;function r(){var r=t.apply(this,arguments);return r!==i&&(n=(i=r)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,r)),n}return r._value=t,r}function Au(e,t){var n,i;function r(){var r=t.apply(this,arguments);return r!==i&&(n=(i=r)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,r)),n}return r._value=t,r}function Lu(e,t){return function(){hc(this,e).delay=+t.apply(this,arguments)}}function Ru(e,t){return t=+t,function(){hc(this,e).delay=t}}function Pu(e,t){return function(){fc(this,e).duration=+t.apply(this,arguments)}}function Mu(e,t){return t=+t,function(){fc(this,e).duration=t}}var Du=Ol.prototype.constructor;function Nu(e){return function(){this.style.removeProperty(e)}}var Fu=0;function Ou(e,t,n,i){this._groups=e,this._parents=t,this._name=n,this._id=i}function Bu(){return++Fu}var zu=Ol.prototype;function Uu(e){return e*e}function Vu(e){return e*(2-e)}function Hu(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}Ou.prototype={constructor:Ou,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Da(e));for(var i=this._groups,r=i.length,o=new Array(r),s=0;s<r;++s)for(var a,l,c=i[s],u=c.length,d=o[s]=new Array(u),h=0;h<u;++h)(a=c[h])&&(l=e.call(a,a.__data__,h,c))&&("__data__"in a&&(l.__data__=a.__data__),d[h]=l,dc(d[h],t,n,h,d,pc(a,n)));return new Ou(o,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Fa(e));for(var i=this._groups,r=i.length,o=[],s=[],a=0;a<r;++a)for(var l,c=i[a],u=c.length,d=0;d<u;++d)if(l=c[d]){for(var h,f=e.call(l,l.__data__,d,c),p=pc(l,n),m=0,g=f.length;m<g;++m)(h=f[m])&&dc(h,t,n,m,f,p);o.push(f),s.push(l)}return new Ou(o,s,t,n)},selectChild:zu.selectChild,selectChildren:zu.selectChildren,filter:function(e){"function"!=typeof e&&(e=Oa(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o,s=t[r],a=s.length,l=i[r]=[],c=0;c<a;++c)(o=s[c])&&e.call(o,o.__data__,c,s)&&l.push(o);return new Ou(i,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,i=t.length,r=n.length,o=Math.min(i,r),s=new Array(i),a=0;a<o;++a)for(var l,c=t[a],u=n[a],d=c.length,h=s[a]=new Array(d),f=0;f<d;++f)(l=c[f]||u[f])&&(h[f]=l);for(;a<i;++a)s[a]=t[a];return new Ou(s,this._parents,this._name,this._id)},selection:function(){return new Du(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=Bu(),i=this._groups,r=i.length,o=0;o<r;++o)for(var s,a=i[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=pc(s,t);dc(s,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ou(i,this._parents,e,n)},call:zu.call,nodes:zu.nodes,node:zu.node,size:zu.size,empty:zu.empty,each:zu.each,on:function(e,t){var n=this._id;return arguments.length<2?pc(this.node(),n).on.on(e):this.each(function(e,t,n){var i,r,o=function(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(t)?hc:fc;return function(){var s=o(this,e),a=s.on;a!==i&&(r=(i=a).copy()).on(t,n),s.on=r}}(n,e,t))},attr:function(e,t){var n=Aa(e),i="transform"===n?mu:xu;return this.attrTween(e,"function"==typeof t?(n.local?ku:Tu)(n,i,bu(this,"attr."+e,t)):null==t?(n.local?Su:wu)(n):(n.local?Cu:Eu)(n,i,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var i=Aa(e);return this.tween(n,(i.local?Iu:Au)(i,t))},style:function(e,t,n){var i="transform"==(e+="")?pu:xu;return null==t?this.styleTween(e,function(e,t){var n,i,r;return function(){var o=sl(this,e),s=(this.style.removeProperty(e),sl(this,e));return o===s?null:o===n&&s===i?r:r=t(n=o,i=s)}}(e,i)).on("end.style."+e,Nu(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var i,r,o;return function(){var s=sl(this,e),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(e),l=a=sl(this,e)),s===l?null:s===i&&l===r?o:(r=l,o=t(i=s,a))}}(e,i,bu(this,"style."+e,t))).each(function(e,t){var n,i,r,o,s="style."+t,a="end."+s;return function(){var l=fc(this,e),c=l.on,u=null==l.value[s]?o||(o=Nu(t)):void 0;(c!==n||r!==u)&&(i=(n=c).copy()).on(a,r=u),l.on=i}}(this._id,e)):this.styleTween(e,function(e,t,n){var i,r,o=n+"";return function(){var s=sl(this,e);return s===o?null:s===i?r:r=t(i=s,n)}}(e,i,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==t)return this.tween(i,null);if("function"!=typeof t)throw new Error;return this.tween(i,function(e,t,n){var i,r;function o(){var o=t.apply(this,arguments);return o!==r&&(i=(r=o)&&function(e,t,n){return function(i){this.style.setProperty(e,t.call(this,i),n)}}(e,o,n)),i}return o._value=t,o}(e,t,n??""))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=t??""}}(bu(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,function(e){var t,n;function i(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&function(e){return function(t){this.textContent=e.call(this,t)}}(i)),t}return i._value=e,i}(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var i,r=pc(this.node(),n).tween,o=0,s=r.length;o<s;++o)if((i=r[o]).name===e)return i.value;return null}return this.each((null==t?yu:vu)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Lu:Ru)(t,e)):pc(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Pu:Mu)(t,e)):pc(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!=typeof t)throw new Error;return function(){fc(this,e).ease=t}}(t,e)):pc(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;fc(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,i=n._id,r=n.size();return new Promise(function(o,s){var a={value:s},l={value:function(){0===--r&&o()}};n.each(function(){var n=fc(this,i),r=n.on;r!==e&&((t=(e=r).copy())._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),n.on=t}),0===r&&o()})},[Symbol.iterator]:zu[Symbol.iterator]};var Wu={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function $u(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Gu(){let e;if(typeof window<"u"&&window.performance)e=window.performance.now();else if(typeof process<"u"&&process.hrtime){const t=process.hrtime();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}Ol.prototype.interrupt=function(e){return this.each(function(){mc(this,e)})},Ol.prototype.transition=function(e){var t,n;e instanceof Ou?(t=e._id,e=e._name):(t=Bu(),(n=Wu).time=tc(),e=null==e?null:e+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var s,a=i[o],l=a.length,c=0;c<l;++c)(s=a[c])&&dc(s,e,t,c,a,n||$u(s,t));return new Ou(i,this._parents,e,t)};class ju{constructor(e,t){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Gu(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Gu()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Yu{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(e=>this._getOrCreate(e))}_getOrCreate(e){const{name:t,type:n}=e;let i=this.stats[t];return i||(i=e instanceof ju?e:new ju(t,n),this.stats[t]=i),i}}const qu=new class{constructor(){Ta(this,"stats",new Map)}getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new Yu({id:e})),this.stats.get(e)}},Xu=globalThis,Ku=globalThis.process||{},Zu=globalThis.navigator||{};function Qu(e){var t,n;if(typeof window<"u"&&"renderer"===(null==(t=window.process)?void 0:t.type)||typeof process<"u"&&null!=(n=process.versions)&&n.electron)return!0;const i=typeof navigator<"u"&&navigator.userAgent;return!!(i&&i.indexOf("Electron")>=0)}function Ju(){return!("object"==typeof process&&"[object process]"===String(process)&&(null==process||!process.browser))||Qu()}const ed="4.1.0";class td{constructor(e,t,n="sessionStorage"){this.storage=function(e){try{const t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),t}catch{return null}}(n),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}var nd;function id(e){return"string"!=typeof e?e:(e=e.toUpperCase(),nd[e]||nd.WHITE)}function rd(e,t){if(!e)throw new Error("Assertion failed")}function od(){var e,t,n;let i;if(Ju()&&Xu.performance)i=null==(t=null==(e=null==Xu?void 0:Xu.performance)?void 0:e.now)?void 0:t.call(e);else if("hrtime"in Ku){const e=null==(n=null==Ku?void 0:Ku.hrtime)?void 0:n.call(Ku);i=1e3*e[0]+e[1]/1e6}else i=Date.now();return i}!function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(nd||(nd={}));const sd={debug:Ju()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},ad={enabled:!0,level:0};function ld(){}const cd={},ud={once:!0};class dd{constructor({id:e}={id:""}){this.VERSION=ed,this._startTs=od(),this._deltaTs=od(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new td(`__probe-${this.id}__`,ad),this.timeStamp(`${this.id} started`),function(e,t=["constructor"]){const n=Object.getPrototypeOf(e),i=Object.getOwnPropertyNames(n),r=e;for(const o of i){const n=r[o];"function"==typeof n&&(t.find(e=>o===e)||(r[o]=n.bind(e)))}}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((od()-this._startTs).toPrecision(10))}getDelta(){return Number((od()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,sd.warn,arguments,ud)}error(e){return this._getLogFunction(0,e,sd.error,arguments)}deprecated(e,t){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${t}\` instead`)}removed(e,t){return this.error(`\`${e}\` has been removed. Use \`${t}\` instead`)}probe(e,t){return this._getLogFunction(e,t,sd.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,sd.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,sd.debug||sd.info,arguments,ud)}table(e,t,n){return t?this._getLogFunction(e,t,console.table||ld,n&&[n],{tag:pd(t)}):ld}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||ld)}group(e,t,n={collapsed:!1}){const i=fd({logLevel:e,message:t,opts:n}),{collapsed:r}=n;return i.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,t,n={}){return this.group(e,t,Object.assign({},n,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||ld)}withGroup(e,t,n){this.group(e,t)();try{n()}finally{this.groupEnd(e)()}}trace(){console.trace}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=hd(e)}_getLogFunction(e,t,n,i,r){if(this._shouldLog(e)){r=fd({logLevel:e,message:t,args:i,opts:r}),rd(n=n||r.method),r.total=this.getTotal(),r.delta=this.getDelta(),this._deltaTs=od();const o=r.tag||r.message;if(r.once&&o){if(cd[o])return ld;cd[o]=od()}return t=function(e,t,n){if("string"==typeof t){const i=n.time?function(e,t=8){const n=Math.max(t-e.length,0);return`${" ".repeat(n)}${e}`}(function(e){let t;return t=e<10?`${e.toFixed(2)}ms`:e<100?`${e.toFixed(1)}ms`:e<1e3?`${e.toFixed(0)}ms`:`${(e/1e3).toFixed(2)}s`,t}(n.total)):"";t=function(e,t,n){return!Ju&&"string"==typeof e&&(t&&(e=`[${id(t)}m${e}[39m`),n&&(e=`[${id(n)+10}m${e}[49m`)),e}(t=n.time?`${e}: ${i}  ${t}`:`${e}: ${t}`,n.color,n.background)}return t}(this.id,r.message,r),n.bind(console,t,...r.args)}return ld}}function hd(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return rd(Number.isFinite(t)&&t>=0),t}function fd(e){const{logLevel:t,message:n}=e;e.logLevel=hd(t);const i=e.args?Array.from(e.args):[];for(;i.length&&i.shift()!==n;);switch(typeof t){case"string":case"function":void 0!==n&&i.unshift(n),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());const r=typeof e.message;return rd("string"===r||"object"===r),Object.assign(e,{args:i},e.opts)}function pd(e){for(const t in e)for(const n in e[t])return n||"untitled";return"empty"}dd.VERSION=ed;const md=new dd({id:"luma.gl"}),gd={};function _d(e="id"){return gd[e]=gd[e]||1,`${e}-${gd[e]++}`}class yd{constructor(e,t,n){if(Ta(this,"id"),Ta(this,"props"),Ta(this,"userData",{}),Ta(this,"_device"),Ta(this,"destroyed",!1),Ta(this,"allocatedBytes",0),Ta(this,"_attachedResources",new Set),!e)throw new Error("no device");this._device=e,this.props=function(e,t){const n={...t};for(const i in e)void 0!==e[i]&&(n[i]=e[i]);return n}(t,n);const i="undefined"!==this.props.id?this.props.id:_d(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get(`${t}s Active`).decrementCount()}trackAllocatedMemory(e,t=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").addCount(e),n.get(`${t} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const t=this._device.statsManager.getStats("Resource Counts");t.get("GPU Memory").subtractCount(this.allocatedBytes),t.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}}Ta(yd,"defaultProps",{id:"undefined",handle:void 0,userData:void 0});const vd=class e extends yd{constructor(t,n){const i={...n};(n.usage||0)&e.INDEX&&!n.indexType&&(n.data instanceof Uint32Array?i.indexType="uint32":n.data instanceof Uint16Array&&(i.indexType="uint16")),delete i.data,super(t,i,e.defaultProps),Ta(this,"usage"),Ta(this,"indexType"),Ta(this,"updateTimestamp"),Ta(this,"debugData",new ArrayBuffer(0)),this.usage=i.usage||0,this.indexType=i.indexType,this.updateTimestamp=t.incrementTimestamp()}get[Symbol.toStringTag](){return"Buffer"}clone(e){return this.device.createBuffer({...this.props,...e})}_setDebugData(t,n,i){const r=ArrayBuffer.isView(t)?t.buffer:t,o=Math.min(t?t.byteLength:i,e.DEBUG_DATA_MAX_LENGTH);null===r?this.debugData=new ArrayBuffer(o):0===n&&i===r.byteLength?this.debugData=r.slice(0,o):this.debugData=r.slice(n,n+o)}};Ta(vd,"INDEX",16),Ta(vd,"VERTEX",32),Ta(vd,"UNIFORM",64),Ta(vd,"STORAGE",128),Ta(vd,"INDIRECT",256),Ta(vd,"QUERY_RESOLVE",512),Ta(vd,"MAP_READ",1),Ta(vd,"MAP_WRITE",2),Ta(vd,"COPY_SRC",4),Ta(vd,"COPY_DST",8),Ta(vd,"DEBUG_DATA_MAX_LENGTH",32),Ta(vd,"defaultProps",{...yd.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",onMapped:void 0});let bd=vd;function xd(e){const[t,n,i]=Cd[e],r=e.includes("norm");return{signedType:t,primitiveType:n,byteLength:i,normalized:r,integer:!r&&!e.startsWith("float"),signed:e.startsWith("s")}}function wd(e,t){switch(t){case 1:return e;case 2:return e+e%2;default:return e+(4-e%4)%4}}function Sd(e){const t=ArrayBuffer.isView(e)?e.constructor:e;if(t===Uint8ClampedArray)return"uint8";const n=Object.values(Cd).find(e=>t===e[4]);if(!n)throw new Error(t.name);return n[0]}function Ed(e){const[,,,,t]=Cd[e];return t}const Cd={uint8:["uint8","u32",1,!1,Uint8Array],sint8:["sint8","i32",1,!1,Int8Array],unorm8:["uint8","f32",1,!0,Uint8Array],snorm8:["sint8","f32",1,!0,Int8Array],uint16:["uint16","u32",2,!1,Uint16Array],sint16:["sint16","i32",2,!1,Int16Array],unorm16:["uint16","u32",2,!0,Uint16Array],snorm16:["sint16","i32",2,!0,Int16Array],float16:["float16","f16",2,!1,Uint16Array],float32:["float32","f32",4,!1,Float32Array],uint32:["uint32","u32",4,!1,Uint32Array],sint32:["sint32","i32",4,!1,Int32Array]};function Td(e){let t;e.endsWith("-webgl")&&(e.replace("-webgl",""),t=!0);const[n,i]=e.split("x"),r=n,o=i?parseInt(i):1,s=xd(r),a={type:r,components:o,byteLength:s.byteLength*o,integer:s.integer,signed:s.signed,normalized:s.normalized};return t&&(a.webglOnly=!0),a}function kd(e,t,n){if(!t||t>4)throw new Error(`size ${t}`);const i=t;return function(e,t,n){const i=n?function(e){const t=e;switch(t){case"uint8":return"unorm8";case"sint8":return"snorm8";case"uint16":return"unorm16";case"sint16":return"snorm16";default:return t}}(e):e;switch(i){case"unorm8":return 1===t?"unorm8":3===t?"unorm8x3-webgl":`${i}x${t}`;case"snorm8":case"uint8":case"sint8":case"uint16":case"sint16":case"unorm16":case"snorm16":case"float16":if(1===t||3===t)throw new Error(`size: ${t}`);return`${i}x${t}`;default:return 1===t?i:`${i}x${t}`}}(Sd(e),i,n)}const Id="texture-compression-bc",Ad="texture-compression-astc",Ld="texture-compression-etc2",Rd="texture-compression-pvrtc-webgl",Pd="texture-compression-atc-webgl",Md="float32-renderable-webgl",Dd="float16-renderable-webgl",Nd="snorm8-renderable-webgl",Fd="norm16-renderable-webgl",Od="snorm16-renderable-webgl",Bd="float32-filterable",zd="float16-filterable-webgl";function Ud(e){const t=Vd[e];if(!t)throw new Error(`Unsupported texture format ${e}`);return t}const Vd={r8unorm:{},rg8unorm:{},"rgb8unorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},r8snorm:{render:Nd},rg8snorm:{render:Nd},"rgb8snorm-webgl":{},rgba8snorm:{render:Nd},r8uint:{},rg8uint:{},rgba8uint:{},r8sint:{},rg8sint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},r16unorm:{f:Fd},rg16unorm:{render:Fd},"rgb16unorm-webgl":{f:Fd},rgba16unorm:{render:Fd},r16snorm:{f:Od},rg16snorm:{render:Od},"rgb16snorm-webgl":{f:Fd},rgba16snorm:{render:Od},r16uint:{},rg16uint:{},rgba16uint:{},r16sint:{},rg16sint:{},rgba16sint:{},r16float:{render:Dd,filter:"float16-filterable-webgl"},rg16float:{render:Dd,filter:zd},rgba16float:{render:Dd,filter:zd},r32uint:{},rg32uint:{},rgba32uint:{},r32sint:{},rg32sint:{},rgba32sint:{},r32float:{render:Md,filter:Bd},rg32float:{render:!1,filter:Bd},"rgb32float-webgl":{render:Md,filter:Bd},rgba32float:{render:Md,filter:Bd},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},rgb9e5ufloat:{channels:"rgb",packed:!0,render:"rgb9e5ufloat-renderable-webgl"},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:Md},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},rgb10a2uint:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0},"bc1-rgb-unorm-webgl":{f:Id},"bc1-rgb-unorm-srgb-webgl":{f:Id},"bc1-rgba-unorm":{f:Id},"bc1-rgba-unorm-srgb":{f:Id},"bc2-rgba-unorm":{f:Id},"bc2-rgba-unorm-srgb":{f:Id},"bc3-rgba-unorm":{f:Id},"bc3-rgba-unorm-srgb":{f:Id},"bc4-r-unorm":{f:Id},"bc4-r-snorm":{f:Id},"bc5-rg-unorm":{f:Id},"bc5-rg-snorm":{f:Id},"bc6h-rgb-ufloat":{f:Id},"bc6h-rgb-float":{f:Id},"bc7-rgba-unorm":{f:Id},"bc7-rgba-unorm-srgb":{f:Id},"etc2-rgb8unorm":{f:Ld},"etc2-rgb8unorm-srgb":{f:Ld},"etc2-rgb8a1unorm":{f:Ld},"etc2-rgb8a1unorm-srgb":{f:Ld},"etc2-rgba8unorm":{f:Ld},"etc2-rgba8unorm-srgb":{f:Ld},"eac-r11unorm":{f:Ld},"eac-r11snorm":{f:Ld},"eac-rg11unorm":{f:Ld},"eac-rg11snorm":{f:Ld},"astc-4x4-unorm":{f:Ad},"astc-4x4-unorm-srgb":{f:Ad},"astc-5x4-unorm":{f:Ad},"astc-5x4-unorm-srgb":{f:Ad},"astc-5x5-unorm":{f:Ad},"astc-5x5-unorm-srgb":{f:Ad},"astc-6x5-unorm":{f:Ad},"astc-6x5-unorm-srgb":{f:Ad},"astc-6x6-unorm":{f:Ad},"astc-6x6-unorm-srgb":{f:Ad},"astc-8x5-unorm":{f:Ad},"astc-8x5-unorm-srgb":{f:Ad},"astc-8x6-unorm":{f:Ad},"astc-8x6-unorm-srgb":{f:Ad},"astc-8x8-unorm":{f:Ad},"astc-8x8-unorm-srgb":{f:Ad},"astc-10x5-unorm":{f:Ad},"astc-10x5-unorm-srgb":{f:Ad},"astc-10x6-unorm":{f:Ad},"astc-10x6-unorm-srgb":{f:Ad},"astc-10x8-unorm":{f:Ad},"astc-10x8-unorm-srgb":{f:Ad},"astc-10x10-unorm":{f:Ad},"astc-10x10-unorm-srgb":{f:Ad},"astc-12x10-unorm":{f:Ad},"astc-12x10-unorm-srgb":{f:Ad},"astc-12x12-unorm":{f:Ad},"astc-12x12-unorm-srgb":{f:Ad},"pvrtc-rgb4unorm-webgl":{f:Rd},"pvrtc-rgba4unorm-webgl":{f:Rd},"pvrtc-rbg2unorm-webgl":{f:Rd},"pvrtc-rgba2unorm-webgl":{f:Rd},"etc1-rbg-unorm-webgl":{f:"texture-compression-etc1-webgl"},"atc-rgb-unorm-webgl":{f:Pd},"atc-rgba-unorm-webgl":{f:Pd},"atc-rgbai-unorm-webgl":{f:Pd}},Hd=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],Wd=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/,$d=new class{getInfo(e){return Gd(e)}isColor(e){return e.startsWith("rgba")||e.startsWith("bgra")||e.startsWith("rgb")}isDepthStencil(e){return e.startsWith("depth")||e.startsWith("stencil")}isCompressed(e){return Hd.some(t=>e.startsWith(t))}getCapabilities(e){const t=Ud(e),n={format:e,create:t.f??!0,render:t.render??!0,filter:t.filter??!0,blend:t.blend??!0,store:t.store??!0},i=Gd(e),r=e.startsWith("depth")||e.startsWith("stencil"),o=null==i?void 0:i.signed,s=null==i?void 0:i.integer,a=null==i?void 0:i.webgl;return n.render&&(n.render=!o),n.filter&&(n.filter=!(r||o||s||a)),n}};function Gd(e){let t=function(e){var t;const n=Ud(e),i=n.bytesPerPixel||1,r=n.bitsPerChannel||[8,8,8,8];return delete n.bitsPerChannel,delete n.bytesPerPixel,delete n.f,delete n.render,delete n.filter,delete n.blend,delete n.store,{...n,format:e,attachment:n.attachment||"color",channels:n.channels||"r",components:n.components||(null==(t=n.channels)?void 0:t.length)||1,bytesPerPixel:i,bitsPerChannel:r,dataType:n.dataType||"uint8",srgb:n.srgb??!1,packed:n.packed??!1,webgl:n.webgl??!1,integer:n.integer??!1,signed:n.signed??!1,normalized:n.normalized??!1,compressed:n.compressed??!1}}(e);if($d.isCompressed(e)){t.channels="rgb",t.components=3,t.bytesPerPixel=1,t.srgb=!1,t.compressed=!0;const n=function(e){const t=/.*-(\d+)x(\d+)-.*/.exec(e);if(t){const[,e,n]=t;return{blockWidth:Number(e),blockHeight:Number(n)}}return null}(e);n&&(t.blockWidth=n.blockWidth,t.blockHeight=n.blockHeight)}const n=Wd.exec(e);if(n){const[,i,r,o,s,a]=n,l=xd(`${o}${r}`),c=8*l.byteLength,u=i.length,d=[c,u>=2?c:0,u>=3?c:0,u>=4?c:0];t={format:e,attachment:t.attachment,dataType:l.signedType,components:u,channels:i,integer:l.integer,signed:l.signed,normalized:l.normalized,bitsPerChannel:d,bytesPerPixel:l.byteLength*i.length,packed:t.packed,srgb:t.srgb},"-webgl"===a&&(t.webgl=!0),"-srgb"===s&&(t.srgb=!0)}return e.endsWith("-webgl")&&(t.webgl=!0),e.endsWith("-srgb")&&(t.srgb=!0),t}class jd{}class Yd{constructor(e=[],t){Ta(this,"features"),Ta(this,"disabledFeatures"),this.features=new Set(e),this.disabledFeatures=t||{}}*[Symbol.iterator](){yield*this.features}has(e){var t;return!(null!=(t=this.disabledFeatures)&&t[e])&&this.features.has(e)}}const qd=class e{constructor(t){Ta(this,"id"),Ta(this,"props"),Ta(this,"userData",{}),Ta(this,"statsManager",qu),Ta(this,"timestamp",0),Ta(this,"_reused",!1),Ta(this,"_lumaData",{}),Ta(this,"_textureCaps",{}),this.props={...e.defaultProps,...t},this.id=this.props.id||_d(this[Symbol.toStringTag].toLowerCase())}get[Symbol.toStringTag](){return"Device"}toString(){return`Device(${this.id})`}getVertexFormatInfo(e){return Td(e)}isVertexFormatSupported(e){return!0}getTextureFormatInfo(e){return $d.getInfo(e)}getTextureFormatCapabilities(e){let t=this._textureCaps[e];if(!t){const n=this._getDeviceTextureFormatCapabilities(e);t=this._getDeviceSpecificTextureFormatCapabilities(n),this._textureCaps[e]=t}return t}getMipLevelCount(e,t,n=1){const i=Math.max(e,t,n);return 1+Math.floor(Math.log2(i))}isExternalImage(e){return function(e){return typeof ImageData<"u"&&e instanceof ImageData||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement||typeof VideoFrame<"u"&&e instanceof VideoFrame||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas}(e)}getExternalImageSize(e){return function(e){if(typeof ImageData<"u"&&e instanceof ImageData||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height};if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)return{width:e.naturalWidth,height:e.naturalHeight};if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)return{width:e.videoWidth,height:e.videoHeight};if(typeof VideoFrame<"u"&&e instanceof VideoFrame)return{width:e.displayWidth,height:e.displayHeight};throw new Error("Unknown image type")}(e)}isTextureFormatSupported(e){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return $d.isCompressed(e)}pushDebugGroup(e){this.commandEncoder.pushDebugGroup(e)}popDebugGroup(){var e;null==(e=this.commandEncoder)||e.popDebugGroup()}insertDebugMarker(e){var t;null==(t=this.commandEncoder)||t.insertDebugMarker(e)}loseDevice(){return!1}incrementTimestamp(){return this.timestamp++}reportError(e,t,...n){return this.props.onError(e,t)?()=>{}:md.error(e.message,t,...n)}debug(){this.props.debug||md.once(0,"'Type luma.log.set({debug: true}) in console to enable debug breakpoints',\nor create a device with the 'debug: true' prop.")()}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}beginRenderPass(e){return this.commandEncoder.beginRenderPass(e)}beginComputePass(e){return this.commandEncoder.beginComputePass(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,t){throw new Error("not implemented")}readPixelsToBufferWebGL(e,t){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,t){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return!0===e.createCanvasContext?{}:e.createCanvasContext}_getDeviceTextureFormatCapabilities(e){const t=$d.getCapabilities(e),n=e=>("string"==typeof e?this.features.has(e):e)??!0,i=n(t.create);return{format:e,create:i,render:i&&n(t.render),filter:i&&n(t.filter),blend:i&&n(t.blend),store:i&&n(t.store)}}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t={...e};if((e.usage||0)&bd.INDEX&&(e.indexType||(e.data instanceof Uint32Array?t.indexType="uint32":e.data instanceof Uint16Array&&(t.indexType="uint16")),!t.indexType))throw new Error("indices buffer content must be of type uint16 or uint32");return t}};Ta(qd,"defaultProps",{id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,webgl:{},onError:(e,t)=>{},onResize:(e,t)=>{const[n,i]=e.getDevicePixelSize();md.log(1,`${e} resized => ${n}x${i}px`)()},onPositionChange:(e,t)=>{const[n,i]=e.getPosition();md.log(1,`${e} repositioned => ${n},${i}`)()},onVisibilityChange:e=>md.log(1,`${e} Visibility changed ${e.isVisible}`)(),onDevicePixelRatioChange:(e,t)=>md.log(1,`${e} DPR changed ${t.oldRatio} => ${e.devicePixelRatio}`)(),debug:md.get("debug")||void 0,debugShaders:md.get("debug-shaders")||void 0,debugFramebuffers:!!md.get("debug-framebuffers"),debugFactories:!!md.get("debug-factories"),debugWebGL:!!md.get("debug-webgl"),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_reuseDevices:!1,_requestMaxLimits:!0,_cacheShaders:!1,_cachePipelines:!1,_cacheDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_handle:void 0});let Xd=qd;const Kd="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.",Zd=class e{constructor(){if(Ta(this,"stats",qu),Ta(this,"log",md),Ta(this,"VERSION","9.2.5"),Ta(this,"spector"),Ta(this,"preregisteredAdapters",new Map),globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw md.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),md.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");md.error("This version of luma.gl has already been initialized")()}md.log(1,`${this.VERSION} - set luma.log.level=1 (or higher) to trace rendering`)(),globalThis.luma=this}async createDevice(t={}){const n={...e.defaultProps,...t},i=this.selectAdapter(n.type,n.adapters);if(!i)throw new Error(Kd);return n.waitForPageLoad&&await i.pageLoaded,await i.create(n)}async attachDevice(e,t){var n;const i=this._getTypeFromHandle(e,t.adapters),r=i&&this.selectAdapter(i,t.adapters);if(!r)throw new Error(Kd);return await(null==(n=null==r?void 0:r.attach)?void 0:n.call(r,e,t))}registerAdapters(e){for(const t of e)this.preregisteredAdapters.set(t.type,t)}getSupportedAdapters(e=[]){const t=this._getAdapterMap(e);return Array.from(t).map(([,e])=>e).filter(e=>{var t;return null==(t=e.isSupported)?void 0:t.call(e)}).map(e=>e.type)}getBestAvailableAdapterType(e=[]){var t,n;const i=["webgpu","webgl","null"],r=this._getAdapterMap(e);for(const o of i)if(null!=(n=null==(t=r.get(o))?void 0:t.isSupported)&&n.call(t))return o;return null}selectAdapter(e,t=[]){let n=e;"best-available"===e&&(n=this.getBestAvailableAdapterType(t));const i=this._getAdapterMap(t);return n&&i.get(n)||null}enforceWebGL2(e=!0,t=[]){var n;const i=this._getAdapterMap(t).get("webgl");i||md.warn("enforceWebGL2: webgl adapter not found")(),null==(n=null==i?void 0:i.enforceWebGL2)||n.call(i,e)}setDefaultDeviceProps(t){Object.assign(e.defaultProps,t)}_getAdapterMap(e=[]){const t=new Map(this.preregisteredAdapters);for(const n of e)t.set(n.type,n);return t}_getTypeFromHandle(e,t=[]){return e instanceof WebGL2RenderingContext?"webgl":typeof GPUDevice<"u"&&e instanceof GPUDevice||null!=e&&e.queue?"webgpu":null===e?"null":(e instanceof WebGLRenderingContext?md.warn("WebGL1 is not supported",e)():md.warn("Unknown handle type",e)(),null)}};Ta(Zd,"defaultProps",{...Xd.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0});const Qd=new Zd;class Jd{get pageLoaded(){return nh||(nh=th()||typeof window>"u"?Promise.resolve():new Promise(e=>window.addEventListener("load",()=>e()))),nh}}const eh=Ju()&&typeof document<"u",th=()=>eh&&"complete"===document.readyState;let nh=null;const ih=class e extends yd{get[Symbol.toStringTag](){return"Sampler"}constructor(t,n){super(t,n=e.normalizeProps(t,n),e.defaultProps)}static normalizeProps(e,t){return t}};Ta(ih,"defaultProps",{...yd.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1});let rh=ih;const oh={"1d":"1d","2d":"2d","2d-array":"2d",cube:"2d","cube-array":"2d","3d":"3d"},sh=class e extends yd{constructor(t,n){if(super(t,n=e.normalizeProps(t,n),e.defaultProps),Ta(this,"dimension"),Ta(this,"baseDimension"),Ta(this,"format"),Ta(this,"width"),Ta(this,"height"),Ta(this,"depth"),Ta(this,"mipLevels"),Ta(this,"updateTimestamp"),this.dimension=this.props.dimension,this.baseDimension=oh[this.dimension],this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.mipLevels=this.props.mipLevels,void 0===this.props.width||void 0===this.props.height)if(t.isExternalImage(n.data)){const e=t.getExternalImageSize(n.data);this.width=(null==e?void 0:e.width)||1,this.height=(null==e?void 0:e.height)||1}else this.width=1,this.height=1,(void 0===this.props.width||void 0===this.props.height)&&md.warn(`${this} created with undefined width or height. This is deprecated. Use AsyncTexture instead.`)();this.updateTimestamp=t.incrementTimestamp()}get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}setSampler(e){this.sampler=e instanceof rh?e:this.device.createSampler(e)}clone(e){return this.device.createTexture({...this.props,...e})}static normalizeProps(e,t){const n={...t},{width:i,height:r}=n;return"number"==typeof i&&(n.width=Math.max(1,Math.ceil(i))),"number"==typeof r&&(n.height=Math.max(1,Math.ceil(r))),n}_initializeData(e){this.device.isExternalImage(e)?this.copyExternalImage({image:e,width:this.width,height:this.height,depth:this.depth,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}):e&&this.copyImageData({data:e,mipLevel:0,x:0,y:0,z:0,aspect:"all"})}_normalizeCopyImageDataOptions(t){const{width:n,height:i,depth:r}=this,o={...e.defaultCopyDataOptions,width:n,height:i,depth:r,...t},s=this.device.getTextureFormatInfo(this.format);if(!t.bytesPerRow&&!s.bytesPerPixel)throw new Error(`bytesPerRow must be provided for texture format ${this.format}`);return o.bytesPerRow=t.bytesPerRow||n*(s.bytesPerPixel||4),o.rowsPerImage=t.rowsPerImage||i,o}_normalizeCopyExternalImageOptions(t){const n=this.device.getExternalImageSize(t.image),i={...e.defaultCopyExternalImageOptions,...n,...t};return i.width=Math.min(i.width,this.width-i.x),i.height=Math.min(i.height,this.height-i.y),i}};Ta(sh,"SAMPLE",4),Ta(sh,"STORAGE",8),Ta(sh,"RENDER",16),Ta(sh,"COPY_SRC",1),Ta(sh,"COPY_DST",2),Ta(sh,"TEXTURE",4),Ta(sh,"RENDER_ATTACHMENT",16),Ta(sh,"defaultProps",{...yd.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",usage:sh.TEXTURE|sh.RENDER_ATTACHMENT|sh.COPY_DST,width:void 0,height:void 0,depth:1,mipLevels:1,samples:void 0,sampler:{},view:void 0}),Ta(sh,"defaultCopyDataOptions",{data:void 0,byteOffset:0,bytesPerRow:void 0,rowsPerImage:void 0,mipLevel:0,x:0,y:0,z:0,aspect:"all"}),Ta(sh,"defaultCopyExternalImageOptions",{image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1});let ah=sh;const lh=class e extends yd{get[Symbol.toStringTag](){return"TextureView"}constructor(t,n){super(t,n,e.defaultProps)}};Ta(lh,"defaultProps",{...yd.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0});let ch=lh;function uh(e,t,n,i){if(null!=i&&i.inlineSource){const i=function(e,t){let n="";for(let i=t-2;i<=t;i++){const r=e[i-1];void 0!==r&&(n+=dh(r,t,undefined))}return n}(t,n);return`\n${i}${e.linePos>0?`${" ".repeat(e.linePos+5)}^^^\n`:""}${e.type.toUpperCase()}: ${e.message}\n\n`}const r="error"===e.type?"red":"#8B4000";return null!=i&&i.html?`<div class='luma-compiler-log-error' style="color:${r};"><b> ${e.type.toUpperCase()}: ${e.message}</b></div>`:`${e.type.toUpperCase()}: ${e.message}`}function dh(e,t,n){const i=null!=n&&n.html?function(e){return e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}(e):e;return`${function(e){let t="";for(let n=e.length;n<4;++n)t+=" ";return t+e}(String(t))}: ${i}${null!=n&&n.html?"<br/>":"\n"}`}const hh=class e extends yd{constructor(t,n){super(t,{id:ph(n={...n,debugShaders:n.debugShaders||t.props.debugShaders||"errors"}),...n},e.defaultProps),Ta(this,"stage"),Ta(this,"source"),Ta(this,"compilationStatus","pending"),this.stage=this.props.stage,this.source=this.props.source}get[Symbol.toStringTag](){return"Shader"}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if("success"===this.compilationStatus)return}const t=await this.getCompilationInfo();"warnings"===e&&0===(null==t?void 0:t.length)||this._displayShaderLog(t,this.id)}_displayShaderLog(e,t){var n;if(typeof document>"u"||null==document||!document.createElement)return;const i=t,r=`${this.stage} shader "${i}"`;let o=function(e,t,n){let i="";const r=t.split(/\r?\n/),o=e.slice().sort((e,t)=>e.lineNum-t.lineNum);switch((null==n?void 0:n.showSourceCode)||"no"){case"all":let t=0;for(let e=1;e<=r.length;e++)for(i+=dh(r[e-1],e,n);o.length>t&&o[t].lineNum===e;){const e=o[t++];i+=uh(e,r,e.lineNum,{...n,inlineSource:!1})}for(;o.length>t;)i+=uh(o[t++],[],0,{...n,inlineSource:!1});return i;case"issues":case"no":for(const o of e)i+=uh(o,r,o.lineNum,{inlineSource:"no"!==(null==n?void 0:n.showSourceCode)});return i}}(e,this.source,{showSourceCode:"all",html:!0});const s=this.getTranslatedSource();s&&(o+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${s}</pre></code>`);const a=document.createElement("Button");a.innerHTML=`\n<h1>Compilation error in ${r}</h1><br /><br />\n<code style="user-select:text;"><pre>\n${o}\n</pre></code>`,a.style.top="10px",a.style.left="10px",a.style.position="absolute",a.style.zIndex="9999",a.style.width="100%",a.style.textAlign="left",document.body.appendChild(a),null==(n=document.getElementsByClassName("luma-compiler-log-error")[0])||n.scrollIntoView(),a.onclick=()=>{const e=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(e)}}};Ta(hh,"defaultProps",{...yd.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0});let fh=hh;function ph(e){return function(e,t="unnamed"){const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(e);return n?n[1]:t}(e.source)||e.id||_d(`unnamed ${e.stage}-shader`)}const mh=class e extends yd{constructor(t,n){super(t,n,e.defaultProps),Ta(this,"shaderLayout"),Ta(this,"bufferLayout"),Ta(this,"linkStatus","pending"),Ta(this,"hash",""),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}get[Symbol.toStringTag](){return"RenderPipeline"}};Ta(mh,"defaultProps",{...yd.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",colorAttachmentFormats:void 0,depthStencilAttachmentFormat:void 0,parameters:{},bindings:{},uniforms:{}});let gh=mh;const _h=class e extends yd{constructor(t,n){super(t,n,e.defaultProps),Ta(this,"hash",""),Ta(this,"shaderLayout"),this.shaderLayout=n.shaderLayout}get[Symbol.toStringTag](){return"ComputePipeline"}};Ta(_h,"defaultProps",{...yd.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0});let yh=_h;function vh(e){return wh[e]}const bh={f32:4,f16:2,i32:4,u32:4},xh={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},wh={f32:{type:"f32",components:1},f16:{type:"f16",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<f16>":{type:"f16",components:2},"vec3<f16>":{type:"f16",components:3},"vec4<f16>":{type:"f16",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16},"mat2x2<f16>":{type:"f16",components:4},"mat2x3<f16>":{type:"f16",components:6},"mat2x4<f16>":{type:"f16",components:8},"mat3x2<f16>":{type:"f16",components:6},"mat3x3<f16>":{type:"f16",components:9},"mat3x4<f16>":{type:"f16",components:12},"mat4x2<f16>":{type:"f16",components:8},"mat4x3<f16>":{type:"f16",components:12},"mat4x4<f16>":{type:"f16",components:16},"mat2x2<i32>":{type:"i32",components:4},"mat2x3<i32>":{type:"i32",components:6},"mat2x4<i32>":{type:"i32",components:8},"mat3x2<i32>":{type:"i32",components:6},"mat3x3<i32>":{type:"i32",components:9},"mat3x4<i32>":{type:"i32",components:12},"mat4x2<i32>":{type:"i32",components:8},"mat4x3<i32>":{type:"i32",components:12},"mat4x4<i32>":{type:"i32",components:16},"mat2x2<u32>":{type:"u32",components:4},"mat2x3<u32>":{type:"u32",components:6},"mat2x4<u32>":{type:"u32",components:8},"mat3x2<u32>":{type:"u32",components:6},"mat3x3<u32>":{type:"u32",components:9},"mat3x4<u32>":{type:"u32",components:12},"mat4x2<u32>":{type:"u32",components:8},"mat4x3<u32>":{type:"u32",components:12},"mat4x4<u32>":{type:"u32",components:16}};function Sh(e,t){const n={};for(const i of e.attributes){const r=Ch(e,t,i.name);r&&(n[i.name]=r)}return n}function Eh(e,t,n=16){const i=Sh(e,t),r=new Array(n).fill(null);for(const o of Object.values(i))r[o.location]=o;return r}function Ch(e,t,n){const i=function(e,t){const n=e.attributes.find(e=>e.name===t);return n||md.warn(`shader layout attribute "${t}" not present in shader`),n||null}(e,n),r=function(e,t){!function(e){for(const t of e)(t.attributes&&t.format||!t.attributes&&!t.format)&&md.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}(e);let n=function(e,t){for(const n of e)if(n.format&&n.name===t)return{attributeName:n.name,bufferName:t,stepMode:n.stepMode,vertexFormat:n.format,byteOffset:0,byteStride:n.byteStride||0};return null}(e,t);return n||(n=function(e,t){var n;for(const i of e){let e=i.byteStride;if("number"!=typeof i.byteStride)for(const t of i.attributes||[])e+=Td(t.format).byteLength;const r=null==(n=i.attributes)?void 0:n.find(e=>e.attribute===t);if(r)return{attributeName:r.attribute,bufferName:i.name,stepMode:i.stepMode,vertexFormat:r.format,byteOffset:r.byteOffset,byteStride:e}}return null}(e,t),n)?n:(md.warn(`layout for attribute "${t}" not present in buffer layout`),null)}(t,n);if(!i)return null;const o=function(e){const[t,n]=xh[e];return{primitiveType:t,components:n,byteLength:bh[t]*n,integer:"i32"===t||"u32"===t,signed:"u32"!==t}}(i.type),s=function(e){let t;switch(e.primitiveType){case"f32":t="float32";break;case"i32":t="sint32";break;case"u32":t="uint32";break;case"f16":return e.components<=2?"float16x2":"float16x4"}return 1===e.components?t:`${t}x${e.components}`}(o),a=(null==r?void 0:r.vertexFormat)||s,l=Td(a);return{attributeName:(null==r?void 0:r.attributeName)||i.name,bufferName:(null==r?void 0:r.bufferName)||i.name,location:i.location,shaderType:i.type,primitiveType:o.primitiveType,shaderComponents:o.components,vertexFormat:a,bufferDataType:l.type,bufferComponents:l.components,normalized:l.normalized,integer:o.integer,stepMode:(null==r?void 0:r.stepMode)||i.stepMode||"vertex",byteOffset:(null==r?void 0:r.byteOffset)||0,byteStride:(null==r?void 0:r.byteStride)||0}}let Th;function kh(e){return(!Th||Th.byteLength<e)&&(Th=new ArrayBuffer(e)),Th}function Ih(e,t){return new e(kh(e.BYTES_PER_ELEMENT*t),0,t)}function Ah(e){return Array.isArray(e)?0===e.length||"number"==typeof e[0]:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(e)}class Lh{constructor(e,t={}){Ta(this,"layout",{}),Ta(this,"byteLength");let n=0;for(const[r,o]of Object.entries(e)){const e=vh(o),{type:i,components:s}=e,a=s*((null==t?void 0:t[r])??1);n=wd(n,a);const l=n;n+=a,this.layout[r]={type:i,size:a,offset:l}}n+=(4-n%4)%4;const i=4*n;this.byteLength=Math.max(i,1024)}getData(e){const t=kh(this.byteLength),n={i32:new Int32Array(t),u32:new Uint32Array(t),f32:new Float32Array(t),f16:new Uint16Array(t)};for(const[i,r]of Object.entries(e)){const e=this.layout[i];if(!e){md.warn(`Supplied uniform value ${i} not present in uniform block layout`)();continue}const{type:t,size:o,offset:s}=e,a=n[t];if(1===o){if("number"!=typeof r&&"boolean"!=typeof r){md.warn(`Supplied value for single component uniform ${i} is not a number: ${r}`)();continue}a[s]=Number(r)}else{if(!Ah(r)){md.warn(`Supplied value for multi component / array uniform ${i} is not a numeric array: ${r}`)();continue}a.set(r,s)}}return new Uint8Array(t,0,this.byteLength)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}class Rh{constructor(e){var t;if(Ta(this,"name"),Ta(this,"uniforms",{}),Ta(this,"modifiedUniforms",{}),Ta(this,"modified",!0),Ta(this,"bindingLayout",{}),Ta(this,"needsRedraw","initialized"),this.name=(null==e?void 0:e.name)||"unnamed",null!=e&&e.name&&null!=e&&e.shaderLayout){const n=null==(t=null==e?void 0:e.shaderLayout.bindings)?void 0:t.find(t=>"uniform"===t.type&&t.name===(null==e?void 0:e.name));if(!n)throw new Error(null==e?void 0:e.name);const i=n;for(const e of i.uniforms||[])this.bindingLayout[e.name]=e}}setUniforms(e){for(const[t,n]of Object.entries(e))this._setUniform(t,n),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${t}=${n}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,t){(function(e,t){if(e!==t)return!1;const n=e,i=t;if(!Ah(n))return!1;if(Ah(i)&&n.length===i.length)for(let r=0;r<n.length;++r)if(i[r]!==n[r])return!1;return!0})(this.uniforms[e],t)||(this.uniforms[e]=function(e){return Ah(e)?e.slice():e}(t),this.modifiedUniforms[e]=!0,this.modified=!0)}}let Ph=class{constructor(e){Ta(this,"uniformBlocks",new Map),Ta(this,"uniformBufferLayouts",new Map),Ta(this,"uniformBuffers",new Map);for(const[t,n]of Object.entries(e)){const e=t,i=new Lh(n.uniformTypes??{},n.uniformSizes??{});this.uniformBufferLayouts.set(e,i);const r=new Rh({name:t});r.setUniforms(n.defaultUniforms||{}),this.uniformBlocks.set(e,r)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){var t;for(const[n,i]of Object.entries(e))null==(t=this.uniformBlocks.get(n))||t.setUniforms(i);this.updateUniformBuffers()}getUniformBufferByteLength(e){var t;return(null==(t=this.uniformBufferLayouts.get(e))?void 0:t.byteLength)||0}getUniformBufferData(e){var t,n;const i=(null==(t=this.uniformBlocks.get(e))?void 0:t.getAllUniforms())||{};return null==(n=this.uniformBufferLayouts.get(e))?void 0:n.getData(i)}createUniformBuffer(e,t,n){n&&this.setUniforms(n);const i=this.getUniformBufferByteLength(t),r=e.createBuffer({usage:bd.UNIFORM|bd.COPY_DST,byteLength:i}),o=this.getUniformBufferData(t);return r.write(o),r}getManagedUniformBuffer(e,t){if(!this.uniformBuffers.get(t)){const n=this.getUniformBufferByteLength(t),i=e.createBuffer({usage:bd.UNIFORM|bd.COPY_DST,byteLength:n});this.uniformBuffers.set(t,i)}return this.uniformBuffers.get(t)}updateUniformBuffers(){let e=!1;for(const t of this.uniformBlocks.keys()){const n=this.updateUniformBuffer(t);e||(e=n)}return e&&md.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){var t;const n=this.uniformBlocks.get(e);let i=this.uniformBuffers.get(e),r=!1;if(i&&null!=n&&n.needsRedraw){r||(r=n.needsRedraw);const o=this.getUniformBufferData(e);i=this.uniformBuffers.get(e),null==i||i.write(o);const s=null==(t=this.uniformBlocks.get(e))?void 0:t.getAllUniforms();md.log(4,`Writing to uniform buffer ${String(e)}`,o,s)()}return r}};var Mh;!function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.R16_EXT=33322]="R16_EXT",e[e.RG16_EXT=33324]="RG16_EXT",e[e.RGB16_EXT=32852]="RGB16_EXT",e[e.RGBA16_EXT=32859]="RGBA16_EXT",e[e.R16_SNORM_EXT=36760]="R16_SNORM_EXT",e[e.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",e[e.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",e[e.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",e[e.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",e[e.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",e[e.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",e[e.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",e[e.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",e[e.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",e[e.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",e[e.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",e[e.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",e[e.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",e[e.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",e[e.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",e[e.LINE_WEBGL=6913]="LINE_WEBGL",e[e.FILL_WEBGL=6914]="FILL_WEBGL",e[e.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",e[e.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",e[e.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",e[e.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",e[e.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",e[e.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",e[e.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",e[e.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",e[e.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",e[e.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",e[e.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",e[e.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",e[e.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",e[e.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",e[e.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",e[e.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",e[e.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",e[e.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",e[e.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",e[e.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",e[e.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",e[e.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",e[e.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",e[e.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"}(Mh||(Mh={}));const Dh={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},Nh=e=>({drawBuffersWEBGL:t=>e.drawBuffers(t),COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),Fh=e=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES:()=>e.createVertexArray(),deleteVertexArrayOES:t=>e.deleteVertexArray(t),isVertexArrayOES:t=>e.isVertexArray(t),bindVertexArrayOES:t=>e.bindVertexArray(t)}),Oh=e=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE:(...t)=>e.drawArraysInstanced(...t),drawElementsInstancedANGLE:(...t)=>e.drawElementsInstanced(...t),vertexAttribDivisorANGLE:(...t)=>e.vertexAttribDivisor(...t)});async function Bh(e,t){const n=document.getElementsByTagName("head")[0];if(!n)throw new Error("loadScript");const i=document.createElement("script");return i.setAttribute("type","text/javascript"),i.setAttribute("src",e),new Promise((t,r)=>{i.onload=t,i.onerror=t=>r(new Error(`Unable to load script '${e}': ${t}`)),n.appendChild(i)})}let zh=null,Uh=!1;const Vh={debugSpectorJS:md.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};function Hh(e){var t;if(!(e={...Vh,...e}).debugSpectorJS)return null;if(!zh&&globalThis.SPECTOR&&(null==(t=globalThis.luma)||!t.spector)){md.probe(1,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;zh=new e,globalThis.luma&&(globalThis.luma.spector=zh)}if(!zh)return null;if(Uh||(Uh=!0,zh.spyCanvases(),null==zh||zh.onCaptureStarted.add(e=>md.info("Spector capture started:",e)()),null==zh||zh.onCapture.add(e=>{md.info("Spector capture complete:",e)(),null==zh||zh.getResultUI(),null==zh||zh.resultView.display(),null==zh||zh.resultView.addCapture(e)})),e.gl){const t=e.gl,n=t.device;null==zh||zh.startCapture(e.gl,500),t.device=n,new Promise(e=>setTimeout(e,2e3)).then(e=>{md.info("Spector capture stopped after 2 seconds")(),null==zh||zh.stopCapture()})}return zh}function Wh(e){return e.luma=e.luma||{},e.luma}function $h(e,t={}){return t.debugWebGL||t.traceWebGL?function(e,t){if(!globalThis.WebGLDebugUtils)return md.warn("webgl-debug not loaded")(),e;const n=Wh(e);if(n.debugContext)return n.debugContext;globalThis.WebGLDebugUtils.init({...Mh,...e});const i=globalThis.WebGLDebugUtils.makeDebugContext(e,jh.bind(null,t),Yh.bind(null,t));for(const s in Mh)!(s in i)&&"number"==typeof Mh[s]&&(i[s]=Mh[s]);class r{}Object.setPrototypeOf(i,Object.getPrototypeOf(e)),Object.setPrototypeOf(r,i);const o=Object.create(r);return n.realContext=e,n.debugContext=o,o.debug=!0,o}(e,t):function(e){const t=Wh(e);return t.realContext?t.realContext:e}(e)}function Gh(e,t){t=Array.from(t).map(e=>void 0===e?"undefined":e);let n=globalThis.WebGLDebugUtils.glFunctionArgsToString(e,t);return n=`${n.slice(0,100)}${n.length>100?"...":""}`,`gl.${e}(${n})`}function jh(e,t,n,i){i=Array.from(i).map(e=>void 0===e?"undefined":e);const r=`${globalThis.WebGLDebugUtils.glEnumToString(t)} in gl.${n}(${globalThis.WebGLDebugUtils.glFunctionArgsToString(n,i)})`;md.error(r)()}function Yh(e,t,n){let i="";md.level>=1&&(i=Gh(t,n),e.traceWebGL&&md.log(1,i)());for(const r of n)void 0===r&&(i=i||Gh(t,n))}const qh=new class extends Jd{constructor(){super(),Ta(this,"type","webgl"),Xd.defaultProps={...Xd.defaultProps,...Vh}}enforceWebGL2(e){!function(e=!0){const t=HTMLCanvasElement.prototype;if(!e&&t.originalGetContext)return t.getContext=t.originalGetContext,void(t.originalGetContext=void 0);t.originalGetContext=t.getContext,t.getContext=function(e,t){if("webgl"===e||"experimental-webgl"===e){const e=this.originalGetContext("webgl2",t);return e instanceof HTMLElement&&function(e){e.getExtension("EXT_color_buffer_float");const t={...Dh,WEBGL_disjoint_timer_query:e.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:Nh(e),OES_vertex_array_object:Fh(e),ANGLE_instanced_arrays:Oh(e)},n=e.getExtension;e.getExtension=function(i){return n.call(e,i)||(i in t?t[i]:null)};const i=e.getSupportedExtensions;e.getSupportedExtensions=function(){const n=i.apply(e)||[];return null==n?void 0:n.concat(Object.keys(t))}}(e),e}return this.originalGetContext(e,t)}}(e)}isSupported(){return typeof WebGL2RenderingContext<"u"}isDeviceHandle(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext||(typeof WebGLRenderingContext<"u"&&e instanceof WebGLRenderingContext&&md.warn("WebGL1 is not supported",e)(),!1)}async attach(e,t={}){const{WebGLDevice:n}=await B(async()=>{const{WebGLDevice:e}=await import("./webgl-device-QoBMYpnS-B_xcj5O_.js");return{WebGLDevice:e}},__vite__mapDeps([0,1]));if(e instanceof n)return e;if((null==e?void 0:e.device)instanceof n)return e.device;if(!function(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext||!(!e||!Number.isFinite(e._version))}(e))throw new Error("Invalid WebGL2RenderingContext");const i=!0===t.createCanvasContext?{}:t.createCanvasContext;return new n({...t,_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1,...i}})}async create(e={}){const{WebGLDevice:t}=await B(async()=>{const{WebGLDevice:e}=await import("./webgl-device-QoBMYpnS-B_xcj5O_.js");return{WebGLDevice:e}},__vite__mapDeps([0,1]));md.groupCollapsed(1,"WebGLDevice created")();try{const n=[];(e.debugWebGL||e.debug)&&n.push(async function(){Ju()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await Bh("https://unpkg.com/webgl-debug@2.0.1/index.js"))}()),e.debugSpectorJS&&n.push(async function(e){if(!globalThis.SPECTOR)try{await Bh(e.debugSpectorJSUrl||Vh.debugSpectorJSUrl)}catch(qe){md.warn(String(qe))}}(e));const i=await Promise.allSettled(n);for(const e of i)"rejected"===e.status&&md.error(`Failed to initialize debug libraries ${e.reason}`)();const r=new t(e),o=`${r._reused?"Reusing":"Created"} device with WebGL2 ${r.props.debug?"debug ":""}context: ${r.info.vendor}, ${r.info.renderer} for canvas: ${r.canvasContext.id}`;return md.probe(1,o)(),md.table(1,r.info)(),r}finally{md.groupEnd(1)()}}},Xh=void 0,Kh="#222222",Zh={enableSimulation:!0,spaceSize:8192,pointSizeScale:1,linkWidthScale:1,linkArrowsSizeScale:1,renderLinks:!0,curvedLinks:!1,curvedLinkSegments:19,curvedLinkWeight:.8,curvedLinkControlPointDistance:.5,linkArrows:!1,linkVisibilityDistanceRange:[50,150],linkVisibilityMinTransparency:.25,hoveredPointCursor:"auto",hoveredLinkCursor:"auto",renderHoveredPointRing:!1,hoveredPointRingColor:"white",hoveredLinkColor:void 0,hoveredLinkWidthIncrease:5,focusedPointRingColor:"white",focusedPointIndex:void 0,simulation:{decay:5e3,gravity:.25,center:0,repulsion:1,repulsionTheta:1.15,linkSpring:1,linkDistance:10,linkDistRandomVariationRange:[1,1.2],repulsionFromMouse:2,friction:.85,cluster:.1},showFPSMonitor:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||2,scalePointsOnZoom:!1,scaleLinksOnZoom:!1,enableZoom:!0,enableSimulationDuringZoom:!1,enableDrag:!1,fitViewOnInit:!0,fitViewDelay:250,fitViewPadding:.1,fitViewDuration:250,pointSamplingDistance:150,attribution:"",rescalePositions:void 0,enableRightClickRepulsion:!1},{entries:Qh,setPrototypeOf:Jh,isFrozen:ef,getPrototypeOf:tf,getOwnPropertyDescriptor:nf}=Object;let{freeze:rf,seal:of,create:sf}=Object,{apply:af,construct:lf}=typeof Reflect<"u"&&Reflect;rf||(rf=function(e){return e}),of||(of=function(e){return e}),af||(af=function(e,t,n){return e.apply(t,n)}),lf||(lf=function(e,t){return new e(...t)});const cf=Sf(Array.prototype.forEach),uf=Sf(Array.prototype.lastIndexOf),df=Sf(Array.prototype.pop),hf=Sf(Array.prototype.push),ff=Sf(Array.prototype.splice),pf=Sf(String.prototype.toLowerCase),mf=Sf(String.prototype.toString),gf=Sf(String.prototype.match),_f=Sf(String.prototype.replace),yf=Sf(String.prototype.indexOf),vf=Sf(String.prototype.trim),bf=Sf(Object.prototype.hasOwnProperty),xf=Sf(RegExp.prototype.test),wf=function(e){return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return lf(e,n)}}(TypeError);function Sf(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return af(e,t,i)}}function Ef(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pf;Jh&&Jh(e,null);let i=t.length;for(;i--;){let r=t[i];if("string"==typeof r){const e=n(r);e!==r&&(ef(t)||(t[i]=e),r=e)}e[r]=!0}return e}function Cf(e){for(let t=0;t<e.length;t++)bf(e,t)||(e[t]=null);return e}function Tf(e){const t=sf(null);for(const[n,i]of Qh(e))bf(e,n)&&(Array.isArray(i)?t[n]=Cf(i):i&&"object"==typeof i&&i.constructor===Object?t[n]=Tf(i):t[n]=i);return t}function kf(e,t){for(;null!==e;){const n=nf(e,t);if(n){if(n.get)return Sf(n.get);if("function"==typeof n.value)return Sf(n.value)}e=tf(e)}return function(){return null}}const If=rf(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Af=rf(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Lf=rf(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Rf=rf(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Pf=rf(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Mf=rf(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Df=rf(["#text"]),Nf=rf(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ff=rf(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Of=rf(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Bf=rf(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),zf=of(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Uf=of(/<%[\w\W]*|[\w\W]*%>/gm),Vf=of(/\$\{[\w\W]*/gm),Hf=of(/^data-[\-\w.\u00B7-\uFFFF]+$/),Wf=of(/^aria-[\-\w]+$/),$f=of(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Gf=of(/^(?:\w+script|data):/i),jf=of(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Yf=of(/^html$/i),qf=of(/^[a-z][.\w]*(-[.\w]+)+$/i);var Xf=Object.freeze({__proto__:null,ARIA_ATTR:Wf,ATTR_WHITESPACE:jf,CUSTOM_ELEMENT:qf,DATA_ATTR:Hf,DOCTYPE_NAME:Yf,ERB_EXPR:Uf,IS_ALLOWED_URI:$f,IS_SCRIPT_OR_DATA:Gf,MUSTACHE_EXPR:zf,TMPLIT_EXPR:Vf});var Kf=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:typeof window>"u"?null:window;const n=t=>e(t);if(n.version="3.2.6",n.removed=[],!t||!t.document||9!==t.document.nodeType||!t.Element)return n.isSupported=!1,n;let{document:i}=t;const r=i,o=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:l,Element:c,NodeFilter:u,NamedNodeMap:d=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:f,trustedTypes:p}=t,m=c.prototype,g=kf(m,"cloneNode"),_=kf(m,"remove"),y=kf(m,"nextSibling"),v=kf(m,"childNodes"),b=kf(m,"parentNode");if("function"==typeof a){const e=i.createElement("template");e.content&&e.content.ownerDocument&&(i=e.content.ownerDocument)}let x,w="";const{implementation:S,createNodeIterator:E,createDocumentFragment:C,getElementsByTagName:T}=i,{importNode:k}=r;let I={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"==typeof Qh&&"function"==typeof b&&S&&void 0!==S.createHTMLDocument;const{MUSTACHE_EXPR:A,ERB_EXPR:L,TMPLIT_EXPR:R,DATA_ATTR:P,ARIA_ATTR:M,IS_SCRIPT_OR_DATA:D,ATTR_WHITESPACE:N,CUSTOM_ELEMENT:F}=Xf;let{IS_ALLOWED_URI:O}=Xf,B=null;const z=Ef({},[...If,...Af,...Lf,...Pf,...Df]);let U=null;const V=Ef({},[...Nf,...Ff,...Of,...Bf]);let H=Object.seal(sf(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),W=null,$=null,G=!0,j=!0,Y=!1,q=!0,X=!1,K=!0,Z=!1,Q=!1,J=!1,ee=!1,te=!1,ne=!1,ie=!0,re=!1,oe=!0,se=!1,ae={},le=null;const ce=Ef({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ue=null;const de=Ef({},["audio","video","img","source","image","track"]);let he=null;const fe=Ef({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),pe="http://www.w3.org/1998/Math/MathML",me="http://www.w3.org/2000/svg",ge="http://www.w3.org/1999/xhtml";let _e=ge,ye=!1,ve=null;const be=Ef({},[pe,me,ge],mf);let xe=Ef({},["mi","mo","mn","ms","mtext"]),we=Ef({},["annotation-xml"]);const Se=Ef({},["title","style","font","a","script"]);let Ee=null;const Ce=["application/xhtml+xml","text/html"];let Te=null,ke=null;const Ie=i.createElement("form"),Ae=function(e){return e instanceof RegExp||e instanceof Function},Le=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!ke||ke!==e){if((!e||"object"!=typeof e)&&(e={}),e=Tf(e),Ee=-1===Ce.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,Te="application/xhtml+xml"===Ee?mf:pf,B=bf(e,"ALLOWED_TAGS")?Ef({},e.ALLOWED_TAGS,Te):z,U=bf(e,"ALLOWED_ATTR")?Ef({},e.ALLOWED_ATTR,Te):V,ve=bf(e,"ALLOWED_NAMESPACES")?Ef({},e.ALLOWED_NAMESPACES,mf):be,he=bf(e,"ADD_URI_SAFE_ATTR")?Ef(Tf(fe),e.ADD_URI_SAFE_ATTR,Te):fe,ue=bf(e,"ADD_DATA_URI_TAGS")?Ef(Tf(de),e.ADD_DATA_URI_TAGS,Te):de,le=bf(e,"FORBID_CONTENTS")?Ef({},e.FORBID_CONTENTS,Te):ce,W=bf(e,"FORBID_TAGS")?Ef({},e.FORBID_TAGS,Te):Tf({}),$=bf(e,"FORBID_ATTR")?Ef({},e.FORBID_ATTR,Te):Tf({}),ae=!!bf(e,"USE_PROFILES")&&e.USE_PROFILES,G=!1!==e.ALLOW_ARIA_ATTR,j=!1!==e.ALLOW_DATA_ATTR,Y=e.ALLOW_UNKNOWN_PROTOCOLS||!1,q=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,X=e.SAFE_FOR_TEMPLATES||!1,K=!1!==e.SAFE_FOR_XML,Z=e.WHOLE_DOCUMENT||!1,ee=e.RETURN_DOM||!1,te=e.RETURN_DOM_FRAGMENT||!1,ne=e.RETURN_TRUSTED_TYPE||!1,J=e.FORCE_BODY||!1,ie=!1!==e.SANITIZE_DOM,re=e.SANITIZE_NAMED_PROPS||!1,oe=!1!==e.KEEP_CONTENT,se=e.IN_PLACE||!1,O=e.ALLOWED_URI_REGEXP||$f,_e=e.NAMESPACE||ge,xe=e.MATHML_TEXT_INTEGRATION_POINTS||xe,we=e.HTML_INTEGRATION_POINTS||we,H=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&Ae(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(H.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Ae(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(H.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(H.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),X&&(j=!1),te&&(ee=!0),ae&&(B=Ef({},Df),U=[],!0===ae.html&&(Ef(B,If),Ef(U,Nf)),!0===ae.svg&&(Ef(B,Af),Ef(U,Ff),Ef(U,Bf)),!0===ae.svgFilters&&(Ef(B,Lf),Ef(U,Ff),Ef(U,Bf)),!0===ae.mathMl&&(Ef(B,Pf),Ef(U,Of),Ef(U,Bf))),e.ADD_TAGS&&(B===z&&(B=Tf(B)),Ef(B,e.ADD_TAGS,Te)),e.ADD_ATTR&&(U===V&&(U=Tf(U)),Ef(U,e.ADD_ATTR,Te)),e.ADD_URI_SAFE_ATTR&&Ef(he,e.ADD_URI_SAFE_ATTR,Te),e.FORBID_CONTENTS&&(le===ce&&(le=Tf(le)),Ef(le,e.FORBID_CONTENTS,Te)),oe&&(B["#text"]=!0),Z&&Ef(B,["html","head","body"]),B.table&&(Ef(B,["tbody"]),delete W.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw wf('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw wf('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');x=e.TRUSTED_TYPES_POLICY,w=x.createHTML("")}else void 0===x&&(x=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(n=t.getAttribute(i));const r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML:e=>e,createScriptURL:e=>e})}catch{return null}}(p,o)),null!==x&&"string"==typeof w&&(w=x.createHTML(""));rf&&rf(e),ke=e}},Re=Ef({},[...Af,...Lf,...Rf]),Pe=Ef({},[...Pf,...Mf]),Me=function(e){hf(n.removed,{element:e});try{b(e).removeChild(e)}catch{_(e)}},De=function(e,t){try{hf(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch{hf(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(ee||te)try{Me(t)}catch{}else try{t.setAttribute(e,"")}catch{}},Ne=function(e){let t=null,n=null;if(J)e="<remove></remove>"+e;else{const t=gf(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===Ee&&_e===ge&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const r=x?x.createHTML(e):e;if(_e===ge)try{t=(new f).parseFromString(r,Ee)}catch{}if(!t||!t.documentElement){t=S.createDocument(_e,"template",null);try{t.documentElement.innerHTML=ye?w:r}catch{}}const o=t.body||t.documentElement;return e&&n&&o.insertBefore(i.createTextNode(n),o.childNodes[0]||null),_e===ge?T.call(t,Z?"html":"body")[0]:Z?t.documentElement:o},Fe=function(e){return E.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Oe=function(e){return e instanceof h&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof d)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},Be=function(e){return"function"==typeof l&&e instanceof l};function ze(e,t,i){cf(e,e=>{e.call(n,t,i,ke)})}const Ue=function(e){let t=null;if(ze(I.beforeSanitizeElements,e,null),Oe(e))return Me(e),!0;const i=Te(e.nodeName);if(ze(I.uponSanitizeElement,e,{tagName:i,allowedTags:B}),K&&e.hasChildNodes()&&!Be(e.firstElementChild)&&xf(/<[/\w!]/g,e.innerHTML)&&xf(/<[/\w!]/g,e.textContent)||7===e.nodeType||K&&8===e.nodeType&&xf(/<[/\w]/g,e.data))return Me(e),!0;if(!B[i]||W[i]){if(!W[i]&&He(i)&&(H.tagNameCheck instanceof RegExp&&xf(H.tagNameCheck,i)||H.tagNameCheck instanceof Function&&H.tagNameCheck(i)))return!1;if(oe&&!le[i]){const t=b(e)||e.parentNode,n=v(e)||e.childNodes;if(n&&t)for(let i=n.length-1;i>=0;--i){const r=g(n[i],!0);r.__removalCount=(e.__removalCount||0)+1,t.insertBefore(r,y(e))}}return Me(e),!0}return e instanceof c&&!function(e){let t=b(e);(!t||!t.tagName)&&(t={namespaceURI:_e,tagName:"template"});const n=pf(e.tagName),i=pf(t.tagName);return!!ve[e.namespaceURI]&&(e.namespaceURI===me?t.namespaceURI===ge?"svg"===n:t.namespaceURI===pe?"svg"===n&&("annotation-xml"===i||xe[i]):!!Re[n]:e.namespaceURI===pe?t.namespaceURI===ge?"math"===n:t.namespaceURI===me?"math"===n&&we[i]:!!Pe[n]:e.namespaceURI===ge?!(t.namespaceURI===me&&!we[i]||t.namespaceURI===pe&&!xe[i])&&!Pe[n]&&(Se[n]||!Re[n]):!("application/xhtml+xml"!==Ee||!ve[e.namespaceURI]))}(e)||("noscript"===i||"noembed"===i||"noframes"===i)&&xf(/<\/no(script|embed|frames)/i,e.innerHTML)?(Me(e),!0):(X&&3===e.nodeType&&(t=e.textContent,cf([A,L,R],e=>{t=_f(t,e," ")}),e.textContent!==t&&(hf(n.removed,{element:e.cloneNode()}),e.textContent=t)),ze(I.afterSanitizeElements,e,null),!1)},Ve=function(e,t,n){if(ie&&("id"===t||"name"===t)&&(n in i||n in Ie))return!1;if((!j||$[t]||!xf(P,t))&&(!G||!xf(M,t)))if(!U[t]||$[t]){if(!(He(e)&&(H.tagNameCheck instanceof RegExp&&xf(H.tagNameCheck,e)||H.tagNameCheck instanceof Function&&H.tagNameCheck(e))&&(H.attributeNameCheck instanceof RegExp&&xf(H.attributeNameCheck,t)||H.attributeNameCheck instanceof Function&&H.attributeNameCheck(t))||"is"===t&&H.allowCustomizedBuiltInElements&&(H.tagNameCheck instanceof RegExp&&xf(H.tagNameCheck,n)||H.tagNameCheck instanceof Function&&H.tagNameCheck(n))))return!1}else if(!he[t]&&!xf(O,_f(n,N,""))&&("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==yf(n,"data:")||!ue[e])&&(!Y||xf(D,_f(n,N,"")))&&n)return!1;return!0},He=function(e){return"annotation-xml"!==e&&gf(e,F)},We=function(e){ze(I.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||Oe(e))return;const i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:U,forceKeepAttr:void 0};let r=t.length;for(;r--;){const o=t[r],{name:s,namespaceURI:a,value:l}=o,c=Te(s),u=l;let d="value"===s?u:vf(u);if(i.attrName=c,i.attrValue=d,i.keepAttr=!0,i.forceKeepAttr=void 0,ze(I.uponSanitizeAttribute,e,i),d=i.attrValue,re&&("id"===c||"name"===c)&&(De(s,e),d="user-content-"+d),K&&xf(/((--!?|])>)|<\/(style|title)/i,d)){De(s,e);continue}if(i.forceKeepAttr)continue;if(!i.keepAttr){De(s,e);continue}if(!q&&xf(/\/>/i,d)){De(s,e);continue}X&&cf([A,L,R],e=>{d=_f(d,e," ")});const h=Te(e.nodeName);if(Ve(h,c,d)){if(x&&"object"==typeof p&&"function"==typeof p.getAttributeType&&!a)switch(p.getAttributeType(h,c)){case"TrustedHTML":d=x.createHTML(d);break;case"TrustedScriptURL":d=x.createScriptURL(d)}if(d!==u)try{a?e.setAttributeNS(a,s,d):e.setAttribute(s,d),Oe(e)?Me(e):df(n.removed)}catch{De(s,e)}}else De(s,e)}ze(I.afterSanitizeAttributes,e,null)},$e=function e(t){let n=null;const i=Fe(t);for(ze(I.beforeSanitizeShadowDOM,t,null);n=i.nextNode();)ze(I.uponSanitizeShadowNode,n,null),Ue(n),We(n),n.content instanceof s&&e(n.content);ze(I.afterSanitizeShadowDOM,t,null)};return n.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=null,o=null,a=null,c=null;if(ye=!e,ye&&(e="\x3c!--\x3e"),"string"!=typeof e&&!Be(e)){if("function"!=typeof e.toString)throw wf("toString is not a function");if("string"!=typeof(e=e.toString()))throw wf("dirty is not a string, aborting")}if(!n.isSupported)return e;if(Q||Le(t),n.removed=[],"string"==typeof e&&(se=!1),se){if(e.nodeName){const t=Te(e.nodeName);if(!B[t]||W[t])throw wf("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof l)i=Ne("\x3c!----\x3e"),o=i.ownerDocument.importNode(e,!0),1===o.nodeType&&"BODY"===o.nodeName||"HTML"===o.nodeName?i=o:i.appendChild(o);else{if(!ee&&!X&&!Z&&-1===e.indexOf("<"))return x&&ne?x.createHTML(e):e;if(i=Ne(e),!i)return ee?null:ne?w:""}i&&J&&Me(i.firstChild);const u=Fe(se?e:i);for(;a=u.nextNode();)Ue(a),We(a),a.content instanceof s&&$e(a.content);if(se)return e;if(ee){if(te)for(c=C.call(i.ownerDocument);i.firstChild;)c.appendChild(i.firstChild);else c=i;return(U.shadowroot||U.shadowrootmode)&&(c=k.call(r,c,!0)),c}let d=Z?i.outerHTML:i.innerHTML;return Z&&B["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&xf(Yf,i.ownerDocument.doctype.name)&&(d="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+d),X&&cf([A,L,R],e=>{d=_f(d,e," ")}),x&&ne?x.createHTML(d):d},n.setConfig=function(){Le(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Q=!0},n.clearConfig=function(){ke=null,Q=!1},n.isValidAttribute=function(e,t,n){ke||Le({});const i=Te(e),r=Te(t);return Ve(i,r,n)},n.addHook=function(e,t){"function"==typeof t&&hf(I[e],t)},n.removeHook=function(e,t){if(void 0!==t){const n=uf(I[e],t);return-1===n?void 0:ff(I[e],n,1)[0]}return df(I[e])},n.removeHooks=function(e){I[e]=[]},n.removeAllHooks=function(){I={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}();const Zf=e=>Array.isArray(e),Qf=e=>(e=>e instanceof Object)(e)&&!Zf(e)&&!(e=>"function"==typeof e)(e)&&!(e=>e instanceof Object&&"Function"!==e.constructor.name&&"Object"!==e.constructor.name)(e);function Jf(e){let t;if(Zf(e))t=e;else{const n=Dc(e),i=null==n?void 0:n.rgb();t=[(null==i?void 0:i.r)||0,(null==i?void 0:i.g)||0,(null==i?void 0:i.b)||0,(null==n?void 0:n.opacity)??1]}return[t[0]/255,t[1]/255,t[2]/255,t[3]]}function ep(e,t,n=0,i=0,r,o){return e.readPixelsToArrayWebGL(t,{sourceX:n,sourceY:i,sourceWidth:r,sourceHeight:o})}function tp(e){return null!=e&&!Number.isNaN(e)}class np{constructor(){this.enableSimulation=Zh.enableSimulation,this.backgroundColor=Kh,this.spaceSize=Zh.spaceSize,this.pointColor="#b3b3b3",this.pointDefaultColor=void 0,this.pointGreyoutOpacity=void 0,this.pointGreyoutColor=Xh,this.pointSize=4,this.pointDefaultSize=void 0,this.pointOpacity=1,this.pointSizeScale=Zh.pointSizeScale,this.hoveredPointCursor=Zh.hoveredPointCursor,this.hoveredLinkCursor=Zh.hoveredLinkCursor,this.renderHoveredPointRing=Zh.renderHoveredPointRing,this.hoveredPointRingColor=Zh.hoveredPointRingColor,this.focusedPointRingColor=Zh.focusedPointRingColor,this.focusedPointIndex=Zh.focusedPointIndex,this.linkColor="#666666",this.linkDefaultColor=void 0,this.linkOpacity=1,this.linkGreyoutOpacity=.1,this.linkWidth=1,this.linkDefaultWidth=void 0,this.linkWidthScale=Zh.linkWidthScale,this.hoveredLinkColor=Zh.hoveredLinkColor,this.hoveredLinkWidthIncrease=Zh.hoveredLinkWidthIncrease,this.renderLinks=Zh.renderLinks,this.curvedLinks=Zh.curvedLinks,this.curvedLinkSegments=Zh.curvedLinkSegments,this.curvedLinkWeight=Zh.curvedLinkWeight,this.curvedLinkControlPointDistance=Zh.curvedLinkControlPointDistance,this.linkArrows=Zh.linkArrows,this.linkDefaultArrows=void 0,this.linkArrowsSizeScale=Zh.linkArrowsSizeScale,this.scaleLinksOnZoom=Zh.scaleLinksOnZoom,this.linkVisibilityDistanceRange=Zh.linkVisibilityDistanceRange,this.linkVisibilityMinTransparency=Zh.linkVisibilityMinTransparency,this.simulationDecay=Zh.simulation.decay,this.simulationGravity=Zh.simulation.gravity,this.simulationCenter=Zh.simulation.center,this.simulationRepulsion=Zh.simulation.repulsion,this.simulationRepulsionTheta=Zh.simulation.repulsionTheta,this.simulationLinkSpring=Zh.simulation.linkSpring,this.simulationLinkDistance=Zh.simulation.linkDistance,this.simulationLinkDistRandomVariationRange=Zh.simulation.linkDistRandomVariationRange,this.simulationRepulsionFromMouse=Zh.simulation.repulsionFromMouse,this.enableRightClickRepulsion=Zh.enableRightClickRepulsion,this.simulationFriction=Zh.simulation.friction,this.simulationCluster=Zh.simulation.cluster,this.onSimulationStart=void 0,this.onSimulationTick=void 0,this.onSimulationEnd=void 0,this.onSimulationPause=void 0,this.onSimulationRestart=void 0,this.onSimulationUnpause=void 0,this.onClick=void 0,this.onPointClick=void 0,this.onLinkClick=void 0,this.onBackgroundClick=void 0,this.onMouseMove=void 0,this.onPointMouseOver=void 0,this.onPointMouseOut=void 0,this.onLinkMouseOver=void 0,this.onLinkMouseOut=void 0,this.onZoomStart=void 0,this.onZoom=void 0,this.onZoomEnd=void 0,this.onDragStart=void 0,this.onDrag=void 0,this.onDragEnd=void 0,this.showFPSMonitor=Zh.showFPSMonitor,this.pixelRatio=Zh.pixelRatio,this.scalePointsOnZoom=Zh.scalePointsOnZoom,this.initialZoomLevel=void 0,this.enableZoom=Zh.enableZoom,this.enableSimulationDuringZoom=Zh.enableSimulationDuringZoom,this.enableDrag=Zh.enableDrag,this.fitViewOnInit=Zh.fitViewOnInit,this.fitViewDelay=Zh.fitViewDelay,this.fitViewPadding=Zh.fitViewPadding,this.fitViewDuration=Zh.fitViewDuration,this.fitViewByPointsInRect=void 0,this.fitViewByPointIndices=void 0,this.randomSeed=void 0,this.pointSamplingDistance=Zh.pointSamplingDistance,this.attribution=Zh.attribution,this.rescalePositions=Zh.rescalePositions}init(e){Object.keys(e).forEach(t=>{this.deepMergeConfig(this.getConfig(),e,t)})}deepMergeConfig(e,t,n){Qf(e[n])&&Qf(t[n])?Object.keys(t[n]).forEach(i=>{this.deepMergeConfig(e[n],t[n],i)}):e[n]=t[n]}getConfig(){return this}}function ip(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}const rp={number:{type:"number",validate:(e,t)=>Number.isFinite(e)&&"object"==typeof t&&(void 0===t.max||e<=t.max)&&(void 0===t.min||e>=t.min)},array:{type:"array",validate:(e,t)=>Array.isArray(e)||ArrayBuffer.isView(e)}};function op(e){let t=sp(e);if("object"!==t)return{value:e,...rp[t],type:t};if("object"==typeof e)return e?void 0!==e.type?{...e,...rp[e.type],type:e.type}:void 0===e.value?{type:"object",value:e}:(t=sp(e.value),{...e,...rp[t],type:t}):{type:"object",value:null};throw new Error("props")}function sp(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}const ap={vertex:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fragment:"#ifdef MODULE_MATERIAL\n  fragColor = material_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  fragColor = lighting_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_FOG\n  fragColor = fog_filterColor(fragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  fragColor = picking_filterHighlightColor(fragColor);\n  fragColor = picking_filterPickingColor(fragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},lp=/void\s+main\s*\([^)]*\)\s*\{\n?/,cp=/}\n?[^{}]*$/,up=[],dp="__LUMA_INJECT_DECLARATIONS__";function hp(e){const t={vertex:{},fragment:{}};for(const n in e){let i=e[n];"string"==typeof i&&(i={order:0,injection:i}),t[fp(n)][n]=i}return t}function fp(e){const t=e.slice(0,2);switch(t){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(t)}}function pp(e,t,n,i=!1){const r="vertex"===t;for(const o in n){const t=n[o];t.sort((e,t)=>e.order-t.order),up.length=t.length;for(let e=0,n=t.length;e<n;++e)up[e]=t[e].injection;const i=`${up.join("\n")}\n`;switch(o){case"vs:#decl":r&&(e=e.replace(dp,i));break;case"vs:#main-start":r&&(e=e.replace(lp,e=>e+i));break;case"vs:#main-end":r&&(e=e.replace(cp,e=>i+e));break;case"fs:#decl":r||(e=e.replace(dp,i));break;case"fs:#main-start":r||(e=e.replace(lp,e=>e+i));break;case"fs:#main-end":r||(e=e.replace(cp,e=>i+e));break;default:e=e.replace(o,e=>e+i)}}return e=e.replace(dp,""),i&&(e=e.replace(/\}\s*$/,e=>e+ap[t])),e}function mp(e){e.map(e=>function(e){if(e.instance)return;mp(e.dependencies||[]);const{propTypes:t={},deprecations:n=[],inject:i={}}=e,r={normalizedInjections:hp(i),parsedDeprecations:_p(n)};t&&(r.propValidators=function(e){const t={};for(const[n,i]of Object.entries(e))t[n]=op(i);return t}(t)),e.instance=r;let o={};t&&(o=Object.entries(t).reduce((e,[t,n])=>{const i=null==n?void 0:n.value;return i&&(e[t]=i),e},{})),e.defaultUniforms={...e.defaultUniforms,...o}}(e))}function gp(e,t,n){var i;null==(i=e.deprecations)||i.forEach(e=>{var i;null!=(i=e.regex)&&i.test(t)&&(e.deprecated?n.deprecated(e.old,e.new)():n.removed(e.old,e.new)())})}function _p(e){return e.forEach(e=>{"function"===e.type?e.regex=new RegExp(`\\b${e.old}\\(`):e.regex=new RegExp(`${e.type} ${e.old};`)}),e}function yp(e){mp(e);const t={},n={};vp({modules:e,level:0,moduleMap:t,moduleDepth:n});const i=Object.keys(n).sort((e,t)=>n[t]-n[e]).map(e=>t[e]);return mp(i),i}function vp(e){const{modules:t,level:n,moduleMap:i,moduleDepth:r}=e;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const o of t)i[o.name]=o,(void 0===r[o.name]||r[o.name]<n)&&(r[o.name]=n);for(const o of t)o.dependencies&&vp({modules:o.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}const bp=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],xp=[...bp,[Ep("attribute"),"in $1"],[Ep("varying"),"out $1"]],wp=[...bp,[Ep("varying"),"in $1"]];function Sp(e,t){for(const[n,i]of t)e=e.replace(n,i);return e}function Ep(e){return new RegExp(`\\b${e}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function Cp(e,t){let n="";for(const i in e){const r=e[i];if(n+=`void ${r.signature} {\n`,r.header&&(n+=`  ${r.header}`),t[i]){const e=t[i];e.sort((e,t)=>e.order-t.order);for(const t of e)n+=`  ${t.injection}\n`}r.footer&&(n+=`  ${r.footer}`),n+="}\n"}return n}function Tp(e){const t={vertex:{},fragment:{}};for(const n of e){let e,i;"string"!=typeof n?(e=n,i=e.hook):(e={},i=n),i=i.trim();const[r,o]=i.split(":"),s=i.replace(/\(.+/,""),a=Object.assign(e,{signature:o});switch(r){case"vs":t.vertex[s]=a;break;case"fs":t.fragment[s]=a;break;default:throw new Error(r)}}return t}function kp(e,t="unnamed"){const n=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(e);return n?n[1]:t}function Ip(e){let t=100;const n=e.match(/[^\s]+/g);if(n&&n.length>=2&&"#version"===n[0]){const e=parseInt(n[1],10);Number.isFinite(e)&&(t=e)}if(100!==t&&300!==t)throw new Error(`Invalid GLSL version ${t}`);return t}const Ap=`\n\n${dp}\n`;function Lp(e){const{vs:t,fs:n}=e,i=yp(e.modules||[]);return{vs:Pp(e.platformInfo,{...e,source:t,stage:"vertex",modules:i}),fs:Pp(e.platformInfo,{...e,source:n,stage:"fragment",modules:i}),getUniforms:Mp(i)}}function Rp(e,t){var n;const{source:i,stage:r,modules:o,hookFunctions:s=[],inject:a={},log:l}=t;ip("string"==typeof i,"shader source must be a string");const c=i;let u="";const d=Tp(s),h={},f={},p={};for(const g in a){const e="string"==typeof a[g]?{injection:a[g],order:0}:a[g],t=/^(v|f)s:(#)?([\w-]+)$/.exec(g);if(t){const n=t[2],i=t[3];n?"decl"===i?f[g]=[e]:p[g]=[e]:h[g]=[e]}else p[g]=[e]}const m=o;for(const g of m){l&&gp(g,c,l),u+=Dp(g,"wgsl");const e=(null==(n=g.injections)?void 0:n[r])||{};for(const t in e){const n=/^(v|f)s:#([\w-]+)$/.exec(t);if(n){const i="decl"===n[2]?f:p;i[t]=i[t]||[],i[t].push(e[t])}else h[t]=h[t]||[],h[t].push(e[t])}}return u+=Ap,u=pp(u,r,f),u+=Cp(d[r],h),u+=c,u=pp(u,r,p),u}function Pp(e,t){var n;const{source:i,stage:r,language:o="glsl",modules:s,defines:a={},hookFunctions:l=[],inject:c={},prologue:u=!0,log:d}=t;ip("string"==typeof i,"shader source must be a string");const h="glsl"===o?function(e){return{name:kp(e,void 0),language:"glsl",version:Ip(e)}}(i).version:-1,f=e.shaderLanguageVersion,p=100===h?"#version 100":"#version 300 es",m=i.split("\n").slice(1).join("\n"),g={};s.forEach(e=>{Object.assign(g,e.defines)}),Object.assign(g,a);let _="";switch(o){case"wgsl":break;case"glsl":_=u?`${p}\n\n// ----- PROLOGUE -------------------------\n#define SHADER_TYPE_${r.toUpperCase()}\n\n${function(e){switch(null==e?void 0:e.gpu.toLowerCase()){case"apple":return"#define APPLE_GPU\n// Apple optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Headless Chrome's software shader 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// If the GPU doesn't have full 32 bits precision, will causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(e)}\n${"fragment"===r?"precision highp float;\n":""}\n\n// ----- APPLICATION DEFINES -------------------------\n\n${function(e={}){let t="";for(const n in e){const i=e[n];(i||Number.isFinite(i))&&(t+=`#define ${n.toUpperCase()} ${e[n]}\n`)}return t}(g)}\n\n`:`${p}\n`}const y=Tp(l),v={},b={},x={};for(const w in c){const e="string"==typeof c[w]?{injection:c[w],order:0}:c[w],t=/^(v|f)s:(#)?([\w-]+)$/.exec(w);if(t){const n=t[2],i=t[3];n?"decl"===i?b[w]=[e]:x[w]=[e]:v[w]=[e]}else x[w]=[e]}for(const w of s){d&&gp(w,m,d),_+=Dp(w,r);const e=(null==(n=w.instance)?void 0:n.normalizedInjections[r])||{};for(const t in e){const n=/^(v|f)s:#([\w-]+)$/.exec(t);if(n){const i="decl"===n[2]?b:x;i[t]=i[t]||[],i[t].push(e[t])}else v[t]=v[t]||[],v[t].push(e[t])}}return _+="// ----- MAIN SHADER SOURCE -------------------------",_+=Ap,_=pp(_,r,b),_+=Cp(y[r],v),_+=m,_=pp(_,r,x),"glsl"===o&&h!==f&&(_=function(e,t){var n;if(300!==Number((null==(n=e.match(/^#version[ \t]+(\d+)/m))?void 0:n[1])||100))throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(t){case"vertex":return Sp(e,xp);case"fragment":return Sp(e,wp);default:throw new Error(t)}}(_,r)),_.trim()}function Mp(e){return function(t){var n;const i={};for(const r of e){const e=null==(n=r.getUniforms)?void 0:n.call(r,t,i);Object.assign(i,e)}return i}}function Dp(e,t){let n;switch(t){case"vertex":n=e.vs||"";break;case"fragment":n=e.fs||"";break;case"wgsl":n=e.source||"";break;default:ip(!1)}if(!e.name)throw new Error("Shader module must have a name");const i=e.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let r=`// ----- MODULE ${e.name} ---------------\n\n`;return"wgsl"!==t&&(r+=`#define MODULE_${i}\n`),r+=`${n}\n`,r}const Np=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,Fp=/^\s*\#\s*endif\s*$/;function Op(e,t){const n=e.split("\n"),i=[];let r=!0,o=null;for(const s of n){const e=s.match(Np),t=s.match(Fp);e?(o=e[1],r=!1):t?r=!0:r&&i.push(s)}return i.join("\n")}const Bp=class e{constructor(){Ta(this,"_hookFunctions",[]),Ta(this,"_defaultModules",[])}static getDefaultShaderAssembler(){return e.defaultShaderAssembler=e.defaultShaderAssembler||new e,e.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(t=>t.name===("string"==typeof e?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(e=>e.name!==t)}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const t=this._getModuleList(e.modules),n=this._hookFunctions,{source:i,getUniforms:r}=function(e){const t=yp(e.modules||[]);return{source:Rp(e.platformInfo,{...e,source:e.source,stage:"vertex",modules:t}),getUniforms:Mp(t)}}({...e,source:e.source,modules:t,hookFunctions:n});return{source:"wgsl"===e.platformInfo.shaderLanguage?Op(i):i,getUniforms:r,modules:t}}assembleGLSLShaderPair(e){const t=this._getModuleList(e.modules),n=this._hookFunctions;return{...Lp({...e,vs:e.vs,fs:e.fs,modules:t,hookFunctions:n}),modules:t}}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),n={};let i=0;for(let r=0,o=this._defaultModules.length;r<o;++r){const e=this._defaultModules[r],o=e.name;t[i++]=e,n[o]=!0}for(let r=0,o=e.length;r<o;++r){const o=e[r],s=o.name;n[s]||(t[i++]=o,n[s]=!0)}return t.length=i,mp(t),t}};Ta(Bp,"defaultShaderAssembler");let zp=Bp;class Up{constructor(e,t){this.name=e,this.attributes=t,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}}class Vp{constructor(e,t,n){this.name=e,this.type=t,this.attributes=n,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class Hp extends Up{constructor(e,t){super(e,t),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class Wp extends Up{constructor(e,t){super(e,t),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return`array<${this.format.getTypeName()}, ${this.count}>`}}class $p extends Up{constructor(e,t,n){super(e,n),this.format=t}get isPointer(){return!0}getTypeName(){return`&${this.format.getTypeName()}`}}class Gp extends Up{constructor(e,t,n,i){super(e,n),this.format=t,this.access=i}get isTemplate(){return!0}getTypeName(){let e=this.name;if(null!==this.format){if("vec2"===e||"vec3"===e||"vec4"===e||"mat2x2"===e||"mat2x3"===e||"mat2x4"===e||"mat3x2"===e||"mat3x3"===e||"mat3x4"===e||"mat4x2"===e||"mat4x3"===e||"mat4x4"===e){if("f32"===this.format.name)return e+="f",e;if("i32"===this.format.name)return e+="i",e;if("u32"===this.format.name)return e+="u",e;if("bool"===this.format.name)return e+="b",e;if("f16"===this.format.name)return e+="h",e}e+=`<${this.format.name}>`}else if("vec2"===e||"vec3"===e||"vec4"===e)return e;return e}}var jp;(e=>{e[e.Uniform=0]="Uniform",e[e.Storage=1]="Storage",e[e.Texture=2]="Texture",e[e.Sampler=3]="Sampler",e[e.StorageTexture=4]="StorageTexture"})(jp||(jp={}));class Yp{constructor(e,t,n,i,r,o,s){this.name=e,this.type=t,this.group=n,this.binding=i,this.attributes=r,this.resourceType=o,this.access=s}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class qp{constructor(e,t){this.name=e,this.type=t}}class Xp{constructor(e,t,n,i){this.name=e,this.type=t,this.locationType=n,this.location=i,this.interpolation=null}}class Kp{constructor(e,t,n,i){this.name=e,this.type=t,this.locationType=n,this.location=i}}class Zp{constructor(e,t,n,i){this.name=e,this.type=t,this.attributes=n,this.id=i}}class Qp{constructor(e,t,n){this.name=e,this.type=t,this.attributes=n}}class Jp{constructor(e,t=null,n){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=t,this.attributes=n}}class em{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}function tm(e){var t=(32768&e)>>15,n=(31744&e)>>10,i=1023&e;return 0==n?(t?-1:1)*Math.pow(2,-14)*(i/Math.pow(2,10)):31==n?i?NaN:1/0*(t?-1:1):(t?-1:1)*Math.pow(2,n-15)*(1+i/Math.pow(2,10))}const nm=new Float32Array(1),im=new Int32Array(nm.buffer),rm=new Uint16Array(1);function om(e){nm[0]=e;const t=im[0],n=t>>31&1;let i=t>>23&255,r=8388607&t;if(255===i)return rm[0]=n<<15|31744|(0!==r?512:0),rm[0];if(0===i){if(0===r)return rm[0]=n<<15,rm[0];r|=8388608;let e=113;for(;!(8388608&r);)r<<=1,e--;return i=127-e,r&=8388607,i>0?(r=(r>>126-i)+(r>>127-i&1),rm[0]=n<<15|i<<10|r>>13,rm[0]):(rm[0]=n<<15,rm[0])}return i=i-127+15,i>=31?(rm[0]=n<<15|31744,rm[0]):i<=0?i<-10?(rm[0]=n<<15,rm[0]):(r=(8388608|r)>>1-i,rm[0]=n<<15|r>>13,rm[0]):(r>>=13,rm[0]=n<<15|i<<10|r,rm[0])}const sm=new Uint32Array(1),am=new Float32Array(sm.buffer,0,1);function lm(e){const t=112+(e>>6&31)<<23|(63&e)<<17;return sm[0]=t,am[0]}function cm(e,t,n,i){const r=[0,0,0,0];for(let o=0;o<i;++o)switch(n){case"8unorm":r[o]=e[t]/255,t++;break;case"8snorm":r[o]=e[t]/255*2-1,t++;break;case"8uint":r[o]=e[t],t++;break;case"8sint":r[o]=e[t]-127,t++;break;case"16uint":r[o]=e[t]|e[t+1]<<8,t+=2;break;case"16sint":r[o]=(e[t]|e[t+1]<<8)-32768,t+=2;break;case"16float":r[o]=tm(e[t]|e[t+1]<<8),t+=2;break;case"32uint":case"32sint":r[o]=e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24,t+=4;break;case"32float":r[o]=new Float32Array(e.buffer,t,1)[0],t+=4}return r}function um(e,t,n,i,r){for(let o=0;o<i;++o)switch(n){case"8unorm":e[t]=255*r[o],t++;break;case"8snorm":e[t]=.5*(r[o]+1)*255,t++;break;case"8uint":e[t]=r[o],t++;break;case"8sint":e[t]=r[o]+127,t++;break;case"16uint":new Uint16Array(e.buffer,t,1)[0]=r[o],t+=2;break;case"16sint":new Int16Array(e.buffer,t,1)[0]=r[o],t+=2;break;case"16float":{const n=om(r[o]);new Uint16Array(e.buffer,t,1)[0]=n,t+=2;break}case"32uint":new Uint32Array(e.buffer,t,1)[0]=r[o],t+=4;break;case"32sint":new Int32Array(e.buffer,t,1)[0]=r[o],t+=4;break;case"32float":new Float32Array(e.buffer,t,1)[0]=r[o],t+=4}return r}const dm={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};class hm{constructor(){this.id=hm._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,t){if(e){t(fm.instance);for(const n of e)n instanceof Array?this.searchBlock(n,t):n.search(t);t(pm.instance)}}constEvaluate(e,t){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}}hm._id=0;class fm extends hm{}fm.instance=new fm;class pm extends hm{}pm.instance=new pm;const mm=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);class gm extends hm{constructor(){super()}}class _m extends gm{constructor(e,t,n,i,r,o){super(),this.calls=new Set,this.name=e,this.args=t,this.returnType=n,this.body=i,this.startLine=r,this.endLine=o}get astNodeType(){return"function"}search(e){if(this.attributes)for(const t of this.attributes)e(t);e(this);for(const t of this.args)e(t);this.searchBlock(this.body,e)}}class ym extends gm{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class vm extends gm{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class bm extends gm{constructor(e,t){super(),this.body=e,this.loopId=t}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class xm extends gm{constructor(e,t,n,i){super(),this.init=e,this.condition=t,this.increment=n,this.body=i}get astNodeType(){return"for"}search(e){var t,n,i;null===(t=this.init)||void 0===t||t.search(e),null===(n=this.condition)||void 0===n||n.search(e),null===(i=this.increment)||void 0===i||i.search(e),this.searchBlock(this.body,e)}}class wm extends gm{constructor(e,t,n,i,r){super(),this.attributes=null,this.name=e,this.type=t,this.storage=n,this.access=i,this.value=r}get astNodeType(){return"var"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}class Sm extends gm{constructor(e,t,n){super(),this.attributes=null,this.name=e,this.type=t,this.value=n}get astNodeType(){return"override"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}}class Em extends gm{constructor(e,t,n,i,r){super(),this.attributes=null,this.name=e,this.type=t,this.storage=n,this.access=i,this.value=r}get astNodeType(){return"let"}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}class Cm extends gm{constructor(e,t,n,i,r){super(),this.attributes=null,this.name=e,this.type=t,this.storage=n,this.access=i,this.value=r}get astNodeType(){return"const"}constEvaluate(e,t){return this.value.constEvaluate(e,t)}search(e){var t;e(this),null===(t=this.value)||void 0===t||t.search(e)}}var Tm,km,Im,Am;(e=>{e.increment="++",e.decrement="--"})(Tm||(Tm={})),(e=>{e.parse=function(t){const n=t;if("parse"==n)throw new Error("Invalid value for IncrementOperator");return e[n]}})(Tm||(Tm={}));class Lm extends gm{constructor(e,t){super(),this.operator=e,this.variable=t}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(e=>{e.assign="=",e.addAssign="+=",e.subtractAssin="-=",e.multiplyAssign="*=",e.divideAssign="/=",e.moduloAssign="%=",e.andAssign="&=",e.orAssign="|=",e.xorAssign="^=",e.shiftLeftAssign="<<=",e.shiftRightAssign=">>="})(km||(km={})),(km||(km={})).parse=function(e){const t=e;if("parse"==t)throw new Error("Invalid value for AssignOperator");return t};class Rm extends gm{constructor(e,t,n){super(),this.operator=e,this.variable=t,this.value=n}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class Pm extends gm{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"call"}isBuiltin(){return mm.has(this.name)}search(e){for(const t of this.args)t.search(e);e(this)}}class Mm extends gm{constructor(e,t){super(),this.body=e,this.continuing=t}get astNodeType(){return"loop"}search(e){var t;this.searchBlock(this.body,e),null===(t=this.continuing)||void 0===t||t.search(e)}}class Dm extends gm{constructor(e,t){super(),this.condition=e,this.cases=t}get astNodeType(){return"switch"}search(e){e(this);for(const t of this.cases)t.search(e)}}class Nm extends gm{constructor(e,t,n,i){super(),this.condition=e,this.body=t,this.elseif=n,this.else=i}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class Fm extends gm{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var t;null===(t=this.value)||void 0===t||t.search(e)}}class Om extends gm{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class Bm extends gm{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class zm extends gm{constructor(e,t){super(),this.severity=e,this.rule=t}get astNodeType(){return"diagnostic"}}class Um extends gm{constructor(e,t){super(),this.name=e,this.type=t}get astNodeType(){return"alias"}}class Vm extends gm{constructor(){super()}get astNodeType(){return"discard"}}class Hm extends gm{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}}let Wm=class extends gm{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}},$m=class e extends gm{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(t){let n=t[0];if("f32"===n.name)return n;for(let i=1;i<t.length;++i){const r=e._priority.get(n.name);e._priority.get(t[i].name)<r&&(n=t[i])}return"x32"===n.name?e.i32:n}getTypeName(){return this.name}};$m.x32=new $m("x32"),$m.f32=new $m("f32"),$m.i32=new $m("i32"),$m.u32=new $m("u32"),$m.f16=new $m("f16"),$m.bool=new $m("bool"),$m.void=new $m("void"),$m._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class Gm extends $m{constructor(e){super(e)}}class jm extends $m{constructor(e,t,n,i){super(e),this.members=t,this.startLine=n,this.endLine=i}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let t=0;t<this.members.length;t++)if(this.members[t].name==e)return t;return-1}search(e){for(const t of this.members)e(t)}}let Ym=class extends $m{constructor(e,t,n){super(e),this.format=t,this.access=n}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(null!==this.format){if("vec2"===e||"vec3"===e||"vec4"===e||"mat2x2"===e||"mat2x3"===e||"mat2x4"===e||"mat3x2"===e||"mat3x3"===e||"mat3x4"===e||"mat4x2"===e||"mat4x3"===e||"mat4x4"===e){if("f32"===this.format.name)return e+="f",e;if("i32"===this.format.name)return e+="i",e;if("u32"===this.format.name)return e+="u",e;if("bool"===this.format.name)return e+="b",e;if("f16"===this.format.name)return e+="h",e}e+=`<${this.format.name}>`}else if("vec2"===e||"vec3"===e||"vec4"===e)return e;return e}};Ym.vec2f=new Ym("vec2",$m.f32,null),Ym.vec3f=new Ym("vec3",$m.f32,null),Ym.vec4f=new Ym("vec4",$m.f32,null),Ym.vec2i=new Ym("vec2",$m.i32,null),Ym.vec3i=new Ym("vec3",$m.i32,null),Ym.vec4i=new Ym("vec4",$m.i32,null),Ym.vec2u=new Ym("vec2",$m.u32,null),Ym.vec3u=new Ym("vec3",$m.u32,null),Ym.vec4u=new Ym("vec4",$m.u32,null),Ym.vec2h=new Ym("vec2",$m.f16,null),Ym.vec3h=new Ym("vec3",$m.f16,null),Ym.vec4h=new Ym("vec4",$m.f16,null),Ym.vec2b=new Ym("vec2",$m.bool,null),Ym.vec3b=new Ym("vec3",$m.bool,null),Ym.vec4b=new Ym("vec4",$m.bool,null),Ym.mat2x2f=new Ym("mat2x2",$m.f32,null),Ym.mat2x3f=new Ym("mat2x3",$m.f32,null),Ym.mat2x4f=new Ym("mat2x4",$m.f32,null),Ym.mat3x2f=new Ym("mat3x2",$m.f32,null),Ym.mat3x3f=new Ym("mat3x3",$m.f32,null),Ym.mat3x4f=new Ym("mat3x4",$m.f32,null),Ym.mat4x2f=new Ym("mat4x2",$m.f32,null),Ym.mat4x3f=new Ym("mat4x3",$m.f32,null),Ym.mat4x4f=new Ym("mat4x4",$m.f32,null),Ym.mat2x2h=new Ym("mat2x2",$m.f16,null),Ym.mat2x3h=new Ym("mat2x3",$m.f16,null),Ym.mat2x4h=new Ym("mat2x4",$m.f16,null),Ym.mat3x2h=new Ym("mat3x2",$m.f16,null),Ym.mat3x3h=new Ym("mat3x3",$m.f16,null),Ym.mat3x4h=new Ym("mat3x4",$m.f16,null),Ym.mat4x2h=new Ym("mat4x2",$m.f16,null),Ym.mat4x3h=new Ym("mat4x3",$m.f16,null),Ym.mat4x4h=new Ym("mat4x4",$m.f16,null),Ym.mat2x2i=new Ym("mat2x2",$m.i32,null),Ym.mat2x3i=new Ym("mat2x3",$m.i32,null),Ym.mat2x4i=new Ym("mat2x4",$m.i32,null),Ym.mat3x2i=new Ym("mat3x2",$m.i32,null),Ym.mat3x3i=new Ym("mat3x3",$m.i32,null),Ym.mat3x4i=new Ym("mat3x4",$m.i32,null),Ym.mat4x2i=new Ym("mat4x2",$m.i32,null),Ym.mat4x3i=new Ym("mat4x3",$m.i32,null),Ym.mat4x4i=new Ym("mat4x4",$m.i32,null),Ym.mat2x2u=new Ym("mat2x2",$m.u32,null),Ym.mat2x3u=new Ym("mat2x3",$m.u32,null),Ym.mat2x4u=new Ym("mat2x4",$m.u32,null),Ym.mat3x2u=new Ym("mat3x2",$m.u32,null),Ym.mat3x3u=new Ym("mat3x3",$m.u32,null),Ym.mat3x4u=new Ym("mat3x4",$m.u32,null),Ym.mat4x2u=new Ym("mat4x2",$m.u32,null),Ym.mat4x3u=new Ym("mat4x3",$m.u32,null),Ym.mat4x4u=new Ym("mat4x4",$m.u32,null);class qm extends $m{constructor(e,t,n,i){super(e),this.storage=t,this.type=n,this.access=i}get astNodeType(){return"pointer"}}class Xm extends $m{constructor(e,t,n,i){super(e),this.attributes=t,this.format=n,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}}class Km extends $m{constructor(e,t,n){super(e),this.format=t,this.access=n}get astNodeType(){return"sampler"}}class Zm extends hm{constructor(){super(),this.postfix=null}}class Qm extends Zm{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}}class Jm extends Zm{constructor(e,t){super(),this.type=e,this.args=t}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const t of this.args)t.search(e)}constEvaluate(e,t){return t&&(t[0]=this.type),e.evalExpression(this,e.context)}}class eg extends Zm{constructor(e,t){super(),this.cachedReturnValue=null,this.name=e,this.args=t}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return mm.has(this.name)}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){for(const t of this.args)t.search(e);e(this)}}class tg extends Zm{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,t){return e.evalExpression(this,e.context)}}class ng extends Zm{constructor(e,t){super(),this.name=e,this.initializer=t}get astNodeType(){return"constExpr"}constEvaluate(e,t){if(this.initializer){const t=e.evalExpression(this.initializer,e.context);return null!==t&&this.postfix?t.getSubData(e,this.postfix,e.context):t}return null}search(e){this.initializer.search(e)}}class ig extends Zm{constructor(e,t){super(),this.value=e,this.type=t}get astNodeType(){return"literalExpr"}constEvaluate(e,t){return void 0!==t&&(t[0]=this.type),this.value}get isScalar(){return this.value instanceof bg}get isVector(){return this.value instanceof wg||this.value instanceof Sg}get scalarValue(){return this.value instanceof bg?this.value.value:0}get vectorValue(){return this.value instanceof wg||this.value instanceof Sg?this.value.data:new Float32Array(0)}}class rg extends Zm{constructor(e,t){super(),this.type=e,this.value=t}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class og extends Zm{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class sg extends Zm{constructor(){super()}}class ag extends sg{constructor(e,t){super(),this.operator=e,this.right=t}get astNodeType(){return"unaryOp"}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class lg extends sg{constructor(e,t,n){super(),this.operator=e,this.left=t,this.right=n}get astNodeType(){return"binaryOp"}_getPromotedType(e,t){return e.name===t.name?e:"f32"===e.name||"f32"===t.name?$m.f32:"u32"===e.name||"u32"===t.name?$m.u32:$m.i32}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class cg extends hm{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}}class ug extends Zm{constructor(){super()}get astNodeType(){return"default"}}class dg extends cg{constructor(e,t){super(t),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class hg extends cg{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class fg extends hm{constructor(e,t,n){super(),this.name=e,this.type=t,this.attributes=n}get astNodeType(){return"argument"}}class pg extends hm{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class mg extends hm{constructor(e,t,n){super(),this.name=e,this.type=t,this.attributes=n}get astNodeType(){return"member"}}class gg extends hm{constructor(e,t){super(),this.name=e,this.value=t}get astNodeType(){return"attribute"}}class _g{constructor(e,t){this.parent=null,this.typeInfo=e,this.parent=t,this.id=_g._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,t,n,i){}getSubData(e,t,n){return null}toString(){return`<${this.typeInfo.getTypeName()}>`}}_g._id=0;class yg extends _g{constructor(){super(new Up("void",null),null)}toString(){return"void"}}yg.void=new yg;class vg extends _g{constructor(e){super(new $p("pointer",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,t,n,i){this.reference.setDataValue(e,t,n,i)}getSubData(e,t,n){return t?this.reference.getSubData(e,t,n):this}toString(){return`&${this.reference.toString()}`}}let bg=class e extends _g{constructor(e,t,n=null){super(t,n),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:"x32"===this.typeInfo.name?e-Math.floor(e)!==0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):"i32"===this.typeInfo.name||"bool"===this.typeInfo.name?this.data=new Int32Array([e]):"u32"===this.typeInfo.name?this.data=new Uint32Array([e]):("f32"===this.typeInfo.name||"f16"===this.typeInfo.name)&&(this.data=new Float32Array([e]))}clone(){if(this.data instanceof Float32Array)return new e(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new e(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new e(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(t,n,i,r){if(i)return;if(!(n instanceof e))return;let o=n.data[0];"i32"===this.typeInfo.name||"u32"===this.typeInfo.name?o=Math.floor(o):"bool"===this.typeInfo.name&&(o=o?1:0),this.data[0]=o}getSubData(e,t,n){return t?null:this}toString(){return`${this.value}`}};function xg(e,t,n){const i=t.length;return 2===i?"f32"===n?new wg(new Float32Array(t),e.getTypeInfo("vec2f")):"i32"===n||"bool"===n?new wg(new Int32Array(t),e.getTypeInfo("vec2i")):"u32"===n?new wg(new Uint32Array(t),e.getTypeInfo("vec2u")):"f16"===n?new wg(new Float32Array(t),e.getTypeInfo("vec2h")):null:3===i?"f32"===n?new wg(new Float32Array(t),e.getTypeInfo("vec3f")):"i32"===n||"bool"===n?new wg(new Int32Array(t),e.getTypeInfo("vec3i")):"u32"===n?new wg(new Uint32Array(t),e.getTypeInfo("vec3u")):"f16"===n?new wg(new Float32Array(t),e.getTypeInfo("vec3h")):null:4===i?"f32"===n?new wg(new Float32Array(t),e.getTypeInfo("vec4f")):"i32"===n||"bool"===n?new wg(new Int32Array(t),e.getTypeInfo("vec4i")):"u32"===n?new wg(new Uint32Array(t),e.getTypeInfo("vec4u")):"f16"===n?new wg(new Float32Array(t),e.getTypeInfo("vec4h")):null:null}let wg=class e extends _g{constructor(e,t,n=null){if(super(t,n),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const t=this.typeInfo.name;"vec2f"===t||"vec3f"===t||"vec4f"===t?this.data=new Float32Array(e):"vec2i"===t||"vec3i"===t||"vec4i"===t?this.data=new Int32Array(e):"vec2u"===t||"vec3u"===t||"vec4u"===t?this.data=new Uint32Array(e):"vec2h"===t||"vec3h"===t||"vec4h"===t?this.data=new Float32Array(e):"vec2b"===t||"vec3b"===t||"vec4b"===t?this.data=new Int32Array(e):("vec2"===t||"vec3"===t||"vec4"===t)&&(this.data=new Float32Array(e))}}clone(){if(this.data instanceof Float32Array)return new e(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new e(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new e(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(t,n,i,r){i instanceof Qm||n instanceof e&&(this.data=n.data)}getSubData(e,t,n){if(null===t)return this;let i=e.getTypeInfo("f32");if(this.typeInfo instanceof Gp)i=this.typeInfo.format||i;else{const t=this.typeInfo.name;"vec2f"===t||"vec3f"===t||"vec4f"===t?i=e.getTypeInfo("f32"):"vec2i"===t||"vec3i"===t||"vec4i"===t?i=e.getTypeInfo("i32"):"vec2b"===t||"vec3b"===t||"vec4b"===t?i=e.getTypeInfo("bool"):"vec2u"===t||"vec3u"===t||"vec4u"===t?i=e.getTypeInfo("u32"):("vec2h"===t||"vec3h"===t||"vec4h"===t)&&(i=e.getTypeInfo("f16"))}let r=this;for(;null!==t&&null!==r;){if(t instanceof og){const o=t.index;let s=-1;if(o instanceof ig){if(!(o.value instanceof bg))return null;s=o.value.value}else{const t=e.evalExpression(o,n);if(!(t instanceof bg))return null;s=t.value}if(s<0||s>=r.data.length)return null;if(r.data instanceof Float32Array){const e=new Float32Array(r.data.buffer,r.data.byteOffset+4*s,1);return new bg(e,i)}if(r.data instanceof Int32Array){const e=new Int32Array(r.data.buffer,r.data.byteOffset+4*s,1);return new bg(e,i)}if(r.data instanceof Uint32Array){const e=new Uint32Array(r.data.buffer,r.data.byteOffset+4*s,1);return new bg(e,i)}throw"GetSubData: Invalid data type"}if(!(t instanceof Qm))return null;{const n=t.value.toLowerCase();if(1===n.length){let e=0;if("x"===n||"r"===n)e=0;else if("y"===n||"g"===n)e=1;else if("z"===n||"b"===n)e=2;else{if("w"!==n&&"a"!==n)return null;e=3}if(this.data instanceof Float32Array){let t=new Float32Array(this.data.buffer,this.data.byteOffset+4*e,1);return new bg(t,i,this)}if(this.data instanceof Int32Array){let t=new Int32Array(this.data.buffer,this.data.byteOffset+4*e,1);return new bg(t,i,this)}if(this.data instanceof Uint32Array){let t=new Uint32Array(this.data.buffer,this.data.byteOffset+4*e,1);return new bg(t,i,this)}}const o=[];for(const e of n)"x"===e||"r"===e?o.push(this.data[0]):"y"===e||"g"===e?o.push(this.data[1]):"z"===e||"b"===e?o.push(this.data[2]):("w"===e||"a"===e)&&o.push(this.data[3]);r=xg(e,o,i.name)}t=t.postfix}return r}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}},Sg=class e extends _g{constructor(e,t,n=null){super(t,n),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new e(new Float32Array(this.data),this.typeInfo,null)}setDataValue(t,n,i,r){i instanceof Qm||n instanceof e&&(this.data=n.data)}getSubData(e,t,n){if(null===t)return this;const i=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof Gp)this.typeInfo.format;else if(i.endsWith("f"))e.getTypeInfo("f32");else if(i.endsWith("i"))e.getTypeInfo("i32");else if(i.endsWith("u"))e.getTypeInfo("u32");else{if(!i.endsWith("h"))return null;e.getTypeInfo("f16")}if(t instanceof og){const r=t.index;let o=-1;if(r instanceof ig){if(!(r.value instanceof bg))return null;o=r.value.value}else{const t=e.evalExpression(r,n);if(!(t instanceof bg))return null;o=t.value}if(o<0||o>=this.data.length)return null;const s=i.endsWith("h")?"h":"f";let a;if("mat2x2"===i||"mat2x2f"===i||"mat2x2h"===i||"mat3x2"===i||"mat3x2f"===i||"mat3x2h"===i||"mat4x2"===i||"mat4x2f"===i||"mat4x2h"===i)a=new wg(new Float32Array(this.data.buffer,this.data.byteOffset+2*o*4,2),e.getTypeInfo(`vec2${s}`));else if("mat2x3"===i||"mat2x3f"===i||"mat2x3h"===i||"mat3x3"===i||"mat3x3f"===i||"mat3x3h"===i||"mat4x3"===i||"mat4x3f"===i||"mat4x3h"===i)a=new wg(new Float32Array(this.data.buffer,this.data.byteOffset+3*o*4,3),e.getTypeInfo(`vec3${s}`));else{if("mat2x4"!==i&&"mat2x4f"!==i&&"mat2x4h"!==i&&"mat3x4"!==i&&"mat3x4f"!==i&&"mat3x4h"!==i&&"mat4x4"!==i&&"mat4x4f"!==i&&"mat4x4h"!==i)return null;a=new wg(new Float32Array(this.data.buffer,this.data.byteOffset+4*o*4,4),e.getTypeInfo(`vec4${s}`))}return t.postfix?a.getSubData(e,t.postfix,n):a}return null}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}};class Eg extends _g{constructor(e,t,n=0,i=null){super(t,i),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=n}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new Eg(e.buffer,this.typeInfo,0,null)}setDataValue(e,t,n,i){if(null===t)return;let r=this.offset,o=this.typeInfo;for(;n;){if(n instanceof og){if(o instanceof Wp){const t=n.index;if(t instanceof ig){if(!(t.value instanceof bg))return;r+=t.value.value*o.stride}else{const n=e.evalExpression(t,i);if(!(n instanceof bg))return;r+=n.value*o.stride}o=o.format}}else{if(!(n instanceof Qm))return;{const e=n.value;if(o instanceof Hp){let t=!1;for(const n of o.members)if(n.name===e){r+=n.offset,o=n.type,t=!0;break}if(!t)return}else if(o instanceof Up){const n=o.getTypeName();let i=0;if("x"===e||"r"===e)i=0;else if("y"===e||"g"===e)i=1;else if("z"===e||"b"===e)i=2;else{if("w"!==e&&"a"!==e)return;i=3}if(!(t instanceof bg))return;const s=t.value;return"vec2f"===n?void(new Float32Array(this.buffer,r,2)[i]=s):"vec3f"===n?void(new Float32Array(this.buffer,r,3)[i]=s):"vec4f"===n?void(new Float32Array(this.buffer,r,4)[i]=s):"vec2i"===n?void(new Int32Array(this.buffer,r,2)[i]=s):"vec3i"===n?void(new Int32Array(this.buffer,r,3)[i]=s):"vec4i"===n?void(new Int32Array(this.buffer,r,4)[i]=s):"vec2u"===n?void(new Uint32Array(this.buffer,r,2)[i]=s):"vec3u"===n?void(new Uint32Array(this.buffer,r,3)[i]=s):"vec4u"===n?void(new Uint32Array(this.buffer,r,4)[i]=s):void 0}}}n=n.postfix}this.setData(e,t,o,r,i)}setData(e,t,n,i,r){const o=n.getTypeName();if("f32"!==o&&"f16"!==o)if("i32"!==o&&"atomic<i32>"!==o&&"x32"!==o)if("u32"!==o&&"atomic<u32>"!==o)if("bool"!==o){if("vec2f"===o||"vec2h"===o){const e=new Float32Array(this.buffer,i,2);return void(t instanceof wg?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3f"===o||"vec3h"===o){const e=new Float32Array(this.buffer,i,3);return void(t instanceof wg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4f"===o||"vec4h"===o){const e=new Float32Array(this.buffer,i,4);return void(t instanceof wg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("vec2i"===o){const e=new Int32Array(this.buffer,i,2);return void(t instanceof wg?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3i"===o){const e=new Int32Array(this.buffer,i,3);return void(t instanceof wg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4i"===o){const e=new Int32Array(this.buffer,i,4);return void(t instanceof wg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("vec2u"===o){const e=new Uint32Array(this.buffer,i,2);return void(t instanceof wg?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3u"===o){const e=new Uint32Array(this.buffer,i,3);return void(t instanceof wg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4u"===o){const e=new Uint32Array(this.buffer,i,4);return void(t instanceof wg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("vec2b"===o){const e=new Uint32Array(this.buffer,i,2);return void(t instanceof wg?(e[0]=t.data[0],e[1]=t.data[1]):(e[0]=t[0],e[1]=t[1]))}if("vec3b"===o){const e=new Uint32Array(this.buffer,i,3);return void(t instanceof wg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2]):(e[0]=t[0],e[1]=t[1],e[2]=t[2]))}if("vec4b"===o){const e=new Uint32Array(this.buffer,i,4);return void(t instanceof wg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("mat2x2f"===o||"mat2x2h"===o){const e=new Float32Array(this.buffer,i,4);return void(t instanceof Sg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]))}if("mat2x3f"===o||"mat2x3h"===o){const e=new Float32Array(this.buffer,i,6);return void(t instanceof Sg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5]))}if("mat2x4f"===o||"mat2x4h"===o){const e=new Float32Array(this.buffer,i,8);return void(t instanceof Sg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7]))}if("mat3x2f"===o||"mat3x2h"===o){const e=new Float32Array(this.buffer,i,6);return void(t instanceof Sg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5]))}if("mat3x3f"===o||"mat3x3h"===o){const e=new Float32Array(this.buffer,i,9);return void(t instanceof Sg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8]))}if("mat3x4f"===o||"mat3x4h"===o){const e=new Float32Array(this.buffer,i,12);return void(t instanceof Sg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8],e[9]=t.data[9],e[10]=t.data[10],e[11]=t.data[11]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11]))}if("mat4x2f"===o||"mat4x2h"===o){const e=new Float32Array(this.buffer,i,8);return void(t instanceof Sg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7]))}if("mat4x3f"===o||"mat4x3h"===o){const e=new Float32Array(this.buffer,i,12);return void(t instanceof Sg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8],e[9]=t.data[9],e[10]=t.data[10],e[11]=t.data[11]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11]))}if("mat4x4f"===o||"mat4x4h"===o){const e=new Float32Array(this.buffer,i,16);return void(t instanceof Sg?(e[0]=t.data[0],e[1]=t.data[1],e[2]=t.data[2],e[3]=t.data[3],e[4]=t.data[4],e[5]=t.data[5],e[6]=t.data[6],e[7]=t.data[7],e[8]=t.data[8],e[9]=t.data[9],e[10]=t.data[10],e[11]=t.data[11],e[12]=t.data[12],e[13]=t.data[13],e[14]=t.data[14],e[15]=t.data[15]):(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]))}if(t instanceof Eg&&n===t.typeInfo)return void new Uint8Array(this.buffer,i,t.buffer.byteLength).set(new Uint8Array(t.buffer))}else t instanceof bg&&(new Int32Array(this.buffer,i,1)[0]=t.value);else t instanceof bg&&(new Uint32Array(this.buffer,i,1)[0]=t.value);else t instanceof bg&&(new Int32Array(this.buffer,i,1)[0]=t.value);else t instanceof bg&&(new Float32Array(this.buffer,i,1)[0]=t.value)}getSubData(e,t,n){var i,r;if(null===t)return this;let o=this.offset,s=this.typeInfo;for(;t;){if(t instanceof og){const i=t.index,r=i instanceof Zm?e.evalExpression(i,n):i;let a=0;if(r instanceof bg?a=r.value:"number"==typeof r&&(a=r),s instanceof Wp)o+=a*s.stride,s=s.format;else{const t=s.getTypeName();("mat4x4"===t||"mat4x4f"===t||"mat4x4h"===t)&&(o+=16*a,s=e.getTypeInfo("vec4f"))}}else{if(!(t instanceof Qm))return null;{const n=t.value;if(s instanceof Hp){let e=!1;for(const t of s.members)if(t.name===n){o+=t.offset,s=t.type,e=!0;break}if(!e)return null}else if(s instanceof Up){const t=s.getTypeName();if("vec2f"===t||"vec3f"===t||"vec4f"===t||"vec2i"===t||"vec3i"===t||"vec4i"===t||"vec2u"===t||"vec3u"===t||"vec4u"===t||"vec2b"===t||"vec3b"===t||"vec4b"===t||"vec2h"===t||"vec3h"===t||"vec4h"===t||"vec2"===t||"vec3"===t||"vec4"===t){if(n.length>0&&n.length<5){let i="f";const r=[];for(let s=0;s<n.length;++s){const a=n[s].toLowerCase();let l=0;if("x"===a||"r"===a)l=0;else if("y"===a||"g"===a)l=1;else if("z"===a||"b"===a)l=2;else{if("w"!==a&&"a"!==a)return null;l=3}if(1===n.length){if(t.endsWith("f"))return this.buffer.byteLength<o+4*l+4?null:new bg(new Float32Array(this.buffer,o+4*l,1),e.getTypeInfo("f32"),this);if(t.endsWith("h"))return new bg(new Float32Array(this.buffer,o+4*l,1),e.getTypeInfo("f16"),this);if(t.endsWith("i"))return new bg(new Int32Array(this.buffer,o+4*l,1),e.getTypeInfo("i32"),this);if(t.endsWith("b"))return new bg(new Int32Array(this.buffer,o+4*l,1),e.getTypeInfo("bool"),this);if(t.endsWith("u"))return new bg(new Uint32Array(this.buffer,o+4*l,1),e.getTypeInfo("i32"),this)}if("vec2f"===t)r.push(new Float32Array(this.buffer,o,2)[l]);else if("vec3f"===t){if(o+12>=this.buffer.byteLength)return null;const e=new Float32Array(this.buffer,o,3);r.push(e[l])}else if("vec4f"===t)r.push(new Float32Array(this.buffer,o,4)[l]);else if("vec2i"===t)i="i",r.push(new Int32Array(this.buffer,o,2)[l]);else if("vec3i"===t)i="i",r.push(new Int32Array(this.buffer,o,3)[l]);else if("vec4i"===t)i="i",r.push(new Int32Array(this.buffer,o,4)[l]);else if("vec2u"===t){i="u";const e=new Uint32Array(this.buffer,o,2);r.push(e[l])}else"vec3u"===t?(i="u",r.push(new Uint32Array(this.buffer,o,3)[l])):"vec4u"===t&&(i="u",r.push(new Uint32Array(this.buffer,o,4)[l]))}return 2===r.length?s=e.getTypeInfo(`vec2${i}`):3===r.length?s=e.getTypeInfo(`vec3${i}`):4===r.length&&(s=e.getTypeInfo(`vec4${i}`)),new wg(r,s,null)}return null}return null}}}t=t.postfix}const a=s.getTypeName();return"f32"===a?new bg(new Float32Array(this.buffer,o,1),s,this):"i32"===a?new bg(new Int32Array(this.buffer,o,1),s,this):"u32"===a?new bg(new Uint32Array(this.buffer,o,1),s,this):"vec2f"===a?new wg(new Float32Array(this.buffer,o,2),s,this):"vec3f"===a?new wg(new Float32Array(this.buffer,o,3),s,this):"vec4f"===a?new wg(new Float32Array(this.buffer,o,4),s,this):"vec2i"===a?new wg(new Int32Array(this.buffer,o,2),s,this):"vec3i"===a?new wg(new Int32Array(this.buffer,o,3),s,this):"vec4i"===a?new wg(new Int32Array(this.buffer,o,4),s,this):"vec2u"===a?new wg(new Uint32Array(this.buffer,o,2),s,this):"vec3u"===a?new wg(new Uint32Array(this.buffer,o,3),s,this):"vec4u"===a?new wg(new Uint32Array(this.buffer,o,4),s,this):s instanceof Gp&&"atomic"===s.name?"u32"===(null===(i=s.format)||void 0===i?void 0:i.name)?new bg(new Uint32Array(this.buffer,o,1)[0],s.format,this):"i32"===(null===(r=s.format)||void 0===r?void 0:r.name)?new bg(new Int32Array(this.buffer,o,1)[0],s.format,this):null:new Eg(this.buffer,s,o,this)}toString(){let e="";if(this.typeInfo instanceof Wp)if("f32"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let n=1;n<t.length;++n)e+=`, ${t[n]}`}else if("i32"===this.typeInfo.format.name){const t=new Int32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let n=1;n<t.length;++n)e+=`, ${t[n]}`}else if("u32"===this.typeInfo.format.name){const t=new Uint32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let n=1;n<t.length;++n)e+=`, ${t[n]}`}else if("vec2f"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}]`;for(let n=1;n<t.length/2;++n)e+=`, [${t[2*n]}, ${t[2*n+1]}]`}else if("vec3f"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}]`;for(let n=4;n<t.length;n+=4)e+=`, [${t[n]}, ${t[n+1]}, ${t[n+2]}]`}else if("vec4f"===this.typeInfo.format.name){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}]`;for(let n=4;n<t.length;n+=4)e+=`, [${t[n]}, ${t[n+1]}, ${t[n+2]}, ${t[n+3]}]`}else e="[...]";else this.typeInfo instanceof Hp?e+="{...}":e="[...]";return e}}class Cg extends _g{constructor(e,t,n,i){super(t,null),this.data=e,this.descriptor=n,this.view=i}clone(){return new Cg(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,t;const n=this.descriptor.size;return n instanceof Array&&n.length>0?null!==(e=n[0])&&void 0!==e?e:0:n instanceof Object&&null!==(t=n.width)&&void 0!==t?t:0}get height(){var e,t;const n=this.descriptor.size;return n instanceof Array&&n.length>1?null!==(e=n[1])&&void 0!==e?e:0:n instanceof Object&&null!==(t=n.height)&&void 0!==t?t:0}get depthOrArrayLayers(){var e,t;const n=this.descriptor.size;return n instanceof Array&&n.length>2?null!==(e=n[2])&&void 0!==e?e:0:n instanceof Object&&null!==(t=n.depthOrArrayLayers)&&void 0!==t?t:0}get format(){var e;return this.descriptor&&null!==(e=this.descriptor.format)&&void 0!==e?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&null!==(e=this.descriptor.sampleCount)&&void 0!==e?e:1}get mipLevelCount(){var e;return this.descriptor&&null!==(e=this.descriptor.mipLevelCount)&&void 0!==e?e:1}get dimension(){var e;return this.descriptor&&null!==(e=this.descriptor.dimension)&&void 0!==e?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const t=[this.width,this.height,this.depthOrArrayLayers];for(let n=0;n<t.length;++n)t[n]=Math.max(1,t[n]>>e);return t}get texelByteSize(){const e=this.format,t=dm[e];return t?t.isDepthStencil?4:t.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,t=dm[e];return!!t&&t.isDepthStencil}getGpuSize(){const e=this.format,t=dm[e],n=this.width;if(!e||n<=0||!t)return-1;const i=this.height,r=this.depthOrArrayLayers,o=this.dimension;return n/t.blockWidth*("1d"===o?1:i/t.blockHeight)*t.bytesPerBlock*r}getPixel(e,t,n=0,i=0){const r=this.texelByteSize,o=this.bytesPerRow,s=this.height,a=this.data[i];return function(e,t,n,i,r,o,s,a,l){const c=i*(s>>=r)*(o>>=r)+n*s+t*a;switch(l){case"r8unorm":return[cm(e,c,"8unorm",1)[0]];case"r8snorm":return[cm(e,c,"8snorm",1)[0]];case"r8uint":return[cm(e,c,"8uint",1)[0]];case"r8sint":return[cm(e,c,"8sint",1)[0]];case"rg8unorm":{const t=cm(e,c,"8unorm",2);return[t[0],t[1]]}case"rg8snorm":{const t=cm(e,c,"8snorm",2);return[t[0],t[1]]}case"rg8uint":{const t=cm(e,c,"8uint",2);return[t[0],t[1]]}case"rg8sint":{const t=cm(e,c,"8sint",2);return[t[0],t[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const t=cm(e,c,"8unorm",4);return[t[0],t[1],t[2],t[3]]}case"rgba8snorm":{const t=cm(e,c,"8snorm",4);return[t[0],t[1],t[2],t[3]]}case"rgba8uint":{const t=cm(e,c,"8uint",4);return[t[0],t[1],t[2],t[3]]}case"rgba8sint":{const t=cm(e,c,"8sint",4);return[t[0],t[1],t[2],t[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const t=cm(e,c,"8unorm",4);return[t[2],t[1],t[0],t[3]]}case"r16uint":return[cm(e,c,"16uint",1)[0]];case"r16sint":return[cm(e,c,"16sint",1)[0]];case"r16float":return[cm(e,c,"16float",1)[0]];case"rg16uint":{const t=cm(e,c,"16uint",2);return[t[0],t[1]]}case"rg16sint":{const t=cm(e,c,"16sint",2);return[t[0],t[1]]}case"rg16float":{const t=cm(e,c,"16float",2);return[t[0],t[1]]}case"rgba16uint":{const t=cm(e,c,"16uint",4);return[t[0],t[1],t[2],t[3]]}case"rgba16sint":{const t=cm(e,c,"16sint",4);return[t[0],t[1],t[2],t[3]]}case"rgba16float":{const t=cm(e,c,"16float",4);return[t[0],t[1],t[2],t[3]]}case"r32uint":return[cm(e,c,"32uint",1)[0]];case"r32sint":return[cm(e,c,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[cm(e,c,"32float",1)[0]];case"rg32uint":{const t=cm(e,c,"32uint",2);return[t[0],t[1]]}case"rg32sint":{const t=cm(e,c,"32sint",2);return[t[0],t[1]]}case"rg32float":{const t=cm(e,c,"32float",2);return[t[0],t[1]]}case"rgba32uint":{const t=cm(e,c,"32uint",4);return[t[0],t[1],t[2],t[3]]}case"rgba32sint":{const t=cm(e,c,"32sint",4);return[t[0],t[1],t[2],t[3]]}case"rgba32float":{const t=cm(e,c,"32float",4);return[t[0],t[1],t[2],t[3]]}case"rg11b10ufloat":{const t=new Uint32Array(e.buffer,c,1)[0],n=(4192256&t)>>11,i=(4290772992&t)>>22;return[lm(2047&t),lm(n),function(e){const t=112+(e>>5&31)<<23|(31&e)<<18;return sm[0]=t,am[0]}(i),1]}}return null}(new Uint8Array(a),e,t,n,i,s,o,r,this.format)}setPixel(e,t,n,i,r){const o=this.texelByteSize,s=this.bytesPerRow,a=this.height,l=this.data[i];!function(e,t,n,i,r,o,s,a,l,c){const u=i*(s>>=r)*(o>>=r)+n*s+t*a;switch(l){case"r8unorm":return void um(e,u,"8unorm",1,c);case"r8snorm":return void um(e,u,"8snorm",1,c);case"r8uint":return void um(e,u,"8uint",1,c);case"r8sint":return void um(e,u,"8sint",1,c);case"rg8unorm":return void um(e,u,"8unorm",2,c);case"rg8snorm":return void um(e,u,"8snorm",2,c);case"rg8uint":return void um(e,u,"8uint",2,c);case"rg8sint":return void um(e,u,"8sint",2,c);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void um(e,u,"8unorm",4,c);case"rgba8snorm":return void um(e,u,"8snorm",4,c);case"rgba8uint":return void um(e,u,"8uint",4,c);case"rgba8sint":return void um(e,u,"8sint",4,c);case"r16uint":return void um(e,u,"16uint",1,c);case"r16sint":return void um(e,u,"16sint",1,c);case"r16float":return void um(e,u,"16float",1,c);case"rg16uint":return void um(e,u,"16uint",2,c);case"rg16sint":return void um(e,u,"16sint",2,c);case"rg16float":return void um(e,u,"16float",2,c);case"rgba16uint":return void um(e,u,"16uint",4,c);case"rgba16sint":return void um(e,u,"16sint",4,c);case"rgba16float":return void um(e,u,"16float",4,c);case"r32uint":return void um(e,u,"32uint",1,c);case"r32sint":return void um(e,u,"32sint",1,c);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void um(e,u,"32float",1,c);case"rg32uint":return void um(e,u,"32uint",2,c);case"rg32sint":return void um(e,u,"32sint",2,c);case"rg32float":return void um(e,u,"32float",2,c);case"rgba32uint":return void um(e,u,"32uint",4,c);case"rgba32sint":return void um(e,u,"32sint",4,c);case"rgba32float":um(e,u,"32float",4,c)}}(new Uint8Array(l),e,t,n,i,a,s,o,this.format,r)}}(e=>{e[e.token=0]="token",e[e.keyword=1]="keyword",e[e.reserved=2]="reserved"})(Am||(Am={}));let Tg=class{constructor(e,t,n){this.name=e,this.type=t,this.rule=n}toString(){return this.name}},kg=class{};Im=kg,kg.none=new Tg("",Am.reserved,""),kg.eof=new Tg("EOF",Am.token,""),kg.reserved={asm:new Tg("asm",Am.reserved,"asm"),bf16:new Tg("bf16",Am.reserved,"bf16"),do:new Tg("do",Am.reserved,"do"),enum:new Tg("enum",Am.reserved,"enum"),f16:new Tg("f16",Am.reserved,"f16"),f64:new Tg("f64",Am.reserved,"f64"),handle:new Tg("handle",Am.reserved,"handle"),i8:new Tg("i8",Am.reserved,"i8"),i16:new Tg("i16",Am.reserved,"i16"),i64:new Tg("i64",Am.reserved,"i64"),mat:new Tg("mat",Am.reserved,"mat"),premerge:new Tg("premerge",Am.reserved,"premerge"),regardless:new Tg("regardless",Am.reserved,"regardless"),typedef:new Tg("typedef",Am.reserved,"typedef"),u8:new Tg("u8",Am.reserved,"u8"),u16:new Tg("u16",Am.reserved,"u16"),u64:new Tg("u64",Am.reserved,"u64"),unless:new Tg("unless",Am.reserved,"unless"),using:new Tg("using",Am.reserved,"using"),vec:new Tg("vec",Am.reserved,"vec"),void:new Tg("void",Am.reserved,"void")},kg.keywords={array:new Tg("array",Am.keyword,"array"),atomic:new Tg("atomic",Am.keyword,"atomic"),bool:new Tg("bool",Am.keyword,"bool"),f32:new Tg("f32",Am.keyword,"f32"),i32:new Tg("i32",Am.keyword,"i32"),mat2x2:new Tg("mat2x2",Am.keyword,"mat2x2"),mat2x3:new Tg("mat2x3",Am.keyword,"mat2x3"),mat2x4:new Tg("mat2x4",Am.keyword,"mat2x4"),mat3x2:new Tg("mat3x2",Am.keyword,"mat3x2"),mat3x3:new Tg("mat3x3",Am.keyword,"mat3x3"),mat3x4:new Tg("mat3x4",Am.keyword,"mat3x4"),mat4x2:new Tg("mat4x2",Am.keyword,"mat4x2"),mat4x3:new Tg("mat4x3",Am.keyword,"mat4x3"),mat4x4:new Tg("mat4x4",Am.keyword,"mat4x4"),ptr:new Tg("ptr",Am.keyword,"ptr"),sampler:new Tg("sampler",Am.keyword,"sampler"),sampler_comparison:new Tg("sampler_comparison",Am.keyword,"sampler_comparison"),struct:new Tg("struct",Am.keyword,"struct"),texture_1d:new Tg("texture_1d",Am.keyword,"texture_1d"),texture_2d:new Tg("texture_2d",Am.keyword,"texture_2d"),texture_2d_array:new Tg("texture_2d_array",Am.keyword,"texture_2d_array"),texture_3d:new Tg("texture_3d",Am.keyword,"texture_3d"),texture_cube:new Tg("texture_cube",Am.keyword,"texture_cube"),texture_cube_array:new Tg("texture_cube_array",Am.keyword,"texture_cube_array"),texture_multisampled_2d:new Tg("texture_multisampled_2d",Am.keyword,"texture_multisampled_2d"),texture_storage_1d:new Tg("texture_storage_1d",Am.keyword,"texture_storage_1d"),texture_storage_2d:new Tg("texture_storage_2d",Am.keyword,"texture_storage_2d"),texture_storage_2d_array:new Tg("texture_storage_2d_array",Am.keyword,"texture_storage_2d_array"),texture_storage_3d:new Tg("texture_storage_3d",Am.keyword,"texture_storage_3d"),texture_depth_2d:new Tg("texture_depth_2d",Am.keyword,"texture_depth_2d"),texture_depth_2d_array:new Tg("texture_depth_2d_array",Am.keyword,"texture_depth_2d_array"),texture_depth_cube:new Tg("texture_depth_cube",Am.keyword,"texture_depth_cube"),texture_depth_cube_array:new Tg("texture_depth_cube_array",Am.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new Tg("texture_depth_multisampled_2d",Am.keyword,"texture_depth_multisampled_2d"),texture_external:new Tg("texture_external",Am.keyword,"texture_external"),u32:new Tg("u32",Am.keyword,"u32"),vec2:new Tg("vec2",Am.keyword,"vec2"),vec3:new Tg("vec3",Am.keyword,"vec3"),vec4:new Tg("vec4",Am.keyword,"vec4"),bitcast:new Tg("bitcast",Am.keyword,"bitcast"),block:new Tg("block",Am.keyword,"block"),break:new Tg("break",Am.keyword,"break"),case:new Tg("case",Am.keyword,"case"),continue:new Tg("continue",Am.keyword,"continue"),continuing:new Tg("continuing",Am.keyword,"continuing"),default:new Tg("default",Am.keyword,"default"),diagnostic:new Tg("diagnostic",Am.keyword,"diagnostic"),discard:new Tg("discard",Am.keyword,"discard"),else:new Tg("else",Am.keyword,"else"),enable:new Tg("enable",Am.keyword,"enable"),fallthrough:new Tg("fallthrough",Am.keyword,"fallthrough"),false:new Tg("false",Am.keyword,"false"),fn:new Tg("fn",Am.keyword,"fn"),for:new Tg("for",Am.keyword,"for"),function:new Tg("function",Am.keyword,"function"),if:new Tg("if",Am.keyword,"if"),let:new Tg("let",Am.keyword,"let"),const:new Tg("const",Am.keyword,"const"),loop:new Tg("loop",Am.keyword,"loop"),while:new Tg("while",Am.keyword,"while"),private:new Tg("private",Am.keyword,"private"),read:new Tg("read",Am.keyword,"read"),read_write:new Tg("read_write",Am.keyword,"read_write"),return:new Tg("return",Am.keyword,"return"),requires:new Tg("requires",Am.keyword,"requires"),storage:new Tg("storage",Am.keyword,"storage"),switch:new Tg("switch",Am.keyword,"switch"),true:new Tg("true",Am.keyword,"true"),alias:new Tg("alias",Am.keyword,"alias"),type:new Tg("type",Am.keyword,"type"),uniform:new Tg("uniform",Am.keyword,"uniform"),var:new Tg("var",Am.keyword,"var"),override:new Tg("override",Am.keyword,"override"),workgroup:new Tg("workgroup",Am.keyword,"workgroup"),write:new Tg("write",Am.keyword,"write"),r8unorm:new Tg("r8unorm",Am.keyword,"r8unorm"),r8snorm:new Tg("r8snorm",Am.keyword,"r8snorm"),r8uint:new Tg("r8uint",Am.keyword,"r8uint"),r8sint:new Tg("r8sint",Am.keyword,"r8sint"),r16uint:new Tg("r16uint",Am.keyword,"r16uint"),r16sint:new Tg("r16sint",Am.keyword,"r16sint"),r16float:new Tg("r16float",Am.keyword,"r16float"),rg8unorm:new Tg("rg8unorm",Am.keyword,"rg8unorm"),rg8snorm:new Tg("rg8snorm",Am.keyword,"rg8snorm"),rg8uint:new Tg("rg8uint",Am.keyword,"rg8uint"),rg8sint:new Tg("rg8sint",Am.keyword,"rg8sint"),r32uint:new Tg("r32uint",Am.keyword,"r32uint"),r32sint:new Tg("r32sint",Am.keyword,"r32sint"),r32float:new Tg("r32float",Am.keyword,"r32float"),rg16uint:new Tg("rg16uint",Am.keyword,"rg16uint"),rg16sint:new Tg("rg16sint",Am.keyword,"rg16sint"),rg16float:new Tg("rg16float",Am.keyword,"rg16float"),rgba8unorm:new Tg("rgba8unorm",Am.keyword,"rgba8unorm"),rgba8unorm_srgb:new Tg("rgba8unorm_srgb",Am.keyword,"rgba8unorm_srgb"),rgba8snorm:new Tg("rgba8snorm",Am.keyword,"rgba8snorm"),rgba8uint:new Tg("rgba8uint",Am.keyword,"rgba8uint"),rgba8sint:new Tg("rgba8sint",Am.keyword,"rgba8sint"),bgra8unorm:new Tg("bgra8unorm",Am.keyword,"bgra8unorm"),bgra8unorm_srgb:new Tg("bgra8unorm_srgb",Am.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new Tg("rgb10a2unorm",Am.keyword,"rgb10a2unorm"),rg11b10float:new Tg("rg11b10float",Am.keyword,"rg11b10float"),rg32uint:new Tg("rg32uint",Am.keyword,"rg32uint"),rg32sint:new Tg("rg32sint",Am.keyword,"rg32sint"),rg32float:new Tg("rg32float",Am.keyword,"rg32float"),rgba16uint:new Tg("rgba16uint",Am.keyword,"rgba16uint"),rgba16sint:new Tg("rgba16sint",Am.keyword,"rgba16sint"),rgba16float:new Tg("rgba16float",Am.keyword,"rgba16float"),rgba32uint:new Tg("rgba32uint",Am.keyword,"rgba32uint"),rgba32sint:new Tg("rgba32sint",Am.keyword,"rgba32sint"),rgba32float:new Tg("rgba32float",Am.keyword,"rgba32float"),static_assert:new Tg("static_assert",Am.keyword,"static_assert")},kg.tokens={decimal_float_literal:new Tg("decimal_float_literal",Am.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new Tg("hex_float_literal",Am.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new Tg("int_literal",Am.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new Tg("uint_literal",Am.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new Tg("name",Am.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new Tg("ident",Am.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new Tg("and",Am.token,"&"),and_and:new Tg("and_and",Am.token,"&&"),arrow:new Tg("arrow ",Am.token,"->"),attr:new Tg("attr",Am.token,"@"),forward_slash:new Tg("forward_slash",Am.token,"/"),bang:new Tg("bang",Am.token,"!"),bracket_left:new Tg("bracket_left",Am.token,"["),bracket_right:new Tg("bracket_right",Am.token,"]"),brace_left:new Tg("brace_left",Am.token,"{"),brace_right:new Tg("brace_right",Am.token,"}"),colon:new Tg("colon",Am.token,":"),comma:new Tg("comma",Am.token,","),equal:new Tg("equal",Am.token,"="),equal_equal:new Tg("equal_equal",Am.token,"=="),not_equal:new Tg("not_equal",Am.token,"!="),greater_than:new Tg("greater_than",Am.token,">"),greater_than_equal:new Tg("greater_than_equal",Am.token,">="),shift_right:new Tg("shift_right",Am.token,">>"),less_than:new Tg("less_than",Am.token,"<"),less_than_equal:new Tg("less_than_equal",Am.token,"<="),shift_left:new Tg("shift_left",Am.token,"<<"),modulo:new Tg("modulo",Am.token,"%"),minus:new Tg("minus",Am.token,"-"),minus_minus:new Tg("minus_minus",Am.token,"--"),period:new Tg("period",Am.token,"."),plus:new Tg("plus",Am.token,"+"),plus_plus:new Tg("plus_plus",Am.token,"++"),or:new Tg("or",Am.token,"|"),or_or:new Tg("or_or",Am.token,"||"),paren_left:new Tg("paren_left",Am.token,"("),paren_right:new Tg("paren_right",Am.token,")"),semicolon:new Tg("semicolon",Am.token,";"),star:new Tg("star",Am.token,"*"),tilde:new Tg("tilde",Am.token,"~"),underscore:new Tg("underscore",Am.token,"_"),xor:new Tg("xor",Am.token,"^"),plus_equal:new Tg("plus_equal",Am.token,"+="),minus_equal:new Tg("minus_equal",Am.token,"-="),times_equal:new Tg("times_equal",Am.token,"*="),division_equal:new Tg("division_equal",Am.token,"/="),modulo_equal:new Tg("modulo_equal",Am.token,"%="),and_equal:new Tg("and_equal",Am.token,"&="),or_equal:new Tg("or_equal",Am.token,"|="),xor_equal:new Tg("xor_equal",Am.token,"^="),shift_right_equal:new Tg("shift_right_equal",Am.token,">>="),shift_left_equal:new Tg("shift_left_equal",Am.token,"<<=")},kg.simpleTokens={"@":Im.tokens.attr,"{":Im.tokens.brace_left,"}":Im.tokens.brace_right,":":Im.tokens.colon,",":Im.tokens.comma,"(":Im.tokens.paren_left,")":Im.tokens.paren_right,";":Im.tokens.semicolon},kg.literalTokens={"&":Im.tokens.and,"&&":Im.tokens.and_and,"->":Im.tokens.arrow,"/":Im.tokens.forward_slash,"!":Im.tokens.bang,"[":Im.tokens.bracket_left,"]":Im.tokens.bracket_right,"=":Im.tokens.equal,"==":Im.tokens.equal_equal,"!=":Im.tokens.not_equal,">":Im.tokens.greater_than,">=":Im.tokens.greater_than_equal,">>":Im.tokens.shift_right,"<":Im.tokens.less_than,"<=":Im.tokens.less_than_equal,"<<":Im.tokens.shift_left,"%":Im.tokens.modulo,"-":Im.tokens.minus,"--":Im.tokens.minus_minus,".":Im.tokens.period,"+":Im.tokens.plus,"++":Im.tokens.plus_plus,"|":Im.tokens.or,"||":Im.tokens.or_or,"*":Im.tokens.star,"~":Im.tokens.tilde,_:Im.tokens.underscore,"^":Im.tokens.xor,"+=":Im.tokens.plus_equal,"-=":Im.tokens.minus_equal,"*=":Im.tokens.times_equal,"/=":Im.tokens.division_equal,"%=":Im.tokens.modulo_equal,"&=":Im.tokens.and_equal,"|=":Im.tokens.or_equal,"^=":Im.tokens.xor_equal,">>=":Im.tokens.shift_right_equal,"<<=":Im.tokens.shift_left_equal},kg.regexTokens={decimal_float_literal:Im.tokens.decimal_float_literal,hex_float_literal:Im.tokens.hex_float_literal,int_literal:Im.tokens.int_literal,uint_literal:Im.tokens.uint_literal,ident:Im.tokens.ident},kg.storage_class=[Im.keywords.function,Im.keywords.private,Im.keywords.workgroup,Im.keywords.uniform,Im.keywords.storage],kg.access_mode=[Im.keywords.read,Im.keywords.write,Im.keywords.read_write],kg.sampler_type=[Im.keywords.sampler,Im.keywords.sampler_comparison],kg.sampled_texture_type=[Im.keywords.texture_1d,Im.keywords.texture_2d,Im.keywords.texture_2d_array,Im.keywords.texture_3d,Im.keywords.texture_cube,Im.keywords.texture_cube_array],kg.multisampled_texture_type=[Im.keywords.texture_multisampled_2d],kg.storage_texture_type=[Im.keywords.texture_storage_1d,Im.keywords.texture_storage_2d,Im.keywords.texture_storage_2d_array,Im.keywords.texture_storage_3d],kg.depth_texture_type=[Im.keywords.texture_depth_2d,Im.keywords.texture_depth_2d_array,Im.keywords.texture_depth_cube,Im.keywords.texture_depth_cube_array,Im.keywords.texture_depth_multisampled_2d],kg.texture_external_type=[Im.keywords.texture_external],kg.any_texture_type=[...Im.sampled_texture_type,...Im.multisampled_texture_type,...Im.storage_texture_type,...Im.depth_texture_type,...Im.texture_external_type],kg.texel_format=[Im.keywords.r8unorm,Im.keywords.r8snorm,Im.keywords.r8uint,Im.keywords.r8sint,Im.keywords.r16uint,Im.keywords.r16sint,Im.keywords.r16float,Im.keywords.rg8unorm,Im.keywords.rg8snorm,Im.keywords.rg8uint,Im.keywords.rg8sint,Im.keywords.r32uint,Im.keywords.r32sint,Im.keywords.r32float,Im.keywords.rg16uint,Im.keywords.rg16sint,Im.keywords.rg16float,Im.keywords.rgba8unorm,Im.keywords.rgba8unorm_srgb,Im.keywords.rgba8snorm,Im.keywords.rgba8uint,Im.keywords.rgba8sint,Im.keywords.bgra8unorm,Im.keywords.bgra8unorm_srgb,Im.keywords.rgb10a2unorm,Im.keywords.rg11b10float,Im.keywords.rg32uint,Im.keywords.rg32sint,Im.keywords.rg32float,Im.keywords.rgba16uint,Im.keywords.rgba16sint,Im.keywords.rgba16float,Im.keywords.rgba32uint,Im.keywords.rgba32sint,Im.keywords.rgba32float],kg.const_literal=[Im.tokens.int_literal,Im.tokens.uint_literal,Im.tokens.decimal_float_literal,Im.tokens.hex_float_literal,Im.keywords.true,Im.keywords.false],kg.literal_or_ident=[Im.tokens.ident,Im.tokens.int_literal,Im.tokens.uint_literal,Im.tokens.decimal_float_literal,Im.tokens.hex_float_literal,Im.tokens.name],kg.element_count_expression=[Im.tokens.int_literal,Im.tokens.uint_literal,Im.tokens.ident],kg.template_types=[Im.keywords.vec2,Im.keywords.vec3,Im.keywords.vec4,Im.keywords.mat2x2,Im.keywords.mat2x3,Im.keywords.mat2x4,Im.keywords.mat3x2,Im.keywords.mat3x3,Im.keywords.mat3x4,Im.keywords.mat4x2,Im.keywords.mat4x3,Im.keywords.mat4x4,Im.keywords.atomic,Im.keywords.bitcast,...Im.any_texture_type],kg.attribute_name=[Im.tokens.ident,Im.keywords.block,Im.keywords.diagnostic],kg.assignment_operators=[Im.tokens.equal,Im.tokens.plus_equal,Im.tokens.minus_equal,Im.tokens.times_equal,Im.tokens.division_equal,Im.tokens.modulo_equal,Im.tokens.and_equal,Im.tokens.or_equal,Im.tokens.xor_equal,Im.tokens.shift_right_equal,Im.tokens.shift_left_equal],kg.increment_operators=[Im.tokens.plus_plus,Im.tokens.minus_minus];class Ig{constructor(e,t,n,i,r){this.type=e,this.lexeme=t,this.line=n,this.start=i,this.end=r}toString(){return this.lexeme}isTemplateType(){return-1!=kg.template_types.indexOf(this.type)}isArrayType(){return this.type==kg.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class Ag{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new Ig(kg.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if("\n"==e)return this._line++,!0;if(this._isWhitespace(e))return!0;if("/"==e){if("/"==this._peekAhead()){for(;"\n"!=e;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if("*"==this._peekAhead()){this._advance();let t=1;for(;t>0;){if(this._isAtEnd())return!0;if(e=this._advance(),"\n"==e)this._line++;else if("*"==e){if("/"==this._peekAhead()&&(this._advance(),t--,0==t))return!0}else"/"==e&&"*"==this._peekAhead()&&(this._advance(),t++)}return!0}}const t=kg.simpleTokens[e];if(t)return this._addToken(t),!0;let n=kg.none;const i=this._isAlpha(e),r="_"===e;if(this._isAlphaNumeric(e)){let t=this._peekAhead();for(;this._isAlphaNumeric(t);)e+=this._advance(),t=this._peekAhead()}if(i){const t=kg.keywords[e];if(t)return this._addToken(t),!0}if(i||r)return this._addToken(kg.tokens.ident),!0;for(;;){let t=this._findType(e);const i=this._peekAhead();if("-"==e&&this._tokens.length>0){if("="==i)return this._current++,e+=i,this._addToken(kg.tokens.minus_equal),!0;if("-"==i)return this._current++,e+=i,this._addToken(kg.tokens.minus_minus),!0;const n=this._tokens.length-1;if((-1!=kg.literal_or_ident.indexOf(this._tokens[n].type)||this._tokens[n].type==kg.tokens.paren_right)&&">"!=i)return this._addToken(t),!0}if(">"==e&&(">"==i||"="==i)){let e=!1,n=this._tokens.length-1;for(let t=0;t<5&&n>=0&&-1===kg.assignment_operators.indexOf(this._tokens[n].type);++t,--n)if(this._tokens[n].type===kg.tokens.less_than){n>0&&this._tokens[n-1].isArrayOrTemplateType()&&(e=!0);break}if(e)return this._addToken(t),!0}if(t===kg.none){let i=e,r=0;const o=2;for(let e=0;e<o;++e)if(i+=this._peekAhead(e),t=this._findType(i),t!==kg.none){r=e;break}if(t===kg.none)return n!==kg.none&&(this._current--,this._addToken(n),!0);e=i,this._current+=r+1}if(n=t,this._isAtEnd())break;e+=this._advance()}return n!==kg.none&&(this._addToken(n),!0)}_findType(e){for(const t in kg.regexTokens){const n=kg.regexTokens[t];if(this._match(e,n.rule))return n}return kg.literalTokens[e]||kg.none}_match(e,t){const n=t.exec(e);return n&&0==n.index&&n[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&"_"!==e&&"."!==e&&"("!==e&&")"!==e&&"["!==e&&"]"!==e&&"{"!==e&&"}"!==e&&","!==e&&";"!==e&&":"!==e&&"="!==e&&"!"!==e&&"<"!==e&&">"!==e&&"+"!==e&&"-"!==e&&"*"!==e&&"/"!==e&&"%"!==e&&"&"!==e&&"|"!==e&&"^"!==e&&"~"!==e&&"@"!==e&&"#"!==e&&"?"!==e&&"'"!==e&&"`"!==e&&'"'!==e&&"\\"!==e&&"\n"!==e&&"\r"!==e&&"\t"!==e&&"\0"!==e}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||"_"===e}_isWhitespace(e){return" "==e||"\t"==e||"\r"==e}_advance(e=0){let t=this._source[this._current];return e=e||0,e++,this._current+=e,t}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const t=this._source.substring(this._start,this._current);this._tokens.push(new Ig(e,t,this._line,this._start,this._current))}}function Lg(e){return Array.isArray(e)||(null==e?void 0:e.buffer)instanceof ArrayBuffer}const Rg=new Float32Array(1),Pg=new Uint32Array(Rg.buffer),Mg=new Uint32Array(Rg.buffer),Dg=new Int32Array(1),Ng=new Float32Array(Dg.buffer),Fg=new Uint32Array(Dg.buffer),Og=new Uint32Array(1),Bg=new Float32Array(Og.buffer),zg=new Int32Array(Og.buffer);function Ug(e,t,n){if(t===n)return e;if("f32"===t){if("i32"===n||"x32"===n)return Rg[0]=e,Pg[0];if("u32"===n)return Rg[0]=e,Mg[0]}else if("i32"===t||"x32"===t){if("f32"===n)return Dg[0]=e,Ng[0];if("u32"===n)return Dg[0]=e,Fg[0]}else if("u32"===t){if("f32"===n)return Og[0]=e,Bg[0];if("i32"===n||"x32"===n)return Og[0]=e,zg[0]}return e}class Vg{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class Hg{constructor(e,t){this.align=e,this.size=t}}class Wg{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new em,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return"texture_storage_1d"==e.name||"texture_storage_2d"==e.name||"texture_storage_2d_array"==e.name||"texture_storage_3d"==e.name}updateAST(e){for(const t of e)t instanceof _m&&this._functions.set(t.name,new Vg(t));for(const t of e)if(t instanceof jm){const e=this.getTypeInfo(t,null);e instanceof Hp&&this.structs.push(e)}for(const t of e)if(t instanceof Um)this.aliases.push(this._getAliasInfo(t));else{if(t instanceof Sm){const e=t,n=this._getAttributeNum(e.attributes,"id",0),i=null!=e.type?this.getTypeInfo(e.type,e.attributes):null;this.overrides.push(new Zp(e.name,i,e.attributes,n));continue}if(this._isUniformVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),i=this._getAttributeNum(e.attributes,"binding",0),r=this.getTypeInfo(e.type,e.attributes),o=new Yp(e.name,r,n,i,e.attributes,jp.Uniform,e.access);o.access||(o.access="read"),this.uniforms.push(o);continue}if(this._isStorageVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),i=this._getAttributeNum(e.attributes,"binding",0),r=this.getTypeInfo(e.type,e.attributes),o=this._isStorageTexture(r),s=new Yp(e.name,r,n,i,e.attributes,o?jp.StorageTexture:jp.Storage,e.access);s.access||(s.access="read"),this.storage.push(s);continue}if(this._isTextureVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),i=this._getAttributeNum(e.attributes,"binding",0),r=this.getTypeInfo(e.type,e.attributes),o=this._isStorageTexture(r),s=new Yp(e.name,r,n,i,e.attributes,o?jp.StorageTexture:jp.Texture,e.access);s.access||(s.access="read"),o?this.storage.push(s):this.textures.push(s);continue}if(this._isSamplerVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),i=this._getAttributeNum(e.attributes,"binding",0),r=this.getTypeInfo(e.type,e.attributes),o=new Yp(e.name,r,n,i,e.attributes,jp.Sampler,e.access);this.samplers.push(o);continue}}for(const t of e)if(t instanceof _m){const e=this._getAttribute(t,"vertex"),n=this._getAttribute(t,"fragment"),i=this._getAttribute(t,"compute"),r=e||n||i,o=new Jp(t.name,null==r?void 0:r.name,t.attributes);o.attributes=t.attributes,o.startLine=t.startLine,o.endLine=t.endLine,this.functions.push(o),this._functions.get(t.name).info=o,r&&(this._functions.get(t.name).inUse=!0,o.inUse=!0,o.resources=this._findResources(t,!!r),o.inputs=this._getInputs(t.args),o.outputs=this._getOutputs(t.returnType),this.entry[r.name].push(o)),o.arguments=t.args.map(e=>new Qp(e.name,this.getTypeInfo(e.type,e.attributes),e.attributes)),o.returnType=t.returnType?this.getTypeInfo(t.returnType,t.attributes):null;continue}for(const t of this._functions.values())t.info&&(t.info.inUse=t.inUse,this._addCalls(t.node,t.info.calls));for(const t of this._functions.values())t.node.search(e=>{var n,i,r;if(e instanceof gg){if(e.value)if(Lg(e.value))for(const o of e.value)for(const e of this.overrides)o===e.name&&(null===(n=t.info)||void 0===n||n.overrides.push(e));else for(const o of this.overrides)e.value===o.name&&(null===(i=t.info)||void 0===i||i.overrides.push(o))}else if(e instanceof tg)for(const o of this.overrides)e.name===o.name&&(null===(r=t.info)||void 0===r||r.overrides.push(o))});for(const t of this.uniforms)this._markStructsInUse(t.type);for(const t of this.storage)this._markStructsInUse(t.type)}getFunctionInfo(e){for(const t of this.functions)if(t.name==e)return t;return null}getStructInfo(e){for(const t of this.structs)if(t.name==e)return t;return null}getOverrideInfo(e){for(const t of this.overrides)if(t.name==e)return t;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const t of e.members)this._markStructsInUse(t.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const t=this._getAlias(e.name);t&&this._markStructsInUse(t)}}_addCalls(e,t){var n;for(const i of e.calls){const e=null===(n=this._functions.get(i.name))||void 0===n?void 0:n.info;e&&t.add(e)}}findResource(e,t,n){if(n){for(const i of this.entry.compute)if(i.name===n)for(const n of i.resources)if(n.group==e&&n.binding==t)return n;for(const i of this.entry.vertex)if(i.name===n)for(const n of i.resources)if(n.group==e&&n.binding==t)return n;for(const i of this.entry.fragment)if(i.name===n)for(const n of i.resources)if(n.group==e&&n.binding==t)return n}for(const i of this.uniforms)if(i.group==e&&i.binding==t)return i;for(const i of this.storage)if(i.group==e&&i.binding==t)return i;for(const i of this.textures)if(i.group==e&&i.binding==t)return i;for(const i of this.samplers)if(i.group==e&&i.binding==t)return i;return null}_findResource(e){for(const t of this.uniforms)if(t.name==e)return t;for(const t of this.storage)if(t.name==e)return t;for(const t of this.textures)if(t.name==e)return t;for(const t of this.samplers)if(t.name==e)return t;return null}_markStructsFromAST(e){const t=this.getTypeInfo(e,null);this._markStructsInUse(t)}_findResources(e,t){const n=[],i=this,r=[];return e.search(o=>{if(o instanceof fm)r.push({});else if(o instanceof pm)r.pop();else if(o instanceof wm){const e=o;t&&null!==e.type&&this._markStructsFromAST(e.type),r.length>0&&(r[r.length-1][e.name]=e)}else if(o instanceof Jm){const e=o;t&&null!==e.type&&this._markStructsFromAST(e.type)}else if(o instanceof Em){const e=o;t&&null!==e.type&&this._markStructsFromAST(e.type),r.length>0&&(r[r.length-1][e.name]=e)}else if(o instanceof tg){const e=o;if(r.length>0&&r[r.length-1][e.name])return;const t=i._findResource(e.name);t&&n.push(t)}else if(o instanceof eg){const r=o,s=i._functions.get(r.name);s&&(t&&(s.inUse=!0),e.calls.add(s.node),null===s.resources&&(s.resources=i._findResources(s.node,t)),n.push(...s.resources))}else if(o instanceof Pm){const r=o,s=i._functions.get(r.name);s&&(t&&(s.inUse=!0),e.calls.add(s.node),null===s.resources&&(s.resources=i._findResources(s.node,t)),n.push(...s.resources))}}),[...new Map(n.map(e=>[e.name,e])).values()]}getBindGroups(){const e=[];function t(t,n){t>=e.length&&(e.length=t+1),void 0===e[t]&&(e[t]=[]),n>=e[t].length&&(e[t].length=n+1)}for(const n of this.uniforms)t(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.storage)t(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.textures)t(n.group,n.binding),e[n.group][n.binding]=n;for(const n of this.samplers)t(n.group,n.binding),e[n.group][n.binding]=n;return e}_getOutputs(e,t=void 0){if(void 0===t&&(t=[]),e instanceof jm)this._getStructOutputs(e,t);else{const n=this._getOutputInfo(e);null!==n&&t.push(n)}return t}_getStructOutputs(e,t){for(const n of e.members)if(n.type instanceof jm)this._getStructOutputs(n.type,t);else{const e=this._getAttribute(n,"location")||this._getAttribute(n,"builtin");if(null!==e){const i=this.getTypeInfo(n.type,n.type.attributes),r=this._parseInt(e.value),o=new Kp(n.name,i,e.name,r);t.push(o)}}}_getOutputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const n=this.getTypeInfo(e,e.attributes),i=this._parseInt(t.value);return new Kp("",n,t.name,i)}return null}_getInputs(e,t=void 0){void 0===t&&(t=[]);for(const n of e)if(n.type instanceof jm)this._getStructInputs(n.type,t);else{const e=this._getInputInfo(n);null!==e&&t.push(e)}return t}_getStructInputs(e,t){for(const n of e.members)if(n.type instanceof jm)this._getStructInputs(n.type,t);else{const e=this._getInputInfo(n);null!==e&&t.push(e)}}_getInputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(null!==t){const n=this._getAttribute(e,"interpolation"),i=this.getTypeInfo(e.type,e.attributes),r=this._parseInt(t.value),o=new Xp(e.name,i,t.name,r);return null!==n&&(o.interpolation=this._parseString(n.value)),o}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const t=parseInt(e);return isNaN(t)?e:t}_getAlias(e){for(const t of this.aliases)if(t.name==e)return t.type;return null}_getAliasInfo(e){return new qp(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const t of this.structs)if(t.name==e)return t;for(const t of this.aliases)if(t.name==e)return t.type;return null}getTypeInfo(e,t=null){if(this._types.has(e))return this._types.get(e);if(e instanceof qm){const n=e.type?this.getTypeInfo(e.type,e.attributes):null,i=new $p(e.name,n,t);return this._types.set(e,i),this._updateTypeInfo(i),i}if(e instanceof Xm){const n=e,i=n.format?this.getTypeInfo(n.format,n.attributes):null,r=new Wp(n.name,t);return r.format=i,r.count=n.count,this._types.set(e,r),this._updateTypeInfo(r),r}if(e instanceof jm){const n=e,i=new Hp(n.name,t);i.startLine=n.startLine,i.endLine=n.endLine;for(const e of n.members){const t=this.getTypeInfo(e.type,e.attributes);i.members.push(new Vp(e.name,t,e.attributes))}return this._types.set(e,i),this._updateTypeInfo(i),i}if(e instanceof Km){const n=e,i=n.format instanceof $m,r=n.format?i?this.getTypeInfo(n.format,null):new Up(n.format,null):null,o=new Gp(n.name,r,t,n.access);return this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof Ym){const n=e,i=n.format?this.getTypeInfo(n.format,null):null,r=new Gp(n.name,i,t,n.access);return this._types.set(e,r),this._updateTypeInfo(r),r}const n=new Up(e.name,t);return this._types.set(e,n),this._updateTypeInfo(n),n}_updateTypeInfo(e){var t,n,i;const r=this._getTypeSize(e);if(e.size=null!==(t=null==r?void 0:r.size)&&void 0!==t?t:0,e instanceof Wp&&e.format){const t=this._getTypeSize(e.format);e.stride=Math.max(null!==(n=null==t?void 0:t.size)&&void 0!==n?n:0,null!==(i=null==t?void 0:t.align)&&void 0!==i?i:0),this._updateTypeInfo(e.format)}e instanceof $p&&this._updateTypeInfo(e.format),e instanceof Hp&&this._updateStructInfo(e)}_updateStructInfo(e){var t;let n=0,i=0,r=0,o=0;for(let s=0,a=e.members.length;s<a;++s){const a=e.members[s],l=this._getTypeSize(a);if(!l)continue;null!==(t=this._getAlias(a.type.name))&&void 0!==t||a.type;const c=l.align,u=l.size;n=this._roundUp(c,n+i),i=u,r=n,o=Math.max(o,c),a.offset=n,a.size=u,this._updateTypeInfo(a.type)}e.size=this._roundUp(o,r+i),e.align=o}_getTypeSize(e){var t,n;if(null==e)return null;const i=this._getAttributeNum(e.attributes,"size",0),r=this._getAttributeNum(e.attributes,"align",0);if(e instanceof Vp&&(e=e.type),e instanceof Up){const t=this._getAlias(e.name);null!==t&&(e=t)}{const n=Wg._typeInfo[e.name];if(void 0!==n){const o="f16"===(null===(t=e.format)||void 0===t?void 0:t.name)?2:1;return new Hg(Math.max(r,n.align/o),Math.max(i,n.size/o))}}{const t=Wg._typeInfo[e.name.substring(0,e.name.length-1)];if(t){const n="h"===e.name[e.name.length-1]?2:1;return new Hg(Math.max(r,t.align/n),Math.max(i,t.size/n))}}if(e instanceof Wp){let t=e,o=8,s=8;const a=this._getTypeSize(t.format);return null!==a&&(s=a.size,o=a.align),s=t.count*this._getAttributeNum(null!==(n=null==e?void 0:e.attributes)&&void 0!==n?n:null,"stride",this._roundUp(o,s)),i&&(s=i),new Hg(Math.max(r,o),Math.max(i,s))}if(e instanceof Hp){let t=0,n=0,o=0,s=0,a=0;for(const i of e.members){const e=this._getTypeSize(i.type);null!==e&&(t=Math.max(e.align,t),o=this._roundUp(e.align,o+s),s=e.size,a=o)}return n=this._roundUp(t,a+s),new Hg(Math.max(r,t),Math.max(i,n))}return null}_isUniformVar(e){return e instanceof wm&&"uniform"==e.storage}_isStorageVar(e){return e instanceof wm&&"storage"==e.storage}_isTextureVar(e){return e instanceof wm&&null!==e.type&&-1!=Wg._textureTypes.indexOf(e.type.name)}_isSamplerVar(e){return e instanceof wm&&null!==e.type&&-1!=Wg._samplerTypes.indexOf(e.type.name)}_getAttribute(e,t){const n=e;if(!n||!n.attributes)return null;const i=n.attributes;for(let r of i)if(r.name==t)return r;return null}_getAttributeNum(e,t,n){if(null===e)return n;for(let i of e)if(i.name==t){let e=null!==i&&null!==i.value?i.value:n;return e instanceof Array&&(e=e[0]),"number"==typeof e?e:"string"==typeof e?parseInt(e):n}return n}_roundUp(e,t){return Math.ceil(t/e)*e}}Wg._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},Wg._textureTypes=kg.any_texture_type.map(e=>e.name),Wg._samplerTypes=kg.sampler_type.map(e=>e.name);let $g=0;class Gg{constructor(e,t,n){this.id=$g++,this.name=e,this.value=t,this.node=n}clone(){return new Gg(this.name,this.value,this.node)}}class jg{constructor(e){this.id=$g++,this.name=e.name,this.node=e}clone(){return new jg(this.node)}}class Yg{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=$g++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var t;return this.variables.has(e)?null!==(t=this.variables.get(e))&&void 0!==t?t:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var t;return this.functions.has(e)?null!==(t=this.functions.get(e))&&void 0!==t?t:null:this.parent?this.parent.getFunction(e):null}createVariable(e,t,n){this.variables.set(e,new Gg(e,t,n??null))}setVariable(e,t,n){const i=this.getVariable(e);null!==i?i.value=t:this.createVariable(e,t,n)}getVariableValue(e){var t;const n=this.getVariable(e);return null!==(t=null==n?void 0:n.value)&&void 0!==t?t:null}clone(){return new Yg(this)}}class qg{evalExpression(e,t){return null}getTypeInfo(e){return null}getVariableName(e,t){return""}}class Xg{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,t){const n=this.exec.evalExpression(e.args[0],t);let i=!0;if(n instanceof wg)return n.data.forEach(e=>{e||(i=!1)}),new bg(i?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg){const e=n.data.some(e=>e);return new bg(e?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,t){const n=this.exec.evalExpression(e.args[2],t);if(!(n instanceof bg))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return n.value?this.exec.evalExpression(e.args[1],t):this.exec.evalExpression(e.args[0],t)}ArrayLength(e,t){let n=e.args[0];n instanceof ag&&(n=n.right);const i=this.exec.evalExpression(n,t);if(i instanceof Eg&&0===i.typeInfo.size){const e=i.typeInfo,t=i.buffer.byteLength/e.stride;return new bg(t,this.getTypeInfo("u32"))}return new bg(i.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.abs(e)),n.typeInfo);const i=n;return new bg(Math.abs(i.value),i.typeInfo)}Acos(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.acos(e)),n.typeInfo);const i=n;return new bg(Math.acos(i.value),n.typeInfo)}Acosh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.acosh(e)),n.typeInfo);const i=n;return new bg(Math.acosh(i.value),n.typeInfo)}Asin(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.asin(e)),n.typeInfo);const i=n;return new bg(Math.asin(i.value),n.typeInfo)}Asinh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.asinh(e)),n.typeInfo);const i=n;return new bg(Math.asinh(i.value),n.typeInfo)}Atan(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.atan(e)),n.typeInfo);const i=n;return new bg(Math.atan(i.value),n.typeInfo)}Atanh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.atanh(e)),n.typeInfo);const i=n;return new bg(Math.atanh(i.value),n.typeInfo)}Atan2(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof wg&&i instanceof wg)return new wg(n.data.map((e,t)=>Math.atan2(e,i.data[t])),n.typeInfo);const r=n,o=i;return new bg(Math.atan2(r.value,o.value),n.typeInfo)}Ceil(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.ceil(e)),n.typeInfo);const i=n;return new bg(Math.ceil(i.value),n.typeInfo)}_clamp(e,t,n){return Math.min(Math.max(e,t),n)}Clamp(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t);if(n instanceof wg&&i instanceof wg&&r instanceof wg)return new wg(n.data.map((e,t)=>this._clamp(e,i.data[t],r.data[t])),n.typeInfo);const o=n,s=i,a=r;return new bg(this._clamp(o.value,s.value,a.value),n.typeInfo)}Cos(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.cos(e)),n.typeInfo);const i=n;return new bg(Math.cos(i.value),n.typeInfo)}Cosh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.cosh(e)),n.typeInfo);const i=n;return new bg(Math.cos(i.value),n.typeInfo)}CountLeadingZeros(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.clz32(e)),n.typeInfo);const i=n;return new bg(Math.clz32(i.value),n.typeInfo)}_countOneBits(e){let t=0;for(;0!==e;)1&e&&t++,e>>=1;return t}CountOneBits(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>this._countOneBits(e)),n.typeInfo);const i=n;return new bg(this._countOneBits(i.value),n.typeInfo)}_countTrailingZeros(e){if(0===e)return 32;let t=0;for(;!(1&e);)e>>=1,t++;return t}CountTrailingZeros(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>this._countTrailingZeros(e)),n.typeInfo);const i=n;return new bg(this._countTrailingZeros(i.value),n.typeInfo)}Cross(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof wg&&i instanceof wg){if(3!==n.data.length||3!==i.data.length)return null;const e=n.data,t=i.data;return new wg([e[1]*t[2]-t[1]*e[2],e[2]*t[0]-t[2]*e[0],e[0]*t[1]-t[0]*e[1]],n.typeInfo)}return null}Degrees(e,t){const n=this.exec.evalExpression(e.args[0],t),i=180/Math.PI;return n instanceof wg?new wg(n.data.map(e=>e*i),n.typeInfo):new bg(n.value*i,this.getTypeInfo("f32"))}Determinant(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof Sg){const e=n.data,t=n.typeInfo.getTypeName(),i=t.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if("mat2x2"===t||"mat2x2f"===t||"mat2x2h"===t)return new bg(e[0]*e[3]-e[1]*e[2],i);if("mat2x3"===t||"mat2x3f"===t||"mat2x3h"===t)return new bg(e[0]*(e[4]*e[8]-e[5]*e[7])-e[1]*(e[3]*e[8]-e[5]*e[6])+e[2]*(e[3]*e[7]-e[4]*e[6]),i);if("mat2x4"===t||"mat2x4f"===t||"mat2x4h"===t);else if("mat3x2"===t||"mat3x2f"===t||"mat3x2h"===t);else if("mat3x3"===t||"mat3x3f"===t||"mat3x3h"===t)return new bg(e[0]*(e[4]*e[8]-e[5]*e[7])-e[1]*(e[3]*e[8]-e[5]*e[6])+e[2]*(e[3]*e[7]-e[4]*e[6]),i)}return null}Distance(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof wg&&i instanceof wg){let e=0;for(let t=0;t<n.data.length;++t)e+=(n.data[t]-i.data[t])*(n.data[t]-i.data[t]);return new bg(Math.sqrt(e),this.getTypeInfo("f32"))}const r=n,o=i;return new bg(Math.abs(r.value-o.value),n.typeInfo)}_dot(e,t){let n=0;for(let i=0;i<e.length;++i)n+=t[i]*e[i];return n}Dot(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);return n instanceof wg&&i instanceof wg?new bg(this._dot(n.data,i.data),this.getTypeInfo("f32")):null}Dot4U8Packed(e,t){return null}Dot4I8Packed(e,t){return null}Exp(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.exp(e)),n.typeInfo);const i=n;return new bg(Math.exp(i.value),n.typeInfo)}Exp2(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.pow(2,e)),n.typeInfo);const i=n;return new bg(Math.pow(2,i.value),n.typeInfo)}ExtractBits(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t);if("u32"!==i.typeInfo.name&&"x32"!==i.typeInfo.name)return null;if("u32"!==r.typeInfo.name&&"x32"!==r.typeInfo.name)return null;const o=i.value,s=r.value;if(n instanceof wg)return new wg(n.data.map(e=>e>>o&(1<<s)-1),n.typeInfo);if("i32"!==n.typeInfo.name&&"x32"!==n.typeInfo.name)return null;const a=n.value;return new bg(a>>o&(1<<s)-1,this.getTypeInfo("i32"))}FaceForward(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t);if(n instanceof wg&&i instanceof wg&&r instanceof wg){const e=this._dot(i.data,r.data);return new wg(e<0?Array.from(n.data):n.data.map(e=>-e),n.typeInfo)}return null}_firstLeadingBit(e){return 0===e?-1:31-Math.clz32(e)}FirstLeadingBit(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>this._firstLeadingBit(e)),n.typeInfo);const i=n;return new bg(this._firstLeadingBit(i.value),n.typeInfo)}_firstTrailingBit(e){return 0===e?-1:Math.log2(e&-e)}FirstTrailingBit(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>this._firstTrailingBit(e)),n.typeInfo);const i=n;return new bg(this._firstTrailingBit(i.value),n.typeInfo)}Floor(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.floor(e)),n.typeInfo);const i=n;return new bg(Math.floor(i.value),n.typeInfo)}Fma(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t);if(n instanceof wg&&i instanceof wg&&r instanceof wg)return n.data.length!==i.data.length||n.data.length!==r.data.length?null:new wg(n.data.map((e,t)=>e*i.data[t]+r.data[t]),n.typeInfo);const o=n,s=i,a=r;return new bg(o.value*s.value+a.value,o.typeInfo)}Fract(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>e-Math.floor(e)),n.typeInfo);const i=n;return new bg(i.value-Math.floor(i.value),n.typeInfo)}Frexp(e,t){return null}InsertBits(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t),o=this.exec.evalExpression(e.args[3],t);if("u32"!==r.typeInfo.name&&"x32"!==r.typeInfo.name)return null;const s=r.value,a=(1<<o.value)-1<<s,l=~a;if(n instanceof wg&&i instanceof wg)return new wg(n.data.map((e,t)=>e&l|i.data[t]<<s&a),n.typeInfo);const c=n.value,u=i.value;return new bg(c&l|u<<s&a,n.typeInfo)}InverseSqrt(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>1/Math.sqrt(e)),n.typeInfo);const i=n;return new bg(1/Math.sqrt(i.value),n.typeInfo)}Ldexp(e,t){return null}Length(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg){let e=0;return n.data.forEach(t=>{e+=t*t}),new bg(Math.sqrt(e),this.getTypeInfo("f32"))}const i=n;return new bg(Math.abs(i.value),n.typeInfo)}Log(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.log(e)),n.typeInfo);const i=n;return new bg(Math.log(i.value),n.typeInfo)}Log2(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.log2(e)),n.typeInfo);const i=n;return new bg(Math.log2(i.value),n.typeInfo)}Max(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof wg&&i instanceof wg)return new wg(n.data.map((e,t)=>Math.max(e,i.data[t])),n.typeInfo);const r=n,o=i;return new bg(Math.max(r.value,o.value),n.typeInfo)}Min(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof wg&&i instanceof wg)return new wg(n.data.map((e,t)=>Math.min(e,i.data[t])),n.typeInfo);const r=n,o=i;return new bg(Math.min(r.value,o.value),n.typeInfo)}Mix(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t);if(n instanceof wg&&i instanceof wg&&r instanceof wg)return new wg(n.data.map((e,t)=>n.data[t]*(1-r.data[t])+i.data[t]*r.data[t]),n.typeInfo);const o=i,s=r;return new bg(n.value*(1-s.value)+o.value*s.value,n.typeInfo)}Modf(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof wg&&i instanceof wg)return new wg(n.data.map((e,t)=>e%i.data[t]),n.typeInfo);const r=i;return new bg(n.value%r.value,n.typeInfo)}Normalize(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg){const i=this.Length(e,t).value;return new wg(n.data.map(e=>e/i),n.typeInfo)}return null}Pow(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof wg&&i instanceof wg)return new wg(n.data.map((e,t)=>Math.pow(e,i.data[t])),n.typeInfo);const r=n,o=i;return new bg(Math.pow(r.value,o.value),n.typeInfo)}QuantizeToF16(e,t){const n=this.exec.evalExpression(e.args[0],t);return n instanceof wg?new wg(n.data.map(e=>e),n.typeInfo):new bg(n.value,n.typeInfo)}Radians(e,t){const n=this.exec.evalExpression(e.args[0],t);return n instanceof wg?new wg(n.data.map(e=>e*Math.PI/180),n.typeInfo):new bg(n.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,t){let n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(n instanceof wg&&i instanceof wg){const e=this._dot(n.data,i.data);return new wg(n.data.map((t,n)=>t-2*e*i.data[n]),n.typeInfo)}return null}Refract(e,t){let n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t);if(n instanceof wg&&i instanceof wg&&r instanceof bg){const e=this._dot(i.data,n.data);return new wg(n.data.map((t,n)=>{const o=1-r.value*r.value*(1-e*e);if(o<0)return 0;const s=Math.sqrt(o);return r.value*t-(r.value*e+s)*i.data[n]}),n.typeInfo)}return null}ReverseBits(e,t){return null}Round(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.round(e)),n.typeInfo);const i=n;return new bg(Math.round(i.value),n.typeInfo)}Saturate(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.min(Math.max(e,0),1)),n.typeInfo);const i=n;return new bg(Math.min(Math.max(i.value,0),1),n.typeInfo)}Sign(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.sign(e)),n.typeInfo);const i=n;return new bg(Math.sign(i.value),n.typeInfo)}Sin(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.sin(e)),n.typeInfo);const i=n;return new bg(Math.sin(i.value),n.typeInfo)}Sinh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.sinh(e)),n.typeInfo);const i=n;return new bg(Math.sinh(i.value),n.typeInfo)}_smoothstep(e,t,n){const i=Math.min(Math.max((n-e)/(t-e),0),1);return i*i*(3-2*i)}SmoothStep(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),r=this.exec.evalExpression(e.args[2],t);if(r instanceof wg&&n instanceof wg&&i instanceof wg)return new wg(r.data.map((e,t)=>this._smoothstep(n.data[t],i.data[t],e)),r.typeInfo);const o=n,s=i,a=r;return new bg(this._smoothstep(o.value,s.value,a.value),r.typeInfo)}Sqrt(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.sqrt(e)),n.typeInfo);const i=n;return new bg(Math.sqrt(i.value),n.typeInfo)}Step(e,t){const n=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(i instanceof wg&&n instanceof wg)return new wg(i.data.map((e,t)=>e<n.data[t]?0:1),i.typeInfo);const r=n;return new bg(i.value<r.value?0:1,r.typeInfo)}Tan(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.tan(e)),n.typeInfo);const i=n;return new bg(Math.tan(i.value),n.typeInfo)}Tanh(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.tanh(e)),n.typeInfo);const i=n;return new bg(Math.tanh(i.value),n.typeInfo)}_getTransposeType(e){const t=e.getTypeName();return"mat2x2f"===t||"mat2x2h"===t?e:"mat2x3f"===t?this.getTypeInfo("mat3x2f"):"mat2x3h"===t?this.getTypeInfo("mat3x2h"):"mat2x4f"===t?this.getTypeInfo("mat4x2f"):"mat2x4h"===t?this.getTypeInfo("mat4x2h"):"mat3x2f"===t?this.getTypeInfo("mat2x3f"):"mat3x2h"===t?this.getTypeInfo("mat2x3h"):"mat3x3f"===t||"mat3x3h"===t?e:"mat3x4f"===t?this.getTypeInfo("mat4x3f"):"mat3x4h"===t?this.getTypeInfo("mat4x3h"):"mat4x2f"===t?this.getTypeInfo("mat2x4f"):"mat4x2h"===t?this.getTypeInfo("mat2x4h"):"mat4x3f"===t?this.getTypeInfo("mat3x4f"):"mat4x3h"===t?this.getTypeInfo("mat3x4h"):e}Transpose(e,t){const n=this.exec.evalExpression(e.args[0],t);if(!(n instanceof Sg))return null;const i=this._getTransposeType(n.typeInfo);if("mat2x2"===n.typeInfo.name||"mat2x2f"===n.typeInfo.name||"mat2x2h"===n.typeInfo.name){const e=n.data;return new Sg([e[0],e[2],e[1],e[3]],i)}if("mat2x3"===n.typeInfo.name||"mat2x3f"===n.typeInfo.name||"mat2x3h"===n.typeInfo.name){const e=n.data;return new Sg([e[0],e[3],e[6],e[1],e[4],e[7]],i)}if("mat2x4"===n.typeInfo.name||"mat2x4f"===n.typeInfo.name||"mat2x4h"===n.typeInfo.name){const e=n.data;return new Sg([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13]],i)}if("mat3x2"===n.typeInfo.name||"mat3x2f"===n.typeInfo.name||"mat3x2h"===n.typeInfo.name){const e=n.data;return new Sg([e[0],e[3],e[1],e[4],e[2],e[5]],i)}if("mat3x3"===n.typeInfo.name||"mat3x3f"===n.typeInfo.name||"mat3x3h"===n.typeInfo.name){const e=n.data;return new Sg([e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]],i)}if("mat3x4"===n.typeInfo.name||"mat3x4f"===n.typeInfo.name||"mat3x4h"===n.typeInfo.name){const e=n.data;return new Sg([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14]],i)}if("mat4x2"===n.typeInfo.name||"mat4x2f"===n.typeInfo.name||"mat4x2h"===n.typeInfo.name){const e=n.data;return new Sg([e[0],e[4],e[1],e[5],e[2],e[6]],i)}if("mat4x3"===n.typeInfo.name||"mat4x3f"===n.typeInfo.name||"mat4x3h"===n.typeInfo.name){const e=n.data;return new Sg([e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]],i)}if("mat4x4"===n.typeInfo.name||"mat4x4f"===n.typeInfo.name||"mat4x4h"===n.typeInfo.name){const e=n.data;return new Sg([e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]],i)}return null}Trunc(e,t){const n=this.exec.evalExpression(e.args[0],t);if(n instanceof wg)return new wg(n.data.map(e=>Math.trunc(e)),n.typeInfo);const i=n;return new bg(Math.trunc(i.value),n.typeInfo)}Dpdx(e,t){return null}DpdxCoarse(e,t){return null}DpdxFine(e,t){return null}Dpdy(e,t){return null}DpdyCoarse(e,t){return null}DpdyFine(e,t){return null}Fwidth(e,t){return null}FwidthCoarse(e,t){return null}FwidthFine(e,t){return null}TextureDimensions(e,t){const n=e.args[0],i=e.args.length>1?this.exec.evalExpression(e.args[1],t).value:0;if(n instanceof tg){const e=n.name,r=t.getVariableValue(e);if(r instanceof Cg){if(i<0||i>=r.mipLevelCount)return null;const e=r.getMipLevelSize(i),t=r.dimension;return"1d"===t?new bg(e[0],this.getTypeInfo("u32")):"3d"===t?new wg(e,this.getTypeInfo("vec3u")):"2d"===t?new wg(e.slice(0,2),this.getTypeInfo("vec2u")):null}return null}return null}TextureGather(e,t){return null}TextureGatherCompare(e,t){return null}TextureLoad(e,t){const n=e.args[0],i=this.exec.evalExpression(e.args[1],t),r=e.args.length>2?this.exec.evalExpression(e.args[2],t).value:0;if(!(i instanceof wg)||2!==i.data.length)return null;if(n instanceof tg){const e=n.name,o=t.getVariableValue(e);if(o instanceof Cg){const e=Math.floor(i.data[0]),t=Math.floor(i.data[1]);if(e<0||e>=o.width||t<0||t>=o.height)return null;const n=o.getPixel(e,t,0,r);return null===n?null:new wg(n,this.getTypeInfo("vec4f"))}return null}return null}TextureNumLayers(e,t){const n=e.args[0];if(n instanceof tg){const e=n.name,i=t.getVariableValue(e);return i instanceof Cg?new bg(i.depthOrArrayLayers,this.getTypeInfo("u32")):null}return null}TextureNumLevels(e,t){const n=e.args[0];if(n instanceof tg){const e=n.name,i=t.getVariableValue(e);return i instanceof Cg?new bg(i.mipLevelCount,this.getTypeInfo("u32")):null}return null}TextureNumSamples(e,t){const n=e.args[0];if(n instanceof tg){const e=n.name,i=t.getVariableValue(e);return i instanceof Cg?new bg(i.sampleCount,this.getTypeInfo("u32")):null}return null}TextureSample(e,t){return null}TextureSampleBias(e,t){return null}TextureSampleCompare(e,t){return null}TextureSampleCompareLevel(e,t){return null}TextureSampleGrad(e,t){return null}TextureSampleLevel(e,t){return null}TextureSampleBaseClampToEdge(e,t){return null}TextureStore(e,t){const n=e.args[0],i=this.exec.evalExpression(e.args[1],t),r=4===e.args.length?this.exec.evalExpression(e.args[2],t).value:0,o=4===e.args.length?this.exec.evalExpression(e.args[3],t).data:this.exec.evalExpression(e.args[2],t).data;if(4!==o.length)return null;if(!(i instanceof wg)||2!==i.data.length)return null;if(n instanceof tg){const e=n.name,s=t.getVariableValue(e);if(s instanceof Cg){const e=s.getMipLevelSize(0),t=Math.floor(i.data[0]),n=Math.floor(i.data[1]);return t<0||t>=e[0]||n<0||n>=e[1]||s.setPixel(t,n,0,r,Array.from(o)),null}return null}return null}AtomicLoad(e,t){let n=e.args[0];n instanceof ag&&(n=n.right);const i=this.exec.getVariableName(n,t);return t.getVariable(i).value.getSubData(this.exec,n.postfix,t)}AtomicStore(e,t){let n=e.args[0];n instanceof ag&&(n=n.right);const i=this.exec.getVariableName(n,t),r=t.getVariable(i);let o=e.args[1];const s=this.exec.evalExpression(o,t),a=r.value.getSubData(this.exec,n.postfix,t);return a instanceof bg&&s instanceof bg&&(a.value=s.value),r.value instanceof Eg&&r.value.setDataValue(this.exec,a,n.postfix,t),null}AtomicAdd(e,t){let n=e.args[0];n instanceof ag&&(n=n.right);const i=this.exec.getVariableName(n,t),r=t.getVariable(i);let o=e.args[1];const s=this.exec.evalExpression(o,t),a=r.value.getSubData(this.exec,n.postfix,t),l=new bg(a.value,a.typeInfo);return a instanceof bg&&s instanceof bg&&(a.value+=s.value),r.value instanceof Eg&&r.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicSub(e,t){let n=e.args[0];n instanceof ag&&(n=n.right);const i=this.exec.getVariableName(n,t),r=t.getVariable(i);let o=e.args[1];const s=this.exec.evalExpression(o,t),a=r.value.getSubData(this.exec,n.postfix,t),l=new bg(a.value,a.typeInfo);return a instanceof bg&&s instanceof bg&&(a.value-=s.value),r.value instanceof Eg&&r.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicMax(e,t){let n=e.args[0];n instanceof ag&&(n=n.right);const i=this.exec.getVariableName(n,t),r=t.getVariable(i);let o=e.args[1];const s=this.exec.evalExpression(o,t),a=r.value.getSubData(this.exec,n.postfix,t),l=new bg(a.value,a.typeInfo);return a instanceof bg&&s instanceof bg&&(a.value=Math.max(a.value,s.value)),r.value instanceof Eg&&r.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicMin(e,t){let n=e.args[0];n instanceof ag&&(n=n.right);const i=this.exec.getVariableName(n,t),r=t.getVariable(i);let o=e.args[1];const s=this.exec.evalExpression(o,t),a=r.value.getSubData(this.exec,n.postfix,t),l=new bg(a.value,a.typeInfo);return a instanceof bg&&s instanceof bg&&(a.value=Math.min(a.value,s.value)),r.value instanceof Eg&&r.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicAnd(e,t){let n=e.args[0];n instanceof ag&&(n=n.right);const i=this.exec.getVariableName(n,t),r=t.getVariable(i);let o=e.args[1];const s=this.exec.evalExpression(o,t),a=r.value.getSubData(this.exec,n.postfix,t),l=new bg(a.value,a.typeInfo);return a instanceof bg&&s instanceof bg&&(a.value=a.value&s.value),r.value instanceof Eg&&r.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicOr(e,t){let n=e.args[0];n instanceof ag&&(n=n.right);const i=this.exec.getVariableName(n,t),r=t.getVariable(i);let o=e.args[1];const s=this.exec.evalExpression(o,t),a=r.value.getSubData(this.exec,n.postfix,t),l=new bg(a.value,a.typeInfo);return a instanceof bg&&s instanceof bg&&(a.value=a.value|s.value),r.value instanceof Eg&&r.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicXor(e,t){let n=e.args[0];n instanceof ag&&(n=n.right);const i=this.exec.getVariableName(n,t),r=t.getVariable(i);let o=e.args[1];const s=this.exec.evalExpression(o,t),a=r.value.getSubData(this.exec,n.postfix,t),l=new bg(a.value,a.typeInfo);return a instanceof bg&&s instanceof bg&&(a.value=a.value^s.value),r.value instanceof Eg&&r.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicExchange(e,t){let n=e.args[0];n instanceof ag&&(n=n.right);const i=this.exec.getVariableName(n,t),r=t.getVariable(i);let o=e.args[1];const s=this.exec.evalExpression(o,t),a=r.value.getSubData(this.exec,n.postfix,t),l=new bg(a.value,a.typeInfo);return a instanceof bg&&s instanceof bg&&(a.value=s.value),r.value instanceof Eg&&r.value.setDataValue(this.exec,a,n.postfix,t),l}AtomicCompareExchangeWeak(e,t){return null}Pack4x8snorm(e,t){return null}Pack4x8unorm(e,t){return null}Pack4xI8(e,t){return null}Pack4xU8(e,t){return null}Pack4x8Clamp(e,t){return null}Pack4xU8Clamp(e,t){return null}Pack2x16snorm(e,t){return null}Pack2x16unorm(e,t){return null}Pack2x16float(e,t){return null}Unpack4x8snorm(e,t){return null}Unpack4x8unorm(e,t){return null}Unpack4xI8(e,t){return null}Unpack4xU8(e,t){return null}Unpack2x16snorm(e,t){return null}Unpack2x16unorm(e,t){return null}Unpack2x16float(e,t){return null}StorageBarrier(e,t){return null}TextureBarrier(e,t){return null}WorkgroupBarrier(e,t){return null}WorkgroupUniformLoad(e,t){return null}SubgroupAdd(e,t){return null}SubgroupExclusiveAdd(e,t){return null}SubgroupInclusiveAdd(e,t){return null}SubgroupAll(e,t){return null}SubgroupAnd(e,t){return null}SubgroupAny(e,t){return null}SubgroupBallot(e,t){return null}SubgroupBroadcast(e,t){return null}SubgroupBroadcastFirst(e,t){return null}SubgroupElect(e,t){return null}SubgroupMax(e,t){return null}SubgroupMin(e,t){return null}SubgroupMul(e,t){return null}SubgroupExclusiveMul(e,t){return null}SubgroupInclusiveMul(e,t){return null}SubgroupOr(e,t){return null}SubgroupShuffle(e,t){return null}SubgroupShuffleDown(e,t){return null}SubgroupShuffleUp(e,t){return null}SubgroupShuffleXor(e,t){return null}SubgroupXor(e,t){return null}QuadBroadcast(e,t){return null}QuadSwapDiagonal(e,t){return null}QuadSwapX(e,t){return null}QuadSwapY(e,t){return null}}const Kg={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},Zg={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class Qg extends qg{constructor(e,t){var n;super(),this.ast=e??[],this.reflection=new Wg,this.reflection.updateAST(this.ast),this.context=null!==(n=null==t?void 0:t.clone())&&void 0!==n?n:new Yg,this.builtins=new Xg(this),this.typeInfo={bool:this.getTypeInfo($m.bool),i32:this.getTypeInfo($m.i32),u32:this.getTypeInfo($m.u32),f32:this.getTypeInfo($m.f32),f16:this.getTypeInfo($m.f16),vec2f:this.getTypeInfo(Ym.vec2f),vec2u:this.getTypeInfo(Ym.vec2u),vec2i:this.getTypeInfo(Ym.vec2i),vec2h:this.getTypeInfo(Ym.vec2h),vec3f:this.getTypeInfo(Ym.vec3f),vec3u:this.getTypeInfo(Ym.vec3u),vec3i:this.getTypeInfo(Ym.vec3i),vec3h:this.getTypeInfo(Ym.vec3h),vec4f:this.getTypeInfo(Ym.vec4f),vec4u:this.getTypeInfo(Ym.vec4u),vec4i:this.getTypeInfo(Ym.vec4i),vec4h:this.getTypeInfo(Ym.vec4h),mat2x2f:this.getTypeInfo(Ym.mat2x2f),mat2x3f:this.getTypeInfo(Ym.mat2x3f),mat2x4f:this.getTypeInfo(Ym.mat2x4f),mat3x2f:this.getTypeInfo(Ym.mat3x2f),mat3x3f:this.getTypeInfo(Ym.mat3x3f),mat3x4f:this.getTypeInfo(Ym.mat3x4f),mat4x2f:this.getTypeInfo(Ym.mat4x2f),mat4x3f:this.getTypeInfo(Ym.mat4x3f),mat4x4f:this.getTypeInfo(Ym.mat4x4f)}}getVariableValue(e){var t,n;const i=null!==(n=null===(t=this.context.getVariable(e))||void 0===t?void 0:t.value)&&void 0!==n?n:null;if(null===i)return null;if(i instanceof bg)return i.value;if(i instanceof wg||i instanceof Sg)return Array.from(i.data);if(i instanceof Eg&&i.typeInfo instanceof Wp){if("u32"===i.typeInfo.format.name)return Array.from(new Uint32Array(i.buffer,i.offset,i.typeInfo.count));if("i32"===i.typeInfo.format.name)return Array.from(new Int32Array(i.buffer,i.offset,i.typeInfo.count));if("f32"===i.typeInfo.format.name)return Array.from(new Float32Array(i.buffer,i.offset,i.typeInfo.count))}return null}execute(e){(e=e??{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,t,n,i){const r=this.context.clone();(i=i??{}).constants&&this._setOverrides(i.constants,r),this._execStatements(this.ast,r);const o=r.getFunction(e);if(!o)return;if("number"==typeof t)t=[t,1,1];else{if(0===t.length)return;1===t.length?t=[t[0],1,1]:2===t.length?t=[t[0],t[1],1]:t.length>3&&(t=[t[0],t[1],t[2]])}const s=t[0],a=t[1],l=t[2],c=this.getTypeInfo("vec3u");r.setVariable("@num_workgroups",new wg(t,c));const u=this.reflection.getFunctionInfo(e);for(const d in n)for(const e in n[d]){const t=n[d][e];r.variables.forEach(n=>{var i;const r=n.node;if(null!=r&&r.attributes){let o=null,s=null;for(const e of r.attributes)"binding"===e.name?o=e.value:"group"===e.name&&(s=e.value);if(e==o&&d==s){let o=!1;for(const t of u.resources)if(t.name===n.name&&t.group===parseInt(d)&&t.binding===parseInt(e)){o=!0;break}if(o)if(void 0!==t.texture&&void 0!==t.descriptor){const e=new Cg(t.texture,this.getTypeInfo(r.type),t.descriptor,null!==(i=t.texture.view)&&void 0!==i?i:null);n.value=e}else void 0!==t.uniform?n.value=new Eg(t.uniform,this.getTypeInfo(r.type)):n.value=new Eg(t,this.getTypeInfo(r.type))}}})}for(let d=0;d<l;++d)for(let e=0;e<a;++e)for(let t=0;t<s;++t)r.setVariable("@workgroup_id",new wg([t,e,d],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(o,[t,e,d],r)}execStatement(e,t){if(e instanceof Fm)return this.evalExpression(e.value,t);if(e instanceof Hm){if(e.condition){const n=this.evalExpression(e.condition,t);if(!(n instanceof bg))throw new Error("Invalid break-if condition");if(!n.value)return null}return Qg._breakObj}if(e instanceof Wm)return Qg._continueObj;if(e instanceof Em)this._let(e,t);else if(e instanceof wm)this._var(e,t);else if(e instanceof Cm)this._const(e,t);else if(e instanceof _m)this._function(e,t);else{if(e instanceof Nm)return this._if(e,t);if(e instanceof Dm)return this._switch(e,t);if(e instanceof xm)return this._for(e,t);if(e instanceof vm)return this._while(e,t);if(e instanceof Mm)return this._loop(e,t);if(e instanceof bm){const n=t.clone();return n.currentFunctionName=t.currentFunctionName,this._execStatements(e.body,n)}if(e instanceof Rm)this._assign(e,t);else if(e instanceof Lm)this._increment(e,t);else{if(e instanceof jm)return null;if(e instanceof Sm){const n=e.name;null===t.getVariable(n)&&t.setVariable(n,new bg(0,this.getTypeInfo("u32")))}else if(e instanceof Pm)this._call(e,t);else if(e instanceof zm||e instanceof Um)return null}}return null}evalExpression(e,t){return e instanceof lg?this._evalBinaryOp(e,t):e instanceof ig?this._evalLiteral(e,t):e instanceof tg?this._evalVariable(e,t):e instanceof eg?this._evalCall(e,t):e instanceof Jm?this._evalCreate(e,t):e instanceof ng?this._evalConst(e,t):e instanceof rg?this._evalBitcast(e,t):e instanceof ag?this._evalUnaryOp(e,t):null}getTypeInfo(e){var t;if(e instanceof $m){const t=this.reflection.getTypeInfo(e);if(null!==t)return t}let n=null!==(t=this.typeInfo[e])&&void 0!==t?t:null;return null!==n||(n=this.reflection.getTypeInfoByName(e)),n}_setOverrides(e,t){for(const n in e){const i=e[n],r=this.reflection.getOverrideInfo(n);null!==r&&(null===r.type&&(r.type=this.getTypeInfo("u32")),"u32"===r.type.name||"i32"===r.type.name||"f32"===r.type.name||"f16"===r.type.name?t.setVariable(n,new bg(i,r.type)):"bool"===r.type.name?t.setVariable(n,new bg(i?1:0,r.type)):("vec2"===r.type.name||"vec3"===r.type.name||"vec4"===r.type.name||"vec2f"===r.type.name||"vec3f"===r.type.name||"vec4f"===r.type.name||"vec2i"===r.type.name||"vec3i"===r.type.name||"vec4i"===r.type.name||"vec2u"===r.type.name||"vec3u"===r.type.name||"vec4u"===r.type.name||"vec2h"===r.type.name||"vec3h"===r.type.name||"vec4h"===r.type.name)&&t.setVariable(n,new wg(i,r.type)))}}_dispatchWorkgroup(e,t,n){const i=[1,1,1];for(const c of e.node.attributes)if("workgroup_size"===c.name){if(c.value.length>0){const e=n.getVariableValue(c.value[0]);i[0]=e instanceof bg?e.value:parseInt(c.value[0])}if(c.value.length>1){const e=n.getVariableValue(c.value[1]);i[1]=e instanceof bg?e.value:parseInt(c.value[1])}if(c.value.length>2){const e=n.getVariableValue(c.value[2]);i[2]=e instanceof bg?e.value:parseInt(c.value[2])}}const r=this.getTypeInfo("vec3u"),o=this.getTypeInfo("u32");n.setVariable("@workgroup_size",new wg(i,r));const s=i[0],a=i[1],l=i[2];for(let c=0,u=0;c<l;++c)for(let l=0;l<a;++l)for(let a=0;a<s;++a,++u){const s=[a,l,c],d=[a+t[0]*i[0],l+t[1]*i[1],c+t[2]*i[2]];n.setVariable("@local_invocation_id",new wg(s,r)),n.setVariable("@global_invocation_id",new wg(d,r)),n.setVariable("@local_invocation_index",new bg(u,o)),this._dispatchExec(e,n)}}_dispatchExec(e,t){for(const n of e.node.args)for(const e of n.attributes)if("builtin"===e.name){const i=`@${e.value}`,r=t.getVariable(i);void 0!==r&&t.variables.set(n.name,r)}this._execStatements(e.node.body,t)}getVariableName(e,t){for(;e instanceof ag;)e=e.right;return e instanceof tg?e.name:null}_execStatements(e,t){for(const n of e){if(n instanceof Array){const e=t.clone(),i=this._execStatements(n,e);if(i)return i;continue}const e=this.execStatement(n,t);if(e)return e}return null}_call(e,t){const n=t.clone();n.currentFunctionName=e.name;const i=t.getFunction(e.name);if(i){for(let t=0;t<i.node.args.length;++t){const r=i.node.args[t],o=this.evalExpression(e.args[t],n);n.setVariable(r.name,o,r)}this._execStatements(i.node.body,n)}else e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)&&this._evalCreate(e,t)}_increment(e,t){const n=this.getVariableName(e.variable,t),i=t.getVariable(n);i&&("++"===e.operator?i.value instanceof bg&&i.value.value++:"--"===e.operator&&i.value instanceof bg&&i.value.value--)}_getVariableData(e,t){if(e instanceof tg){const n=this.getVariableName(e,t),i=t.getVariable(n);return null===i?null:i.value.getSubData(this,e.postfix,t)}if(e instanceof ag){if("*"===e.operator){const n=this._getVariableData(e.right,t);return n instanceof vg?n.reference.getSubData(this,e.postfix,t):null}if("&"===e.operator){const n=this._getVariableData(e.right,t);return new vg(n)}}return null}_assign(e,t){let n=null,i="<var>",r=null;if(e.variable instanceof ag){const n=this._getVariableData(e.variable,t),i=this.evalExpression(e.value,t),r=e.operator;if("="===r){if(n instanceof bg||n instanceof wg||n instanceof Sg){if(i instanceof bg||i instanceof wg||i instanceof Sg&&n.data.length===i.data.length)return void n.data.set(i.data)}else if(n instanceof Eg&&i instanceof Eg&&n.buffer.byteLength-n.offset>=i.buffer.byteLength-i.offset)return void(n.buffer.byteLength%4==0?new Uint32Array(n.buffer,n.offset,n.typeInfo.size/4).set(new Uint32Array(i.buffer,i.offset,i.typeInfo.size/4)):new Uint8Array(n.buffer,n.offset,n.typeInfo.size).set(new Uint8Array(i.buffer,i.offset,i.typeInfo.size)));return null}if("+="===r)return(n instanceof bg||n instanceof wg||n instanceof Sg)&&(i instanceof bg||i instanceof wg||i instanceof Sg)?void n.data.set(i.data.map((e,t)=>n.data[t]+e)):void 0;if("-="===r)return(n instanceof bg||n instanceof wg||n instanceof Sg)&&(i instanceof bg||i instanceof wg||i instanceof Sg)?void n.data.set(i.data.map((e,t)=>n.data[t]-e)):void 0}if(e.variable instanceof ag){if("*"===e.variable.operator){i=this.getVariableName(e.variable.right,t);const r=t.getVariable(i);if(!(r&&r.value instanceof vg))return;n=r.value.reference;let o=e.variable.postfix;if(!o){let t=e.variable.right;for(;t instanceof ag;){if(t.postfix){o=t.postfix;break}t=t.right}}o&&(n=n.getSubData(this,o,t))}}else{r=e.variable.postfix,i=this.getVariableName(e.variable,t);const o=t.getVariable(i);if(null===o)return;n=o.value}if(n instanceof vg&&(n=n.reference),null===n)return;const o=this.evalExpression(e.value,t),s=e.operator;if("="!==s){const e=n.getSubData(this,r,t);if(e instanceof wg&&o instanceof bg){const t=e.data,n=o.value;if("+="===s)for(let e=0;e<t.length;++e)t[e]+=n;else if("-="===s)for(let e=0;e<t.length;++e)t[e]-=n;else if("*="===s)for(let e=0;e<t.length;++e)t[e]*=n;else if("/="===s)for(let e=0;e<t.length;++e)t[e]/=n;else if("%="===s)for(let e=0;e<t.length;++e)t[e]%=n;else if("&="===s)for(let e=0;e<t.length;++e)t[e]&=n;else if("|="===s)for(let e=0;e<t.length;++e)t[e]|=n;else if("^="===s)for(let e=0;e<t.length;++e)t[e]^=n;else if("<<="===s)for(let e=0;e<t.length;++e)t[e]<<=n;else if(">>="===s)for(let e=0;e<t.length;++e)t[e]>>=n}else if(e instanceof wg&&o instanceof wg){const t=e.data,n=o.data;if(t.length!==n.length)return;if("+="===s)for(let e=0;e<t.length;++e)t[e]+=n[e];else if("-="===s)for(let e=0;e<t.length;++e)t[e]-=n[e];else if("*="===s)for(let e=0;e<t.length;++e)t[e]*=n[e];else if("/="===s)for(let e=0;e<t.length;++e)t[e]/=n[e];else if("%="===s)for(let e=0;e<t.length;++e)t[e]%=n[e];else if("&="===s)for(let e=0;e<t.length;++e)t[e]&=n[e];else if("|="===s)for(let e=0;e<t.length;++e)t[e]|=n[e];else if("^="===s)for(let e=0;e<t.length;++e)t[e]^=n[e];else if("<<="===s)for(let e=0;e<t.length;++e)t[e]<<=n[e];else if(">>="===s)for(let e=0;e<t.length;++e)t[e]>>=n[e]}else{if(!(e instanceof bg&&o instanceof bg))return;"+="===s?e.value+=o.value:"-="===s?e.value-=o.value:"*="===s?e.value*=o.value:"/="===s?e.value/=o.value:"%="===s?e.value%=o.value:"&="===s?e.value&=o.value:"|="===s?e.value|=o.value:"^="===s?e.value^=o.value:"<<="===s?e.value<<=o.value:">>="===s&&(e.value>>=o.value)}return void(n instanceof Eg&&n.setDataValue(this,e,r,t))}if(n instanceof Eg)n.setDataValue(this,o,r,t);else if(r){if(!(n instanceof wg||n instanceof Sg))return;if(r instanceof og){const e=this.evalExpression(r.index,t).value;if(n instanceof wg){if(!(o instanceof bg))return;n.data[e]=o.value}else{if(!(n instanceof Sg))return;{const e=this.evalExpression(r.index,t).value;if(e<0)return;if(!(o instanceof wg))return;{const t=n.typeInfo.getTypeName();if("mat2x2"===t||"mat2x2f"===t||"mat2x2h"===t){if(!(e<2&&2===o.data.length))return;n.data[2*e]=o.data[0],n.data[2*e+1]=o.data[1]}else if("mat2x3"===t||"mat2x3f"===t||"mat2x3h"===t){if(!(e<2&&3===o.data.length))return;n.data[3*e]=o.data[0],n.data[3*e+1]=o.data[1],n.data[3*e+2]=o.data[2]}else if("mat2x4"===t||"mat2x4f"===t||"mat2x4h"===t){if(!(e<2&&4===o.data.length))return;n.data[4*e]=o.data[0],n.data[4*e+1]=o.data[1],n.data[4*e+2]=o.data[2],n.data[4*e+3]=o.data[3]}else if("mat3x2"===t||"mat3x2f"===t||"mat3x2h"===t){if(!(e<3&&2===o.data.length))return;n.data[2*e]=o.data[0],n.data[2*e+1]=o.data[1]}else if("mat3x3"===t||"mat3x3f"===t||"mat3x3h"===t){if(!(e<3&&3===o.data.length))return;n.data[3*e]=o.data[0],n.data[3*e+1]=o.data[1],n.data[3*e+2]=o.data[2]}else if("mat3x4"===t||"mat3x4f"===t||"mat3x4h"===t){if(!(e<3&&4===o.data.length))return;n.data[4*e]=o.data[0],n.data[4*e+1]=o.data[1],n.data[4*e+2]=o.data[2],n.data[4*e+3]=o.data[3]}else if("mat4x2"===t||"mat4x2f"===t||"mat4x2h"===t){if(!(e<4&&2===o.data.length))return;n.data[2*e]=o.data[0],n.data[2*e+1]=o.data[1]}else if("mat4x3"===t||"mat4x3f"===t||"mat4x3h"===t){if(!(e<4&&3===o.data.length))return;n.data[3*e]=o.data[0],n.data[3*e+1]=o.data[1],n.data[3*e+2]=o.data[2]}else{if("mat4x4"!==t&&"mat4x4f"!==t&&"mat4x4h"!==t)return;if(!(e<4&&4===o.data.length))return;n.data[4*e]=o.data[0],n.data[4*e+1]=o.data[1],n.data[4*e+2]=o.data[2],n.data[4*e+3]=o.data[3]}}}}}else if(r instanceof Qm){const e=r.value;if(!(n instanceof wg))return;if(o instanceof bg){if(e.length>1)return;if("x"===e)n.data[0]=o.value;else if("y"===e){if(n.data.length<2)return;n.data[1]=o.value}else if("z"===e){if(n.data.length<3)return;n.data[2]=o.value}else if("w"===e){if(n.data.length<4)return;n.data[3]=o.value}}else{if(!(o instanceof wg))return;if(e.length!==o.data.length)return;for(let t=0;t<e.length;++t){const i=e[t];if("x"===i||"r"===i)n.data[0]=o.data[t];else if("y"===i||"g"===i){if(o.data.length<2)return;n.data[1]=o.data[t]}else if("z"===i||"b"===i){if(o.data.length<3)return;n.data[2]=o.data[t]}else{if("w"!==i&&"a"!==i)return;if(o.data.length<4)return;n.data[3]=o.data[t]}}}}}else n instanceof bg&&o instanceof bg?n.value=o.value:(n instanceof wg&&o instanceof wg||n instanceof Sg&&o instanceof Sg)&&n.data.set(o.data)}_function(e,t){const n=new jg(e);t.functions.set(e.name,n)}_const(e,t){let n=null;null!==e.value&&(n=this.evalExpression(e.value,t)),t.createVariable(e.name,n,e)}_let(e,t){let n=null;if(null!==e.value){if(n=this.evalExpression(e.value,t),null===n)return;e.value instanceof ag||(n=n.clone())}else{const i=e.type.name;if("f32"===i||"i32"===i||"u32"===i||"bool"===i||"f16"===i||"vec2"===i||"vec3"===i||"vec4"===i||"vec2f"===i||"vec3f"===i||"vec4f"===i||"vec2i"===i||"vec3i"===i||"vec4i"===i||"vec2u"===i||"vec3u"===i||"vec4u"===i||"vec2h"===i||"vec3h"===i||"vec4h"===i||"vec2b"===i||"vec3b"===i||"vec4b"===i||"mat2x2"===i||"mat2x3"===i||"mat2x4"===i||"mat3x2"===i||"mat3x3"===i||"mat3x4"===i||"mat4x2"===i||"mat4x3"===i||"mat4x4"===i||"mat2x2f"===i||"mat2x3f"===i||"mat2x4f"===i||"mat3x2f"===i||"mat3x3f"===i||"mat3x4f"===i||"mat4x2f"===i||"mat4x3f"===i||"mat4x4f"===i||"mat2x2h"===i||"mat2x3h"===i||"mat2x4h"===i||"mat3x2h"===i||"mat3x3h"===i||"mat3x4h"===i||"mat4x2h"===i||"mat4x3h"===i||"mat4x4h"===i||"array"===i){const i=new Jm(e.type,[]);n=this._evalCreate(i,t)}}t.createVariable(e.name,n,e)}_var(e,t){let n=null;if(null!==e.value){if(n=this.evalExpression(e.value,t),null===n)return;e.value instanceof ag||(n=n.clone())}else{if(null===e.type)return;const i=e.type.name;if("f32"===i||"i32"===i||"u32"===i||"bool"===i||"f16"===i||"vec2"===i||"vec3"===i||"vec4"===i||"vec2f"===i||"vec3f"===i||"vec4f"===i||"vec2i"===i||"vec3i"===i||"vec4i"===i||"vec2u"===i||"vec3u"===i||"vec4u"===i||"vec2h"===i||"vec3h"===i||"vec4h"===i||"vec2b"===i||"vec3b"===i||"vec4b"===i||"mat2x2"===i||"mat2x3"===i||"mat2x4"===i||"mat3x2"===i||"mat3x3"===i||"mat3x4"===i||"mat4x2"===i||"mat4x3"===i||"mat4x4"===i||"mat2x2f"===i||"mat2x3f"===i||"mat2x4f"===i||"mat3x2f"===i||"mat3x3f"===i||"mat3x4f"===i||"mat4x2f"===i||"mat4x3f"===i||"mat4x4f"===i||"mat2x2h"===i||"mat2x3h"===i||"mat2x4h"===i||"mat3x2h"===i||"mat3x3h"===i||"mat3x4h"===i||"mat4x2h"===i||"mat4x3h"===i||"mat4x4h"===i||e.type instanceof Xm||e.type instanceof jm||e.type instanceof Ym){const i=new Jm(e.type,[]);n=this._evalCreate(i,t)}}t.createVariable(e.name,n,e)}_switch(e,t){t=t.clone();const n=this.evalExpression(e.condition,t);if(!(n instanceof bg))return null;let i=null;for(const r of e.cases)if(r instanceof dg)for(const e of r.selectors){if(e instanceof ug){i=r;continue}const o=this.evalExpression(e,t);if(!(o instanceof bg))return null;if(o.value===n.value)return this._execStatements(r.body,t)}else r instanceof hg&&(i=r);return i?this._execStatements(i.body,t):null}_if(e,t){t=t.clone();const n=this.evalExpression(e.condition,t);if(!(n instanceof bg))return null;if(n.value)return this._execStatements(e.body,t);for(const i of e.elseif){const e=this.evalExpression(i.condition,t);if(!(e instanceof bg))return null;if(e.value)return this._execStatements(i.body,t)}return e.else?this._execStatements(e.else,t):null}_getScalarValue(e){return e instanceof bg?e.value:0}_for(e,t){for(t=t.clone(),this.execStatement(e.init,t);this._getScalarValue(this.evalExpression(e.condition,t));){const n=this._execStatements(e.body,t);if(n===Qg._breakObj)break;if(null!==n&&n!==Qg._continueObj)return n;this.execStatement(e.increment,t)}return null}_loop(e,t){for(t=t.clone();;){const n=this._execStatements(e.body,t);if(n===Qg._breakObj)break;if(n===Qg._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,t)===Qg._breakObj)break}else if(null!==n)return n}return null}_while(e,t){for(t=t.clone();this._getScalarValue(this.evalExpression(e.condition,t));){const n=this._execStatements(e.body,t);if(n===Qg._breakObj)break;if(n!==Qg._continueObj&&null!==n)return n}return null}_evalBitcast(e,t){const n=this.evalExpression(e.value,t),i=e.type;if(n instanceof bg){const e=Ug(n.value,n.typeInfo.name,i.name);return new bg(e,this.getTypeInfo(i))}if(n instanceof wg){const e=n.typeInfo.getTypeName();let t="";if(e.endsWith("f"))t="f32";else if(e.endsWith("i"))t="i32";else if(e.endsWith("u"))t="u32";else if(e.endsWith("b"))t="bool";else{if(!e.endsWith("h"))return null;t="f16"}const r=i.getTypeName();let o="";if(r.endsWith("f"))o="f32";else if(r.endsWith("i"))o="i32";else if(r.endsWith("u"))o="u32";else if(r.endsWith("b"))o="bool";else{if(!r.endsWith("h"))return null;o="f16"}const s=function(e,t,n){if(t===n)return e;const i=new Array(e.length);for(let r=0;r<e.length;r++)i[r]=Ug(e[r],t,n);return i}(Array.from(n.data),t,o);return new wg(s,this.getTypeInfo(i))}return null}_evalConst(e,t){return t.getVariableValue(e.name).clone().getSubData(this,e.postfix,t)}_evalCreate(e,t){var n;if(e instanceof Jm){if(null===e.type)return yg.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,t);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,t);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,t)}}e instanceof Jm?e.type.name:e.name;const i=e instanceof Jm?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(null===i)return null;if(0===i.size)return null;const r=new Eg(new ArrayBuffer(i.size),i,0);if(i instanceof Hp){if(e.args)for(let o=0;o<e.args.length;++o){const n=i.members[o],s=e.args[o],a=this.evalExpression(s,t);r.setData(this,a,n.type,n.offset,t)}}else if(i instanceof Wp){let o=0;if(e.args)for(let s=0;s<e.args.length;++s){const a=e.args[s],l=this.evalExpression(a,t);null===i.format&&("x32"===(null===(n=l.typeInfo)||void 0===n?void 0:n.name)?i.format=this.getTypeInfo("i32"):i.format=l.typeInfo),r.setData(this,l,i.format,o,t),o+=i.stride}}return e instanceof Jm?r.getSubData(this,e.postfix,t):r}_evalLiteral(e,t){const n=this.getTypeInfo(e.type),i=n.name;return"x32"===i||"u32"===i||"f32"===i||"f16"===i||"i32"===i||"bool"===i?new bg(e.scalarValue,n):"vec2"===i||"vec3"===i||"vec4"===i||"vec2f"===i||"vec3f"===i||"vec4f"===i||"vec2h"===i||"vec3h"===i||"vec4h"===i||"vec2i"===i||"vec3i"===i||"vec4i"===i||"vec2u"===i||"vec3u"===i||"vec4u"===i?this._callConstructorVec(e,t):"mat2x2"===i||"mat2x3"===i||"mat2x4"===i||"mat3x2"===i||"mat3x3"===i||"mat3x4"===i||"mat4x2"===i||"mat4x3"===i||"mat4x4"===i||"mat2x2f"===i||"mat2x3f"===i||"mat2x4f"===i||"mat3x2f"===i||"mat3x3f"===i||"mat3x4f"===i||"mat4x2f"===i||"mat4x3f"===i||"mat4x4f"===i||"mat2x2h"===i||"mat2x3h"===i||"mat2x4h"===i||"mat3x2h"===i||"mat3x3h"===i||"mat3x4h"===i||"mat4x2h"===i||"mat4x3h"===i||"mat4x4h"===i?this._callConstructorMatrix(e,t):e.value}_evalVariable(e,t){const n=t.getVariableValue(e.name);return null===n?n:n.getSubData(this,e.postfix,t)}_maxFormatTypeInfo(e){let t=e[0];if("f32"===t.name)return t;for(let n=1;n<e.length;++n){const i=Qg._priority.get(t.name);Qg._priority.get(e[n].name)<i&&(t=e[n])}return"x32"===t.name?this.getTypeInfo("i32"):t}_evalUnaryOp(e,t){const n=this.evalExpression(e.right,t);if("&"===e.operator)return new vg(n);if("*"===e.operator)return n instanceof vg?n.reference.getSubData(this,e.postfix,t):null;const i=n instanceof bg?n.value:n instanceof wg?Array.from(n.data):null;switch(e.operator){case"+":{if(Lg(i)){const e=i.map((e,t)=>+e);return new wg(e,n.typeInfo)}const e=i,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new bg(+e,t)}case"-":{if(Lg(i)){const e=i.map((e,t)=>-e);return new wg(e,n.typeInfo)}const e=i,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new bg(-e,t)}case"!":{if(Lg(i)){const e=i.map((e,t)=>e?0:1);return new wg(e,n.typeInfo)}const e=i,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new bg(e?0:1,t)}case"~":{if(Lg(i)){const e=i.map((e,t)=>~e);return new wg(e,n.typeInfo)}const e=i,t=this._maxFormatTypeInfo([n.typeInfo,n.typeInfo]);return new bg(~e,t)}}return null}_evalBinaryOp(e,t){const n=this.evalExpression(e.left,t),i=this.evalExpression(e.right,t),r=n instanceof bg?n.value:n instanceof wg||n instanceof Sg?Array.from(n.data):null,o=i instanceof bg?i.value:i instanceof wg||i instanceof Sg?Array.from(i.data):null;switch(e.operator){case"+":{if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e+t[n]);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t+e);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e+t);return new wg(t,i.typeInfo)}const e=r,t=o,s=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new bg(e+t,s)}case"-":{if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e-t[n]);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t-e);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e-t);return new wg(t,i.typeInfo)}const e=r,t=o,s=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new bg(e-t,s)}case"*":{if(Lg(r)&&Lg(o)){const e=r,t=o;if(n instanceof Sg&&i instanceof Sg){const r=function(e,t,n,i){if(void 0===Zg[t.name]||void 0===Zg[i.name])return null;const r=Zg[t.name][0],o=Zg[t.name][1],s=Zg[i.name][0];if(r!==Zg[i.name][1])return null;const a=new Array(s*o);for(let l=0;l<o;l++)for(let t=0;t<s;t++){let i=0;for(let s=0;s<r;s++)i+=e[s*o+l]*n[t*r+s];a[l*s+t]=i}return a}(e,n.typeInfo,t,i.typeInfo);if(null===r)return null;const o=Zg[i.typeInfo.name][0],s=Zg[n.typeInfo.name][1],a=this.getTypeInfo(`mat${o}x${s}f`);return new Sg(r,a)}if(n instanceof Sg&&i instanceof wg){const r=function(e,t,n,i){if(void 0===Zg[t.name]||void 0===Kg[i.name])return null;const r=Zg[t.name][0],o=Zg[t.name][1];if(r!==n.length)return null;const s=new Array(o);for(let a=0;a<o;a++){let t=0;for(let i=0;i<r;i++)t+=e[i*o+a]*n[i];s[a]=t}return s}(e,n.typeInfo,t,i.typeInfo);return null===r?null:new wg(r,i.typeInfo)}if(n instanceof wg&&i instanceof Sg){const r=function(e,t,n,i){if(void 0===Kg[t.name]||void 0===Zg[i.name])return null;const r=Zg[i.name][0],o=Zg[i.name][1];if(o!==e.length)return null;const s=[];for(let a=0;a<r;a++){let t=0;for(let i=0;i<o;i++)t+=e[i]*n[i*r+a];s[a]=t}return s}(e,n.typeInfo,t,i.typeInfo);return null===r?null:new wg(r,n.typeInfo)}{if(e.length!==t.length)return null;const i=e.map((e,n)=>e*t[n]);return new wg(i,n.typeInfo)}}if(Lg(r)){const e=o,t=r.map((t,n)=>t*e);return n instanceof Sg?new Sg(t,n.typeInfo):new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e*t);return i instanceof Sg?new Sg(t,i.typeInfo):new wg(t,i.typeInfo)}const e=r,t=o,s=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new bg(e*t,s)}case"%":{if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e%t[n]);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t%e);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e%t);return new wg(t,i.typeInfo)}const e=r,t=o,s=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new bg(e%t,s)}case"/":{if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e/t[n]);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t/e);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e/t);return new wg(t,i.typeInfo)}const e=r,t=o,s=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new bg(e/t,s)}case"&":{if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e&t[n]);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t&e);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e&t);return new wg(t,i.typeInfo)}const e=r,t=o,s=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new bg(e&t,s)}case"|":{if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e|t[n]);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t|e);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e|t);return new wg(t,i.typeInfo)}const e=r,t=o,s=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new bg(e|t,s)}case"^":{if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e^t[n]);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t^e);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e^t);return new wg(t,i.typeInfo)}const e=r,t=o,s=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new bg(e^t,s)}case"<<":{if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e<<t[n]);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t<<e);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e<<t);return new wg(t,i.typeInfo)}const e=r,t=o,s=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new bg(e<<t,s)}case">>":{if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e>>t[n]);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t>>e);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e>>t);return new wg(t,i.typeInfo)}const e=r,t=o,s=this._maxFormatTypeInfo([n.typeInfo,i.typeInfo]);return new bg(e>>t,s)}case">":if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e>t[n]?1:0);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t>e?1:0);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e>t?1:0);return new wg(t,i.typeInfo)}return new bg(r>o?1:0,this.getTypeInfo("bool"));case"<":if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e<t[n]?1:0);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t<e?1:0);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e<t?1:0);return new wg(t,i.typeInfo)}return new bg(r<o?1:0,this.getTypeInfo("bool"));case"==":if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e===t[n]?1:0);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t==e?1:0);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e==t?1:0);return new wg(t,i.typeInfo)}return new bg(r===o?1:0,this.getTypeInfo("bool"));case"!=":if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e!==t[n]?1:0);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t!==e?1:0);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e!==t?1:0);return new wg(t,i.typeInfo)}return new bg(r!==o?1:0,this.getTypeInfo("bool"));case">=":if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e>=t[n]?1:0);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t>=e?1:0);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e>=t?1:0);return new wg(t,i.typeInfo)}return new bg(r>=o?1:0,this.getTypeInfo("bool"));case"<=":if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e<=t[n]?1:0);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t<=e?1:0);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e<=t?1:0);return new wg(t,i.typeInfo)}return new bg(r<=o?1:0,this.getTypeInfo("bool"));case"&&":if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e&&t[n]?1:0);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t&&e?1:0);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e&&t?1:0);return new wg(t,i.typeInfo)}return new bg(r&&o?1:0,this.getTypeInfo("bool"));case"||":if(Lg(r)&&Lg(o)){const e=r,t=o;if(e.length!==t.length)return null;const i=e.map((e,n)=>e||t[n]?1:0);return new wg(i,n.typeInfo)}if(Lg(r)){const e=o,t=r.map((t,n)=>t||e?1:0);return new wg(t,n.typeInfo)}if(Lg(o)){const e=r,t=o.map((t,n)=>e||t?1:0);return new wg(t,i.typeInfo)}return new bg(r||o?1:0,this.getTypeInfo("bool"))}return null}_evalCall(e,t){if(null!==e.cachedReturnValue)return e.cachedReturnValue;const n=t.clone();n.currentFunctionName=e.name;const i=t.getFunction(e.name);if(!i)return e.isBuiltin?this._callBuiltinFunction(e,n):this.getTypeInfo(e.name)?this._evalCreate(e,t):null;for(let r=0;r<i.node.args.length;++r){const t=i.node.args[r],o=this.evalExpression(e.args[r],n);n.createVariable(t.name,o,t)}return this._execStatements(i.node.body,n)}_callBuiltinFunction(e,t){switch(e.name){case"all":return this.builtins.All(e,t);case"any":return this.builtins.Any(e,t);case"select":return this.builtins.Select(e,t);case"arrayLength":return this.builtins.ArrayLength(e,t);case"abs":return this.builtins.Abs(e,t);case"acos":return this.builtins.Acos(e,t);case"acosh":return this.builtins.Acosh(e,t);case"asin":return this.builtins.Asin(e,t);case"asinh":return this.builtins.Asinh(e,t);case"atan":return this.builtins.Atan(e,t);case"atanh":return this.builtins.Atanh(e,t);case"atan2":return this.builtins.Atan2(e,t);case"ceil":return this.builtins.Ceil(e,t);case"clamp":return this.builtins.Clamp(e,t);case"cos":return this.builtins.Cos(e,t);case"cosh":return this.builtins.Cosh(e,t);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,t);case"countOneBits":return this.builtins.CountOneBits(e,t);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,t);case"cross":return this.builtins.Cross(e,t);case"degrees":return this.builtins.Degrees(e,t);case"determinant":return this.builtins.Determinant(e,t);case"distance":return this.builtins.Distance(e,t);case"dot":return this.builtins.Dot(e,t);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,t);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,t);case"exp":return this.builtins.Exp(e,t);case"exp2":return this.builtins.Exp2(e,t);case"extractBits":return this.builtins.ExtractBits(e,t);case"faceForward":return this.builtins.FaceForward(e,t);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,t);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,t);case"floor":return this.builtins.Floor(e,t);case"fma":return this.builtins.Fma(e,t);case"fract":return this.builtins.Fract(e,t);case"frexp":return this.builtins.Frexp(e,t);case"insertBits":return this.builtins.InsertBits(e,t);case"inverseSqrt":return this.builtins.InverseSqrt(e,t);case"ldexp":return this.builtins.Ldexp(e,t);case"length":return this.builtins.Length(e,t);case"log":return this.builtins.Log(e,t);case"log2":return this.builtins.Log2(e,t);case"max":return this.builtins.Max(e,t);case"min":return this.builtins.Min(e,t);case"mix":return this.builtins.Mix(e,t);case"modf":return this.builtins.Modf(e,t);case"normalize":return this.builtins.Normalize(e,t);case"pow":return this.builtins.Pow(e,t);case"quantizeToF16":return this.builtins.QuantizeToF16(e,t);case"radians":return this.builtins.Radians(e,t);case"reflect":return this.builtins.Reflect(e,t);case"refract":return this.builtins.Refract(e,t);case"reverseBits":return this.builtins.ReverseBits(e,t);case"round":return this.builtins.Round(e,t);case"saturate":return this.builtins.Saturate(e,t);case"sign":return this.builtins.Sign(e,t);case"sin":return this.builtins.Sin(e,t);case"sinh":return this.builtins.Sinh(e,t);case"smoothstep":return this.builtins.SmoothStep(e,t);case"sqrt":return this.builtins.Sqrt(e,t);case"step":return this.builtins.Step(e,t);case"tan":return this.builtins.Tan(e,t);case"tanh":return this.builtins.Tanh(e,t);case"transpose":return this.builtins.Transpose(e,t);case"trunc":return this.builtins.Trunc(e,t);case"dpdx":return this.builtins.Dpdx(e,t);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,t);case"dpdxFine":return this.builtins.DpdxFine(e,t);case"dpdy":return this.builtins.Dpdy(e,t);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,t);case"dpdyFine":return this.builtins.DpdyFine(e,t);case"fwidth":return this.builtins.Fwidth(e,t);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,t);case"fwidthFine":return this.builtins.FwidthFine(e,t);case"textureDimensions":return this.builtins.TextureDimensions(e,t);case"textureGather":return this.builtins.TextureGather(e,t);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,t);case"textureLoad":return this.builtins.TextureLoad(e,t);case"textureNumLayers":return this.builtins.TextureNumLayers(e,t);case"textureNumLevels":return this.builtins.TextureNumLevels(e,t);case"textureNumSamples":return this.builtins.TextureNumSamples(e,t);case"textureSample":return this.builtins.TextureSample(e,t);case"textureSampleBias":return this.builtins.TextureSampleBias(e,t);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,t);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,t);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,t);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,t);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,t);case"textureStore":return this.builtins.TextureStore(e,t);case"atomicLoad":return this.builtins.AtomicLoad(e,t);case"atomicStore":return this.builtins.AtomicStore(e,t);case"atomicAdd":return this.builtins.AtomicAdd(e,t);case"atomicSub":return this.builtins.AtomicSub(e,t);case"atomicMax":return this.builtins.AtomicMax(e,t);case"atomicMin":return this.builtins.AtomicMin(e,t);case"atomicAnd":return this.builtins.AtomicAnd(e,t);case"atomicOr":return this.builtins.AtomicOr(e,t);case"atomicXor":return this.builtins.AtomicXor(e,t);case"atomicExchange":return this.builtins.AtomicExchange(e,t);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,t);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,t);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,t);case"pack4xI8":return this.builtins.Pack4xI8(e,t);case"pack4xU8":return this.builtins.Pack4xU8(e,t);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,t);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,t);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,t);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,t);case"pack2x16float":return this.builtins.Pack2x16float(e,t);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,t);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,t);case"unpack4xI8":return this.builtins.Unpack4xI8(e,t);case"unpack4xU8":return this.builtins.Unpack4xU8(e,t);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,t);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,t);case"unpack2x16float":return this.builtins.Unpack2x16float(e,t);case"storageBarrier":return this.builtins.StorageBarrier(e,t);case"textureBarrier":return this.builtins.TextureBarrier(e,t);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,t);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,t);case"subgroupAdd":return this.builtins.SubgroupAdd(e,t);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,t);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,t);case"subgroupAll":return this.builtins.SubgroupAll(e,t);case"subgroupAnd":return this.builtins.SubgroupAnd(e,t);case"subgroupAny":return this.builtins.SubgroupAny(e,t);case"subgroupBallot":return this.builtins.SubgroupBallot(e,t);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,t);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,t);case"subgroupElect":return this.builtins.SubgroupElect(e,t);case"subgroupMax":return this.builtins.SubgroupMax(e,t);case"subgroupMin":return this.builtins.SubgroupMin(e,t);case"subgroupMul":return this.builtins.SubgroupMul(e,t);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,t);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,t);case"subgroupOr":return this.builtins.SubgroupOr(e,t);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,t);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,t);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,t);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,t);case"subgroupXor":return this.builtins.SubgroupXor(e,t);case"quadBroadcast":return this.builtins.QuadBroadcast(e,t);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,t);case"quadSwapX":return this.builtins.QuadSwapX(e,t);case"quadSwapY":return this.builtins.QuadSwapY(e,t)}const n=t.getFunction(e.name);if(n){const i=t.clone();for(let t=0;t<n.node.args.length;++t){const r=n.node.args[t],o=this.evalExpression(e.args[t],i);i.setVariable(r.name,o,r)}return this._execStatements(n.node.body,i)}return null}_callConstructorValue(e,t){if(!e.args||0===e.args.length)return new bg(0,this.getTypeInfo(e.type));const n=this.evalExpression(e.args[0],t);return n.typeInfo=this.getTypeInfo(e.type),n.getSubData(this,e.postfix,t).clone()}_callConstructorVec(e,t){const n=this.getTypeInfo(e.type),i=e.type.getTypeName(),r=Kg[i];if(void 0===r)return null;const o=[];if(e instanceof ig)if(e.isVector){const t=e.vectorValue;for(const e of t)o.push(e)}else o.push(e.scalarValue);else if(e.args)for(const s of e.args){const e=this.evalExpression(s,t);if(e instanceof wg){const t=e.data;for(let e=0;e<t.length;++e){let n=t[e];o.push(n)}}else if(e instanceof bg){let t=e.value;o.push(t)}}if(e.type instanceof Ym&&null===e.type.format&&(e.type.format=Ym.f32),0===o.length){const i=new Array(r).fill(0);return new wg(i,n).getSubData(this,e.postfix,t)}if(1===o.length)for(;o.length<r;)o.push(o[0]);return o.length<r?null:new wg(o.length>r?o.slice(0,r):o,n).getSubData(this,e.postfix,t)}_callConstructorMatrix(e,t){const n=this.getTypeInfo(e.type),i=e.type.getTypeName(),r=Zg[i];if(void 0===r)return null;const o=[];if(e instanceof ig)if(e.isVector){const t=e.vectorValue;for(const e of t)o.push(e)}else o.push(e.scalarValue);else if(e.args)for(const s of e.args){const e=this.evalExpression(s,t);e instanceof wg?o.push(...e.data):e instanceof bg?o.push(e.value):e instanceof Sg&&o.push(...e.data)}if(n instanceof Gp&&null===n.format&&(n.format=this.getTypeInfo("f32")),0===o.length){const i=new Array(r[2]).fill(0);return new Sg(i,n).getSubData(this,e.postfix,t)}return o.length!==r[2]?null:new Sg(o,n).getSubData(this,e.postfix,t)}}Qg._breakObj=new _g(new Up("BREAK",null),null),Qg._continueObj=new _g(new Up("CONTINUE",null),null),Qg._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class Jg{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class e_{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new Jg,this._exec=new Qg,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const t=[];for(;!this._isAtEnd();){const e=this._global_decl_or_directive();if(!e)break;t.push(e)}if(this._deferArrayCountEval.length>0){for(const e of this._deferArrayCountEval){const t=e.arrayType,n=e.countNode;if(n instanceof tg){const e=n.name,i=this._context.constants.get(e);if(i)try{const e=i.constEvaluate(this._exec);t.count=e}catch{}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const n of t)n.search(e=>{e instanceof mg||e instanceof qm?e.type=this._forwardType(e.type):e instanceof Xm?e.format=this._forwardType(e.format):e instanceof wm||e instanceof Em||e instanceof Cm?e.type=this._forwardType(e.type):e instanceof _m?e.returnType=this._forwardType(e.returnType):e instanceof fg&&(e.type=this._forwardType(e.type))});return t}_forwardType(e){if(e instanceof Gm){const t=this._getType(e.name);if(t)return t}else e instanceof qm?e.type=this._forwardType(e.type):e instanceof Xm&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if("string"==typeof e){const t=new Ag(e);this._tokens=t.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,t){return e.line=t??this._currentLine,e}_error(e,t){return{token:e,message:t,toString:()=>`${t}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==kg.eof}_match(e){if(e instanceof Tg)return!!this._check(e)&&(this._advance(),!0);for(let t=0,n=e.length;t<n;++t){const n=e[t];if(this._check(n))return this._advance(),!0}return!1}_consume(e,t){if(this._check(e))return this._advance();throw this._error(this._peek(),`${t}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;const t=this._peek();if(e instanceof Array){const n=t.type;let i=!1;for(const t of e){if(n===t)return!0;t===kg.tokens.name&&(i=!0)}if(i){const e=kg.tokens.name.rule.exec(t.lexeme);if(e&&0==e.index&&e[0]==t.lexeme)return!0}return!1}if(t.type===e)return!0;if(e===kg.tokens.name){const e=kg.tokens.name.rule.exec(t.lexeme);return e&&0==e.index&&e[0]==t.lexeme}return!1}_advance(){var e,t;return this._currentLine=null!==(t=null===(e=this._peek())||void 0===e?void 0:e.line)&&void 0!==t?t:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(kg.tokens.semicolon)&&!this._isAtEnd(););if(this._match(kg.keywords.alias)){const e=this._type_alias();return this._consume(kg.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}if(this._match(kg.keywords.diagnostic)){const e=this._diagnostic();return this._consume(kg.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}if(this._match(kg.keywords.requires)){const e=this._requires_directive();return this._consume(kg.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}if(this._match(kg.keywords.enable)){const e=this._enable_directive();return this._consume(kg.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([e]),e}const e=this._attribute();if(this._check(kg.keywords.var)){const t=this._global_variable_decl();return null!=t&&(t.attributes=e),this._consume(kg.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(kg.keywords.override)){const t=this._override_variable_decl();return null!=t&&(t.attributes=e),this._consume(kg.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(kg.keywords.let)){const t=this._global_let_decl();return null!=t&&(t.attributes=e),this._consume(kg.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(kg.keywords.const)){const t=this._global_const_decl();return null!=t&&(t.attributes=e),this._consume(kg.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(kg.keywords.struct)){const t=this._struct_decl();return null!=t&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}if(this._check(kg.keywords.fn)){const t=this._function_decl();return null!=t&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}return null}_function_decl(){if(!this._match(kg.keywords.fn))return null;const e=this._currentLine,t=this._consume(kg.tokens.ident,"Expected function name.").toString();this._consume(kg.tokens.paren_left,"Expected '(' for function arguments.");const n=[];if(!this._check(kg.tokens.paren_right))do{if(this._check(kg.tokens.paren_right))break;const e=this._attribute(),t=this._consume(kg.tokens.name,"Expected argument name.").toString();this._consume(kg.tokens.colon,"Expected ':' for argument type.");const i=this._attribute(),r=this._type_decl();null!=r&&(r.attributes=i,n.push(this._updateNode(new fg(t,r,e))))}while(this._match(kg.tokens.comma));this._consume(kg.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(kg.tokens.arrow)){const e=this._attribute();i=this._type_decl(),null!=i&&(i.attributes=e)}const r=this._compound_statement(),o=this._currentLine;return this._updateNode(new _m(t,n,i,r,e,o),e)}_compound_statement(){const e=[];for(this._consume(kg.tokens.brace_left,"Expected '{' for block.");!this._check(kg.tokens.brace_right);){const t=this._statement();null!==t&&e.push(t)}return this._consume(kg.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(kg.tokens.semicolon)&&!this._isAtEnd(););if(this._check(kg.tokens.attr)&&this._attribute(),this._check(kg.keywords.if))return this._if_statement();if(this._check(kg.keywords.switch))return this._switch_statement();if(this._check(kg.keywords.loop))return this._loop_statement();if(this._check(kg.keywords.for))return this._for_statement();if(this._check(kg.keywords.while))return this._while_statement();if(this._check(kg.keywords.continuing))return this._continuing_statement();if(this._check(kg.keywords.static_assert))return this._static_assert_statement();if(this._check(kg.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(kg.keywords.return))e=this._return_statement();else if(this._check([kg.keywords.var,kg.keywords.let,kg.keywords.const]))e=this._variable_statement();else if(this._match(kg.keywords.discard))e=this._updateNode(new Vm);else if(this._match(kg.keywords.break)){const t=this._updateNode(new Hm);if(this._currentLoop.length>0){const e=this._currentLoop[this._currentLoop.length-1];t.loopId=e.id}e=t,this._check(kg.keywords.if)&&(this._advance(),t.condition=this._optional_paren_expression())}else if(this._match(kg.keywords.continue)){const t=this._updateNode(new Wm);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${t.line}`);{const e=this._currentLoop[this._currentLoop.length-1];t.loopId=e.id}e=t}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return null!=e&&this._consume(kg.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(kg.keywords.static_assert))return null;const e=this._currentLine,t=this._optional_paren_expression();return this._updateNode(new ym(t),e)}_while_statement(){if(!this._match(kg.keywords.while))return null;const e=this._updateNode(new vm(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(kg.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(kg.keywords.continuing))return null;const t=this._currentLine,n=this._compound_statement();return this._updateNode(new bm(n,e),t)}_for_statement(){if(!this._match(kg.keywords.for))return null;this._consume(kg.tokens.paren_left,"Expected '('.");const e=this._updateNode(new xm(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(kg.tokens.semicolon)?null:this._for_init(),this._consume(kg.tokens.semicolon,"Expected ';'."),e.condition=this._check(kg.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(kg.tokens.semicolon,"Expected ';'."),e.increment=this._check(kg.tokens.paren_right)?null:this._for_increment(),this._consume(kg.tokens.paren_right,"Expected ')'."),this._check(kg.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(kg.keywords.var)){const e=this._variable_decl();if(null===e)throw this._error(this._peek(),"Variable declaration expected.");let t=null;return this._match(kg.tokens.equal)&&(t=this._short_circuit_or_expression()),this._updateNode(new wm(e.name,e.type,e.storage,e.access,t),e.line)}if(this._match(kg.keywords.let)){const e=this._currentLine,t=this._consume(kg.tokens.name,"Expected name for let.").toString();let n=null;if(this._match(kg.tokens.colon)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}this._consume(kg.tokens.equal,"Expected '=' for let.");const i=this._short_circuit_or_expression();return this._updateNode(new Em(t,n,null,null,i),e)}if(this._match(kg.keywords.const)){const e=this._currentLine,t=this._consume(kg.tokens.name,"Expected name for const.").toString();let n=null;if(this._match(kg.tokens.colon)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}this._consume(kg.tokens.equal,"Expected '=' for const.");const i=this._short_circuit_or_expression();return null===n&&i instanceof ig&&(n=i.type),this._updateNode(new Cm(t,n,null,null,i),e)}return null}_increment_decrement_statement(){const e=this._current,t=this._unary_expression();if(null==t)return null;if(!this._check(kg.increment_operators))return this._current=e,null;const n=this._consume(kg.increment_operators,"Expected increment operator");return this._updateNode(new Lm(n.type===kg.tokens.plus_plus?Tm.increment:Tm.decrement,t))}_assignment_statement(){let e=null;const t=this._currentLine;if(this._check(kg.tokens.brace_right))return null;let n=this._match(kg.tokens.underscore);if(n||(e=this._unary_expression()),!n&&null==e)return null;const i=this._consume(kg.assignment_operators,"Expected assignment operator."),r=this._short_circuit_or_expression();return this._updateNode(new Rm(km.parse(i.lexeme),e,r),t)}_func_call_statement(){if(!this._check(kg.tokens.ident))return null;const e=this._currentLine,t=this._current,n=this._consume(kg.tokens.ident,"Expected function name."),i=this._argument_expression_list();return null===i?(this._current=t,null):this._updateNode(new Pm(n.lexeme,i),e)}_loop_statement(){if(!this._match(kg.keywords.loop))return null;this._check(kg.tokens.attr)&&this._attribute(),this._consume(kg.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new Mm([],null));this._currentLoop.push(e);let t=this._statement();for(;null!==t;){if(Array.isArray(t))for(let n of t)e.body.push(n);else e.body.push(t);if(t instanceof bm){e.continuing=t;break}t=this._statement()}return this._currentLoop.pop(),this._consume(kg.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(kg.keywords.switch))return null;const e=this._updateNode(new Dm(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(kg.tokens.attr)&&this._attribute(),this._consume(kg.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),null==e.cases||0==e.cases.length)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(kg.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let t=!1;for(;this._check([kg.keywords.default,kg.keywords.case]);){if(this._match(kg.keywords.case)){const n=this._case_selectors();for(const e of n)if(e instanceof ug){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");t=!0;break}this._match(kg.tokens.colon),this._check(kg.tokens.attr)&&this._attribute(),this._consume(kg.tokens.brace_left,"Exected '{' for switch case.");const i=this._case_body();this._consume(kg.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new dg(n,i)))}if(this._match(kg.keywords.default)){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(kg.tokens.colon),this._check(kg.tokens.attr)&&this._attribute(),this._consume(kg.tokens.brace_left,"Exected '{' for switch default.");const n=this._case_body();this._consume(kg.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new hg(n)))}}return e}_case_selectors(){const e=[];for(this._match(kg.keywords.default)?e.push(this._updateNode(new ug)):e.push(this._shift_expression());this._match(kg.tokens.comma);)this._match(kg.keywords.default)?e.push(this._updateNode(new ug)):e.push(this._shift_expression());return e}_case_body(){if(this._match(kg.keywords.fallthrough))return this._consume(kg.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(null==e)return[];e instanceof Array||(e=[e]);const t=this._case_body();return 0==t.length?e:[...e,t[0]]}_if_statement(){if(!this._match(kg.keywords.if))return null;const e=this._currentLine,t=this._optional_paren_expression();this._check(kg.tokens.attr)&&this._attribute();const n=this._compound_statement();let i=[];this._match_elseif()&&(this._check(kg.tokens.attr)&&this._attribute(),i=this._elseif_statement(i));let r=null;return this._match(kg.keywords.else)&&(this._check(kg.tokens.attr)&&this._attribute(),r=this._compound_statement()),this._updateNode(new Nm(t,n,i,r),e)}_match_elseif(){return this._tokens[this._current].type===kg.keywords.else&&this._tokens[this._current+1].type===kg.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const t=this._optional_paren_expression(),n=this._compound_statement();return e.push(this._updateNode(new pg(t,n))),this._match_elseif()&&(this._check(kg.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(kg.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new Fm(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(kg.tokens.or_or);)e=this._updateNode(new lg(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(kg.tokens.and_and);)e=this._updateNode(new lg(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(kg.tokens.or);)e=this._updateNode(new lg(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(kg.tokens.xor);)e=this._updateNode(new lg(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(kg.tokens.and);)e=this._updateNode(new lg(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([kg.tokens.equal_equal,kg.tokens.not_equal])?this._updateNode(new lg(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([kg.tokens.less_than,kg.tokens.greater_than,kg.tokens.less_than_equal,kg.tokens.greater_than_equal]);)e=this._updateNode(new lg(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([kg.tokens.shift_left,kg.tokens.shift_right]);)e=this._updateNode(new lg(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([kg.tokens.plus,kg.tokens.minus]);)e=this._updateNode(new lg(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([kg.tokens.star,kg.tokens.forward_slash,kg.tokens.modulo]);)e=this._updateNode(new lg(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([kg.tokens.minus,kg.tokens.bang,kg.tokens.tilde,kg.tokens.star,kg.tokens.and])?this._updateNode(new ag(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),t=this._postfix_expression();return t&&(e.postfix=t),e}_postfix_expression(){if(this._match(kg.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(kg.tokens.bracket_right,"Expected ']'.");const t=this._updateNode(new og(e)),n=this._postfix_expression();return n&&(t.postfix=n),t}if(this._match(kg.tokens.period)){const e=this._consume(kg.tokens.name,"Expected member name."),t=this._postfix_expression(),n=this._updateNode(new Qm(e.lexeme));return t&&(n.postfix=t),n}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const t=this._getStruct(e);if(null!==t)return t;switch(e){case"void":return $m.void;case"bool":return $m.bool;case"i32":return $m.i32;case"u32":return $m.u32;case"f32":return $m.f32;case"f16":return $m.f16;case"vec2f":return Ym.vec2f;case"vec3f":return Ym.vec3f;case"vec4f":return Ym.vec4f;case"vec2i":return Ym.vec2i;case"vec3i":return Ym.vec3i;case"vec4i":return Ym.vec4i;case"vec2u":return Ym.vec2u;case"vec3u":return Ym.vec3u;case"vec4u":return Ym.vec4u;case"vec2h":return Ym.vec2h;case"vec3h":return Ym.vec3h;case"vec4h":return Ym.vec4h;case"mat2x2f":return Ym.mat2x2f;case"mat2x3f":return Ym.mat2x3f;case"mat2x4f":return Ym.mat2x4f;case"mat3x2f":return Ym.mat3x2f;case"mat3x3f":return Ym.mat3x3f;case"mat3x4f":return Ym.mat3x4f;case"mat4x2f":return Ym.mat4x2f;case"mat4x3f":return Ym.mat4x3f;case"mat4x4f":return Ym.mat4x4f;case"mat2x2h":return Ym.mat2x2h;case"mat2x3h":return Ym.mat2x3h;case"mat2x4h":return Ym.mat2x4h;case"mat3x2h":return Ym.mat3x2h;case"mat3x3h":return Ym.mat3x3h;case"mat3x4h":return Ym.mat3x4h;case"mat4x2h":return Ym.mat4x2h;case"mat4x3h":return Ym.mat4x3h;case"mat4x4h":return Ym.mat4x4h;case"mat2x2i":return Ym.mat2x2i;case"mat2x3i":return Ym.mat2x3i;case"mat2x4i":return Ym.mat2x4i;case"mat3x2i":return Ym.mat3x2i;case"mat3x3i":return Ym.mat3x3i;case"mat3x4i":return Ym.mat3x4i;case"mat4x2i":return Ym.mat4x2i;case"mat4x3i":return Ym.mat4x3i;case"mat4x4i":return Ym.mat4x4i;case"mat2x2u":return Ym.mat2x2u;case"mat2x3u":return Ym.mat2x3u;case"mat2x4u":return Ym.mat2x4u;case"mat3x2u":return Ym.mat3x2u;case"mat3x3u":return Ym.mat3x3u;case"mat3x4u":return Ym.mat3x4u;case"mat4x2u":return Ym.mat4x2u;case"mat4x3u":return Ym.mat4x3u;case"mat4x4u":return Ym.mat4x4u}return null}_validateTypeRange(e,t){if("i32"===t.name){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if("u32"===t.name&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(kg.tokens.ident)){const e=this._previous().toString();if(this._check(kg.tokens.paren_left)){const t=this._argument_expression_list(),n=this._getType(e);return null!==n?this._updateNode(new Jm(n,t)):this._updateNode(new eg(e,t))}if(this._context.constants.has(e)){const t=this._context.constants.get(e);return this._updateNode(new ng(e,t.value))}return this._updateNode(new tg(e))}if(this._match(kg.tokens.int_literal)){const e=this._previous().toString();let t=e.endsWith("i")||e.endsWith("i")?$m.i32:e.endsWith("u")||e.endsWith("U")?$m.u32:$m.x32;const n=parseInt(e);return this._validateTypeRange(n,t),this._updateNode(new ig(new bg(n,this._exec.getTypeInfo(t)),t))}if(this._match(kg.tokens.uint_literal)){const e=parseInt(this._previous().toString());return this._validateTypeRange(e,$m.u32),this._updateNode(new ig(new bg(e,this._exec.getTypeInfo($m.u32)),$m.u32))}if(this._match([kg.tokens.decimal_float_literal,kg.tokens.hex_float_literal])){let e=this._previous().toString(),t=e.endsWith("h");t&&(e=e.substring(0,e.length-1));const n=parseFloat(e);this._validateTypeRange(n,t?$m.f16:$m.f32);const i=t?$m.f16:$m.f32;return this._updateNode(new ig(new bg(n,this._exec.getTypeInfo(i)),i))}if(this._match([kg.keywords.true,kg.keywords.false])){let e=this._previous().toString()===kg.keywords.true.rule;return this._updateNode(new ig(new bg(e?1:0,this._exec.getTypeInfo($m.bool)),$m.bool))}if(this._check(kg.tokens.paren_left))return this._paren_expression();if(this._match(kg.keywords.bitcast)){this._consume(kg.tokens.less_than,"Expected '<'.");const e=this._type_decl();this._consume(kg.tokens.greater_than,"Expected '>'.");const t=this._paren_expression();return this._updateNode(new rg(e,t))}const e=this._type_decl(),t=this._argument_expression_list();return this._updateNode(new Jm(e,t))}_argument_expression_list(){if(!this._match(kg.tokens.paren_left))return null;const e=[];do{if(this._check(kg.tokens.paren_right))break;const t=this._short_circuit_or_expression();e.push(t)}while(this._match(kg.tokens.comma));return this._consume(kg.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(kg.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(kg.tokens.paren_right),e}_paren_expression(){this._consume(kg.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(kg.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(kg.keywords.struct))return null;const e=this._currentLine,t=this._consume(kg.tokens.ident,"Expected name for struct.").toString();this._consume(kg.tokens.brace_left,"Expected '{' for struct body.");const n=[];for(;!this._check(kg.tokens.brace_right);){const e=this._attribute(),t=this._consume(kg.tokens.name,"Expected variable name.").toString();this._consume(kg.tokens.colon,"Expected ':' for struct member type.");const i=this._attribute(),r=this._type_decl();null!=r&&(r.attributes=i),this._check(kg.tokens.brace_right)?this._match(kg.tokens.comma):this._consume(kg.tokens.comma,"Expected ',' for struct member."),n.push(this._updateNode(new mg(t,r,e)))}this._consume(kg.tokens.brace_right,"Expected '}' after struct body.");const i=this._currentLine,r=this._updateNode(new jm(t,n,e,i),e);return this._context.structs.set(t,r),r}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(kg.tokens.equal)){const t=this._const_expression();e.value=t}if(null!==e.type&&e.value instanceof ig){if("x32"!==e.value.type.name&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else null===e.type&&e.value instanceof ig&&(e.type="x32"===e.value.type.name?$m.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(kg.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(kg.keywords.const))return null;const t=this._consume(kg.tokens.name,"Expected variable name"),n=this._currentLine;let i=null;if(this._match(kg.tokens.colon)){const e=this._attribute();i=this._type_decl(),null!=i&&(i.attributes=e)}let r=null;this._consume(kg.tokens.equal,"const declarations require an assignment");const o=this._short_circuit_or_expression();try{let e=[$m.f32],n=o.constEvaluate(this._exec,e);n instanceof bg&&this._validateTypeRange(n.value,e[0]),e[0]instanceof Ym&&null===e[0].format&&n.typeInfo instanceof Gp&&null!==n.typeInfo.format&&("f16"===n.typeInfo.format.name?e[0].format=$m.f16:"f32"===n.typeInfo.format.name?e[0].format=$m.f32:"i32"===n.typeInfo.format.name?e[0].format=$m.i32:"u32"===n.typeInfo.format.name?e[0].format=$m.u32:"bool"===n.typeInfo.format.name&&(e[0].format=$m.bool)),r=this._updateNode(new ig(n,e[0])),this._exec.context.setVariable(t.toString(),n)}catch{r=o}if(null!==i&&r instanceof ig){if("x32"!==r.type.name&&i.getTypeName()!==r.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${r.type.name} to ${i.name}. Line:${this._currentLine}`);r.type=i,r.isScalar&&this._validateTypeRange(r.scalarValue,r.type)}else null===i&&r instanceof ig&&(i=null!==(e=null==r?void 0:r.type)&&void 0!==e?e:$m.f32,i===$m.x32&&(i=$m.i32));const s=this._updateNode(new Cm(t.toString(),i,"","",r),n);return this._context.constants.set(s.name,s),s}_global_let_decl(){if(!this._match(kg.keywords.let))return null;const e=this._currentLine,t=this._consume(kg.tokens.name,"Expected variable name");let n=null;if(this._match(kg.tokens.colon)){const e=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=e)}let i=null;if(this._match(kg.tokens.equal)&&(i=this._const_expression()),null!==n&&i instanceof ig){if("x32"!==i.type.name&&n.getTypeName()!==i.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${i.type.name} to ${n.name}. Line:${this._currentLine}`);i.type=n}else null===n&&i instanceof ig&&(n="x32"===i.type.name?$m.i32:i.type);return i instanceof ig&&i.isScalar&&this._validateTypeRange(i.scalarValue,n),this._updateNode(new Em(t.toString(),n,"","",i),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(kg.keywords.var))return null;const e=this._currentLine;let t="",n="";this._match(kg.tokens.less_than)&&(t=this._consume(kg.storage_class,"Expected storage_class.").toString(),this._match(kg.tokens.comma)&&(n=this._consume(kg.access_mode,"Expected access_mode.").toString()),this._consume(kg.tokens.greater_than,"Expected '>'."));const i=this._consume(kg.tokens.name,"Expected variable name");let r=null;if(this._match(kg.tokens.colon)){const e=this._attribute();r=this._type_decl(),null!=r&&(r.attributes=e)}return this._updateNode(new wm(i.toString(),r,t,n,null),e)}_override_decl(){if(!this._match(kg.keywords.override))return null;const e=this._consume(kg.tokens.name,"Expected variable name");let t=null;if(this._match(kg.tokens.colon)){const e=this._attribute();t=this._type_decl(),null!=t&&(t.attributes=e)}return this._updateNode(new Sm(e.toString(),t,null))}_diagnostic(){this._consume(kg.tokens.paren_left,"Expected '('");const e=this._consume(kg.tokens.ident,"Expected severity control name.");this._consume(kg.tokens.comma,"Expected ','");let t=this._consume(kg.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(kg.tokens.period)&&(t+=`.${this._consume(kg.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(kg.tokens.paren_right,"Expected ')'"),this._updateNode(new zm(e.toString(),t))}_enable_directive(){const e=this._consume(kg.tokens.ident,"identity expected.");return this._updateNode(new Om(e.toString()))}_requires_directive(){const e=[this._consume(kg.tokens.ident,"identity expected.").toString()];for(;this._match(kg.tokens.comma);){const t=this._consume(kg.tokens.ident,"identity expected.");e.push(t.toString())}return this._updateNode(new Bm(e))}_type_alias(){const e=this._consume(kg.tokens.ident,"identity expected.");this._consume(kg.tokens.equal,"Expected '=' for type alias.");let t=this._type_decl();if(null===t)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(t.name)&&(t=this._context.aliases.get(t.name).type);const n=this._updateNode(new Um(e.toString(),t));return this._context.aliases.set(n.name,n),n}_type_decl(){if(this._check([kg.tokens.ident,...kg.texel_format,kg.keywords.bool,kg.keywords.f32,kg.keywords.i32,kg.keywords.u32])){const e=this._advance().toString();if(this._context.structs.has(e))return this._context.structs.get(e);if(this._context.aliases.has(e))return this._context.aliases.get(e).type;if(!this._getType(e)){const t=this._updateNode(new Gm(e));return this._forwardTypeCount++,t}return this._updateNode(new $m(e))}let e=this._texture_sampler_types();if(e)return e;if(this._check(kg.template_types)){let e=this._advance().toString(),t=null,n=null;return this._match(kg.tokens.less_than)&&(t=this._type_decl(),n=null,this._match(kg.tokens.comma)&&(n=this._consume(kg.access_mode,"Expected access_mode for pointer").toString()),this._consume(kg.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new Ym(e,t,n))}if(this._match(kg.keywords.ptr)){let e=this._previous().toString();this._consume(kg.tokens.less_than,"Expected '<' for pointer.");const t=this._consume(kg.storage_class,"Expected storage_class for pointer");this._consume(kg.tokens.comma,"Expected ',' for pointer.");const n=this._type_decl();let i=null;return this._match(kg.tokens.comma)&&(i=this._consume(kg.access_mode,"Expected access_mode for pointer").toString()),this._consume(kg.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new qm(e,t.toString(),n,i))}const t=this._attribute();if(this._match(kg.keywords.array)){let e=null,n=-1;const i=this._previous();let r=null;if(this._match(kg.tokens.less_than)){e=this._type_decl(),this._context.aliases.has(e.name)&&(e=this._context.aliases.get(e.name).type);let t="";if(this._match(kg.tokens.comma)){r=this._shift_expression();try{t=r.constEvaluate(this._exec).toString(),r=null}catch{t="1"}}this._consume(kg.tokens.greater_than,"Expected '>' for array."),n=t?parseInt(t):0}const o=this._updateNode(new Xm(i.toString(),t,e,n));return r&&this._deferArrayCountEval.push({arrayType:o,countNode:r}),o}return null}_texture_sampler_types(){if(this._match(kg.sampler_type))return this._updateNode(new Km(this._previous().toString(),null,null));if(this._match(kg.depth_texture_type))return this._updateNode(new Km(this._previous().toString(),null,null));if(this._match(kg.sampled_texture_type)||this._match(kg.multisampled_texture_type)){const e=this._previous();this._consume(kg.tokens.less_than,"Expected '<' for sampler type.");const t=this._type_decl();return this._consume(kg.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new Km(e.toString(),t,null))}if(this._match(kg.storage_texture_type)){const e=this._previous();this._consume(kg.tokens.less_than,"Expected '<' for sampler type.");const t=this._consume(kg.texel_format,"Invalid texel format.").toString();this._consume(kg.tokens.comma,"Expected ',' after texel format.");const n=this._consume(kg.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(kg.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new Km(e.toString(),t,n))}return null}_attribute(){let e=[];for(;this._match(kg.tokens.attr);){const t=this._consume(kg.attribute_name,"Expected attribute name"),n=this._updateNode(new gg(t.toString(),null));if(this._match(kg.tokens.paren_left)){if(n.value=this._consume(kg.literal_or_ident,"Expected attribute value").toString(),this._check(kg.tokens.comma)){this._advance();do{const e=this._consume(kg.literal_or_ident,"Expected attribute value").toString();n.value instanceof Array||(n.value=[n.value]),n.value.push(e)}while(this._match(kg.tokens.comma))}this._consume(kg.tokens.paren_right,"Expected ')'")}e.push(n)}return 0==e.length?null:e}}class t_ extends Wg{constructor(e){super(),e&&this.update(e)}update(e){const t=(new e_).parse(e);this.updateAST(t)}}function n_(e){return null!=e&&e.format?`${e.name}<${e.format.name}>`:e.name}const i_={};function r_(e="id"){return i_[e]=i_[e]||1,`${e}-${i_[e]++}`}class o_{constructor(e){if(Ta(this,"id"),Ta(this,"userData",{}),Ta(this,"topology"),Ta(this,"bufferLayout",[]),Ta(this,"vertexCount"),Ta(this,"indices"),Ta(this,"attributes"),this.id=e.id||r_("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&bd.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){var e;null==(e=this.indices)||e.destroy();for(const t of Object.values(this.attributes))t.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}const s_=class e{constructor(e){Ta(this,"device"),Ta(this,"cachingEnabled"),Ta(this,"destroyPolicy"),Ta(this,"debug"),Ta(this,"_hashCounter",0),Ta(this,"_hashes",{}),Ta(this,"_renderPipelineCache",{}),Ta(this,"_computePipelineCache",{}),this.device=e,this.cachingEnabled=e.props._cachePipelines,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=e.props.debugFactories}static getDefaultPipelineFactory(t){return t._lumaData.defaultPipelineFactory=t._lumaData.defaultPipelineFactory||new e(t),t._lumaData.defaultPipelineFactory}get[Symbol.toStringTag](){return"PipelineFactory"}toString(){return`PipelineFactory(${this.device.id})`}createRenderPipeline(e){var t;if(!this.cachingEnabled)return this.device.createRenderPipeline(e);const n={...gh.defaultProps,...e},i=this._renderPipelineCache,r=this._hashRenderPipeline(n);let o=null==(t=i[r])?void 0:t.pipeline;return o?(i[r].useCount++,this.debug&&md.log(3,`${this}: ${i[r].pipeline} reused, count=${i[r].useCount}, (id=${e.id})`)()):(o=this.device.createRenderPipeline({...n,id:n.id?`${n.id}-cached`:r_("unnamed-cached")}),o.hash=r,i[r]={pipeline:o,useCount:1},this.debug&&md.log(3,`${this}: ${o} created, count=${i[r].useCount}`)()),o}createComputePipeline(e){var t;if(!this.cachingEnabled)return this.device.createComputePipeline(e);const n={...yh.defaultProps,...e},i=this._computePipelineCache,r=this._hashComputePipeline(n);let o=null==(t=i[r])?void 0:t.pipeline;return o?(i[r].useCount++,this.debug&&md.log(3,`${this}: ${i[r].pipeline} reused, count=${i[r].useCount}, (id=${e.id})`)()):(o=this.device.createComputePipeline({...n,id:n.id?`${n.id}-cached`:void 0}),o.hash=r,i[r]={pipeline:o,useCount:1},this.debug&&md.log(3,`${this}: ${o} created, count=${i[r].useCount}`)()),o}release(e){if(!this.cachingEnabled)return void e.destroy();const t=this._getCache(e),n=e.hash;t[n].useCount--,0===t[n].useCount?(this._destroyPipeline(e),this.debug&&md.log(3,`${this}: ${e} released and destroyed`)()):t[n].useCount<0?(md.error(`${this}: ${e} released, useCount < 0, resetting`)(),t[n].useCount=0):this.debug&&md.log(3,`${this}: ${e} released, count=${t[n].useCount}`)()}_destroyPipeline(e){const t=this._getCache(e);switch(this.destroyPolicy){case"never":return!1;case"unused":return delete t[e.hash],e.destroy(),!0}}_getCache(e){let t;if(e instanceof yh&&(t=this._computePipelineCache),e instanceof gh&&(t=this._renderPipelineCache),!t)throw new Error(`${this}`);if(!t[e.hash])throw new Error(`${this}: ${e} matched incorrect entry`);return t}_hashComputePipeline(e){const{type:t}=this.device;return`${t}/C/${this._getHash(e.shader.source)}`}_hashRenderPipeline(e){const t=e.vs?this._getHash(e.vs.source):0,n=e.fs?this._getHash(e.fs.source):0,i=this._getHash(JSON.stringify(e.bufferLayout)),{type:r}=this.device;if("webgl"===r)return`${r}/R/${t}/${n}V-BL${i}`;{const o=this._getHash(JSON.stringify(e.parameters));return`${r}/R/${t}/${n}V-T${e.topology}P${o}BL${i}`}}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}};Ta(s_,"defaultProps",{...gh.defaultProps});let a_=s_;const l_=class e{constructor(e){Ta(this,"device"),Ta(this,"cachingEnabled"),Ta(this,"destroyPolicy"),Ta(this,"debug"),Ta(this,"_cache",{}),this.device=e,this.cachingEnabled=e.props._cacheShaders,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=!0}static getDefaultShaderFactory(t){var n;return(n=t._lumaData).defaultShaderFactory||(n.defaultShaderFactory=new e(t)),t._lumaData.defaultShaderFactory}get[Symbol.toStringTag](){return"ShaderFactory"}toString(){return`${this[Symbol.toStringTag]}(${this.device.id})`}createShader(e){if(!this.cachingEnabled)return this.device.createShader(e);const t=this._hashShader(e);let n=this._cache[t];if(n)n.useCount++,this.debug&&md.log(3,`${this}: Reusing shader ${n.shader.id} count=${n.useCount}`)();else{const i=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[t]=n={shader:i,useCount:1},this.debug&&md.log(3,`${this}: Created new shader ${i.id}`)()}return n.shader}release(e){if(!this.cachingEnabled)return void e.destroy();const t=this._hashShader(e),n=this._cache[t];if(n)if(n.useCount--,0===n.useCount)"unused"===this.destroyPolicy&&(delete this._cache[t],n.shader.destroy(),this.debug&&md.log(3,`${this}: Releasing shader ${e.id}, destroyed`)());else{if(n.useCount<0)throw new Error(`ShaderFactory: Shader ${e.id} released too many times`);this.debug&&md.log(3,`${this}: Releasing shader ${e.id} count=${n.useCount}`)()}}_hashShader(e){return`${e.stage}:${e.source}`}};Ta(l_,"defaultProps",{...fh.defaultProps});let c_=l_,u_=null,d_=null;function h_(e,t,n){if(e===t)return!0;if(!n||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!h_(e[i],t[i],n-1))return!1;return!0}if(Array.isArray(t))return!1;if("object"==typeof e&&"object"==typeof t){const i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(const o of i)if(!t.hasOwnProperty(o)||!h_(e[o],t[o],n-1))return!1;return!0}return!1}class f_{constructor(e){Ta(this,"bufferLayouts"),this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(t=>t.name===e)||null}getAttributeNamesForBuffer(e){var t;return e.attributes?null==(t=e.attributes)?void 0:t.map(e=>e.attribute):[e.name]}mergeBufferLayouts(e,t){const n=[...e];for(const i of t){const e=n.findIndex(e=>e.name===i.name);e<0?n.push(i):n[e]=i}return n}getBufferIndex(e){const t=this.bufferLayouts.findIndex(t=>t.name===e);return-1===t&&md.warn(`BufferLayout: Missing buffer for "${e}".`)(),t}}function p_(e){const t={bindings:{},uniforms:{}};return Object.keys(e).forEach(n=>{const i=e[n];!function(e){return function(e){return function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(e)||function(e){return!!Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}(e)}(e)||"number"==typeof e||"boolean"==typeof e}(i)?t.bindings[n]=i:t.uniforms[n]=i}),t}class m_{constructor(e,t){Ta(this,"options",{disableWarnings:!1}),Ta(this,"modules"),Ta(this,"moduleUniforms"),Ta(this,"moduleBindings"),Object.assign(this.options,t);const n=yp(Object.values(e).filter(e=>e.dependencies));for(const i of n)e[i.name]=i;md.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[i,r]of Object.entries(e))this._addModule(r),r.name&&i!==r.name&&!this.options.disableWarnings&&md.warn(`Module name: ${i} vs ${r.name}`)()}destroy(){}setProps(e){var t;for(const n of Object.keys(e)){const i=n,r=e[i]||{},o=this.modules[i];if(!o){this.options.disableWarnings||md.warn(`Module ${n} not found`)();continue}const s=this.moduleUniforms[i],a=this.moduleBindings[i],l=(null==(t=o.getUniforms)?void 0:t.call(o,r,s))||r,{uniforms:c,bindings:u}=p_(l);this.moduleUniforms[i]={...s,...c},this.moduleBindings[i]={...a,...u}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const t of Object.values(this.moduleBindings))Object.assign(e,t);return e}getDebugTable(){var e;const t={};for(const[n,i]of Object.entries(this.moduleUniforms))for(const[r,o]of Object.entries(i))t[`${n}.${r}`]={type:null==(e=this.modules[n].uniformTypes)?void 0:e[r],value:String(o)};return t}_addModule(e){const t=e.name;this.moduleUniforms[t]=e.defaultUniforms||{},this.moduleBindings[t]={}}}const g_=["+X","-X","+Y","-Y","+Z","-Z"],__=["+X","-X","+Y","-Y","+Z","-Z"],y_=class e{constructor(t,n){Ta(this,"device"),Ta(this,"id"),Ta(this,"props"),Ta(this,"texture"),Ta(this,"sampler"),Ta(this,"view"),Ta(this,"ready"),Ta(this,"isReady",!1),Ta(this,"destroyed",!1),Ta(this,"resolveReady",()=>{}),Ta(this,"rejectReady",()=>{}),this.device=t;const i=r_("async-texture");this.props={...e.defaultProps,id:i,...n},this.id=this.props.id,"string"==typeof(null==(n={...n})?void 0:n.data)&&"2d"===n.dimension&&(n.data=async function(e){const t=new Image;return t.crossOrigin="anonymous",t.src=e.startsWith("http")?e:""+e,await t.decode(),await createImageBitmap(t)}(n.data)),n.mipmaps&&(n.mipLevels="auto"),this.ready=new Promise((e,t)=>{this.resolveReady=()=>{this.isReady=!0,e()},this.rejectReady=t}),this.initAsync(n)}get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}async initAsync(e){const t=e.data,n=await b_(t).then(void 0,this.rejectReady);if(this.destroyed)return;const i=this.props.width&&this.props.height?{width:this.props.width,height:this.props.height}:this.getTextureDataSize(n);if(!i)throw new Error("Texture size could not be determined");const r={...i,...e,data:void 0,mipLevels:1},o=this.device.getMipLevelCount(r.width,r.height);if(r.mipLevels="auto"===this.props.mipLevels?o:Math.min(o,this.props.mipLevels),this.texture=this.device.createTexture(r),this.sampler=this.texture.sampler,this.view=this.texture.view,e.data)switch(this.props.dimension){case"1d":this._setTexture1DData(this.texture,n);break;case"2d":this._setTexture2DData(n);break;case"3d":this._setTexture3DData(this.texture,n);break;case"2d-array":this._setTextureArrayData(this.texture,n);break;case"cube":this._setTextureCubeData(this.texture,n);break;case"cube-array":this._setTextureCubeArrayData(this.texture,n)}this.props.mipmaps&&this.generateMipmaps(),md.info(1,`${this} loaded`),this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}generateMipmaps(){this.texture.generateMipmapsWebGL()}setSampler(e={}){this.texture.setSampler(e instanceof rh?e:this.device.createSampler(e))}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const t=this.texture;this.texture=t.clone(e),t.destroy()}return!0}isTextureLevelData(e){const t=null==e?void 0:e.data;return ArrayBuffer.isView(t)}getTextureDataSize(e){if(!e||ArrayBuffer.isView(e))return null;if(Array.isArray(e))return this.getTextureDataSize(e[0]);if(this.device.isExternalImage(e))return this.device.getExternalImageSize(e);if(e&&"object"==typeof e&&e.constructor===Object){const t=Object.values(e)[0];return{width:t.width,height:t.height}}throw new Error("texture size deduction failed")}getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}setTextureData(e){}_setTexture1DData(e,t){throw new Error("setTexture1DData not supported in WebGL.")}_setTexture2DData(e,t=0){if(!this.texture)throw new Error("Texture not initialized");const n=this._normalizeTextureData(e);n.length>1&&!1!==this.props.mipmaps&&md.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let i=0;i<n.length;i++){const e=n[i];this.device.isExternalImage(e)?this.texture.copyExternalImage({image:e,depth:t,mipLevel:i,flipY:!0}):this.texture.copyImageData({data:e.data,mipLevel:i})}}_setTexture3DData(e,t){var n;if("3d"!==(null==(n=this.texture)?void 0:n.props.dimension))throw new Error(this.id);for(let i=0;i<t.length;i++)this._setTexture2DData(t[i],i)}_setTextureCubeData(e,t){var n;if("cube"!==(null==(n=this.texture)?void 0:n.props.dimension))throw new Error(this.id);for(const[i,r]of Object.entries(t)){const e=__.indexOf(i);this._setTexture2DData(r,e)}}_setTextureArrayData(e,t){var n;if("2d-array"!==(null==(n=this.texture)?void 0:n.props.dimension))throw new Error(this.id);for(let i=0;i<t.length;i++)this._setTexture2DData(t[i],i)}_setTextureCubeArrayData(e,t){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}_setTextureCubeFaceData(e,t,n,i=0){Array.isArray(t)&&t.length>1&&!1!==this.props.mipmaps&&md.warn(`${this.id} has mipmap and multiple LODs.`)();const r=g_.indexOf(n);this._setTexture2DData(t,r)}_normalizeTextureData(e){const t=this.texture;let n;return n=ArrayBuffer.isView(e)?[{data:e,width:t.width,height:t.height}]:Array.isArray(e)?e:[e],n}};Ta(y_,"defaultProps",{...ah.defaultProps,data:null,mipmaps:!1});let v_=y_;async function b_(e){if(e=await e,Array.isArray(e))return await Promise.all(e.map(b_));if(e&&"object"==typeof e&&e.constructor===Object){const t=e,n=await Promise.all(Object.values(t)),i=Object.keys(t),r={};for(let e=0;e<i.length;e++)r[i[e]]=n[e];return r}return e}const x_=class e{constructor(t,n){var i,r,o,s;Ta(this,"device"),Ta(this,"id"),Ta(this,"source"),Ta(this,"vs"),Ta(this,"fs"),Ta(this,"pipelineFactory"),Ta(this,"shaderFactory"),Ta(this,"userData",{}),Ta(this,"parameters"),Ta(this,"topology"),Ta(this,"bufferLayout"),Ta(this,"isInstanced"),Ta(this,"instanceCount",0),Ta(this,"vertexCount"),Ta(this,"indexBuffer",null),Ta(this,"bufferAttributes",{}),Ta(this,"constantAttributes",{}),Ta(this,"bindings",{}),Ta(this,"vertexArray"),Ta(this,"transformFeedback",null),Ta(this,"pipeline"),Ta(this,"shaderInputs"),Ta(this,"_uniformStore"),Ta(this,"_attributeInfos",{}),Ta(this,"_gpuGeometry",null),Ta(this,"props"),Ta(this,"_pipelineNeedsUpdate","newly created"),Ta(this,"_needsRedraw","initializing"),Ta(this,"_destroyed",!1),Ta(this,"_lastDrawTimestamp",-1),Ta(this,"_lastLogTime",0),Ta(this,"_logOpen",!1),Ta(this,"_drawCount",0),this.props={...e.defaultProps,...n},n=this.props,this.id=n.id||r_("model"),this.device=t,Object.assign(this.userData,n.userData);const a=Object.fromEntries((null==(i=this.props.modules)?void 0:i.map(e=>[e.name,e]))||[]),l=n.shaderInputs||new m_(a,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(l);const c=function(e){return{type:e.type,shaderLanguage:e.info.shadingLanguage,shaderLanguageVersion:e.info.shadingLanguageVersion,gpu:e.info.gpu,features:e.features}}(t),u=((null==(r=this.props.modules)?void 0:r.length)>0?this.props.modules:null==(o=this.shaderInputs)?void 0:o.getModules())||[];if("webgpu"===this.device.type&&this.props.source){const{source:e,getUniforms:t}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:c,...this.props,modules:u});this.source=e,this._getModuleUniforms=t,(s=this.props).shaderLayout||(s.shaderLayout=function(e){var t;const n={attributes:[],bindings:[]};let i;try{i=function(e){try{return new t_(e)}catch(n){if(n instanceof Error)throw n;let t="WGSL parse error";throw"object"==typeof n&&null!=n&&n.message&&(t+=`: ${n.message} `),"object"==typeof n&&null!=n&&n.token&&(t+=n.token.line||""),new Error(t,{cause:n})}}(e)}catch(u){return md.error(u.message)(),n}for(const s of i.uniforms){const e=[];for(const n of(null==(t=s.type)?void 0:t.members)||[])e.push({name:n.name,type:n_(n.type)});n.bindings.push({type:"uniform",name:s.name,group:s.group,location:s.binding,members:e})}for(const s of i.textures)n.bindings.push({type:"texture",name:s.name,group:s.group,location:s.binding});for(const s of i.samplers)n.bindings.push({type:"sampler",name:s.name,group:s.group,location:s.binding});const r=i.entry.vertex[0],o=(null==r?void 0:r.inputs.length)||0;for(let s=0;s<o;s++){const e=r.inputs[s];if("location"===e.locationType){const t=n_(e.type);n.attributes.push({name:e.name,location:Number(e.location),type:t})}}return n}(this.source))}else{const{vs:e,fs:t,getUniforms:n}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:c,...this.props,modules:u});this.vs=e,this.fs=t,this._getModuleUniforms=n}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,n.geometry&&this.setGeometry(n.geometry),this.pipelineFactory=n.pipelineFactory||a_.getDefaultPipelineFactory(this.device),this.shaderFactory=n.shaderFactory||c_.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=t.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in n&&(this.isInstanced=n.isInstanced),n.instanceCount&&this.setInstanceCount(n.instanceCount),n.vertexCount&&this.setVertexCount(n.vertexCount),n.indexBuffer&&this.setIndexBuffer(n.indexBuffer),n.attributes&&this.setAttributes(n.attributes),n.constantAttributes&&this.setConstantAttributes(n.constantAttributes),n.bindings&&this.setBindings(n.bindings),n.transformFeedback&&(this.transformFeedback=n.transformFeedback),Object.seal(this)}get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}destroy(){var e;this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),null==(e=this._gpuGeometry)||e.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||(this._needsRedraw=e)}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const t=this._areBindingsLoading();if(t)return md.info(2,`>>> DRAWING ABORTED ${this.id}: ${t} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let n;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const t=this._getBindings();this.pipeline.setBindings(t,{disableWarnings:this.props.disableWarnings});const{indexBuffer:i}=this.vertexArray,r=i?i.byteLength/("uint32"===i.indexType?4:2):void 0;n=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:r,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(e){var t;null==(t=this._gpuGeometry)||t.destroy();const n=e&&function(e,t){if(t instanceof o_)return t;const n=function(e,t){if(!t.indices)return;const n=t.indices.value;return e.createBuffer({usage:bd.INDEX,data:n})}(e,t),{attributes:i,bufferLayout:r}=function(e,t){const n=[],i={};for(const[r,o]of Object.entries(t.attributes)){let t=r;switch(r){case"POSITION":t="positions";break;case"NORMAL":t="normals";break;case"TEXCOORD_0":t="texCoords";break;case"COLOR_0":t="colors"}if(o){i[t]=e.createBuffer({data:o.value,id:`${r}-buffer`});const{value:s,size:a,normalized:l}=o;n.push({name:t,format:kd(s,a,l)})}}return{attributes:i,bufferLayout:n,vertexCount:t._calculateVertexCount(t.attributes,t.indices)}}(e,t);return new o_({topology:t.topology||"triangle-list",bufferLayout:r,vertexCount:t.vertexCount,indices:n,attributes:i})}(this.device,e);if(n){this.setTopology(n.topology||"triangle-list");const e=new f_(this.bufferLayout);this.bufferLayout=e.mergeBufferLayouts(n.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(n)}this._gpuGeometry=n}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const t=new f_(this.bufferLayout);this.bufferLayout=this._gpuGeometry?t.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){h_(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,void 0===this.isInstanced&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new Ph(this.shaderInputs.modules);for(const[t,n]of Object.entries(this.shaderInputs.modules))if(S_(n)){const e=this._uniformStore.getManagedUniformBuffer(this.device,t);this.bindings[`${t}Uniforms`]=e}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,t){const n=(null==t?void 0:t.disableWarnings)??this.props.disableWarnings;e.indices&&md.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)(),this.bufferLayout=function(e,t){const n=Object.fromEntries(e.attributes.map(e=>[e.name,e.location])),i=t.slice();return i.sort((e,t)=>{const i=e.attributes?e.attributes.map(e=>e.attribute):[e.name],r=t.attributes?t.attributes.map(e=>e.attribute):[t.name];return Math.min(...i.map(e=>n[e]))-Math.min(...r.map(e=>n[e]))}),i}(this.pipeline.shaderLayout,this.bufferLayout);const i=new f_(this.bufferLayout);for(const[r,o]of Object.entries(e)){const e=i.getBufferLayout(r);if(!e){n||md.warn(`Model(${this.id}): Missing layout for buffer "${r}".`)();continue}const t=i.getAttributeNamesForBuffer(e);let s=!1;for(const n of t){const e=this._attributeInfos[n];if(e){const t="webgpu"===this.device.type?i.getBufferIndex(e.bufferName):e.location;this.vertexArray.setBuffer(t,o),s=!0}}!s&&!n&&md.warn(`Model(${this.id}): Ignoring buffer "${o.id}" for unknown attribute "${r}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,t){for(const[n,i]of Object.entries(e)){const e=this._attributeInfos[n];e?this.vertexArray.setConstantWebGL(e.location,i):((null==t?void 0:t.disableWarnings)??this.props.disableWarnings)||md.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${n}"`)()}this.setNeedsRedraw("constants")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof v_&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[t,n]of Object.entries(this.bindings))n instanceof v_?n.isReady&&(e[t]=n.texture):e[t]=n;return e}_getBindingsUpdateTimestamp(){let e=0;for(const t of Object.values(this.bindings))t instanceof ch?e=Math.max(e,t.texture.updateTimestamp):t instanceof bd||t instanceof ah?e=Math.max(e,t.updateTimestamp):t instanceof v_?e=t.texture?Math.max(e,t.texture.updateTimestamp):1/0:t instanceof rh||(e=Math.max(e,t.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const t={...e.attributes};for(const[n]of Object.entries(t))!this.pipeline.shaderLayout.attributes.find(e=>e.name===n)&&"positions"!==n&&delete t[n];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(t,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||(this._pipelineNeedsUpdate=e),this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,t=null;this.pipeline&&(md.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,t=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const n=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let i=null;this.source?i=n:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:n,fs:i}),this._attributeInfos=Sh(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),t&&this.shaderFactory.release(t)}return this.pipeline}_logDrawCallStart(){const e=md.level>3?0:1e4;md.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,md.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:md.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=function(e){var t;const n={},i="Values";if(0===e.attributes.length&&(null==(t=e.varyings)||!t.length))return{"No attributes or varyings":{[i]:"N/A"}};for(const r of e.attributes)r&&(n[`in ${r.location} ${r.name}: ${r.type}`]={[i]:r.stepMode||"vertex"});for(const r of e.varyings||[])n[`out ${r.location} ${r.name}`]={[i]:JSON.stringify(r)};return n}(this.pipeline.shaderLayout,this.id);md.table(2,e)();const t=this.shaderInputs.getDebugTable();md.table(2,t)();const n=this._getAttributeDebugTable();md.table(2,this._attributeInfos)(),md.table(2,n)(),md.groupEnd(2)(),this._logOpen=!1}}_logFramebuffer(e){const t=this.device.props.debugFramebuffers;if(this._drawCount++,!t)return;const n=e.props.framebuffer;n&&function(e,{id:t,minimap:n,opaque:i,top:r="0",left:o="0",rgbaScale:s=1}){u_||(u_=document.createElement("canvas"),u_.id=t,u_.title=t,u_.style.zIndex="100",u_.style.position="absolute",u_.style.top=r,u_.style.left=o,u_.style.border="blue 5px solid",u_.style.transform="scaleY(-1)",document.body.appendChild(u_),d_=u_.getContext("2d")),(u_.width!==e.width||u_.height!==e.height)&&(u_.width=e.width/2,u_.height=e.height/2,u_.style.width="400px",u_.style.height="400px");const a=e.device.readPixelsToArrayWebGL(e),l=null==d_?void 0:d_.createImageData(e.width,e.height);if(l){for(let e=0;e<a.length;e+=4)l.data[0+e+0]=a[e+0]*s,l.data[0+e+1]=a[e+1]*s,l.data[0+e+2]=a[e+2]*s,l.data[0+e+3]=i?255:a[e+3]*s;null==d_||d_.putImageData(l,0,0)}}(n,{id:n.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[t,n]of Object.entries(this._attributeInfos)){const i=this.vertexArray.attributes[n.location];e[n.location]={name:t,type:n.shaderType,values:i?this._getBufferOrConstantValues(i,n.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:t}=this.vertexArray,n="uint32"===t.indexType?new Uint32Array(t.debugData):new Uint16Array(t.debugData);e.indices={name:"indices",type:t.indexType,values:n.toString()}}return e}_getBufferOrConstantValues(e,t){const n=Ed(t);return(e instanceof bd?new n(e.debugData):e).toString()}};Ta(x_,"defaultProps",{...gh.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:zp.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0});let w_=x_;function S_(e){return!(!e.uniformTypes||function(e){for(const t in e)return!1;return!0}(e.uniformTypes))}class E_{constructor(e,t,n,i,r){this._debugRandomNumber=Math.floor(1e3*Math.random()),this.device=e,this.config=t,this.store=n,this.data=i,r&&(this.points=r)}}function C_(e){const t=new Float32Array(e*e*2);for(let n=0;n<e;n++)for(let i=0;i<e;i++){const r=n*e*2+2*i;t[r+0]=i,t[r+1]=n}return t}function T_(e,t){return t*($d.getInfo(e).bytesPerPixel??0)}const k_="#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nin vec2 vertexCoord; // Vertex coordinates in normalized device coordinates\nout vec2 textureCoords; // Texture coordinates to pass to the fragment shader\n\nvoid main() {\n    // Convert vertex coordinates from [-1, 1] range to [0, 1] range for texture sampling\n    textureCoords = (vertexCoord + 1.0) / 2.0;\n    gl_Position = vec4(vertexCoord, 0, 1);\n}\n";class I_ extends E_{create(){var e;const{device:t,store:n}=this,{pointsTextureSize:i}=n;if(i){if(this.centermassTexture||(this.centermassTexture=t.createTexture({width:1,height:1,format:"rgba32float",usage:ah.SAMPLE|ah.RENDER|ah.COPY_DST})),this.centermassTexture.copyImageData({data:new Float32Array(4).fill(0),bytesPerRow:T_("rgba32float",1),mipLevel:0,x:0,y:0}),this.centermassFbo||(this.centermassFbo=t.createFramebuffer({width:1,height:1,colorAttachments:[this.centermassTexture]})),!this.pointIndices||this.previousPointsTextureSize!==n.pointsTextureSize){this.pointIndices&&!this.pointIndices.destroyed&&this.pointIndices.destroy();const i=C_(n.pointsTextureSize);this.pointIndices=t.createBuffer({data:i,usage:bd.VERTEX|bd.COPY_DST}),null==(e=this.calculateCentermassCommand)||e.setAttributes({pointIndices:this.pointIndices})}this.previousPointsTextureSize=i}}initPrograms(){const{device:e,store:t,points:n}=this;!n||!t.pointsTextureSize||!this.centermassFbo||this.centermassFbo.destroyed||!this.centermassTexture||this.centermassTexture.destroyed||(this.forceVertexCoordBuffer||(this.forceVertexCoordBuffer=e.createBuffer({data:new Float32Array([-1,-1,1,-1,-1,1,1,1])})),this.calculateUniformStore||(this.calculateUniformStore=new Ph({calculateCentermassUniforms:{uniformTypes:{pointsTextureSize:"f32"}}})),this.forceUniformStore||(this.forceUniformStore=new Ph({forceCenterUniforms:{uniformTypes:{centerForce:"f32",alpha:"f32"}}})),this.calculateCentermassCommand||(this.calculateCentermassCommand=new w_(e,{fs:"#version 300 es\nprecision highp float;\n\nin vec4 rgba;\nout vec4 fragColor;\n\nvoid main() {\n  fragColor = rgba;\n}",vs:"#version 300 es\nprecision highp float;\n\nuniform sampler2D positionsTexture;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform calculateCentermassUniforms {\n  float pointsTextureSize;\n} calculateCentermass;\n\n#define pointsTextureSize calculateCentermass.pointsTextureSize\n#else\nuniform float pointsTextureSize;\n#endif\n\nin vec2 pointIndices;\n\nout vec4 rgba;\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, pointIndices / pointsTextureSize);\n  rgba = vec4(pointPosition.xy, 1.0, 0.0);\n\n  gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n  gl_PointSize = 1.0;\n}\n",topology:"point-list",attributes:{...this.pointIndices&&{pointIndices:this.pointIndices}},bufferLayout:[{name:"pointIndices",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{calculateCentermassUniforms:this.calculateUniformStore.getManagedUniformBuffer(e,"calculateCentermassUniforms")},parameters:{blend:!0,blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"add",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",depthWriteEnabled:!1,depthCompare:"always"}})),this.calculateCentermassCommand.setVertexCount(this.data.pointsNumber??0),this.runCommand||(this.runCommand=new w_(e,{fs:"#version 300 es\nprecision highp float;\n\nuniform sampler2D positionsTexture;\nuniform sampler2D centermassTexture;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform forceCenterUniforms {\n  float centerForce;\n  float alpha;\n} forceCenter;\n\n#define centerForce forceCenter.centerForce\n#define alpha forceCenter.alpha\n#else\nuniform float centerForce;\nuniform float alpha;\n#endif\n\nin vec2 textureCoords;\nout vec4 fragColor;\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, textureCoords);\n  vec4 velocity = vec4(0.0);\n  vec4 centermassValues = texture(centermassTexture, vec2(0.0));\n  vec2 centermassPosition = centermassValues.xy / centermassValues.b;\n  vec2 distVector = centermassPosition - pointPosition.xy;\n  float dist = sqrt(dot(distVector, distVector));\n  if (dist > 0.0) {\n    float angle = atan(distVector.y, distVector.x);\n    float addV = alpha * centerForce * dist * 0.01;\n    velocity.rg += addV * vec2(cos(angle), sin(angle));\n  }\n\n  fragColor = velocity;\n}",vs:k_,topology:"triangle-strip",vertexCount:4,attributes:{vertexCoord:this.forceVertexCoordBuffer},bufferLayout:[{name:"vertexCoord",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{forceCenterUniforms:this.forceUniformStore.getManagedUniformBuffer(e,"forceCenterUniforms")},parameters:{depthWriteEnabled:!1,depthCompare:"always"}})))}run(){const{device:e,store:t,points:n}=this;if(!n||!this.calculateCentermassCommand||!this.calculateUniformStore||!this.runCommand||!this.forceUniformStore||!this.centermassFbo||!this.centermassTexture||!n.previousPositionTexture||n.previousPositionTexture.destroyed||!n.velocityFbo||n.velocityFbo.destroyed||t.pointsTextureSize!==this.previousPointsTextureSize||!this.pointIndices)return;const i=e.beginRenderPass({framebuffer:this.centermassFbo,clearColor:[0,0,0,0]});this.calculateUniformStore.setUniforms({calculateCentermassUniforms:{pointsTextureSize:t.pointsTextureSize??0}}),this.calculateCentermassCommand.setBindings({positionsTexture:n.previousPositionTexture}),this.calculateCentermassCommand.draw(i),i.end(),this.forceUniformStore.setUniforms({forceCenterUniforms:{centerForce:this.config.simulationCenter??0,alpha:t.alpha}}),this.runCommand.setBindings({positionsTexture:n.previousPositionTexture,centermassTexture:this.centermassTexture});const r=e.beginRenderPass({framebuffer:n.velocityFbo,clearColor:[0,0,0,0]});this.runCommand.draw(r),r.end()}destroy(){var e,t,n,i;null==(e=this.calculateCentermassCommand)||e.destroy(),this.calculateCentermassCommand=void 0,null==(t=this.runCommand)||t.destroy(),this.runCommand=void 0,this.centermassFbo&&!this.centermassFbo.destroyed&&this.centermassFbo.destroy(),this.centermassFbo=void 0,this.centermassTexture&&!this.centermassTexture.destroyed&&this.centermassTexture.destroy(),this.centermassTexture=void 0,null==(n=this.calculateUniformStore)||n.destroy(),this.calculateUniformStore=void 0,null==(i=this.forceUniformStore)||i.destroy(),this.forceUniformStore=void 0,this.pointIndices&&!this.pointIndices.destroyed&&this.pointIndices.destroy(),this.pointIndices=void 0,this.forceVertexCoordBuffer&&!this.forceVertexCoordBuffer.destroyed&&this.forceVertexCoordBuffer.destroy(),this.forceVertexCoordBuffer=void 0,this.previousPointsTextureSize=void 0}}class A_ extends E_{initPrograms(){const{device:e,points:t,store:n}=this;!t||!n.pointsTextureSize||(this.vertexCoordBuffer||(this.vertexCoordBuffer=e.createBuffer({data:new Float32Array([-1,-1,1,-1,-1,1,1,1])})),this.uniformStore||(this.uniformStore=new Ph({forceGravityUniforms:{uniformTypes:{gravity:"f32",spaceSize:"f32",alpha:"f32"}}})),this.runCommand||(this.runCommand=new w_(e,{fs:"#version 300 es\nprecision highp float;\n\nuniform sampler2D positionsTexture;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform forceGravityUniforms {\n  float gravity;\n  float spaceSize;\n  float alpha;\n} forceGravity;\n\n#define gravity forceGravity.gravity\n#define spaceSize forceGravity.spaceSize\n#define alpha forceGravity.alpha\n#else\nuniform float gravity;\nuniform float spaceSize;\nuniform float alpha;\n#endif\n\nin vec2 textureCoords;\nout vec4 fragColor;\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, textureCoords);\n\n  vec4 velocity = vec4(0.0);\n\n  vec2 centerPosition = vec2(spaceSize * 0.5);\n  vec2 distVector = centerPosition - pointPosition.rg;\n  float dist = sqrt(dot(distVector, distVector));\n  if (dist > 0.0) {\n    float angle = atan(distVector.y, distVector.x);\n    float additionalVelocity = alpha * gravity * dist * 0.1;\n    velocity.rg += additionalVelocity * vec2(cos(angle), sin(angle));\n  }\n\n  fragColor = velocity;\n}",vs:k_,topology:"triangle-strip",vertexCount:4,attributes:{vertexCoord:this.vertexCoordBuffer},bufferLayout:[{name:"vertexCoord",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{forceGravityUniforms:this.uniformStore.getManagedUniformBuffer(e,"forceGravityUniforms")},parameters:{depthWriteEnabled:!1,depthCompare:"always"}})))}run(){const{device:e,points:t,store:n}=this;if(!t||!this.runCommand||!this.uniformStore||!t.previousPositionTexture||t.previousPositionTexture.destroyed||!t.velocityFbo||t.velocityFbo.destroyed)return;this.uniformStore.setUniforms({forceGravityUniforms:{gravity:this.config.simulationGravity??0,spaceSize:n.adjustedSpaceSize??0,alpha:n.alpha}}),this.runCommand.setBindings({positionsTexture:t.previousPositionTexture});const i=e.beginRenderPass({framebuffer:t.velocityFbo,clearColor:[0,0,0,0]});this.runCommand.draw(i),i.end()}destroy(){var e,t;null==(e=this.runCommand)||e.destroy(),this.runCommand=void 0,null==(t=this.uniformStore)||t.destroy(),this.uniformStore=void 0,this.vertexCoordBuffer&&!this.vertexCoordBuffer.destroyed&&this.vertexCoordBuffer.destroy(),this.vertexCoordBuffer=void 0}}function L_(e){return`#version 300 es\nprecision highp float;\n\nuniform sampler2D positionsTexture;\nuniform sampler2D linkInfoTexture; // Texture storing first link indices and amount\nuniform sampler2D linkIndicesTexture;\nuniform sampler2D linkPropertiesTexture; // Texture storing link bias and strength\nuniform sampler2D linkRandomDistanceTexture;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform forceLinkUniforms {\n  float linkSpring;\n  float linkDistance;\n  vec2 linkDistRandomVariationRange;\n  float pointsTextureSize;\n  float linksTextureSize;\n  float alpha;\n} forceLink;\n\n#define linkSpring forceLink.linkSpring\n#define linkDistance forceLink.linkDistance\n#define linkDistRandomVariationRange forceLink.linkDistRandomVariationRange\n#define pointsTextureSize forceLink.pointsTextureSize\n#define linksTextureSize forceLink.linksTextureSize\n#define alpha forceLink.alpha\n#else\nuniform float linkSpring;\nuniform float linkDistance;\nuniform vec2 linkDistRandomVariationRange;\nuniform float pointsTextureSize;\nuniform float linksTextureSize;\nuniform float alpha;\n#endif\n\nin vec2 textureCoords;\nout vec4 fragColor;\n\nconst float MAX_LINKS = ${e}.0;\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, textureCoords);\n  vec4 velocity = vec4(0.0);\n\n  vec4 linkInfo = texture(linkInfoTexture, textureCoords);\n  float iCount = linkInfo.r;\n  float jCount = linkInfo.g;\n  float linkAmount = linkInfo.b;\n  if (linkAmount > 0.0) {\n    for (float i = 0.0; i < MAX_LINKS; i += 1.0) {\n      if (i < linkAmount) {\n        if (iCount >= linksTextureSize) {\n          iCount = 0.0;\n          jCount += 1.0;\n        }\n        vec2 linkTextureIndex = (vec2(iCount, jCount) + 0.5) / linksTextureSize;\n        vec4 connectedPointIndex = texture(linkIndicesTexture, linkTextureIndex);\n        vec4 biasAndStrength = texture(linkPropertiesTexture, linkTextureIndex);\n        vec4 randomMinDistance = texture(linkRandomDistanceTexture, linkTextureIndex);\n        float bias = biasAndStrength.r;\n        float strength = biasAndStrength.g;\n        float randomMinLinkDist = randomMinDistance.r * (linkDistRandomVariationRange.g - linkDistRandomVariationRange.r) + linkDistRandomVariationRange.r;\n        randomMinLinkDist *= linkDistance;\n\n        iCount += 1.0;\n\n        vec4 connectedPointPosition = texture(positionsTexture, (connectedPointIndex.rg + 0.5) / pointsTextureSize);\n        float x = connectedPointPosition.x - (pointPosition.x + velocity.x);\n        float y = connectedPointPosition.y - (pointPosition.y + velocity.y);\n        float l = sqrt(x * x + y * y);\n\n        // Apply the link force\n        l = max(l, randomMinLinkDist * 0.99);\n        l = (l - randomMinLinkDist) / l;\n        l *= linkSpring * alpha;\n        l *= strength;\n        l *= bias;\n        x *= l;\n        y *= l;\n        velocity.x += x;\n        velocity.y += y;\n      }\n    }\n  }\n\n  fragColor = vec4(velocity.rg, 0.0, 0.0);\n}\n  `}function R_(e,t){return e&&2===e.length?[e[0],e[1]]:t}function P_(e,t){return e&&4===e.length?[e[0],e[1],e[2],e[3]]:t}var M_=(e=>(e.OUTGOING="outgoing",e.INCOMING="incoming",e))(M_||{});class D_ extends E_{constructor(){super(...arguments),this.linkFirstIndicesAndAmount=new Float32Array,this.indices=new Float32Array,this.maxPointDegree=0}create(e){var t;const{device:n,store:{pointsTextureSize:i,linksTextureSize:r},data:o}=this;if(!i||!r)return;this.linkFirstIndicesAndAmount=new Float32Array(i*i*4),this.indices=new Float32Array(r*r*4);const s=new Float32Array(r*r*4),a=new Float32Array(r*r*4),l="incoming"===e?o.sourceIndexToTargetIndices:o.targetIndexToSourceIndices;this.maxPointDegree=0;let c=0;null==l||l.forEach((e,t)=>{e&&(this.linkFirstIndicesAndAmount[4*t+0]=c%r,this.linkFirstIndicesAndAmount[4*t+1]=Math.floor(c/r),this.linkFirstIndicesAndAmount[4*t+2]=e.length??0,e.forEach(([e,n])=>{var r,l,u;this.indices[4*c+0]=e%i,this.indices[4*c+1]=Math.floor(e/i);const d=(null==(r=o.degree)?void 0:r[e])??0,h=(null==(l=o.degree)?void 0:l[t])??0,f=d+h,p=0!==f?d/f:.5,m=Math.min(d,h);let g=(null==(u=o.linkStrength)?void 0:u[n])??1/Math.max(m,1);g=Math.sqrt(g),s[4*c+0]=p,s[4*c+1]=g,a[4*c]=this.store.getRandomFloat(0,1),c+=1}),this.maxPointDegree=Math.max(this.maxPointDegree,e.length??0))});const u=!this.linkFirstIndicesAndAmountTexture||this.linkFirstIndicesAndAmountTexture.width!==i||this.linkFirstIndicesAndAmountTexture.height!==i,d=!this.indicesTexture||this.indicesTexture.width!==r||this.indicesTexture.height!==r;u&&(this.linkFirstIndicesAndAmountTexture&&!this.linkFirstIndicesAndAmountTexture.destroyed&&this.linkFirstIndicesAndAmountTexture.destroy(),this.linkFirstIndicesAndAmountTexture=n.createTexture({width:i,height:i,format:"rgba32float",usage:ah.SAMPLE|ah.COPY_DST})),this.linkFirstIndicesAndAmountTexture.copyImageData({data:this.linkFirstIndicesAndAmount,bytesPerRow:T_("rgba32float",i),mipLevel:0,x:0,y:0}),d&&(this.indicesTexture&&!this.indicesTexture.destroyed&&this.indicesTexture.destroy(),this.biasAndStrengthTexture&&!this.biasAndStrengthTexture.destroyed&&this.biasAndStrengthTexture.destroy(),this.randomDistanceTexture&&!this.randomDistanceTexture.destroyed&&this.randomDistanceTexture.destroy(),this.indicesTexture=n.createTexture({width:r,height:r,format:"rgba32float",usage:ah.SAMPLE|ah.COPY_DST}),this.biasAndStrengthTexture=n.createTexture({width:r,height:r,format:"rgba32float",usage:ah.SAMPLE|ah.COPY_DST}),this.randomDistanceTexture=n.createTexture({width:r,height:r,format:"rgba32float",usage:ah.SAMPLE|ah.COPY_DST})),this.indicesTexture.copyImageData({data:this.indices,bytesPerRow:T_("rgba32float",r),mipLevel:0,x:0,y:0}),this.biasAndStrengthTexture.copyImageData({data:s,bytesPerRow:T_("rgba32float",r),mipLevel:0,x:0,y:0}),this.randomDistanceTexture.copyImageData({data:a,bytesPerRow:T_("rgba32float",r),mipLevel:0,x:0,y:0}),void 0!==this.previousMaxPointDegree&&this.previousMaxPointDegree!==this.maxPointDegree&&(null==(t=this.runCommand)||t.destroy(),this.runCommand=void 0),this.previousMaxPointDegree=this.maxPointDegree,this.previousPointsTextureSize=i,this.previousLinksTextureSize=r}initPrograms(){const{device:e,store:t,points:n}=this;!n||!t.pointsTextureSize||!t.linksTextureSize||!this.linkFirstIndicesAndAmountTexture||!this.indicesTexture||!this.biasAndStrengthTexture||!this.randomDistanceTexture||(this.vertexCoordBuffer||(this.vertexCoordBuffer=e.createBuffer({data:new Float32Array([-1,-1,1,-1,-1,1,1,1])})),this.uniformStore||(this.uniformStore=new Ph({forceLinkUniforms:{uniformTypes:{linkSpring:"f32",linkDistance:"f32",linkDistRandomVariationRange:"vec2<f32>",pointsTextureSize:"f32",linksTextureSize:"f32",alpha:"f32"}}})),this.runCommand||(this.runCommand=new w_(e,{fs:L_(this.maxPointDegree),vs:k_,topology:"triangle-strip",vertexCount:4,attributes:{vertexCoord:this.vertexCoordBuffer},bufferLayout:[{name:"vertexCoord",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{forceLinkUniforms:this.uniformStore.getManagedUniformBuffer(e,"forceLinkUniforms")},parameters:{depthWriteEnabled:!1,depthCompare:"always"}})))}run(){const{device:e,store:t,points:n}=this;if(!n||!this.runCommand||!this.uniformStore||!n.previousPositionTexture||n.previousPositionTexture.destroyed||!this.linkFirstIndicesAndAmountTexture||!this.indicesTexture||!this.biasAndStrengthTexture||!this.randomDistanceTexture||!n.velocityFbo||n.velocityFbo.destroyed||t.pointsTextureSize!==this.previousPointsTextureSize||t.linksTextureSize!==this.previousLinksTextureSize)return;this.uniformStore.setUniforms({forceLinkUniforms:{linkSpring:this.config.simulationLinkSpring??0,linkDistance:this.config.simulationLinkDistance??0,linkDistRandomVariationRange:R_(this.config.simulationLinkDistRandomVariationRange,[0,0]),pointsTextureSize:t.pointsTextureSize,linksTextureSize:t.linksTextureSize,alpha:t.alpha}}),this.runCommand.setBindings({positionsTexture:n.previousPositionTexture,linkInfoTexture:this.linkFirstIndicesAndAmountTexture,linkIndicesTexture:this.indicesTexture,linkPropertiesTexture:this.biasAndStrengthTexture,linkRandomDistanceTexture:this.randomDistanceTexture});const i=e.beginRenderPass({framebuffer:n.velocityFbo,clearColor:[0,0,0,0]});this.runCommand.draw(i),i.end()}destroy(){var e,t;null==(e=this.runCommand)||e.destroy(),this.runCommand=void 0,this.linkFirstIndicesAndAmountTexture&&!this.linkFirstIndicesAndAmountTexture.destroyed&&this.linkFirstIndicesAndAmountTexture.destroy(),this.linkFirstIndicesAndAmountTexture=void 0,this.indicesTexture&&!this.indicesTexture.destroyed&&this.indicesTexture.destroy(),this.indicesTexture=void 0,this.biasAndStrengthTexture&&!this.biasAndStrengthTexture.destroyed&&this.biasAndStrengthTexture.destroy(),this.biasAndStrengthTexture=void 0,this.randomDistanceTexture&&!this.randomDistanceTexture.destroyed&&this.randomDistanceTexture.destroy(),this.randomDistanceTexture=void 0,null==(t=this.uniformStore)||t.destroy(),this.uniformStore=void 0,this.vertexCoordBuffer&&!this.vertexCoordBuffer.destroyed&&this.vertexCoordBuffer.destroy(),this.vertexCoordBuffer=void 0}}class N_ extends E_{constructor(){super(...arguments),this.levels=0,this.levelTargets=new Map}create(){var e;const{device:t,store:n}=this;if(!n.pointsTextureSize)return;this.levels=Math.log2(n.adjustedSpaceSize);for(let o=0;o<this.levels;o+=1){const e=Math.pow(2,o+1),n=this.levelTargets.get(o);if(n&&n.texture.width===e&&n.texture.height===e){n.texture.copyImageData({data:new Float32Array(e*e*4).fill(0),bytesPerRow:T_("rgba32float",e),mipLevel:0,x:0,y:0});continue}n&&(n.fbo.destroyed||n.fbo.destroy(),n.texture.destroyed||n.texture.destroy());const i=t.createTexture({width:e,height:e,format:"rgba32float",usage:ah.SAMPLE|ah.RENDER|ah.COPY_DST});i.copyImageData({data:new Float32Array(e*e*4).fill(0),bytesPerRow:T_("rgba32float",e),mipLevel:0,x:0,y:0});const r=t.createFramebuffer({width:e,height:e,colorAttachments:[i]});this.levelTargets.set(o,{texture:i,fbo:r})}for(const[o,s]of Array.from(this.levelTargets.entries()))o>=this.levels&&(s.fbo.destroyed||s.fbo.destroy(),s.texture.destroyed||s.texture.destroy(),this.levelTargets.delete(o));const i=n.pointsTextureSize*n.pointsTextureSize,r=new Float32Array(4*i);for(let o=0;o<i;++o)r[4*o]=1e-5*n.getRandomFloat(-1,1),r[4*o+1]=1e-5*n.getRandomFloat(-1,1);if((!this.randomValuesTexture||this.randomValuesTexture.destroyed||this.randomValuesTexture.width!==n.pointsTextureSize||this.randomValuesTexture.height!==n.pointsTextureSize)&&(this.randomValuesTexture&&!this.randomValuesTexture.destroyed&&this.randomValuesTexture.destroy(),this.randomValuesTexture=t.createTexture({width:n.pointsTextureSize,height:n.pointsTextureSize,format:"rgba32float",usage:ah.SAMPLE|ah.COPY_DST})),this.randomValuesTexture.copyImageData({data:r,bytesPerRow:T_("rgba32float",n.pointsTextureSize),mipLevel:0,x:0,y:0}),!this.pointIndices||this.previousPointsTextureSize!==n.pointsTextureSize){this.pointIndices&&!this.pointIndices.destroyed&&this.pointIndices.destroy();const i=C_(n.pointsTextureSize);this.pointIndices=t.createBuffer({data:i,usage:bd.VERTEX|bd.COPY_DST}),null==(e=this.calculateLevelsCommand)||e.setAttributes({pointIndices:this.pointIndices})}this.previousPointsTextureSize=n.pointsTextureSize,this.previousSpaceSize=n.adjustedSpaceSize}initPrograms(){const{device:e,store:t,data:n,points:i}=this;!n.pointsNumber||!i||!t.pointsTextureSize||(this.calculateLevelsUniformStore||(this.calculateLevelsUniformStore=new Ph({calculateLevelsUniforms:{uniformTypes:{pointsTextureSize:"f32",levelTextureSize:"f32",cellSize:"f32"},defaultUniforms:{pointsTextureSize:t.pointsTextureSize,levelTextureSize:0,cellSize:0}}})),this.calculateLevelsCommand||(this.calculateLevelsCommand=new w_(e,{fs:"#version 300 es\nprecision highp float;\n\nin vec4 vColor;\nout vec4 fragColor;\n\nvoid main() {\n  fragColor = vColor;\n}",vs:"#version 300 es\nprecision highp float;\n\nuniform sampler2D positionsTexture;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform calculateLevelsUniforms {\n  float pointsTextureSize;\n  float levelTextureSize;\n  float cellSize;\n} calculateLevels;\n\n#define pointsTextureSize calculateLevels.pointsTextureSize\n#define levelTextureSize calculateLevels.levelTextureSize\n#define cellSize calculateLevels.cellSize\n#else\nuniform float pointsTextureSize;\nuniform float levelTextureSize;\nuniform float cellSize;\n#endif\n\nin vec2 pointIndices;\n\nout vec4 vColor;\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, pointIndices / pointsTextureSize);\n  vColor = vec4(pointPosition.rg, 1.0, 0.0);\n\n  float n = floor(pointPosition.x / cellSize);\n  float m = floor(pointPosition.y / cellSize);\n  \n  vec2 levelPosition = 2.0 * (vec2(n, m) + 0.5) / levelTextureSize - 1.0;\n\n  gl_Position = vec4(levelPosition, 0.0, 1.0);\n  gl_PointSize = 1.0;\n}",topology:"point-list",vertexCount:n.pointsNumber,attributes:{...this.pointIndices&&{pointIndices:this.pointIndices}},bufferLayout:[{name:"pointIndices",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{calculateLevelsUniforms:this.calculateLevelsUniformStore.getManagedUniformBuffer(e,"calculateLevelsUniforms")},parameters:{blend:!0,blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"add",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",depthWriteEnabled:!1,depthCompare:"always"}})),this.forceUniformStore||(this.forceUniformStore=new Ph({forceUniforms:{uniformTypes:{level:"f32",levels:"f32",levelTextureSize:"f32",alpha:"f32",repulsion:"f32",spaceSize:"f32",theta:"f32"},defaultUniforms:{level:0,levels:this.levels,levelTextureSize:0,alpha:t.alpha,repulsion:this.config.simulationRepulsion??0,spaceSize:t.adjustedSpaceSize??0,theta:this.config.simulationRepulsionTheta??0}}})),this.forceVertexCoordBuffer||(this.forceVertexCoordBuffer=e.createBuffer({data:new Float32Array([-1,-1,1,-1,-1,1,1,1])})),this.forceCommand||(this.forceCommand=new w_(e,{fs:"#version 300 es\nprecision highp float;\n\nuniform sampler2D positionsTexture;\nuniform sampler2D levelFbo;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform forceUniforms {\n  float level;\n  float levels;\n  float levelTextureSize;\n  float repulsion;\n  float alpha;\n  float spaceSize;\n  float theta;\n} force;\n\n#define level force.level\n#define levels force.levels\n#define levelTextureSize force.levelTextureSize\n#define repulsion force.repulsion\n#define alpha force.alpha\n#define spaceSize force.spaceSize\n#define theta force.theta\n#else\nuniform float level;\nuniform float levels;\nuniform float levelTextureSize;\nuniform float repulsion;\nuniform float alpha;\nuniform float spaceSize;\nuniform float theta;\n#endif\n\nin vec2 textureCoords;\nout vec4 fragColor;\n\nconst float MAX_LEVELS_NUM = 14.0;\n\nvec2 calculateAdditionalVelocity (vec2 ij, vec2 pp) {\n  vec2 add = vec2(0.0);\n  vec4 centermass = texture(levelFbo, ij);\n  if (centermass.r > 0.0 && centermass.g > 0.0 && centermass.b > 0.0) {\n    vec2 centermassPosition = vec2(centermass.rg / centermass.b);\n    vec2 distVector = pp - centermassPosition;\n    float l = dot(distVector, distVector);\n    float dist = sqrt(l);\n    if (l > 0.0) {\n      float c = alpha * repulsion * centermass.b;\n\n      float distanceMin2 = 1.0;\n      if (l < distanceMin2) l = sqrt(distanceMin2 * l);\n      float addV = c / sqrt(l);\n      add = addV * normalize(distVector);\n    }\n  }\n  return add;\n}\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, textureCoords);\n  float x = pointPosition.x;\n  float y = pointPosition.y;\n\n  float left = 0.0;\n  float top = 0.0;\n  float right = spaceSize;\n  float bottom = spaceSize;\n\n  float n_left = 0.0;\n  float n_top = 0.0;\n  float n_right = 0.0;\n  float n_bottom = 0.0;\n\n  float cellSize = 0.0;\n\n  // Iterate over levels to adjust the boundaries based on the current level\n  for (float i = 0.0; i < MAX_LEVELS_NUM; i += 1.0) {\n    if (i <= level) {\n      left += cellSize * n_left;\n      top += cellSize * n_top;\n      right -= cellSize * n_right;\n      bottom -= cellSize * n_bottom;\n\n      cellSize = pow(2.0 , levels - i - 1.0);\n\n      float dist_left = x - left;\n      n_left = max(0.0, floor(dist_left / cellSize - theta));\n\n      float dist_top = y - top;\n      n_top = max(0.0, floor(dist_top / cellSize - theta));\n      \n      float dist_right = right - x;\n      n_right = max(0.0, floor(dist_right / cellSize - theta));\n\n      float dist_bottom = bottom - y;\n      n_bottom = max(0.0, floor(dist_bottom / cellSize - theta));\n\n    }\n  }\n\n  vec4 velocity = vec4(vec2(0.0), 1.0, 0.0);\n\n  // Calculate the additional velocity based on neighboring cells\n  for (float i = 0.0; i < 12.0; i += 1.0) {\n    for (float j = 0.0; j < 4.0; j += 1.0) {\n      float n = left + cellSize * j;\n      float m = top + cellSize * n_top + cellSize * i;\n\n      if (n < (left + n_left * cellSize) && m < bottom) {\n        velocity.xy += calculateAdditionalVelocity(vec2(n / cellSize, m / cellSize) / levelTextureSize, pointPosition.xy);\n      }\n\n      n = left + cellSize * i;\n      m = top + cellSize * j;\n\n      if (n < (right - n_right * cellSize) && m < (top + n_top * cellSize)) {\n        velocity.xy += calculateAdditionalVelocity(vec2(n / cellSize, m / cellSize) / levelTextureSize, pointPosition.xy);\n      }\n\n      n = right - n_right * cellSize + cellSize * j;\n      m = top + cellSize * i;\n\n      if (n < right && m < (bottom - n_bottom * cellSize)) {\n        velocity.xy += calculateAdditionalVelocity(vec2(n / cellSize, m / cellSize) / levelTextureSize, pointPosition.xy);\n      }\n\n      n = left + n_left * cellSize + cellSize * i;\n      m = bottom - n_bottom * cellSize + cellSize * j;\n\n      if (n < right && m < bottom) {\n        velocity.xy += calculateAdditionalVelocity(vec2(n / cellSize, m / cellSize) / levelTextureSize, pointPosition.xy);\n      }\n    }\n  }\n\n  fragColor = velocity;\n}",vs:k_,topology:"triangle-strip",vertexCount:4,attributes:{vertexCoord:this.forceVertexCoordBuffer},bufferLayout:[{name:"vertexCoord",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{forceUniforms:this.forceUniformStore.getManagedUniformBuffer(e,"forceUniforms")},parameters:{blend:!0,blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"add",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",depthWriteEnabled:!1,depthCompare:"always"}})),this.forceCenterUniformStore||(this.forceCenterUniformStore=new Ph({forceCenterUniforms:{uniformTypes:{levelTextureSize:"f32",alpha:"f32",repulsion:"f32"},defaultUniforms:{levelTextureSize:0,alpha:t.alpha,repulsion:this.config.simulationRepulsion??0}}})),this.forceFromItsOwnCentermassCommand||(this.forceFromItsOwnCentermassCommand=new w_(e,{fs:"#version 300 es\nprecision highp float;\n\nuniform sampler2D positionsTexture;\nuniform sampler2D levelFbo;\nuniform sampler2D randomValues;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform forceCenterUniforms {\n  float levelTextureSize;\n  float repulsion;\n  float alpha;\n} forceCenter;\n\n#define levelTextureSize forceCenter.levelTextureSize\n#define repulsion forceCenter.repulsion\n#define alpha forceCenter.alpha\n#else\nuniform float levelTextureSize;\nuniform float repulsion;\nuniform float alpha;\n#endif\n\nin vec2 textureCoords;\nout vec4 fragColor;\n\n// Calculate the additional velocity based on the center of mass\nvec2 calculateAdditionalVelocity (vec2 ij, vec2 pp) {\n  vec2 add = vec2(0.0);\n  vec4 centermass = texture(levelFbo, ij);\n  if (centermass.r > 0.0 && centermass.g > 0.0 && centermass.b > 0.0) {\n    vec2 centermassPosition = vec2(centermass.rg / centermass.b);\n    vec2 distVector = pp - centermassPosition;\n    float l = dot(distVector, distVector);\n    float dist = sqrt(l);\n    if (l > 0.0) {\n      float angle = atan(distVector.y, distVector.x);\n      float c = alpha * repulsion * centermass.b;\n\n      float distanceMin2 = 1.0;\n      if (l < distanceMin2) l = sqrt(distanceMin2 * l);\n      float addV = c / sqrt(l);\n      add = addV * vec2(cos(angle), sin(angle));\n    }\n  }\n  return add;\n}\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, textureCoords);\n  vec4 random = texture(randomValues, textureCoords);\n\n  vec4 velocity = vec4(0.0);\n\n  // Calculate additional velocity based on the point position\n  velocity.xy += calculateAdditionalVelocity(pointPosition.xy / levelTextureSize, pointPosition.xy);\n  // Apply random factor to the velocity\n  velocity.xy += velocity.xy * random.rg;\n\n  fragColor = velocity;\n}",vs:k_,topology:"triangle-strip",vertexCount:4,attributes:{vertexCoord:this.forceVertexCoordBuffer},bufferLayout:[{name:"vertexCoord",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{forceCenterUniforms:this.forceCenterUniformStore.getManagedUniformBuffer(e,"forceCenterUniforms")},parameters:{blend:!0,blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"add",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",depthWriteEnabled:!1,depthCompare:"always"}})))}run(){this.store.pointsTextureSize!==this.previousPointsTextureSize||this.store.adjustedSpaceSize!==this.previousSpaceSize||(this.drawLevels(),this.drawForces())}destroy(){var e,t,n,i,r,o;null==(e=this.calculateLevelsCommand)||e.destroy(),this.calculateLevelsCommand=void 0,null==(t=this.forceCommand)||t.destroy(),this.forceCommand=void 0,null==(n=this.forceFromItsOwnCentermassCommand)||n.destroy(),this.forceFromItsOwnCentermassCommand=void 0;for(const s of this.levelTargets.values())s.fbo&&!s.fbo.destroyed&&s.fbo.destroy();this.randomValuesTexture&&!this.randomValuesTexture.destroyed&&this.randomValuesTexture.destroy(),this.randomValuesTexture=void 0;for(const s of this.levelTargets.values())s.texture&&!s.texture.destroyed&&s.texture.destroy();this.levelTargets.clear(),null==(i=this.calculateLevelsUniformStore)||i.destroy(),this.calculateLevelsUniformStore=void 0,null==(r=this.forceUniformStore)||r.destroy(),this.forceUniformStore=void 0,null==(o=this.forceCenterUniformStore)||o.destroy(),this.forceCenterUniformStore=void 0,this.pointIndices&&!this.pointIndices.destroyed&&this.pointIndices.destroy(),this.pointIndices=void 0,this.forceVertexCoordBuffer&&!this.forceVertexCoordBuffer.destroyed&&this.forceVertexCoordBuffer.destroy(),this.forceVertexCoordBuffer=void 0}drawLevels(){const{device:e,store:t,data:n,points:i}=this;if(i&&this.calculateLevelsCommand&&this.calculateLevelsUniformStore&&i.previousPositionTexture&&!i.previousPositionTexture.destroyed&&n.pointsNumber&&this.pointIndices)for(let r=0;r<this.levels;r+=1){const o=this.levelTargets.get(r);if(!o||o.fbo.destroyed||o.texture.destroyed)continue;const s=Math.pow(2,r+1),a=(t.adjustedSpaceSize??0)/s;this.calculateLevelsUniformStore.setUniforms({calculateLevelsUniforms:{pointsTextureSize:t.pointsTextureSize??0,levelTextureSize:s,cellSize:a}}),this.calculateLevelsCommand.setVertexCount(n.pointsNumber),this.calculateLevelsCommand.setBindings({positionsTexture:i.previousPositionTexture});const l=e.beginRenderPass({framebuffer:o.fbo,clearColor:[0,0,0,0]});this.calculateLevelsCommand.draw(l),l.end()}}drawForces(){const{device:e,store:t,points:n}=this;if(!n||!this.forceCommand||!this.forceUniformStore||!this.forceFromItsOwnCentermassCommand||!this.forceCenterUniformStore||!n.previousPositionTexture||n.previousPositionTexture.destroyed||!this.randomValuesTexture||this.randomValuesTexture.destroyed||!n.velocityFbo||n.velocityFbo.destroyed)return;const i=e.beginRenderPass({framebuffer:n.velocityFbo,clearColor:[0,0,0,0]});for(let r=0;r<this.levels;r+=1){const e=this.levelTargets.get(r);if(!e||e.texture.destroyed)continue;const o=Math.pow(2,r+1);this.forceUniformStore.setUniforms({forceUniforms:{level:r,levels:this.levels,levelTextureSize:o,alpha:t.alpha,repulsion:this.config.simulationRepulsion??0,spaceSize:t.adjustedSpaceSize??0,theta:this.config.simulationRepulsionTheta??0}}),this.forceCommand.setBindings({positionsTexture:n.previousPositionTexture,levelFbo:e.texture}),this.forceCommand.draw(i),r===this.levels-1&&(this.forceCenterUniformStore.setUniforms({forceCenterUniforms:{levelTextureSize:o,alpha:t.alpha,repulsion:this.config.simulationRepulsion??0}}),this.forceFromItsOwnCentermassCommand.setBindings({positionsTexture:n.previousPositionTexture,randomValues:this.randomValuesTexture,levelFbo:e.texture}),this.forceFromItsOwnCentermassCommand.draw(i))}i.end()}}class F_ extends E_{initPrograms(){const{device:e,points:t}=this;t&&(this.vertexCoordBuffer||(this.vertexCoordBuffer=e.createBuffer({data:new Float32Array([-1,-1,1,-1,-1,1,1,1])})),this.uniformStore||(this.uniformStore=new Ph({forceMouseUniforms:{uniformTypes:{repulsion:"f32",mousePos:"vec2<f32>"}}})),this.runCommand||(this.runCommand=new w_(e,{fs:"#version 300 es\nprecision highp float;\n\nuniform sampler2D positionsTexture;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform forceMouseUniforms {\n  float repulsion;\n  vec2 mousePos;\n} forceMouse;\n\n#define repulsion forceMouse.repulsion\n#define mousePos forceMouse.mousePos\n#else\nuniform float repulsion;\nuniform vec2 mousePos;\n#endif\n\nin vec2 textureCoords;\nout vec4 fragColor;\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, textureCoords);\n  vec4 velocity = vec4(0.0);\n  vec2 mouse = mousePos;\n  // Move particles away from the mouse position using a repulsive force\n  vec2 distVector = mouse - pointPosition.rg;\n  float dist = sqrt(dot(distVector, distVector));\n  dist = max(dist, 10.0);\n  float angle = atan(distVector.y, distVector.x);\n  float addV = 100.0 * repulsion / (dist * dist);\n  velocity.rg -= addV * vec2(cos(angle), sin(angle));\n\n  fragColor = velocity;\n}",vs:k_,topology:"triangle-strip",vertexCount:4,attributes:{vertexCoord:this.vertexCoordBuffer},bufferLayout:[{name:"vertexCoord",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{forceMouseUniforms:this.uniformStore.getManagedUniformBuffer(e,"forceMouseUniforms")},parameters:{depthWriteEnabled:!1,depthCompare:"always"}})))}run(){const{device:e,points:t,store:n}=this;if(!t||!this.runCommand||!this.uniformStore||!t.previousPositionTexture||t.previousPositionTexture.destroyed||!t.velocityFbo||t.velocityFbo.destroyed)return;this.uniformStore.setUniforms({forceMouseUniforms:{repulsion:this.config.simulationRepulsionFromMouse??0,mousePos:R_(n.mousePosition,[0,0])}}),this.runCommand.setBindings({positionsTexture:t.previousPositionTexture});const i=e.beginRenderPass({framebuffer:t.velocityFbo,clearColor:[0,0,0,0]});this.runCommand.draw(i),i.end()}destroy(){var e,t;null==(e=this.runCommand)||e.destroy(),this.runCommand=void 0,null==(t=this.uniformStore)||t.destroy(),this.uniformStore=void 0,this.vertexCoordBuffer&&!this.vertexCoordBuffer.destroyed&&this.vertexCoordBuffer.destroy(),this.vertexCoordBuffer=void 0}}class O_ extends E_{create(){var e,t;const{device:n,store:i,data:r}=this,{pointsTextureSize:o}=i;if(void 0===r.pointsNumber||!r.pointClusters&&!r.clusterPositions)return;this.clusterCount=(r.pointClusters??[]).reduce((e,t)=>void 0===t||t<0?e:Math.max(e,t),0)+1,this.clustersTextureSize=Math.ceil(Math.sqrt(this.clusterCount));const s=this.previousPointsTextureSize!==o||this.previousClustersTextureSize!==this.clustersTextureSize||this.previousClusterCount!==this.clusterCount,a=o*o*4,l=this.clustersTextureSize*this.clustersTextureSize*4,c=new Float32Array(a),u=new Float32Array(l).fill(-1),d=new Float32Array(a).fill(1);if(r.clusterPositions)for(let h=0;h<this.clusterCount;++h)u[4*h+0]=r.clusterPositions[2*h+0]??-1,u[4*h+1]=r.clusterPositions[2*h+1]??-1;for(let h=0;h<r.pointsNumber;++h){const t=null==(e=r.pointClusters)?void 0:e[h];void 0===t?(c[4*h+0]=-1,c[4*h+1]=-1):(c[4*h+0]=t%this.clustersTextureSize,c[4*h+1]=Math.floor(t/this.clustersTextureSize)),r.clusterStrength&&(d[4*h+0]=r.clusterStrength[h]??1)}if(!this.clusterTexture||s?(this.clusterTexture&&!this.clusterTexture.destroyed&&this.clusterTexture.destroy(),this.clusterTexture=n.createTexture({width:o,height:o,format:"rgba32float",usage:ah.SAMPLE|ah.RENDER|ah.COPY_DST}),this.clusterTexture.copyImageData({data:c,bytesPerRow:T_("rgba32float",o),mipLevel:0,x:0,y:0})):this.clusterTexture.copyImageData({data:c,bytesPerRow:T_("rgba32float",o),mipLevel:0,x:0,y:0}),!this.clusterPositionsTexture||s?(this.clusterPositionsTexture&&!this.clusterPositionsTexture.destroyed&&this.clusterPositionsTexture.destroy(),this.clusterPositionsTexture=n.createTexture({width:this.clustersTextureSize,height:this.clustersTextureSize,format:"rgba32float",usage:ah.SAMPLE|ah.RENDER|ah.COPY_DST}),this.clusterPositionsTexture.copyImageData({data:u,bytesPerRow:T_("rgba32float",this.clustersTextureSize),mipLevel:0,x:0,y:0})):this.clusterPositionsTexture.copyImageData({data:u,bytesPerRow:T_("rgba32float",this.clustersTextureSize),mipLevel:0,x:0,y:0}),!this.clusterForceCoefficientTexture||s?(this.clusterForceCoefficientTexture&&!this.clusterForceCoefficientTexture.destroyed&&this.clusterForceCoefficientTexture.destroy(),this.clusterForceCoefficientTexture=n.createTexture({width:o,height:o,format:"rgba32float",usage:ah.SAMPLE|ah.RENDER|ah.COPY_DST}),this.clusterForceCoefficientTexture.copyImageData({data:d,bytesPerRow:T_("rgba32float",o),mipLevel:0,x:0,y:0})):this.clusterForceCoefficientTexture.copyImageData({data:d,bytesPerRow:T_("rgba32float",o),mipLevel:0,x:0,y:0}),this.centermassTexture&&this.previousClustersTextureSize===this.clustersTextureSize?this.centermassTexture.copyImageData({data:new Float32Array(l).fill(0),bytesPerRow:T_("rgba32float",this.clustersTextureSize),mipLevel:0,x:0,y:0}):(this.centermassFbo&&!this.centermassFbo.destroyed&&this.centermassFbo.destroy(),this.centermassTexture&&!this.centermassTexture.destroyed&&this.centermassTexture.destroy(),this.centermassTexture=n.createTexture({width:this.clustersTextureSize,height:this.clustersTextureSize,format:"rgba32float",usage:ah.SAMPLE|ah.RENDER|ah.COPY_DST}),this.centermassTexture.copyImageData({data:new Float32Array(l).fill(0),bytesPerRow:T_("rgba32float",this.clustersTextureSize),mipLevel:0,x:0,y:0}),this.centermassFbo=n.createFramebuffer({width:this.clustersTextureSize,height:this.clustersTextureSize,colorAttachments:[this.centermassTexture]})),!this.pointIndices||this.previousPointsTextureSize!==o){this.pointIndices&&!this.pointIndices.destroyed&&this.pointIndices.destroy();const e=C_(i.pointsTextureSize);this.pointIndices=n.createBuffer({data:e,usage:bd.VERTEX|bd.COPY_DST}),null==(t=this.calculateCentermassCommand)||t.setAttributes({pointIndices:this.pointIndices})}this.previousPointsTextureSize=o,this.previousClustersTextureSize=this.clustersTextureSize,this.previousClusterCount=this.clusterCount}initPrograms(){const{device:e,store:t,data:n}=this;void 0===n.pointsNumber||!n.pointClusters&&!n.clusterPositions||(this.calculateCentermassUniformStore||(this.calculateCentermassUniformStore=new Ph({calculateCentermassUniforms:{uniformTypes:{pointsTextureSize:"f32",clustersTextureSize:"f32"},defaultUniforms:{pointsTextureSize:t.pointsTextureSize,clustersTextureSize:this.clustersTextureSize??0}}})),this.calculateCentermassCommand||(this.calculateCentermassCommand=new w_(e,{fs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nin vec4 rgba;\n\nout vec4 fragColor;\n\nvoid main() {\n  fragColor = rgba;\n}",vs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform sampler2D clusterTexture;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform calculateCentermassUniforms {\n  float pointsTextureSize;\n  float clustersTextureSize;\n} calculateCentermass;\n\n#define pointsTextureSize calculateCentermass.pointsTextureSize\n#define clustersTextureSize calculateCentermass.clustersTextureSize\n#else\nuniform float pointsTextureSize;\nuniform float clustersTextureSize;\n#endif\n\nin vec2 pointIndices;\n\nout vec4 rgba;\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, pointIndices / pointsTextureSize);\n  rgba = vec4(pointPosition.xy, 1.0, 0.0);\n\n  vec4 pointClusterIndices = texture(clusterTexture, pointIndices / pointsTextureSize);\n  vec2 xy = vec2(0.0);\n  if (pointClusterIndices.x >= 0.0 && pointClusterIndices.y >= 0.0) {\n    xy = 2.0 * (pointClusterIndices.xy + 0.5) / clustersTextureSize - 1.0;\n  }\n  \n  gl_Position = vec4(xy, 0.0, 1.0);\n  gl_PointSize = 1.0;\n}\n",topology:"point-list",vertexCount:n.pointsNumber??0,attributes:{...this.pointIndices&&{pointIndices:this.pointIndices}},bufferLayout:[{name:"pointIndices",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{calculateCentermassUniforms:this.calculateCentermassUniformStore.getManagedUniformBuffer(e,"calculateCentermassUniforms")},parameters:{blend:!0,blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"add",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",depthWriteEnabled:!1,depthCompare:"always"}})),this.applyForcesUniformStore||(this.applyForcesUniformStore=new Ph({applyForcesUniforms:{uniformTypes:{alpha:"f32",clustersTextureSize:"f32",clusterCoefficient:"f32"},defaultUniforms:{alpha:t.alpha,clustersTextureSize:this.clustersTextureSize??0,clusterCoefficient:this.config.simulationCluster??0}}})),this.applyForcesVertexCoordBuffer||(this.applyForcesVertexCoordBuffer=e.createBuffer({data:new Float32Array([-1,-1,1,-1,-1,1,1,1])})),this.applyForcesCommand||(this.applyForcesCommand=new w_(e,{fs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform sampler2D centermassTexture;\nuniform sampler2D clusterTexture;\nuniform sampler2D clusterPositionsTexture;\nuniform sampler2D clusterForceCoefficient;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform applyForcesUniforms {\n  float alpha;\n  float clustersTextureSize;\n  float clusterCoefficient;\n} applyForces;\n\n#define alpha applyForces.alpha\n#define clustersTextureSize applyForces.clustersTextureSize\n#define clusterCoefficient applyForces.clusterCoefficient\n#else\nuniform float alpha;\nuniform float clustersTextureSize;\nuniform float clusterCoefficient;\n#endif\n\nin vec2 textureCoords;\n\nout vec4 fragColor;\n\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, textureCoords);\n  vec4 velocity = vec4(0.0);\n  vec4 pointClusterIndices = texture(clusterTexture, textureCoords);\n  // no cluster, so no forces\n  if (pointClusterIndices.x >= 0.0 && pointClusterIndices.y >= 0.0) {\n    // positioning points to custom cluster position or either to the center of mass\n    vec2 clusterPositions = texture(clusterPositionsTexture, pointClusterIndices.xy / clustersTextureSize).xy;\n    if (clusterPositions.x < 0.0 || clusterPositions.y < 0.0) {\n      vec4 centermassValues = texture(centermassTexture, pointClusterIndices.xy / clustersTextureSize);\n      clusterPositions = centermassValues.xy / centermassValues.b;\n    }\n    vec4 clusterCustomCoeff = texture(clusterForceCoefficient, textureCoords);\n    vec2 distVector = clusterPositions.xy - pointPosition.xy;\n    float dist = length(distVector);\n    if (dist > 0.0) {\n      float addV = alpha * dist * clusterCoefficient * clusterCustomCoeff.r;\n      velocity.rg += addV * normalize(distVector);\n    }\n  }\n\n  fragColor = velocity;\n}",vs:k_,topology:"triangle-strip",vertexCount:4,attributes:{vertexCoord:this.applyForcesVertexCoordBuffer},bufferLayout:[{name:"vertexCoord",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{applyForcesUniforms:this.applyForcesUniformStore.getManagedUniformBuffer(e,"applyForcesUniforms")}})))}calculateCentermass(){const{device:e,points:t}=this;if(!t||!this.calculateCentermassCommand||!this.calculateCentermassUniformStore||!this.pointIndices||!this.centermassFbo||this.centermassFbo.destroyed||!this.clusterTexture||this.clusterTexture.destroyed||!t.previousPositionTexture||t.previousPositionTexture.destroyed)return;this.calculateCentermassCommand.setVertexCount(this.data.pointsNumber??0),this.calculateCentermassUniformStore.setUniforms({calculateCentermassUniforms:{pointsTextureSize:this.store.pointsTextureSize,clustersTextureSize:this.clustersTextureSize??0}}),this.calculateCentermassCommand.setBindings({clusterTexture:this.clusterTexture,positionsTexture:t.previousPositionTexture});const n=e.beginRenderPass({framebuffer:this.centermassFbo,clearColor:[0,0,0,0]});this.calculateCentermassCommand.draw(n),n.end()}run(){var e;if(!this.data.pointClusters&&!this.data.clusterPositions||(this.calculateCentermass(),!this.applyForcesCommand||!this.applyForcesUniformStore)||!this.clusterTexture||this.clusterTexture.destroyed||!this.centermassTexture||this.centermassTexture.destroyed||!this.clusterPositionsTexture||this.clusterPositionsTexture.destroyed||!this.clusterForceCoefficientTexture||this.clusterForceCoefficientTexture.destroyed||null==(e=this.points)||!e.previousPositionTexture||this.points.previousPositionTexture.destroyed||!this.points.velocityFbo||this.points.velocityFbo.destroyed)return;this.applyForcesUniformStore.setUniforms({applyForcesUniforms:{alpha:this.store.alpha,clustersTextureSize:this.clustersTextureSize??0,clusterCoefficient:this.config.simulationCluster??0}}),this.applyForcesCommand.setBindings({clusterTexture:this.clusterTexture,centermassTexture:this.centermassTexture,clusterPositionsTexture:this.clusterPositionsTexture,clusterForceCoefficient:this.clusterForceCoefficientTexture,positionsTexture:this.points.previousPositionTexture});const t=this.device.beginRenderPass({framebuffer:this.points.velocityFbo,clearColor:[0,0,0,0]});this.applyForcesCommand.draw(t),t.end()}destroy(){var e,t,n,i;null==(e=this.calculateCentermassCommand)||e.destroy(),this.calculateCentermassCommand=void 0,null==(t=this.applyForcesCommand)||t.destroy(),this.applyForcesCommand=void 0,this.centermassFbo&&!this.centermassFbo.destroyed&&this.centermassFbo.destroy(),this.centermassFbo=void 0,this.clusterTexture&&!this.clusterTexture.destroyed&&this.clusterTexture.destroy(),this.clusterTexture=void 0,this.clusterPositionsTexture&&!this.clusterPositionsTexture.destroyed&&this.clusterPositionsTexture.destroy(),this.clusterPositionsTexture=void 0,this.clusterForceCoefficientTexture&&!this.clusterForceCoefficientTexture.destroyed&&this.clusterForceCoefficientTexture.destroy(),this.clusterForceCoefficientTexture=void 0,this.centermassTexture&&!this.centermassTexture.destroyed&&this.centermassTexture.destroy(),this.centermassTexture=void 0,null==(n=this.calculateCentermassUniformStore)||n.destroy(),this.calculateCentermassUniformStore=void 0,null==(i=this.applyForcesUniformStore)||i.destroy(),this.applyForcesUniformStore=void 0,this.pointIndices&&!this.pointIndices.destroyed&&this.pointIndices.destroy(),this.pointIndices=void 0,this.applyForcesVertexCoordBuffer&&!this.applyForcesVertexCoordBuffer.destroyed&&this.applyForcesVertexCoordBuffer.destroy(),this.applyForcesVertexCoordBuffer=void 0}}function B_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function z_(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var i=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,i.get?i:{enumerable:!0,get:function(){return e[t]}})}),n}var U_,V_={exports:{}},H_=(U_||(U_=1,V_.exports=class{constructor(e,t={}){this.css="#gl-bench {\n  position:absolute;\n  left:0;\n  top:0;\n  z-index:1000;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n}\n\n#gl-bench div {\n  position: relative;\n  display: block;\n  margin: 4px;\n  padding: 0 7px 0 10px;\n  background: #6c6;\n  border-radius: 15px;\n  cursor: pointer;\n  opacity: 0.9;\n}\n\n#gl-bench svg {\n  height: 60px;\n  margin: 0 -1px;\n}\n\n#gl-bench text {\n  font-size: 12px;\n  font-family: Helvetica,Arial,sans-serif;\n  font-weight: 700;\n  dominant-baseline: middle;\n  text-anchor: middle;\n}\n\n#gl-bench .gl-mem {\n  font-size: 9px;\n}\n\n#gl-bench line {\n  stroke-width: 5;\n  stroke: #112211;\n  stroke-linecap: round;\n}\n\n#gl-bench polyline {\n  fill: none;\n  stroke: #112211;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n  stroke-width: 3.5;\n}\n\n#gl-bench rect {\n  fill: #448844;\n}\n\n#gl-bench .opacity {\n  stroke: #448844;\n}\n",this.svg='<div class="gl-box">\n  <svg viewBox="0 0 55 60">\n    <text x="27" y="56" class="gl-fps">00 FPS</text>\n    <text x="28" y="8" class="gl-mem"></text>\n    <rect x="0" y="14" rx="4" ry="4" width="55" height="32"></rect>\n    <polyline class="gl-chart"></polyline>\n  </svg>\n  <svg viewBox="0 0 14 60" class="gl-cpu-svg">\n    <line x1="7" y1="38" x2="7" y2="11" class="opacity"/>\n    <line x1="7" y1="38" x2="7" y2="11" class="gl-cpu" stroke-dasharray="0 27"/>\n    <path d="M5.35 43c-.464 0-.812.377-.812.812v1.16c-.783.1972-1.421.812-1.595 1.624h-1.16c-.435 0-.812.348-.812.812s.348.812.812.812h1.102v1.653H1.812c-.464 0-.812.377-.812.812 0 .464.377.812.812.812h1.131c.1943.783.812 1.392 1.595 1.595v1.131c0 .464.377.812.812.812.464 0 .812-.377.812-.812V53.15h1.653v1.073c0 .464.377.812.812.812.464 0 .812-.377.812-.812v-1.131c.783-.1943 1.392-.812 1.595-1.595h1.131c.464 0 .812-.377.812-.812 0-.464-.377-.812-.812-.812h-1.073V48.22h1.102c.435 0 .812-.348.812-.812s-.348-.812-.812-.812h-1.16c-.1885-.783-.812-1.421-1.595-1.624v-1.131c0-.464-.377-.812-.812-.812-.464 0-.812.377-.812.812v1.073H6.162v-1.073c0-.464-.377-.812-.812-.812zm.58 3.48h2.088c.754 0 1.363.609 1.363 1.363v2.088c0 .754-.609 1.363-1.363 1.363H5.93c-.754 0-1.363-.609-1.363-1.363v-2.088c0-.754.609-1.363 1.363-1.363z"/>\n  </svg>\n  <svg viewBox="0 0 14 60" class="gl-gpu-svg">\n    <line x1="7" y1="38" x2="7" y2="11" class="opacity"/>\n    <line x1="7" y1="38" x2="7" y2="11" class="gl-gpu" stroke-dasharray="0 27"/>\n    <path d="M1.94775 43.3772a.736.736 0 10-.00416 1.472c.58535.00231.56465.1288.6348.3197.07015.18975.04933.43585.04933.43585l-.00653.05405v8.671a.736.736 0 101.472 0v-1.4145c.253.09522.52785.1495.81765.1495h5.267c1.2535 0 2.254-.9752 2.254-2.185v-3.105c0-1.2075-1.00625-2.185-2.254-2.185h-5.267c-.28865 0-.5635.05405-.8165.1495.01806-.16445.04209-.598-.1357-1.0787-.22425-.6072-.9499-1.2765-2.0125-1.2765zm2.9095 3.6455c.42435 0 .7659.36225.7659.8119v2.9785c0 .44965-.34155.8119-.7659.8119s-.7659-.36225-.7659-.8119v-2.9785c0-.44965.34155-.8119.7659-.8119zm4.117 0a2.3 2.3 0 012.3 2.3 2.3 2.3 0 01-2.3 2.3 2.3 2.3 0 01-2.3-2.3 2.3 2.3 0 012.3-2.3z"/>\n  </svg>\n</div>',this.paramLogger=()=>{},this.chartLogger=()=>{},this.chartLen=20,this.chartHz=20,this.names=[],this.cpuAccums=[],this.gpuAccums=[],this.activeAccums=[],this.chart=new Array(this.chartLen),this.now=()=>performance&&performance.now?performance.now():Date.now(),this.updateUI=()=>{[].forEach.call(this.nodes["gl-gpu-svg"],e=>{e.style.display=this.trackGPU?"inline":"none"})},Object.assign(this,t),this.detected=0,this.finished=[],this.isFramebuffer=0,this.frameId=0;let n,i,r=0,o=e=>{++r<20?n=requestAnimationFrame(o):(this.detected=Math.ceil(1e3*r/(e-i)/70),cancelAnimationFrame(n)),i||(i=e)};if(requestAnimationFrame(o),e){const t=async(t,n)=>Promise.resolve(setTimeout(()=>{e.getError();const i=this.now()-t;n.forEach((e,t)=>{e&&(this.gpuAccums[t]+=i)})},0)),n=(e,n,i)=>function(){const r=n.now();e.apply(i,arguments),n.trackGPU&&n.finished.push(t(r,n.activeAccums.slice(0)))};["drawArrays","drawElements","drawArraysInstanced","drawBuffers","drawElementsInstanced","drawRangeElements"].forEach(t=>{e[t]&&(e[t]=n(e[t],this,e))}),e.getExtension=((t,i)=>function(){let r=t.apply(e,arguments);return r&&["drawElementsInstancedANGLE","drawBuffersWEBGL"].forEach(e=>{r[e]&&(r[e]=n(r[e],i,r))}),r})(e.getExtension,this)}if(!this.withoutUI){this.dom||(this.dom=document.body);let e=document.createElement("div");e.id="gl-bench",this.dom.appendChild(e),this.dom.insertAdjacentHTML("afterbegin",'<style id="gl-bench-style">'+this.css+"</style>"),this.dom=e,this.dom.addEventListener("click",()=>{this.trackGPU=!this.trackGPU,this.updateUI()}),this.paramLogger=((e,t,n)=>{const i=["gl-cpu","gl-gpu","gl-mem","gl-fps","gl-gpu-svg","gl-chart"],r=Object.assign({},i);return i.forEach(e=>r[e]=t.getElementsByClassName(e)),this.nodes=r,(t,i,o,s,a,l,c)=>{r["gl-cpu"][t].style.strokeDasharray=(.27*i).toFixed(0)+" 100",r["gl-gpu"][t].style.strokeDasharray=(.27*o).toFixed(0)+" 100",r["gl-mem"][t].innerHTML=n[t]?n[t]:s?"mem: "+s.toFixed(0)+"mb":"",r["gl-fps"][t].innerHTML=a.toFixed(0)+" FPS",e(n[t],i,o,s,a,l,c)}})(this.paramLogger,this.dom,this.names),this.chartLogger=(e=>{let t={"gl-chart":this.dom.getElementsByClassName("gl-chart")};return(n,i,r)=>{let o="",s=i.length;for(let e=0;e<s;e++){let t=(r+e+1)%s;null!=i[t]&&(o=o+" "+(55*e/(s-1)).toFixed(1)+","+(45-22*i[t]/60/this.detected).toFixed(1))}t["gl-chart"][n].setAttribute("points",o),e(this.names[n],i,r)}})(this.chartLogger)}}addUI(e){-1==this.names.indexOf(e)&&(this.names.push(e),this.dom&&(this.dom.insertAdjacentHTML("beforeend",this.svg),this.updateUI()),this.cpuAccums.push(0),this.gpuAccums.push(0),this.activeAccums.push(!1))}nextFrame(e){this.frameId++;const t=e||this.now();if(this.frameId<=1)this.paramFrame=this.frameId,this.paramTime=t;else{let e=t-this.paramTime;if(e>=1e3){const n=this.frameId-this.paramFrame,i=n/e*1e3;for(let t=0;t<this.names.length;t++){const r=this.cpuAccums[t]/e*100,o=this.gpuAccums[t]/e*100,s=performance&&performance.memory?performance.memory.usedJSHeapSize/(1<<20):0;this.paramLogger(t,r,o,s,i,e,n),this.cpuAccums[t]=0,Promise.all(this.finished).then(()=>{this.gpuAccums[t]=0,this.finished=[]})}this.paramFrame=this.frameId,this.paramTime=t}}if(this.detected&&this.chartFrame){let e=t-this.chartTime,n=this.chartHz*e/1e3;for(;--n>0&&this.detected;){const n=(this.frameId-this.chartFrame)/e*1e3;this.chart[this.circularId%this.chartLen]=n;for(let e=0;e<this.names.length;e++)this.chartLogger(e,this.chart,this.circularId);this.circularId++,this.chartFrame=this.frameId,this.chartTime=t}}else this.chartFrame=this.frameId,this.chartTime=t,this.circularId=0}begin(e){this.updateAccums(e)}end(e){this.updateAccums(e)}updateAccums(e){let t=this.names.indexOf(e);-1==t&&(t=this.names.length,this.addUI(e));const n=this.now(),i=n-this.t0;for(let r=0;r<t+1;r++)this.activeAccums[r]&&(this.cpuAccums[r]+=i);this.activeAccums[t]=!this.activeAccums[t],this.t0=n}}),V_.exports);const W_=B_(H_);class $_{constructor(e){this.destroy();const t=e.getContext("webgl")||e.getContext("experimental-webgl");this.bench=new W_(t,{css:"\n  #gl-bench {\n    position:absolute;\n    right:0;\n    top:0;\n    z-index:1000;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  #gl-bench div {\n    position: relative;\n    display: block;\n    margin: 4px;\n    padding: 0 7px 0 10px;\n    background: #5f69de;\n    border-radius: 15px;\n    cursor: pointer;\n    opacity: 0.9;\n  }\n  #gl-bench svg {\n    height: 60px;\n    margin: 0 -1px;\n  }\n  #gl-bench text {\n    font-size: 12px;\n    font-family: Helvetica,Arial,sans-serif;\n    font-weight: 700;\n    dominant-baseline: middle;\n    text-anchor: middle;\n  }\n  #gl-bench .gl-mem {\n    font-size: 9px;\n  }\n  #gl-bench line {\n    stroke-width: 5;\n    stroke: #112211;\n    stroke-linecap: round;\n  }\n  #gl-bench polyline {\n    fill: none;\n    stroke: #112211;\n    stroke-linecap: round;\n    stroke-linejoin: round;\n    stroke-width: 3.5;\n  }\n  #gl-bench rect {\n    fill: #8288e4;\n  }\n  #gl-bench .opacity {\n    stroke: #8288e4;\n  }\n"})}begin(){var e;null==(e=this.bench)||e.begin("frame")}end(e){var t,n;null==(t=this.bench)||t.end("frame"),null==(n=this.bench)||n.nextFrame(e)}destroy(){this.bench=void 0,Bl("#gl-bench").remove()}}class G_{constructor(e){this._config=e}get pointsNumber(){return this.pointPositions&&this.pointPositions.length/2}get linksNumber(){return this.links&&this.links.length/2}updatePoints(){this.pointPositions=this.inputPointPositions}updatePointColor(){if(void 0===this.pointsNumber)return void(this.pointColors=void 0);const e=Jf(this._config.pointDefaultColor??this._config.pointColor);if(void 0===this.inputPointColors||this.inputPointColors.length/4!==this.pointsNumber){this.pointColors=new Float32Array(4*this.pointsNumber);for(let t=0;t<this.pointColors.length/4;t++)this.pointColors[4*t]=e[0],this.pointColors[4*t+1]=e[1],this.pointColors[4*t+2]=e[2],this.pointColors[4*t+3]=e[3]}else{this.pointColors=this.inputPointColors;for(let t=0;t<this.pointColors.length/4;t++)tp(this.pointColors[4*t])||(this.pointColors[4*t]=e[0]),tp(this.pointColors[4*t+1])||(this.pointColors[4*t+1]=e[1]),tp(this.pointColors[4*t+2])||(this.pointColors[4*t+2]=e[2]),tp(this.pointColors[4*t+3])||(this.pointColors[4*t+3]=e[3])}}updatePointSize(){if(void 0===this.pointsNumber)return void(this.pointSizes=void 0);const e=this._config.pointDefaultSize??this._config.pointSize;if(void 0===this.inputPointSizes||this.inputPointSizes.length!==this.pointsNumber)this.pointSizes=new Float32Array(this.pointsNumber).fill(e);else{this.pointSizes=this.inputPointSizes;for(let t=0;t<this.pointSizes.length;t++)tp(this.pointSizes[t])||(this.pointSizes[t]=e)}}updatePointShape(){if(void 0!==this.pointsNumber)if(void 0===this.inputPointShapes||this.inputPointShapes.length!==this.pointsNumber)this.pointShapes=new Float32Array(this.pointsNumber).fill(0);else{this.pointShapes=new Float32Array(this.inputPointShapes);const e=this.pointShapes;for(let t=0;t<e.length;t++){const n=e[t];(null==n||!tp(n)||n<0||n>8)&&(e[t]=0)}}else this.pointShapes=void 0}updatePointImageIndices(){if(void 0!==this.pointsNumber)if(void 0===this.inputPointImageIndices||this.inputPointImageIndices.length!==this.pointsNumber)this.pointImageIndices=new Float32Array(this.pointsNumber).fill(-1);else{const e=new Float32Array(this.inputPointImageIndices);for(let t=0;t<e.length;t++){const n=e[t],i=void 0===n?NaN:n;!Number.isFinite(i)||i<0?e[t]=-1:e[t]=Math.trunc(i)}this.pointImageIndices=e}else this.pointImageIndices=void 0}updatePointImageSizes(){var e;if(void 0===this.pointsNumber)return void(this.pointImageSizes=void 0);const t=this._config.pointDefaultSize??this._config.pointSize;if(void 0===this.inputPointImageSizes||this.inputPointImageSizes.length!==this.pointsNumber)this.pointImageSizes=this.pointSizes?new Float32Array(this.pointSizes):new Float32Array(this.pointsNumber).fill(t);else{this.pointImageSizes=new Float32Array(this.inputPointImageSizes);for(let n=0;n<this.pointImageSizes.length;n++)tp(this.pointImageSizes[n])||(this.pointImageSizes[n]=(null==(e=this.pointSizes)?void 0:e[n])??t)}}updateLinks(){this.links=this.inputLinks}updateLinkColor(){if(void 0===this.linksNumber)return void(this.linkColors=void 0);const e=Jf(this._config.linkDefaultColor??this._config.linkColor);if(void 0===this.inputLinkColors||this.inputLinkColors.length/4!==this.linksNumber){this.linkColors=new Float32Array(4*this.linksNumber);for(let t=0;t<this.linkColors.length/4;t++)this.linkColors[4*t]=e[0],this.linkColors[4*t+1]=e[1],this.linkColors[4*t+2]=e[2],this.linkColors[4*t+3]=e[3]}else{this.linkColors=this.inputLinkColors;for(let t=0;t<this.linkColors.length/4;t++)tp(this.linkColors[4*t])||(this.linkColors[4*t]=e[0]),tp(this.linkColors[4*t+1])||(this.linkColors[4*t+1]=e[1]),tp(this.linkColors[4*t+2])||(this.linkColors[4*t+2]=e[2]),tp(this.linkColors[4*t+3])||(this.linkColors[4*t+3]=e[3])}}updateLinkWidth(){if(void 0===this.linksNumber)return void(this.linkWidths=void 0);const e=this._config.linkDefaultWidth??this._config.linkWidth;if(void 0===this.inputLinkWidths||this.inputLinkWidths.length!==this.linksNumber)this.linkWidths=new Float32Array(this.linksNumber).fill(e);else{this.linkWidths=this.inputLinkWidths;for(let t=0;t<this.linkWidths.length;t++)tp(this.linkWidths[t])||(this.linkWidths[t]=e)}}updateArrows(){if(void 0===this.linksNumber)return void(this.linkArrows=void 0);const e=this._config.linkDefaultArrows??this._config.linkArrows;void 0===this.linkArrowsBoolean||this.linkArrowsBoolean.length!==this.linksNumber?this.linkArrows=new Array(this.linksNumber).fill(+e):this.linkArrows=this.linkArrowsBoolean.map(e=>+e)}updateLinkStrength(){void 0===this.linksNumber&&(this.linkStrength=void 0),void 0===this.inputLinkStrength||this.inputLinkStrength.length!==this.linksNumber?this.linkStrength=void 0:this.linkStrength=this.inputLinkStrength}updateClusters(){if(void 0===this.pointsNumber)return this.pointClusters=void 0,void(this.clusterPositions=void 0);void 0===this.inputPointClusters||this.inputPointClusters.length!==this.pointsNumber?this.pointClusters=void 0:this.pointClusters=this.inputPointClusters,void 0===this.inputClusterPositions?this.clusterPositions=void 0:this.clusterPositions=this.inputClusterPositions,void 0===this.inputClusterStrength||this.inputClusterStrength.length!==this.pointsNumber?this.clusterStrength=void 0:this.clusterStrength=this.inputClusterStrength}update(){this.updatePoints(),this.updatePointColor(),this.updatePointSize(),this.updatePointShape(),this.updatePointImageIndices(),this.updatePointImageSizes(),this.updateLinks(),this.updateLinkColor(),this.updateLinkWidth(),this.updateArrows(),this.updateLinkStrength(),this.updateClusters(),this._createAdjacencyLists(),this._calculateDegrees()}getAdjacentIndices(e){var t,n,i,r;return[...(null==(n=null==(t=this.sourceIndexToTargetIndices)?void 0:t[e])?void 0:n.map(e=>e[0]))||[],...(null==(r=null==(i=this.targetIndexToSourceIndices)?void 0:i[e])?void 0:r.map(e=>e[0]))||[]]}_createAdjacencyLists(){var e,t;if(void 0===this.linksNumber||void 0===this.links)return this.sourceIndexToTargetIndices=void 0,void(this.targetIndexToSourceIndices=void 0);this.sourceIndexToTargetIndices=new Array(this.pointsNumber).fill(void 0),this.targetIndexToSourceIndices=new Array(this.pointsNumber).fill(void 0);for(let n=0;n<this.linksNumber;n++){const i=this.links[2*n],r=this.links[2*n+1];void 0!==i&&void 0!==r&&(void 0===this.sourceIndexToTargetIndices[i]&&(this.sourceIndexToTargetIndices[i]=[]),null==(e=this.sourceIndexToTargetIndices[i])||e.push([r,n]),void 0===this.targetIndexToSourceIndices[r]&&(this.targetIndexToSourceIndices[r]=[]),null==(t=this.targetIndexToSourceIndices[r])||t.push([i,n]))}}_calculateDegrees(){var e,t,n,i;if(void 0===this.pointsNumber)return this.degree=void 0,this.inDegree=void 0,void(this.outDegree=void 0);this.degree=new Array(this.pointsNumber).fill(0),this.inDegree=new Array(this.pointsNumber).fill(0),this.outDegree=new Array(this.pointsNumber).fill(0);for(let r=0;r<this.pointsNumber;r++)this.inDegree[r]=(null==(t=null==(e=this.targetIndexToSourceIndices)?void 0:e[r])?void 0:t.length)??0,this.outDegree[r]=(null==(i=null==(n=this.sourceIndexToTargetIndices)?void 0:n[r])?void 0:i.length)??0,this.degree[r]=(this.inDegree[r]??0)+(this.outDegree[r]??0)}}function j_(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Y_(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function q_(e){let t,n,i;function r(e,i,r=0,o=e.length){if(r<o){if(0!==t(i,i))return o;do{const t=r+o>>>1;n(e[t],i)<0?r=t+1:o=t}while(r<o)}return r}return 2!==e.length?(t=j_,n=(t,n)=>j_(e(t),n),i=(t,n)=>e(t)-n):(t=e===j_||e===Y_?e:X_,n=e,i=e),{left:r,center:function(e,t,n=0,o=e.length){const s=r(e,t,n,o-1);return s>n&&i(e[s-1],t)>-i(e[s],t)?s-1:s},right:function(e,i,r=0,o=e.length){if(r<o){if(0!==t(i,i))return o;do{const t=r+o>>>1;n(e[t],i)<=0?r=t+1:o=t}while(r<o)}return r}}}function X_(){return 0}const K_=q_(j_).right;function Z_(e,t){let n,i;for(const r of e)null!=r&&(void 0===n?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)));return[n,i]}q_(function(e){return null===e?NaN:+e}).center;var Q_=Math.sqrt(50),J_=Math.sqrt(10),ey=Math.sqrt(2);function ty(e,t,n){var i=(t-e)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,r);return r>=0?(o>=Q_?10:o>=J_?5:o>=ey?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=Q_?10:o>=J_?5:o>=ey?2:1)}function ny(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function iy(e){return+e}var ry=[0,1];function oy(e){return e}function sy(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function ay(e,t,n){var i=e[0],r=e[1],o=t[0],s=t[1];return r<i?(i=sy(r,i),o=n(s,o)):(i=sy(i,r),o=n(o,s)),function(e){return o(i(e))}}function ly(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),o=new Array(i),s=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<i;)r[s]=sy(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(t){var n=K_(e,t,1,i)-1;return o[n](r[n](t))}}function cy(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function uy(){var e,t,n,i,r,o,s=ry,a=ry,l=au,c=oy;function u(){var e=Math.min(s.length,a.length);return c!==oy&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(s[0],s[e-1])),i=e>2?ly:ay,r=o=null,d}function d(t){return null==t||isNaN(t=+t)?n:(r||(r=i(s.map(e),a,l)))(e(c(t)))}return d.invert=function(n){return c(t((o||(o=i(a,s.map(e),nu)))(n)))},d.domain=function(e){return arguments.length?(s=Array.from(e,iy),u()):s.slice()},d.range=function(e){return arguments.length?(a=Array.from(e),u()):a.slice()},d.rangeRound=function(e){return a=Array.from(e),l=lu,u()},d.clamp=function(e){return arguments.length?(c=!!e||oy,u()):c!==oy},d.interpolate=function(e){return arguments.length?(l=e,u()):l},d.unknown=function(e){return arguments.length?(n=e,d):n},function(n,i){return e=n,t=i,u()}}function dy(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function hy(e){return(e=dy(Math.abs(e)))?e[1]:NaN}var fy,py=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function my(e){if(!(t=py.exec(e)))throw new Error("invalid format: "+e);var t;return new gy({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function gy(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function _y(e,t){var n=dy(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}my.prototype=gy.prototype,gy.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const yy={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>_y(100*e,t),r:_y,s:function(e,t){var n=dy(e,t);if(!n)return e+"";var i=n[0],r=n[1],o=r-(fy=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,s=i.length;return o===s?i:o>s?i+new Array(o-s+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+dy(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function vy(e){return e}var by,xy,wy,Sy=Array.prototype.map,Ey=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Cy(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){var i,r,o,s,a=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((i=t<e)&&(r=e,e=t,t=r),0===(s=ty(e,t,n))||!isFinite(s))return[];if(s>0){let n=Math.round(e/s),i=Math.round(t/s);for(n*s<e&&++n,i*s>t&&--i,o=new Array(r=i-n+1);++a<r;)o[a]=(n+a)*s}else{s=-s;let n=Math.round(e*s),i=Math.round(t*s);for(n/s<e&&++n,i/s>t&&--i,o=new Array(r=i-n+1);++a<r;)o[a]=(n+a)/s}return i&&o.reverse(),o}(n[0],n[n.length-1],e??10)},e.tickFormat=function(e,n){var i=t();return function(e,t,n,i){var r,o=function(e,t,n){var i=Math.abs(t-e)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=Q_?r*=10:o>=J_?r*=5:o>=ey&&(r*=2),t<e?-r:r}(e,t,n);switch((i=my(i??",f")).type){case"s":var s=Math.max(Math.abs(e),Math.abs(t));return null==i.precision&&!isNaN(r=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(hy(t)/3)))-hy(Math.abs(e)))}(o,s))&&(i.precision=r),wy(i,s);case"":case"e":case"g":case"p":case"r":null==i.precision&&!isNaN(r=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,hy(t)-hy(e))+1}(o,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=r-("e"===i.type));break;case"f":case"%":null==i.precision&&!isNaN(r=function(e){return Math.max(0,-hy(Math.abs(e)))}(o))&&(i.precision=r-2*("%"===i.type))}return xy(i)}(i[0],i[i.length-1],e??10,n)},e.nice=function(n){null==n&&(n=10);var i,r,o=t(),s=0,a=o.length-1,l=o[s],c=o[a],u=10;for(c<l&&(r=l,l=c,c=r,r=s,s=a,a=r);u-- >0;){if((r=ty(l,c,n))===i)return o[s]=l,o[a]=c,t(o);if(r>0)l=Math.floor(l/r)*r,c=Math.ceil(c/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,c=Math.floor(c*r)/r}i=r}return e},e}function Ty(){var e=uy()(oy,oy);return e.copy=function(){return cy(e,Ty())},ny.apply(e,arguments),Cy(e)}function ky(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Iy(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Ay(e){return e<0?-e*e:e*e}function Ly(){var e=function(e){var t=e(oy,oy),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(oy,oy):.5===n?e(Iy,Ay):e(ky(n),ky(1/n)):n},Cy(t)}(uy());return e.copy=function(){return cy(e,Ly()).exponent(e.exponent())},ny.apply(e,arguments),e}by=function(e){var t=void 0===e.grouping||void 0===e.thousands?vy:function(e,t){return function(n,i){for(var r=n.length,o=[],s=0,a=e[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),o.push(n.substring(r-=a,r+a)),!((l+=a+1)>i));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}(Sy.call(e.grouping,Number),e.thousands+""),n=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",r=void 0===e.decimal?".":e.decimal+"",o=void 0===e.numerals?vy:function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(Sy.call(e.numerals,String)),s=void 0===e.percent?"%":e.percent+"",a=void 0===e.minus?"":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function c(e){var c=(e=my(e)).fill,u=e.align,d=e.sign,h=e.symbol,f=e.zero,p=e.width,m=e.comma,g=e.precision,_=e.trim,y=e.type;"n"===y?(m=!0,y="g"):yy[y]||(void 0===g&&(g=12),_=!0,y="g"),(f||"0"===c&&"="===u)&&(f=!0,c="0",u="=");var v="$"===h?n:"#"===h&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",b="$"===h?i:/[%p]/.test(y)?s:"",x=yy[y],w=/[defgprs%]/.test(y);function S(e){var n,i,s,h=v,S=b;if("c"===y)S=x(e)+S,e="";else{var E=(e=+e)<0||1/e<0;if(e=isNaN(e)?l:x(Math.abs(e),g),_&&(e=function(e){e:for(var t,n=e.length,i=1,r=-1;i<n;++i)switch(e[i]){case".":r=t=i;break;case"0":0===r&&(r=i),t=i;break;default:if(!+e[i])break e;r>0&&(r=0)}return r>0?e.slice(0,r)+e.slice(t+1):e}(e)),E&&0==+e&&"+"!==d&&(E=!1),h=(E?"("===d?d:a:"-"===d||"("===d?"":d)+h,S=("s"===y?Ey[8+fy/3]:"")+S+(E&&"("===d?")":""),w)for(n=-1,i=e.length;++n<i;)if(48>(s=e.charCodeAt(n))||s>57){S=(46===s?r+e.slice(n+1):e.slice(n))+S,e=e.slice(0,n);break}}m&&!f&&(e=t(e,1/0));var C=h.length+e.length+S.length,T=C<p?new Array(p-C+1).join(c):"";switch(m&&f&&(e=t(T+e,T.length?p-S.length:1/0),T=""),u){case"<":e=h+e+S+T;break;case"=":e=h+T+e+S;break;case"^":e=T.slice(0,C=T.length>>1)+h+e+S+T.slice(C);break;default:e=T+h+e+S}return o(e)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),S.toString=function(){return e+""},S}return{format:c,formatPrefix:function(e,t){var n=c(((e=my(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor(hy(t)/3))),r=Math.pow(10,-i),o=Ey[8+i/3];return function(e){return n(r*e)+o}}}}({thousands:",",grouping:[3],currency:["$",""]}),xy=by.format,wy=by.formatPrefix;class Ry extends E_{initPrograms(){var e;const{device:t,config:n,store:i}=this;this.updateLinkIndexFbo(),this.hoveredLineIndexTexture||(this.hoveredLineIndexTexture=t.createTexture({width:1,height:1,format:"rgba32float",usage:ah.SAMPLE|ah.RENDER|ah.COPY_DST,data:new Float32Array(4).fill(0)})),this.hoveredLineIndexFbo||(this.hoveredLineIndexFbo=t.createFramebuffer({width:1,height:1,colorAttachments:[this.hoveredLineIndexTexture]})),this.curveLineGeometry||this.updateCurveLineGeometry();const r=this.data.linksNumber??0;this.pointABuffer||(this.pointABuffer=t.createBuffer({data:new Float32Array(2*r),usage:bd.VERTEX|bd.COPY_DST})),this.pointBBuffer||(this.pointBBuffer=t.createBuffer({data:new Float32Array(2*r),usage:bd.VERTEX|bd.COPY_DST})),this.colorBuffer||(this.colorBuffer=t.createBuffer({data:new Float32Array(4*r),usage:bd.VERTEX|bd.COPY_DST})),this.widthBuffer||(this.widthBuffer=t.createBuffer({data:new Float32Array(r),usage:bd.VERTEX|bd.COPY_DST})),this.arrowBuffer||(this.arrowBuffer=t.createBuffer({data:new Float32Array(r),usage:bd.VERTEX|bd.COPY_DST})),this.linkIndexBuffer||(this.linkIndexBuffer=t.createBuffer({data:new Float32Array(r),usage:bd.VERTEX|bd.COPY_DST})),this.drawLineUniformStore||(this.drawLineUniformStore=new Ph({drawLineUniforms:{uniformTypes:{transformationMatrix:"mat4x4<f32>",pointsTextureSize:"f32",widthScale:"f32",linkArrowsSizeScale:"f32",spaceSize:"f32",screenSize:"vec2<f32>",linkVisibilityDistanceRange:"vec2<f32>",linkVisibilityMinTransparency:"f32",linkOpacity:"f32",greyoutOpacity:"f32",curvedWeight:"f32",curvedLinkControlPointDistance:"f32",curvedLinkSegments:"f32",scaleLinksOnZoom:"f32",maxPointSize:"f32",renderMode:"f32",hoveredLinkIndex:"f32",hoveredLinkColor:"vec4<f32>",hoveredLinkWidthIncrease:"f32"},defaultUniforms:{transformationMatrix:i.transformationMatrix4x4,pointsTextureSize:i.pointsTextureSize,widthScale:n.linkWidthScale??1,linkArrowsSizeScale:n.linkArrowsSizeScale??1,spaceSize:i.adjustedSpaceSize??0,screenSize:R_(i.screenSize,[0,0]),linkVisibilityDistanceRange:R_(n.linkVisibilityDistanceRange,[0,0]),linkVisibilityMinTransparency:n.linkVisibilityMinTransparency??0,linkOpacity:n.linkOpacity??1,greyoutOpacity:n.linkGreyoutOpacity??1,curvedWeight:n.curvedLinkWeight??0,curvedLinkControlPointDistance:n.curvedLinkControlPointDistance??0,curvedLinkSegments:n.curvedLinks?n.curvedLinkSegments??Zh.curvedLinkSegments:1,scaleLinksOnZoom:n.scaleLinksOnZoom??1?1:0,maxPointSize:i.maxPointSize??100,renderMode:0,hoveredLinkIndex:i.hoveredLinkIndex??-1,hoveredLinkColor:P_(i.hoveredLinkColor,[-1,-1,-1,-1]),hoveredLinkWidthIncrease:n.hoveredLinkWidthIncrease??0}},drawLineFragmentUniforms:{uniformTypes:{renderMode:"f32"},defaultUniforms:{renderMode:0}}})),this.drawCurveCommand||(this.drawCurveCommand=new w_(t,{vs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nin vec2 position, pointA, pointB;\nin vec4 color;\nin float width;\nin float arrow;\nin float linkIndices;\n\nuniform sampler2D positionsTexture;\nuniform sampler2D pointGreyoutStatus;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform drawLineUniforms {\n  mat4 transformationMatrix;\n  float pointsTextureSize;\n  float widthScale;\n  float linkArrowsSizeScale;\n  float spaceSize;\n  vec2 screenSize;\n  vec2 linkVisibilityDistanceRange;\n  float linkVisibilityMinTransparency;\n  float linkOpacity;\n  float greyoutOpacity;\n  float curvedWeight;\n  float curvedLinkControlPointDistance;\n  float curvedLinkSegments;\n  float scaleLinksOnZoom;\n  float maxPointSize;\n  float renderMode;\n  float hoveredLinkIndex;\n  vec4 hoveredLinkColor;\n  float hoveredLinkWidthIncrease;\n} drawLine;\n\n#define transformationMatrix drawLine.transformationMatrix\n#define pointsTextureSize drawLine.pointsTextureSize\n#define widthScale drawLine.widthScale\n#define linkArrowsSizeScale drawLine.linkArrowsSizeScale\n#define spaceSize drawLine.spaceSize\n#define screenSize drawLine.screenSize\n#define linkVisibilityDistanceRange drawLine.linkVisibilityDistanceRange\n#define linkVisibilityMinTransparency drawLine.linkVisibilityMinTransparency\n#define linkOpacity drawLine.linkOpacity\n#define greyoutOpacity drawLine.greyoutOpacity\n#define curvedWeight drawLine.curvedWeight\n#define curvedLinkControlPointDistance drawLine.curvedLinkControlPointDistance\n#define curvedLinkSegments drawLine.curvedLinkSegments\n#define scaleLinksOnZoom drawLine.scaleLinksOnZoom\n#define maxPointSize drawLine.maxPointSize\n#define renderMode drawLine.renderMode\n#define hoveredLinkIndex drawLine.hoveredLinkIndex\n#define hoveredLinkColor drawLine.hoveredLinkColor\n#define hoveredLinkWidthIncrease drawLine.hoveredLinkWidthIncrease\n#else\nuniform mat3 transformationMatrix;\nuniform float pointsTextureSize;\nuniform float widthScale;\nuniform float linkArrowsSizeScale;\nuniform float spaceSize;\nuniform vec2 screenSize;\nuniform vec2 linkVisibilityDistanceRange;\nuniform float linkVisibilityMinTransparency;\nuniform float linkOpacity;\nuniform float greyoutOpacity;\nuniform float curvedWeight;\nuniform float curvedLinkControlPointDistance;\nuniform float curvedLinkSegments;\nuniform bool scaleLinksOnZoom;\nuniform float maxPointSize;\n// renderMode: 0.0 = normal rendering, 1.0 = index buffer rendering for picking\nuniform float renderMode;\nuniform float hoveredLinkIndex;\nuniform vec4 hoveredLinkColor;\nuniform float hoveredLinkWidthIncrease;\n#endif\n\nout vec4 rgbaColor;\nout vec2 pos;\nout float arrowLength;\nout float useArrow;\nout float smoothing;\nout float arrowWidthFactor;\nout float linkIndex;\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvec2 conicParametricCurve(vec2 A, vec2 B, vec2 ControlPoint, float t, float w) {\n  vec2 divident = (1.0 - t) * (1.0 - t) * A + 2.0 * (1.0 - t) * t * w * ControlPoint + t * t * B;\n  float divisor = (1.0 - t) * (1.0 - t) + 2.0 * (1.0 - t) * t * w + t * t;\n  return divident / divisor;\n}\n\nfloat calculateLinkWidth(float width) {\n  float linkWidth;\n  if (scaleLinksOnZoom > 0.0) {\n    // Use original width if links should scale with zoom\n    linkWidth = width;\n  } else {\n    // Adjust width based on zoom level to maintain visual size\n    linkWidth = width / transformationMatrix[0][0];\n    // Apply a non-linear scaling to avoid extreme widths\n    linkWidth *= min(5.0, max(1.0, transformationMatrix[0][0] * 0.01));\n  }\n  // Limit link width based on whether it has an arrow\n  if (useArrow > 0.5) {\n    return min(linkWidth, (maxPointSize * 2.0) / transformationMatrix[0][0]);\n  } else {\n    return min(linkWidth, maxPointSize / transformationMatrix[0][0]);\n  }\n}\n\nfloat calculateArrowWidth(float arrowWidth) {\n  if (scaleLinksOnZoom > 0.0) {\n    return arrowWidth;\n  } else {\n    // Apply the same scaling logic as calculateLinkWidth to maintain proportionality\n    arrowWidth = arrowWidth / transformationMatrix[0][0];\n    // Apply the same non-linear scaling to avoid extreme widths\n    arrowWidth *= min(5.0, max(1.0, transformationMatrix[0][0] * 0.01));\n    return arrowWidth;\n  }\n}\n\nvoid main() {\n  pos = position;\n  linkIndex = linkIndices;\n\n  vec2 pointTexturePosA = (pointA + 0.5) / pointsTextureSize;\n  vec2 pointTexturePosB = (pointB + 0.5) / pointsTextureSize;\n  \n  vec4 greyoutStatusA = texture(pointGreyoutStatus, pointTexturePosA);\n  vec4 greyoutStatusB = texture(pointGreyoutStatus, pointTexturePosB);\n  \n  vec4 pointPositionA = texture(positionsTexture, pointTexturePosA);\n  vec4 pointPositionB = texture(positionsTexture, pointTexturePosB);\n  vec2 a = pointPositionA.xy;\n  vec2 b = pointPositionB.xy;\n  \n  // Calculate direction vector and its perpendicular\n  vec2 xBasis = b - a;\n  vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));\n\n  // Calculate link distance and control point for curved link\n  float linkDist = length(xBasis);\n  float h = curvedLinkControlPointDistance;\n  vec2 controlPoint = (a + b) / 2.0 + yBasis * linkDist * h;\n\n  // Convert link distance to screen pixels\n  float linkDistPx = linkDist * transformationMatrix[0][0];\n  \n  // Calculate line width using the width scale\n  float linkWidth = width * widthScale;\n  float k = 2.0;\n  // Arrow width is proportionally larger than the line width\n  float arrowWidth = linkWidth * k;\n  arrowWidth *= linkArrowsSizeScale;\n\n  // Ensure arrow width difference is non-negative to prevent unwanted changes to link width\n  float arrowWidthDifference = max(0.0, arrowWidth - linkWidth);\n\n  // Calculate arrow width in pixels\n  float arrowWidthPx = calculateArrowWidth(arrowWidth);\n\n  // Calculate arrow length proportional to its width\n  // 0.866 is approximately sqrt(3)/2 - related to equilateral triangle geometry\n  // Cap the length to avoid overly long arrows on short links\n  arrowLength = min(0.3, (0.866 * arrowWidthPx * 2.0) / linkDist);\n\n  useArrow = arrow;\n  if (useArrow > 0.5) {\n    linkWidth += arrowWidthDifference;\n  }\n\n  arrowWidthFactor = arrowWidthDifference / linkWidth;\n\n  // Calculate final link width in pixels with smoothing\n  float linkWidthPx = calculateLinkWidth(linkWidth);\n    \n  if (renderMode > 0.0) {\n    // Add 5 pixels padding for better hover detection\n    linkWidthPx += 5.0 / transformationMatrix[0][0];\n  } else {\n      // Add pixel increase if this is the hovered link\n    if (hoveredLinkIndex == linkIndex) {\n      linkWidthPx += hoveredLinkWidthIncrease / transformationMatrix[0][0];\n    }\n  }\n  float smoothingPx = 0.5 / transformationMatrix[0][0];\n  smoothing = smoothingPx / linkWidthPx;\n  linkWidthPx += smoothingPx;\n\n\n\n  // Calculate final color with opacity based on link distance\n  vec3 rgbColor = color.rgb;\n  // Adjust opacity based on link distance\n  float opacity = color.a * linkOpacity * max(linkVisibilityMinTransparency, map(linkDistPx, linkVisibilityDistanceRange.g, linkVisibilityDistanceRange.r, 0.0, 1.0));\n\n  // Apply greyed out opacity if either endpoint is greyed out\n  if (greyoutStatusA.r > 0.0 || greyoutStatusB.r > 0.0) {\n    opacity *= greyoutOpacity;\n  }\n\n  // Pass final color to fragment shader\n  rgbaColor = vec4(rgbColor, opacity);\n\n  // Apply hover color if this is the hovered link and hover color is defined\n  if (hoveredLinkIndex == linkIndex && hoveredLinkColor.a > -0.5) {\n    // Keep existing RGB values but multiply opacity with hover color opacity\n    rgbaColor.rgb = hoveredLinkColor.rgb;\n    rgbaColor.a *= hoveredLinkColor.a;\n  }\n\n  // Calculate position on the curved path\n  float t = position.x;\n  float w = curvedWeight;\n  \n  float tPrev = t - 1.0 / curvedLinkSegments;\n  float tNext = t + 1.0 / curvedLinkSegments;\n  \n  vec2 pointCurr = conicParametricCurve(a, b, controlPoint, t, w);\n  \n  vec2 pointPrev = conicParametricCurve(a, b, controlPoint, max(0.0, tPrev), w);\n  vec2 pointNext = conicParametricCurve(a, b, controlPoint, min(tNext, 1.0), w);\n  \n  vec2 xBasisCurved = pointNext - pointPrev;\n  vec2 yBasisCurved = normalize(vec2(-xBasisCurved.y, xBasisCurved.x));\n  \n  pointCurr += yBasisCurved * linkWidthPx * position.y;\n  \n  // Transform to clip space coordinates\n  vec2 p = 2.0 * pointCurr / spaceSize - 1.0;\n  p *= spaceSize / screenSize;\n  \n  #ifdef USE_UNIFORM_BUFFERS\n  mat3 transformMat3 = mat3(transformationMatrix);\n  vec3 final = transformMat3 * vec3(p, 1);\n  #else\n  vec3 final = transformationMatrix * vec3(p, 1);\n  #endif\n  \n  gl_Position = vec4(final.rg, 0, 1);\n}",fs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nin vec4 rgbaColor;\nin vec2 pos;\nin float arrowLength;\nin float useArrow;\nin float smoothing;\nin float arrowWidthFactor;\nin float linkIndex;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform drawLineFragmentUniforms {\n  float renderMode;\n} drawLineFrag;\n\n#define renderMode drawLineFrag.renderMode\n#else\n// renderMode: 0.0 = normal rendering, 1.0 = index buffer rendering for picking\nuniform float renderMode;\n#endif\n\nout vec4 fragColor;\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvoid main() {\n  float opacity = 1.0;\n  vec3 color = rgbaColor.rgb;\n\n  if (useArrow > 0.5) {\n    float end_arrow = 0.5 + arrowLength / 2.0;\n    float start_arrow = end_arrow - arrowLength;\n    float arrowWidthDelta = arrowWidthFactor / 2.0;\n    float linkOpacity = rgbaColor.a * smoothstep(0.5 - arrowWidthDelta, 0.5 - arrowWidthDelta - smoothing / 2.0, abs(pos.y));\n    float arrowOpacity = 1.0;\n    if (pos.x > start_arrow && pos.x < start_arrow + arrowLength) {\n      float xmapped = map(pos.x, start_arrow, end_arrow, 0.0, 1.0);\n      arrowOpacity = rgbaColor.a * smoothstep(xmapped - smoothing, xmapped, map(abs(pos.y), 0.5, 0.0, 0.0, 1.0));\n      if (linkOpacity != arrowOpacity) {\n        linkOpacity = max(linkOpacity, arrowOpacity);\n      }\n    }\n    opacity = linkOpacity;\n  } else opacity = rgbaColor.a * smoothstep(0.5, 0.5 - smoothing, abs(pos.y));\n  \n  if (renderMode > 0.0) {\n    if (opacity > 0.0) {\n      fragColor = vec4(linkIndex, 0.0, 0.0, 1.0);\n    } else {\n      fragColor = vec4(-1.0, 0.0, 0.0, 0.0);\n    }\n  } else fragColor = vec4(color, opacity);\n\n}",topology:"triangle-strip",vertexCount:(null==(e=this.curveLineGeometry)?void 0:e.length)??0,attributes:{...this.curveLineBuffer&&{position:this.curveLineBuffer},...this.pointABuffer&&{pointA:this.pointABuffer},...this.pointBBuffer&&{pointB:this.pointBBuffer},...this.colorBuffer&&{color:this.colorBuffer},...this.widthBuffer&&{width:this.widthBuffer},...this.arrowBuffer&&{arrow:this.arrowBuffer},...this.linkIndexBuffer&&{linkIndices:this.linkIndexBuffer}},bufferLayout:[{name:"position",format:"float32x2"},{name:"pointA",format:"float32x2",stepMode:"instance"},{name:"pointB",format:"float32x2",stepMode:"instance"},{name:"color",format:"float32x4",stepMode:"instance"},{name:"width",format:"float32",stepMode:"instance"},{name:"arrow",format:"float32",stepMode:"instance"},{name:"linkIndices",format:"float32",stepMode:"instance"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{drawLineUniforms:this.drawLineUniformStore.getManagedUniformBuffer(t,"drawLineUniforms"),drawLineFragmentUniforms:this.drawLineUniformStore.getManagedUniformBuffer(t,"drawLineFragmentUniforms")},parameters:{cullMode:"back",blend:!0,blendColorOperation:"add",blendColorSrcFactor:"src-alpha",blendColorDstFactor:"one-minus-src-alpha",blendAlphaOperation:"add",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one-minus-src-alpha",depthWriteEnabled:!1,depthCompare:"always"}})),this.quadBuffer||(this.quadBuffer=t.createBuffer({data:new Float32Array([-1,-1,1,-1,-1,1,1,1]),usage:bd.VERTEX|bd.COPY_DST})),this.hoveredLineIndexUniformStore||(this.hoveredLineIndexUniformStore=new Ph({hoveredLineIndexUniforms:{uniformTypes:{mousePosition:"vec2<f32>",screenSize:"vec2<f32>"},defaultUniforms:{mousePosition:R_(i.screenMousePosition,[0,0]),screenSize:R_(i.screenSize,[0,0])}}})),this.hoveredLineIndexCommand||(this.hoveredLineIndexCommand=new w_(t,{vs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nin vec2 vertexCoord;\n\nvoid main() {\n  gl_Position = vec4(vertexCoord, 0.0, 1.0);\n} ",fs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D linkIndexTexture;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform hoveredLineIndexUniforms {\n  vec2 mousePosition;\n  vec2 screenSize;\n} hoveredLine;\n\n#define mousePosition hoveredLine.mousePosition\n#define screenSize hoveredLine.screenSize\n#else\nuniform vec2 mousePosition;\nuniform vec2 screenSize;\n#endif\n\nout vec4 fragColor;\n\nvoid main() {\n  // Convert mouse position to texture coordinates\n  vec2 texCoord = mousePosition / screenSize;\n  \n  // Read the link index from the linkIndexFbo texture at mouse position\n  vec4 linkIndexData = texture(linkIndexTexture, texCoord);\n  \n  // Extract the link index (stored in the red channel)\n  float linkIndex = linkIndexData.r;\n  \n  // Check if there's a valid link at this position (alpha > 0)\n  if (linkIndexData.a > 0.0 && linkIndex >= 0.0) {\n    // Output the link index\n    fragColor = vec4(linkIndex, 0.0, 0.0, 1.0);\n  } else {\n    // No link at this position, output -1 to indicate no hover\n    fragColor = vec4(-1.0, 0.0, 0.0, 0.0);\n  }\n} ",topology:"triangle-strip",vertexCount:4,attributes:{vertexCoord:this.quadBuffer},bufferLayout:[{name:"vertexCoord",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{hoveredLineIndexUniforms:this.hoveredLineIndexUniformStore.getManagedUniformBuffer(t,"hoveredLineIndexUniforms")}}))}draw(e){const{config:t,points:n,store:i}=this;n&&(!n.currentPositionTexture||n.currentPositionTexture.destroyed||!n.greyoutStatusTexture||n.greyoutStatusTexture.destroyed||((!this.pointABuffer||!this.pointBBuffer)&&this.updatePointsBuffer(),this.colorBuffer||this.updateColor(),this.widthBuffer||this.updateWidth(),this.arrowBuffer||this.updateArrow(),this.curveLineGeometry||this.updateCurveLineGeometry(),this.drawCurveCommand&&this.drawLineUniformStore&&(this.drawLineUniformStore.setUniforms({drawLineUniforms:{transformationMatrix:i.transformationMatrix4x4,pointsTextureSize:i.pointsTextureSize,widthScale:t.linkWidthScale??1,linkArrowsSizeScale:t.linkArrowsSizeScale??1,spaceSize:i.adjustedSpaceSize??0,screenSize:R_(i.screenSize,[0,0]),linkVisibilityDistanceRange:R_(t.linkVisibilityDistanceRange,[0,0]),linkVisibilityMinTransparency:t.linkVisibilityMinTransparency??0,linkOpacity:t.linkOpacity??1,greyoutOpacity:t.linkGreyoutOpacity??1,curvedWeight:t.curvedLinkWeight??0,curvedLinkControlPointDistance:t.curvedLinkControlPointDistance??0,curvedLinkSegments:t.curvedLinks?t.curvedLinkSegments??Zh.curvedLinkSegments:1,scaleLinksOnZoom:t.scaleLinksOnZoom??1?1:0,maxPointSize:i.maxPointSize??100,renderMode:0,hoveredLinkIndex:i.hoveredLinkIndex??-1,hoveredLinkColor:P_(i.hoveredLinkColor,[-1,-1,-1,-1]),hoveredLinkWidthIncrease:t.hoveredLinkWidthIncrease??0},drawLineFragmentUniforms:{renderMode:0}}),this.drawCurveCommand.setBindings({positionsTexture:n.currentPositionTexture,pointGreyoutStatus:n.greyoutStatusTexture}),this.drawCurveCommand.setInstanceCount(this.data.linksNumber??0),this.drawCurveCommand.draw(e))))}updateLinkIndexFbo(){var e,t;const{device:n,store:i}=this;if(!this.store.isLinkHoveringEnabled)return;const r=i.screenSize??[0,0],o=r[0],s=r[1];if(!o||!s)return;const a=(null==(e=this.previousScreenSize)?void 0:e[0])!==o||(null==(t=this.previousScreenSize)?void 0:t[1])!==s;(!this.linkIndexTexture||a)&&(this.linkIndexFbo&&!this.linkIndexFbo.destroyed&&this.linkIndexFbo.destroy(),this.linkIndexTexture&&!this.linkIndexTexture.destroyed&&this.linkIndexTexture.destroy(),this.linkIndexTexture=n.createTexture({width:o,height:s,format:"rgba32float",usage:ah.SAMPLE|ah.RENDER|ah.COPY_DST}),this.linkIndexTexture.copyImageData({data:new Float32Array(o*s*4).fill(0),bytesPerRow:T_("rgba32float",o),mipLevel:0,x:0,y:0}),this.linkIndexFbo=n.createFramebuffer({width:o,height:s,colorAttachments:[this.linkIndexTexture]}),this.previousScreenSize=[o,s])}updatePointsBuffer(){var e;const{device:t,data:n,store:i}=this;if(void 0===n.linksNumber||void 0===n.links||!i.pointsTextureSize)return;const r=new Float32Array(2*n.linksNumber),o=new Float32Array(2*n.linksNumber);for(let l=0;l<n.linksNumber;l++){const e=n.links[2*l],t=n.links[2*l+1],s=e%i.pointsTextureSize,a=Math.floor(e/i.pointsTextureSize),c=t%i.pointsTextureSize,u=Math.floor(t/i.pointsTextureSize);r[2*l]=s,r[2*l+1]=a,o[2*l]=c,o[2*l+1]=u}const s=((null==(e=this.pointABuffer)?void 0:e.byteLength)??0)/(2*Float32Array.BYTES_PER_ELEMENT);this.pointABuffer&&s===n.linksNumber?this.pointABuffer.write(r):(this.pointABuffer&&!this.pointABuffer.destroyed&&this.pointABuffer.destroy(),this.pointABuffer=t.createBuffer({data:r,usage:bd.VERTEX|bd.COPY_DST})),this.pointBBuffer&&s===n.linksNumber?this.pointBBuffer.write(o):(this.pointBBuffer&&!this.pointBBuffer.destroyed&&this.pointBBuffer.destroy(),this.pointBBuffer=t.createBuffer({data:o,usage:bd.VERTEX|bd.COPY_DST}));const a=new Float32Array(n.linksNumber);for(let l=0;l<n.linksNumber;l++)a[l]=l;this.linkIndexBuffer&&s===n.linksNumber?this.linkIndexBuffer.write(a):(this.linkIndexBuffer&&!this.linkIndexBuffer.destroyed&&this.linkIndexBuffer.destroy(),this.linkIndexBuffer=t.createBuffer({data:a,usage:bd.VERTEX|bd.COPY_DST})),this.drawCurveCommand&&this.drawCurveCommand.setAttributes({pointA:this.pointABuffer,pointB:this.pointBBuffer,linkIndices:this.linkIndexBuffer})}updateColor(){const{device:e,data:t}=this,n=t.linksNumber??0,i=t.linkColors??new Float32Array(4*n).fill(0);this.colorBuffer?(this.colorBuffer.byteLength??0)/(4*Float32Array.BYTES_PER_ELEMENT)!==n?(this.colorBuffer&&!this.colorBuffer.destroyed&&this.colorBuffer.destroy(),this.colorBuffer=e.createBuffer({data:i,usage:bd.VERTEX|bd.COPY_DST})):this.colorBuffer.write(i):this.colorBuffer=e.createBuffer({data:i,usage:bd.VERTEX|bd.COPY_DST}),this.drawCurveCommand&&this.drawCurveCommand.setAttributes({color:this.colorBuffer})}updateWidth(){const{device:e,data:t}=this,n=t.linksNumber??0,i=t.linkWidths??new Float32Array(n).fill(0);this.widthBuffer?(this.widthBuffer.byteLength??0)/Float32Array.BYTES_PER_ELEMENT!==n?(this.widthBuffer&&!this.widthBuffer.destroyed&&this.widthBuffer.destroy(),this.widthBuffer=e.createBuffer({data:i,usage:bd.VERTEX|bd.COPY_DST})):this.widthBuffer.write(i):this.widthBuffer=e.createBuffer({data:i,usage:bd.VERTEX|bd.COPY_DST}),this.drawCurveCommand&&this.drawCurveCommand.setAttributes({width:this.widthBuffer})}updateArrow(){const{device:e,data:t}=this,n=t.linksNumber??0,i=t.linkArrows?new Float32Array(t.linkArrows):new Float32Array(n).fill(0);this.arrowBuffer?(this.arrowBuffer.byteLength??0)/Float32Array.BYTES_PER_ELEMENT!==n?(this.arrowBuffer&&!this.arrowBuffer.destroyed&&this.arrowBuffer.destroy(),this.arrowBuffer=e.createBuffer({data:i,usage:bd.VERTEX|bd.COPY_DST})):this.arrowBuffer.write(i):this.arrowBuffer=e.createBuffer({data:i,usage:bd.VERTEX|bd.COPY_DST}),this.drawCurveCommand&&this.drawCurveCommand.setAttributes({arrow:this.arrowBuffer})}updateCurveLineGeometry(){var e;const{device:t,config:{curvedLinks:n,curvedLinkSegments:i}}=this;this.curveLineGeometry=(e=>{const t=Ly().exponent(2).range([0,1]).domain([-1,1]),n=function(e,t,n){e=+e,t=+t,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((t-e)/n)),o=new Array(r);++i<r;)o[i]=e+i*n;return o}(0,e).map(t=>t/e-.5);n.push(.5);const i=new Array(2*n.length);return n.forEach((e,n)=>{i[2*n]=[t(2*e),.5],i[2*n+1]=[t(2*e),-.5]}),i})(n?i??Zh.curvedLinkSegments:1);const r=new Float32Array(2*this.curveLineGeometry.length);for(let o=0;o<this.curveLineGeometry.length;o++)r[2*o]=this.curveLineGeometry[o][0],r[2*o+1]=this.curveLineGeometry[o][1];this.curveLineBuffer&&this.curveLineBuffer.byteLength===r.byteLength?this.curveLineBuffer.write(r):(null==(e=this.curveLineBuffer)||e.destroy(),this.curveLineBuffer=t.createBuffer({data:r,usage:bd.VERTEX|bd.COPY_DST})),this.drawCurveCommand&&(this.drawCurveCommand.setAttributes({position:this.curveLineBuffer}),this.drawCurveCommand.setVertexCount(this.curveLineGeometry.length))}findHoveredLine(){const{config:e,points:t,store:n}=this;if(!t||!t.currentPositionTexture||t.currentPositionTexture.destroyed||!t.greyoutStatusTexture||t.greyoutStatusTexture.destroyed||!this.data.linksNumber||!this.store.isLinkHoveringEnabled||!this.linkIndexFbo||!this.drawCurveCommand||!this.drawLineUniformStore||!this.linkIndexTexture||this.linkIndexTexture.destroyed)return;this.drawLineUniformStore.setUniforms({drawLineUniforms:{transformationMatrix:n.transformationMatrix4x4,pointsTextureSize:n.pointsTextureSize,widthScale:e.linkWidthScale??1,linkArrowsSizeScale:e.linkArrowsSizeScale??1,spaceSize:n.adjustedSpaceSize??0,screenSize:R_(n.screenSize,[0,0]),linkVisibilityDistanceRange:R_(e.linkVisibilityDistanceRange,[0,0]),linkVisibilityMinTransparency:e.linkVisibilityMinTransparency??0,linkOpacity:e.linkOpacity??1,greyoutOpacity:e.linkGreyoutOpacity??1,curvedWeight:e.curvedLinkWeight??0,curvedLinkControlPointDistance:e.curvedLinkControlPointDistance??0,curvedLinkSegments:e.curvedLinks?e.curvedLinkSegments??Zh.curvedLinkSegments:1,scaleLinksOnZoom:e.scaleLinksOnZoom??1?1:0,maxPointSize:n.maxPointSize??100,renderMode:1,hoveredLinkIndex:n.hoveredLinkIndex??-1,hoveredLinkColor:P_(n.hoveredLinkColor,[-1,-1,-1,-1]),hoveredLinkWidthIncrease:e.hoveredLinkWidthIncrease??0},drawLineFragmentUniforms:{renderMode:1}}),this.drawCurveCommand.setBindings({positionsTexture:t.currentPositionTexture,pointGreyoutStatus:t.greyoutStatusTexture}),this.drawCurveCommand.setInstanceCount(this.data.linksNumber??0);const i=this.device.beginRenderPass({framebuffer:this.linkIndexFbo,clearColor:[0,0,0,0]});if(this.drawCurveCommand.draw(i),i.end(),this.hoveredLineIndexCommand&&this.hoveredLineIndexFbo&&this.hoveredLineIndexUniformStore){this.hoveredLineIndexUniformStore.setUniforms({hoveredLineIndexUniforms:{mousePosition:R_(n.screenMousePosition,[0,0]),screenSize:R_(n.screenSize,[0,0])}}),this.hoveredLineIndexCommand.setBindings({linkIndexTexture:this.linkIndexTexture});const e=this.device.beginRenderPass({framebuffer:this.hoveredLineIndexFbo});this.hoveredLineIndexCommand.draw(e),e.end()}}destroy(){var e,t,n,i;null==(e=this.drawCurveCommand)||e.destroy(),this.drawCurveCommand=void 0,null==(t=this.hoveredLineIndexCommand)||t.destroy(),this.hoveredLineIndexCommand=void 0,this.linkIndexFbo&&!this.linkIndexFbo.destroyed&&this.linkIndexFbo.destroy(),this.linkIndexFbo=void 0,this.hoveredLineIndexFbo&&!this.hoveredLineIndexFbo.destroyed&&this.hoveredLineIndexFbo.destroy(),this.hoveredLineIndexFbo=void 0,this.linkIndexTexture&&!this.linkIndexTexture.destroyed&&this.linkIndexTexture.destroy(),this.linkIndexTexture=void 0,this.hoveredLineIndexTexture&&!this.hoveredLineIndexTexture.destroyed&&this.hoveredLineIndexTexture.destroy(),this.hoveredLineIndexTexture=void 0,null==(n=this.drawLineUniformStore)||n.destroy(),this.drawLineUniformStore=void 0,null==(i=this.hoveredLineIndexUniformStore)||i.destroy(),this.hoveredLineIndexUniformStore=void 0,this.pointABuffer&&!this.pointABuffer.destroyed&&this.pointABuffer.destroy(),this.pointABuffer=void 0,this.pointBBuffer&&!this.pointBBuffer.destroyed&&this.pointBBuffer.destroy(),this.pointBBuffer=void 0,this.colorBuffer&&!this.colorBuffer.destroyed&&this.colorBuffer.destroy(),this.colorBuffer=void 0,this.widthBuffer&&!this.widthBuffer.destroyed&&this.widthBuffer.destroy(),this.widthBuffer=void 0,this.arrowBuffer&&!this.arrowBuffer.destroyed&&this.arrowBuffer.destroy(),this.arrowBuffer=void 0,this.curveLineBuffer&&!this.curveLineBuffer.destroyed&&this.curveLineBuffer.destroy(),this.curveLineBuffer=void 0,this.linkIndexBuffer&&!this.linkIndexBuffer.destroyed&&this.linkIndexBuffer.destroy(),this.linkIndexBuffer=void 0,this.quadBuffer&&!this.quadBuffer.destroyed&&this.quadBuffer.destroy(),this.quadBuffer=void 0}}class Py extends E_{constructor(){super(...arguments),this.imageCount=0,this.isPositionsUpToDate=!1,this.polygonPathLength=0}updatePositions(){var e,t,n;const{device:i,store:r,data:o,config:{rescalePositions:s,enableSimulation:a}}=this,{pointsTextureSize:l}=r;if(!l||!o.pointPositions||void 0===o.pointsNumber)return;const c=new Float32Array(l*l*4);c.byteLength;let u=s;void 0===s&&!a&&(u=!0),this.shouldSkipRescale&&(u=!1),u?this.rescaleInitialNodePositions():this.shouldSkipRescale||(this.scaleX=void 0,this.scaleY=void 0),this.shouldSkipRescale=void 0;for(let f=0;f<o.pointsNumber;++f)c[4*f+0]=o.pointPositions[2*f+0],c[4*f+1]=o.pointPositions[2*f+1],c[4*f+2]=f;if(this.currentPositionTexture&&this.currentPositionTexture.width===l&&this.currentPositionTexture.height===l?this.currentPositionTexture.copyImageData({data:c,bytesPerRow:T_("rgba32float",l),mipLevel:0,x:0,y:0}):(this.currentPositionTexture&&this.currentPositionTexture.destroy(),this.currentPositionFbo&&this.currentPositionFbo.destroy(),this.currentPositionTexture=i.createTexture({width:l,height:l,format:"rgba32float"}),this.currentPositionTexture.copyImageData({data:c,bytesPerRow:T_("rgba32float",l),mipLevel:0,x:0,y:0}),this.currentPositionFbo=i.createFramebuffer({width:l,height:l,colorAttachments:[this.currentPositionTexture]})),this.previousPositionTexture&&this.previousPositionTexture.width===l&&this.previousPositionTexture.height===l?this.previousPositionTexture.copyImageData({data:c,bytesPerRow:T_("rgba32float",l),mipLevel:0,x:0,y:0}):(this.previousPositionTexture&&this.previousPositionTexture.destroy(),this.previousPositionFbo&&this.previousPositionFbo.destroy(),this.previousPositionTexture=i.createTexture({width:l,height:l,format:"rgba32float"}),this.previousPositionTexture.copyImageData({data:c,bytesPerRow:T_("rgba32float",l),mipLevel:0,x:0,y:0}),this.previousPositionFbo=i.createFramebuffer({width:l,height:l,colorAttachments:[this.previousPositionTexture]})),this.config.enableSimulation){const e=new Float32Array(l*l*4).fill(0);this.velocityTexture&&this.velocityTexture.width===l&&this.velocityTexture.height===l?this.velocityTexture.copyImageData({data:e,bytesPerRow:T_("rgba32float",l),mipLevel:0,x:0,y:0}):(this.velocityTexture&&this.velocityTexture.destroy(),this.velocityFbo&&this.velocityFbo.destroy(),this.velocityTexture=i.createTexture({width:l,height:l,format:"rgba32float"}),this.velocityTexture.copyImageData({data:e,bytesPerRow:T_("rgba32float",l),mipLevel:0,x:0,y:0}),this.velocityFbo=i.createFramebuffer({width:l,height:l,colorAttachments:[this.velocityTexture]}))}this.selectedTexture&&this.selectedTexture.width===l&&this.selectedTexture.height===l?this.selectedTexture.copyImageData({data:c,bytesPerRow:T_("rgba32float",l),mipLevel:0,x:0,y:0}):(this.selectedTexture&&this.selectedTexture.destroy(),this.selectedFbo&&this.selectedFbo.destroy(),this.selectedTexture=i.createTexture({width:l,height:l,format:"rgba32float"}),this.selectedTexture.copyImageData({data:c,bytesPerRow:T_("rgba32float",l),mipLevel:0,x:0,y:0}),this.selectedFbo=i.createFramebuffer({width:l,height:l,colorAttachments:[this.selectedTexture]})),this.hoveredFbo||(this.hoveredFbo=i.createFramebuffer({width:2,height:2,colorAttachments:["rgba32float"]}));const d=C_(r.pointsTextureSize),h=d.byteLength;this.drawPointIndices&&this.drawPointIndices.byteLength===h?this.drawPointIndices.write(d):(null==(e=this.drawPointIndices)||e.destroy(),this.drawPointIndices=i.createBuffer({data:d,usage:bd.VERTEX|bd.COPY_DST})),this.drawCommand&&this.drawCommand.setAttributes({pointIndices:this.drawPointIndices}),this.hoveredPointIndices&&this.hoveredPointIndices.byteLength===h?this.hoveredPointIndices.write(d):(null==(t=this.hoveredPointIndices)||t.destroy(),this.hoveredPointIndices=i.createBuffer({data:d,usage:bd.VERTEX|bd.COPY_DST})),this.sampledPointIndices&&this.sampledPointIndices.byteLength===h?this.sampledPointIndices.write(d):(null==(n=this.sampledPointIndices)||n.destroy(),this.sampledPointIndices=i.createBuffer({data:d,usage:bd.VERTEX|bd.COPY_DST})),this.fillSampledPointsFboCommand&&this.fillSampledPointsFboCommand.setAttributes({pointIndices:this.sampledPointIndices}),this.updateGreyoutStatus(),this.updatePinnedStatus(),this.updateSampledPointsGrid(),this.trackPointsByIndices()}initPrograms(){var e,t,n;const{device:i,config:r,store:o,data:s}=this;(!this.imageAtlasCoordsTexture||!this.imageAtlasTexture)&&this.createAtlas(),this.colorBuffer||this.updateColor(),this.sizeBuffer||this.updateSize(),this.shapeBuffer||this.updateShape(),this.imageIndicesBuffer||this.updateImageIndices(),this.imageSizesBuffer||this.updateImageSizes(),this.greyoutStatusTexture||this.updateGreyoutStatus(),r.enableSimulation&&(this.updatePositionVertexCoordBuffer||(this.updatePositionVertexCoordBuffer=i.createBuffer({data:new Float32Array([-1,-1,1,-1,-1,1,1,1])})),this.updatePositionUniformStore||(this.updatePositionUniformStore=new Ph({updatePositionUniforms:{uniformTypes:{friction:"f32",spaceSize:"f32"},defaultUniforms:{friction:r.simulationFriction??0,spaceSize:o.adjustedSpaceSize??0}}})),this.updatePositionCommand||(this.updatePositionCommand=new w_(i,{fs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform sampler2D velocity;\nuniform sampler2D pinnedStatusTexture;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform updatePositionUniforms {\n  float friction;\n  float spaceSize;\n} updatePosition;\n\n#define friction updatePosition.friction\n#define spaceSize updatePosition.spaceSize\n#else\nuniform float friction;\nuniform float spaceSize;\n#endif\n\nin vec2 textureCoords;\n\nout vec4 fragColor;\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, textureCoords);\n  vec4 pointVelocity = texture(velocity, textureCoords);\n\n  // Check if point is pinned\n  // pinnedStatusTexture has the same size and layout as positionsTexture\n  // Each pixel corresponds to a point: red channel > 0.5 means the point is pinned\n  vec4 pinnedStatus = texture(pinnedStatusTexture, textureCoords);\n  \n  // If pinned, don't update position\n  if (pinnedStatus.r > 0.5) {\n    fragColor = pointPosition;\n    return;\n  }\n\n  // Friction\n  pointVelocity.rg *= friction;\n\n  pointPosition.rg += pointVelocity.rg;\n\n  pointPosition.r = clamp(pointPosition.r, 0.0, spaceSize);\n  pointPosition.g = clamp(pointPosition.g, 0.0, spaceSize);\n  \n  fragColor = pointPosition;\n}",vs:k_,topology:"triangle-strip",vertexCount:4,attributes:{vertexCoord:this.updatePositionVertexCoordBuffer},bufferLayout:[{name:"vertexCoord",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{updatePositionUniforms:this.updatePositionUniformStore.getManagedUniformBuffer(i,"updatePositionUniforms")}}))),this.dragPointVertexCoordBuffer||(this.dragPointVertexCoordBuffer=i.createBuffer({data:new Float32Array([-1,-1,1,-1,-1,1,1,1])})),this.dragPointUniformStore||(this.dragPointUniformStore=new Ph({dragPointUniforms:{uniformTypes:{mousePos:"vec2<f32>",index:"f32"},defaultUniforms:{mousePos:R_(o.mousePosition,[0,0]),index:(null==(e=o.hoveredPoint)?void 0:e.index)??-1}}})),this.dragPointCommand||(this.dragPointCommand=new w_(i,{fs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform dragPointUniforms {\n  vec2 mousePos;\n  float index;\n} dragPoint;\n\n#define mousePos dragPoint.mousePos\n#define index dragPoint.index\n#else\nuniform vec2 mousePos;\nuniform float index;\n#endif\n\nin vec2 textureCoords;\n\nout vec4 fragColor;\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, textureCoords);\n\n  // Check if a point is being dragged\n  if (index >= 0.0 && index == pointPosition.b) {\n    pointPosition.rg = mousePos.rg;\n  }\n\n  fragColor = pointPosition;\n}",vs:k_,topology:"triangle-strip",vertexCount:4,attributes:{vertexCoord:this.dragPointVertexCoordBuffer},bufferLayout:[{name:"vertexCoord",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{dragPointUniforms:this.dragPointUniformStore.getManagedUniformBuffer(i,"dragPointUniforms")}})),this.drawUniformStore||(this.drawUniformStore=new Ph({drawVertexUniforms:{uniformTypes:{ratio:"f32",transformationMatrix:"mat4x4<f32>",pointsTextureSize:"f32",sizeScale:"f32",spaceSize:"f32",screenSize:"vec2<f32>",greyoutColor:"vec4<f32>",backgroundColor:"vec4<f32>",scalePointsOnZoom:"f32",maxPointSize:"f32",isDarkenGreyout:"f32",skipSelected:"f32",skipUnselected:"f32",hasImages:"f32",imageCount:"f32",imageAtlasCoordsTextureSize:"f32"},defaultUniforms:{ratio:r.pixelRatio??Zh.pixelRatio,transformationMatrix:(()=>{const e=o.transform??[1,0,0,0,1,0,0,0,1];return[e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,0,0,0,1]})(),pointsTextureSize:o.pointsTextureSize??0,sizeScale:r.pointSizeScale??1,spaceSize:o.adjustedSpaceSize??0,screenSize:R_(o.screenSize,[0,0]),greyoutColor:P_(o.greyoutPointColor,[0,0,0,1]),backgroundColor:P_(o.backgroundColor,[0,0,0,1]),scalePointsOnZoom:r.scalePointsOnZoom??1?1:0,maxPointSize:o.maxPointSize??100,isDarkenGreyout:o.isDarkenGreyout?1:0,skipSelected:0,skipUnselected:0,hasImages:this.imageCount>0?1:0,imageCount:this.imageCount,imageAtlasCoordsTextureSize:this.imageAtlasCoordsTextureSize??0}},drawFragmentUniforms:{uniformTypes:{greyoutOpacity:"f32",pointOpacity:"f32",isDarkenGreyout:"f32",backgroundColor:"vec4<f32>"},defaultUniforms:{greyoutOpacity:r.pointGreyoutOpacity??-1,pointOpacity:r.pointOpacity??1,isDarkenGreyout:o.isDarkenGreyout?1:0,backgroundColor:P_(o.backgroundColor,[0,0,0,1])}}})),this.drawCommand||(this.drawCommand=new w_(i,{fs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D imageAtlasTexture;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform drawFragmentUniforms {\n  float greyoutOpacity;\n  float pointOpacity;\n  float isDarkenGreyout;\n  vec4 backgroundColor;\n} drawFragment;\n\n#define greyoutOpacity drawFragment.greyoutOpacity\n#define pointOpacity drawFragment.pointOpacity\n#define isDarkenGreyout drawFragment.isDarkenGreyout\n#define backgroundColor drawFragment.backgroundColor\n#else\nuniform float greyoutOpacity;\nuniform float pointOpacity;\nuniform float isDarkenGreyout;\nuniform vec4 backgroundColor;\n#endif\n\n\nin float pointShape;\nin float isGreyedOut;\nin vec4 shapeColor;\nin vec4 imageAtlasUV;\nin float shapeSize;\nin float imageSizeVarying;\nin float overallSize;\n\nout vec4 fragColor;\n\n// Smoothing controls the smoothness of the point's edge\nconst float smoothing = 0.9;\n\n// Shape constants\nconst float CIRCLE = 0.0;\nconst float SQUARE = 1.0;\nconst float TRIANGLE = 2.0;\nconst float DIAMOND = 3.0;\nconst float PENTAGON = 4.0;\nconst float HEXAGON = 5.0;\nconst float STAR = 6.0;\nconst float CROSS = 7.0;\nconst float NONE = 8.0;\n\n// Distance functions for different shapes\nfloat circleDistance(vec2 p) {\n    return dot(p, p);\n}\n\n// Function to apply greyout logic to image colors\nvec4 applyGreyoutToImage(vec4 imageColor, float isGreyedOutValue) {\n    vec3 finalColor = imageColor.rgb;\n    float finalAlpha = imageColor.a;\n    \n    if (isGreyedOutValue > 0.0) {\n        float blendFactor = 0.65; // Controls how much to modify (0.0 = original, 1.0 = target color)\n        \n        if (isDarkenGreyout > 0.0) {\n            finalColor = mix(finalColor, vec3(0.2), blendFactor);\n        } else {\n            finalColor = mix(finalColor, max(backgroundColor.rgb, vec3(0.8)), blendFactor);\n        }\n    }\n    \n    return vec4(finalColor, finalAlpha);\n}\n\nfloat squareDistance(vec2 p) {\n    vec2 d = abs(p) - vec2(0.8);\n    return length(max(d, 0.0)) + min(max(d.x, d.y), 0.0);\n}\n\nfloat triangleDistance(vec2 p) {\n    const float k = sqrt(3.0);   // 1.732; slope of 60 lines for an equilateral triangle\n    p.x = abs(p.x) - 0.9;        // fold the X axis and shift: brings left and right halves together\n    p.y = p.y + 0.55;             // move the whole shape up slightly so it is centred vertically\n\n    // reflect points that fall outside the main triangle back inside, to reuse the same maths\n    if (p.x + k * p.y > 0.0)\n        p = vec2(p.x - k * p.y,  -k * p.x - p.y) / 2.0;\n\n    p.x -= clamp(p.x, -1.0, 0.0); // clip any remainder on the left side\n\n    // Return signed distance: negative = inside; positive = outside\n    return -length(p) * sign(p.y);\n}\n\nfloat diamondDistance(vec2 p) {\n    // aspect > 1    taller diamond\n    const float aspect = 1.2;\n    return abs(p.x) + abs(p.y) / aspect - 0.8;\n}\n\nfloat pentagonDistance(vec2 p) {\n    // Regular pentagon signed-distance (Inigo Quilez)\n    const vec3 k = vec3(0.809016994, 0.587785252, 0.726542528);\n    p.x = abs(p.x);\n\n    // Reflect across the two tilted edges  only if point is outside\n    p -= 2.0 * min(dot(vec2(-k.x, k.y), p), 0.0) * vec2(-k.x, k.y);\n    p -= 2.0 * min(dot(vec2( k.x, k.y), p), 0.0) * vec2( k.x, k.y);\n\n    // Clip against the top horizontal edge (keeps top point sharp)\n    p -= vec2(clamp(p.x, -k.z * k.x, k.z * k.x), k.z);\n\n    // Return signed distance (negative  inside, positive  outside)\n    return length(p) * sign(p.y);\n}\n\nfloat hexagonDistance(vec2 p) {\n    const vec3 k = vec3(-0.866025404, 0.5, 0.577350269);\n    p = abs(p);\n    p -= 2.0 * min(dot(k.xy, p), 0.0) * k.xy;\n    p -= vec2(clamp(p.x, -k.z * 0.8, k.z * 0.8), 0.8);\n    return length(p) * sign(p.y);\n}\n\nfloat starDistance(vec2 p) {\n    // 5-point star signed-distance function (adapted from Inigo Quilez)\n    // r   outer radius, rf  inner/outer radius ratio\n    const float r  = 0.9;\n    const float rf = 0.45;\n\n    // Pre-computed rotation vectors for the star arms (36 increments)\n    const vec2 k1 = vec2(0.809016994, -0.587785252);\n    const vec2 k2 = vec2(-k1.x, k1.y);\n\n    // Fold the plane into a single arm sector\n    p.x = abs(p.x);\n    p -= 2.0 * max(dot(k1, p), 0.0) * k1;\n    p -= 2.0 * max(dot(k2, p), 0.0) * k2;\n    p.x = abs(p.x);\n\n    // Translate so the top tip of the star lies on the X-axis\n    p.y -= r;\n\n    // Vector describing the edge between an outer tip and its adjacent inner point\n    vec2 ba = rf * vec2(-k1.y, k1.x) - vec2(0.0, 1.0);\n    // Project the point onto that edge and clamp the projection to the segment\n    float h = clamp(dot(p, ba) / dot(ba, ba), 0.0, r);\n\n    // Return signed distance (negative => inside, positive => outside)\n    return length(p - ba * h) * sign(p.y * ba.x - p.x * ba.y);\n}\n\nfloat crossDistance(vec2 p) {\n    // Signed distance function for a cross (union of two rectangles)\n    // Adapted from Inigo Quilez (https://iquilezles.org/)\n    // Each arm has half-sizes 0.3 (thickness) and 0.8 (length)\n    p = abs(p);\n    if (p.y > p.x) p = p.yx;       // exploit symmetry\n\n    vec2 q = p - vec2(0.8, 0.3);   // subtract half-sizes (length, thickness)\n\n    // Standard rectangle SDF, then take union of the two arms\n    return length(max(q, 0.0)) + min(max(q.x, q.y), 0.0);\n}\n\nfloat getShapeDistance(vec2 p, float shape) {\n    if (shape == SQUARE) return squareDistance(p);\n    else if (shape == TRIANGLE) return triangleDistance(p);\n    else if (shape == DIAMOND) return diamondDistance(p);\n    else if (shape == PENTAGON) return pentagonDistance(p);\n    else if (shape == HEXAGON) return hexagonDistance(p);\n    else if (shape == STAR) return starDistance(p);\n    else if (shape == CROSS) return crossDistance(p);\n    else return circleDistance(p); // Default to circle\n}\n\nvoid main() {\n    // Discard the fragment if the point is fully transparent and has no image\n    if (shapeColor.a == 0.0 && imageAtlasUV.x == -1.0) {\n        discard;\n    }\n\n    // Discard the fragment if the point has no shape and no image\n    if (pointShape == NONE && imageAtlasUV.x == -1.0) {\n        discard;\n    }\n\n    // Calculate coordinates within the point\n    vec2 pointCoord = 2.0 * gl_PointCoord - 1.0;\n\n    vec4 finalShapeColor = vec4(0.0);\n    vec4 finalImageColor = vec4(0.0);\n    \n    // Handle shape rendering with centering logic\n    if (pointShape != NONE) {\n        // Calculate shape coordinates with centering\n        vec2 shapeCoord = pointCoord;\n        if (overallSize > shapeSize && shapeSize > 0.0) {\n            // Shape is smaller than overall size, center it\n            float scale = shapeSize / overallSize;\n            shapeCoord = pointCoord / scale;\n        }\n        \n        float opacity;\n        if (pointShape == CIRCLE) {\n            // For circles, use the original distance calculation\n            float pointCenterDistance = dot(shapeCoord, shapeCoord);\n            opacity = 1.0 - smoothstep(smoothing, 1.0, pointCenterDistance);\n        } else {\n            // For other shapes, use the shape distance function\n            float shapeDistance = getShapeDistance(shapeCoord, pointShape);\n            opacity = 1.0 - smoothstep(-0.01, 0.01, shapeDistance);\n        }\n        opacity *= shapeColor.a;\n\n        finalShapeColor = vec4(shapeColor.rgb, opacity);\n    }\n\n    // Handle image rendering with centering logic\n    if (imageAtlasUV.x != -1.0) {\n        // Calculate image coordinates with centering\n        vec2 imageCoord = pointCoord;\n        if (overallSize > imageSizeVarying && imageSizeVarying > 0.0) {\n            // Image is smaller than overall size, center it\n            float scale = imageSizeVarying / overallSize;\n            imageCoord = pointCoord / scale;\n            \n            // Check if we're outside the valid image area\n            if (abs(imageCoord.x) > 1.0 || abs(imageCoord.y) > 1.0) {\n                // We're outside the image bounds, don't render the image\n                finalImageColor = vec4(0.0);\n            } else {\n                // Sample from texture atlas\n                vec2 atlasUV = mix(imageAtlasUV.xy, imageAtlasUV.zw, (imageCoord + 1.0) * 0.5);\n                vec4 imageColor = texture(imageAtlasTexture, atlasUV);\n                finalImageColor = applyGreyoutToImage(imageColor, isGreyedOut);\n            }\n        } else {\n            // Image is same size or larger than overall size, no scaling needed\n            // Sample from texture atlas\n            vec2 atlasUV = mix(imageAtlasUV.xy, imageAtlasUV.zw, (imageCoord + 1.0) * 0.5);\n            vec4 imageColor = texture(imageAtlasTexture, atlasUV);\n            finalImageColor = applyGreyoutToImage(imageColor, isGreyedOut);\n        }\n    }\n\n    float finalPointAlpha = max(finalShapeColor.a, finalImageColor.a);\n    if (isGreyedOut > 0.0 && greyoutOpacity != -1.0) {\n        finalPointAlpha *= greyoutOpacity;\n    } else {\n        finalPointAlpha *= pointOpacity;\n    }\n\n    // Blend image color above point color\n    fragColor = vec4(\n        mix(finalShapeColor.rgb, finalImageColor.rgb, finalImageColor.a),\n        finalPointAlpha\n    );\n}\n",vs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nin vec2 pointIndices;\nin float size;\nin vec4 color;\nin float shape;\nin float imageIndex;\nin float imageSize;\n\nuniform sampler2D positionsTexture;\nuniform sampler2D pointGreyoutStatus;\nuniform sampler2D imageAtlasCoords;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform drawVertexUniforms {\n  float ratio;\n  mat4 transformationMatrix;\n  float pointsTextureSize;\n  float sizeScale;\n  float spaceSize;\n  vec2 screenSize;\n  vec4 greyoutColor;\n  vec4 backgroundColor;\n  float scalePointsOnZoom;\n  float maxPointSize;\n  float isDarkenGreyout;\n  float skipSelected;\n  float skipUnselected;\n  float hasImages;\n  float imageCount;\n  float imageAtlasCoordsTextureSize;\n} drawVertex;\n\n#define ratio drawVertex.ratio\n#define transformationMatrix drawVertex.transformationMatrix\n#define pointsTextureSize drawVertex.pointsTextureSize\n#define sizeScale drawVertex.sizeScale\n#define spaceSize drawVertex.spaceSize\n#define screenSize drawVertex.screenSize\n#define greyoutColor drawVertex.greyoutColor\n#define backgroundColor drawVertex.backgroundColor\n#define scalePointsOnZoom drawVertex.scalePointsOnZoom\n#define maxPointSize drawVertex.maxPointSize\n#define isDarkenGreyout drawVertex.isDarkenGreyout\n#define skipSelected drawVertex.skipSelected\n#define skipUnselected drawVertex.skipUnselected\n#define hasImages drawVertex.hasImages\n#define imageCount drawVertex.imageCount\n#define imageAtlasCoordsTextureSize drawVertex.imageAtlasCoordsTextureSize\n#else\nuniform float ratio;\nuniform mat3 transformationMatrix;\nuniform float pointsTextureSize;\nuniform float sizeScale;\nuniform float spaceSize;\nuniform vec2 screenSize;\nuniform vec4 greyoutColor;\nuniform vec4 backgroundColor;\nuniform float scalePointsOnZoom;\nuniform float maxPointSize;\nuniform float isDarkenGreyout;\nuniform float skipSelected;\nuniform float skipUnselected;\nuniform float hasImages;\nuniform float imageCount;\nuniform float imageAtlasCoordsTextureSize;\n#endif\n\nout float pointShape;\nout float isGreyedOut;\nout vec4 shapeColor;\nout vec4 imageAtlasUV;\nout float shapeSize;\nout float imageSizeVarying;\nout float overallSize;\n\nfloat calculatePointSize(float size) {\n  float pSize;\n\n  if (scalePointsOnZoom > 0.0) { \n    pSize = size * ratio * transformationMatrix[0][0];\n  } else {\n    pSize = size * ratio * min(5.0, max(1.0, transformationMatrix[0][0] * 0.01));\n  }\n\n  return min(pSize, maxPointSize * ratio);\n}\n\nvoid main() {    \n  // Check greyout status for selective rendering\n  vec4 greyoutStatus = texture(pointGreyoutStatus, (pointIndices + 0.5) / pointsTextureSize);\n  isGreyedOut = greyoutStatus.r;\n  float isSelected = (greyoutStatus.r == 0.0) ? 1.0 : 0.0;\n  \n  // Discard point based on rendering mode\n  if (skipSelected > 0.0 && isSelected > 0.0) {\n    gl_Position = vec4(2.0, 2.0, 2.0, 1.0); // Move off-screen\n    gl_PointSize = 0.0;\n    return;\n  }\n  if (skipUnselected > 0.0 && isSelected <= 0.0) {\n    gl_Position = vec4(2.0, 2.0, 2.0, 1.0); // Move off-screen\n    gl_PointSize = 0.0;\n    return;\n  }\n  \n  // Position\n  vec4 pointPosition = texture(positionsTexture, (pointIndices + 0.5) / pointsTextureSize);\n  vec2 point = pointPosition.rg;\n\n  // Transform point position to normalized device coordinates\n  // Convert from space coordinates [0, spaceSize] to normalized [-1, 1]\n  vec2 normalizedPosition = 2.0 * point / spaceSize - 1.0;\n  \n  // Apply aspect ratio correction - this is needed to map the square space to the rectangular screen\n  // The transformation matrix handles zoom/pan, but we need this to handle aspect ratio\n  normalizedPosition *= spaceSize / screenSize;\n  \n  #ifdef USE_UNIFORM_BUFFERS\n  mat3 transformMat3 = mat3(transformationMatrix);\n  vec3 finalPosition = transformMat3 * vec3(normalizedPosition, 1);\n  #else\n  vec3 finalPosition = transformationMatrix * vec3(normalizedPosition, 1);\n  #endif\n  gl_Position = vec4(finalPosition.rg, 0, 1);\n\n  // Calculate sizes for shape and image\n  float shapeSizeValue = calculatePointSize(size * sizeScale);\n  float imageSizeValue = calculatePointSize(imageSize * sizeScale);\n  \n  // Use the larger of the two sizes for the overall point size\n  float overallSizeValue = max(shapeSizeValue, imageSizeValue);\n  gl_PointSize = overallSizeValue;\n\n  // Pass size information to fragment shader\n  shapeSize = shapeSizeValue;\n  imageSizeVarying = imageSizeValue;\n  overallSize = overallSizeValue;\n\n  shapeColor = color;\n  pointShape = shape;\n\n  // Adjust alpha of selected points\n  if (isGreyedOut > 0.0) {\n    if (greyoutColor[0] != -1.0) {\n      shapeColor = greyoutColor;\n    } else {\n      // If greyoutColor is not set, make color lighter or darker based on isDarkenGreyout\n      float blendFactor = 0.65; // Controls how much to modify (0.0 = original, 1.0 = target color)\n      \n      #ifdef USE_UNIFORM_BUFFERS\n      if (isDarkenGreyout > 0.0) {\n        // Darken the color\n        shapeColor.rgb = mix(shapeColor.rgb, vec3(0.2), blendFactor);\n      } else {\n        // Lighten the color\n        shapeColor.rgb = mix(shapeColor.rgb, max(backgroundColor.rgb, vec3(0.8)), blendFactor);\n      }\n      #else\n      if (isDarkenGreyout > 0.0) {\n        // Darken the color\n        shapeColor.rgb = mix(shapeColor.rgb, vec3(0.2), blendFactor);\n      } else {\n        // Lighten the color\n        shapeColor.rgb = mix(shapeColor.rgb, max(backgroundColor.rgb, vec3(0.8)), blendFactor);\n      }\n      #endif\n    }\n  }\n\n  #ifdef USE_UNIFORM_BUFFERS\n  if (hasImages <= 0.0 || imageIndex < 0.0 || imageIndex >= imageCount) {\n    imageAtlasUV = vec4(-1.0);\n  } else {\n    // Calculate image atlas UV coordinates based on imageIndex\n    float atlasCoordIndex = imageIndex;\n    // Calculate the position in the texture grid\n    float texX = mod(atlasCoordIndex, imageAtlasCoordsTextureSize);\n    float texY = floor(atlasCoordIndex / imageAtlasCoordsTextureSize);\n    // Convert to texture coordinates (0.0 to 1.0)\n    vec2 atlasCoordTexCoord = (vec2(texX, texY) + 0.5) / imageAtlasCoordsTextureSize;\n    vec4 atlasCoords = texture(imageAtlasCoords, atlasCoordTexCoord);\n    imageAtlasUV = atlasCoords;\n  }\n  #else\n  if (hasImages <= 0.0 || imageIndex < 0.0 || imageIndex >= imageCount) {\n    imageAtlasUV = vec4(-1.0);\n  } else {\n    // Calculate image atlas UV coordinates based on imageIndex\n    float atlasCoordIndex = imageIndex;\n    // Calculate the position in the texture grid\n    float texX = mod(atlasCoordIndex, imageAtlasCoordsTextureSize);\n    float texY = floor(atlasCoordIndex / imageAtlasCoordsTextureSize);\n    // Convert to texture coordinates (0.0 to 1.0)\n    vec2 atlasCoordTexCoord = (vec2(texX, texY) + 0.5) / imageAtlasCoordsTextureSize;\n    vec4 atlasCoords = texture(imageAtlasCoords, atlasCoordTexCoord);\n    imageAtlasUV = atlasCoords;\n  }\n  #endif\n} ",topology:"point-list",vertexCount:s.pointsNumber??0,attributes:{...this.drawPointIndices&&{pointIndices:this.drawPointIndices},...this.sizeBuffer&&{size:this.sizeBuffer},...this.colorBuffer&&{color:this.colorBuffer},...this.shapeBuffer&&{shape:this.shapeBuffer},...this.imageIndicesBuffer&&{imageIndex:this.imageIndicesBuffer},...this.imageSizesBuffer&&{imageSize:this.imageSizesBuffer}},bufferLayout:[{name:"pointIndices",format:"float32x2"},{name:"size",format:"float32"},{name:"color",format:"float32x4"},{name:"shape",format:"float32"},{name:"imageIndex",format:"float32"},{name:"imageSize",format:"float32"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{drawVertexUniforms:this.drawUniformStore.getManagedUniformBuffer(i,"drawVertexUniforms"),drawFragmentUniforms:this.drawUniformStore.getManagedUniformBuffer(i,"drawFragmentUniforms")},parameters:{blend:!0,blendColorOperation:"add",blendColorSrcFactor:"src-alpha",blendColorDstFactor:"one-minus-src-alpha",blendAlphaOperation:"add",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one-minus-src-alpha",depthWriteEnabled:!1,depthCompare:"always"}})),this.findPointsOnAreaSelectionVertexCoordBuffer||(this.findPointsOnAreaSelectionVertexCoordBuffer=i.createBuffer({data:new Float32Array([-1,-1,1,-1,-1,1,1,1])})),this.findPointsOnAreaSelectionUniformStore||(this.findPointsOnAreaSelectionUniformStore=new Ph({findPointsOnAreaSelectionUniforms:{uniformTypes:{sizeScale:"f32",spaceSize:"f32",screenSize:"vec2<f32>",ratio:"f32",transformationMatrix:"mat4x4<f32>",selection0:"vec2<f32>",selection1:"vec2<f32>",scalePointsOnZoom:"f32",maxPointSize:"f32"},defaultUniforms:{sizeScale:r.pointSizeScale??1,spaceSize:o.adjustedSpaceSize??0,screenSize:R_(o.screenSize,[0,0]),ratio:r.pixelRatio??Zh.pixelRatio,transformationMatrix:o.transformationMatrix4x4,selection0:R_(null==(t=o.selectedArea)?void 0:t[0],[0,0]),selection1:R_(null==(n=o.selectedArea)?void 0:n[1],[0,0]),scalePointsOnZoom:r.scalePointsOnZoom??1?1:0,maxPointSize:o.maxPointSize??100}}})),this.findPointsOnAreaSelectionCommand||(this.findPointsOnAreaSelectionCommand=new w_(i,{fs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform sampler2D pointSize;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform findPointsOnAreaSelectionUniforms {\n  float sizeScale;\n  float spaceSize;\n  vec2 screenSize;\n  float ratio;\n  mat4 transformationMatrix;\n  vec2 selection0;\n  vec2 selection1;\n  float scalePointsOnZoom;\n  float maxPointSize;\n} findPointsOnAreaSelection;\n\n#define sizeScale findPointsOnAreaSelection.sizeScale\n#define spaceSize findPointsOnAreaSelection.spaceSize\n#define screenSize findPointsOnAreaSelection.screenSize\n#define ratio findPointsOnAreaSelection.ratio\n#define transformationMatrix findPointsOnAreaSelection.transformationMatrix\n#define selection0 findPointsOnAreaSelection.selection0\n#define selection1 findPointsOnAreaSelection.selection1\n#define scalePointsOnZoom findPointsOnAreaSelection.scalePointsOnZoom\n#define maxPointSize findPointsOnAreaSelection.maxPointSize\n#else\nuniform float sizeScale;\nuniform float spaceSize;\nuniform vec2 screenSize;\nuniform float ratio;\nuniform mat3 transformationMatrix;\nuniform vec2 selection0;\nuniform vec2 selection1;\nuniform float scalePointsOnZoom;\nuniform float maxPointSize;\n#endif\n\nin vec2 textureCoords;\n\nout vec4 fragColor;\n\nfloat pointSizeF(float size) {\n  float pSize;\n  // Extract top-left element from mat4 (or use mat3 conversion)\n  #ifdef USE_UNIFORM_BUFFERS\n  float scale = transformationMatrix[0][0]; // mat4 first element\n  #else\n  float scale = transformationMatrix[0][0]; // mat3 first element\n  #endif\n  if (scalePointsOnZoom > 0.0) { \n    pSize = size * ratio * scale;\n  } else {\n    pSize = size * ratio * min(5.0, max(1.0, scale * 0.01));\n  }\n  return min(pSize, maxPointSize * ratio);\n}\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, textureCoords);\n  vec2 p = 2.0 * pointPosition.rg / spaceSize - 1.0;\n  p *= spaceSize / screenSize;\n  #ifdef USE_UNIFORM_BUFFERS\n  // Convert mat4 to mat3 for vec3 multiplication\n  mat3 transformMat3 = mat3(transformationMatrix);\n  vec3 final = transformMat3 * vec3(p, 1);\n  #else\n  vec3 final = transformationMatrix * vec3(p, 1);\n  #endif\n\n  vec4 pSize = texture(pointSize, textureCoords);\n  float size = pSize.r * sizeScale;\n\n  float left = 2.0 * (selection0.x - 0.5 * pointSizeF(size)) / screenSize.x - 1.0;\n  float right = 2.0 * (selection1.x + 0.5 * pointSizeF(size)) / screenSize.x - 1.0;\n  float top =  2.0 * (selection0.y - 0.5 * pointSizeF(size)) / screenSize.y - 1.0;\n  float bottom =  2.0 * (selection1.y + 0.5 * pointSizeF(size)) / screenSize.y - 1.0;\n\n  fragColor = vec4(0.0, 0.0, pointPosition.r, pointPosition.g);\n  if (final.x >= left && final.x <= right && final.y >= top && final.y <= bottom) {\n    fragColor.r = 1.0;\n  }\n}\n\n",vs:k_,topology:"triangle-strip",vertexCount:4,attributes:{vertexCoord:this.findPointsOnAreaSelectionVertexCoordBuffer},bufferLayout:[{name:"vertexCoord",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{findPointsOnAreaSelectionUniforms:this.findPointsOnAreaSelectionUniformStore.getManagedUniformBuffer(i,"findPointsOnAreaSelectionUniforms")}})),this.findPointsOnPolygonSelectionVertexCoordBuffer||(this.findPointsOnPolygonSelectionVertexCoordBuffer=i.createBuffer({data:new Float32Array([-1,-1,1,-1,-1,1,1,1])})),this.findPointsOnPolygonSelectionUniformStore||(this.findPointsOnPolygonSelectionUniformStore=new Ph({findPointsOnPolygonSelectionUniforms:{uniformTypes:{spaceSize:"f32",screenSize:"vec2<f32>",transformationMatrix:"mat4x4<f32>",polygonPathLength:"f32"},defaultUniforms:{spaceSize:o.adjustedSpaceSize??0,screenSize:R_(o.screenSize,[0,0]),transformationMatrix:o.transformationMatrix4x4,polygonPathLength:this.polygonPathLength}}})),this.findPointsOnPolygonSelectionCommand||(this.findPointsOnPolygonSelectionCommand=new w_(i,{fs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform sampler2D polygonPathTexture; // Texture containing polygon path points\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform findPointsOnPolygonSelectionUniforms {\n  float spaceSize;\n  vec2 screenSize;\n  mat4 transformationMatrix;\n  float polygonPathLength;\n} findPointsOnPolygonSelection;\n\n#define spaceSize findPointsOnPolygonSelection.spaceSize\n#define screenSize findPointsOnPolygonSelection.screenSize\n#define transformationMatrix findPointsOnPolygonSelection.transformationMatrix\n#define polygonPathLength int(findPointsOnPolygonSelection.polygonPathLength)\n#else\nuniform int polygonPathLength;\nuniform float spaceSize;\nuniform vec2 screenSize;\nuniform mat3 transformationMatrix;\n#endif\n\nin vec2 textureCoords;\n\nout vec4 fragColor;\n\n// Get a point from the polygon path texture at a specific index\nvec2 getPolygonPoint(sampler2D pathTexture, int index, int pathLength) {\n  if (index >= pathLength) return vec2(0.0);\n  \n  // Calculate texture coordinates for the index\n  int textureSize = int(ceil(sqrt(float(pathLength))));\n  int x = index - (index / textureSize) * textureSize;\n  int y = index / textureSize;\n  \n  vec2 texCoord = (vec2(float(x), float(y)) + 0.5) / float(textureSize);\n  vec4 pathData = texture(pathTexture, texCoord);\n  \n  return pathData.xy;\n}\n\n// Point-in-polygon algorithm using ray casting\nbool pointInPolygon(vec2 point, sampler2D pathTexture, int pathLength) {\n  bool inside = false;\n  \n  for (int i = 0; i < 2048; i++) {\n    if (i >= pathLength) break;\n    \n    int j = int(mod(float(i + 1), float(pathLength)));\n    \n    vec2 pi = getPolygonPoint(pathTexture, i, pathLength);\n    vec2 pj = getPolygonPoint(pathTexture, j, pathLength);\n    \n    if (((pi.y > point.y) != (pj.y > point.y)) &&\n        (point.x < (pj.x - pi.x) * (point.y - pi.y) / (pj.y - pi.y) + pi.x)) {\n      inside = !inside;\n    }\n  }\n  \n  return inside;\n}\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, textureCoords);\n  vec2 p = 2.0 * pointPosition.rg / spaceSize - 1.0;\n  p *= spaceSize / screenSize;\n  #ifdef USE_UNIFORM_BUFFERS\n  // Convert mat4 to mat3 for vec3 multiplication\n  mat3 transformMat3 = mat3(transformationMatrix);\n  vec3 final = transformMat3 * vec3(p, 1);\n  #else\n  vec3 final = transformationMatrix * vec3(p, 1);\n  #endif\n\n  // Convert to screen coordinates for polygon check\n  vec2 screenPos = (final.xy + 1.0) * screenSize / 2.0;\n  \n  fragColor = vec4(0.0, 0.0, pointPosition.r, pointPosition.g);\n  \n  // Check if point center is inside the polygon\n  if (pointInPolygon(screenPos, polygonPathTexture, polygonPathLength)) {\n    fragColor.r = 1.0;\n  }\n} ",vs:k_,topology:"triangle-strip",vertexCount:4,attributes:{vertexCoord:this.findPointsOnPolygonSelectionVertexCoordBuffer},bufferLayout:[{name:"vertexCoord",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{findPointsOnPolygonSelectionUniforms:this.findPointsOnPolygonSelectionUniformStore.getManagedUniformBuffer(i,"findPointsOnPolygonSelectionUniforms")}})),this.findHoveredPointUniformStore||(this.findHoveredPointUniformStore=new Ph({findHoveredPointUniforms:{uniformTypes:{pointsTextureSize:"f32",sizeScale:"f32",spaceSize:"f32",screenSize:"vec2<f32>",ratio:"f32",transformationMatrix:"mat4x4<f32>",mousePosition:"vec2<f32>",scalePointsOnZoom:"f32",maxPointSize:"f32"},defaultUniforms:{pointsTextureSize:o.pointsTextureSize??0,sizeScale:r.pointSizeScale??1,spaceSize:o.adjustedSpaceSize??0,screenSize:R_(o.screenSize,[0,0]),ratio:r.pixelRatio??Zh.pixelRatio,transformationMatrix:o.transformationMatrix4x4,mousePosition:R_(o.screenMousePosition,[0,0]),scalePointsOnZoom:r.scalePointsOnZoom??1?1:0,maxPointSize:o.maxPointSize??100}}})),this.findHoveredPointCommand||(this.findHoveredPointCommand=new w_(i,{fs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nin vec4 rgba;\n\nout vec4 fragColor;\n\nvoid main() {\n  if (rgba.g <= 0.0) {\n    discard;\n  }\n  fragColor = rgba;\n}",vs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nin vec2 pointIndices;\nin float size;\n\nuniform sampler2D positionsTexture;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform findHoveredPointUniforms {\n  float pointsTextureSize;\n  float sizeScale;\n  float spaceSize;\n  vec2 screenSize;\n  float ratio;\n  mat4 transformationMatrix;\n  vec2 mousePosition;\n  float scalePointsOnZoom;\n  float maxPointSize;\n} findHoveredPoint;\n\n#define pointsTextureSize findHoveredPoint.pointsTextureSize\n#define sizeScale findHoveredPoint.sizeScale\n#define spaceSize findHoveredPoint.spaceSize\n#define screenSize findHoveredPoint.screenSize\n#define ratio findHoveredPoint.ratio\n#define transformationMatrix findHoveredPoint.transformationMatrix\n#define mousePosition findHoveredPoint.mousePosition\n#define scalePointsOnZoom findHoveredPoint.scalePointsOnZoom\n#define maxPointSize findHoveredPoint.maxPointSize\n#else\nuniform float pointsTextureSize;\nuniform float sizeScale;\nuniform float spaceSize;\nuniform vec2 screenSize;\nuniform float ratio;\nuniform mat3 transformationMatrix;\nuniform vec2 mousePosition;\nuniform float scalePointsOnZoom;\nuniform float maxPointSize;\n#endif\n\nout vec4 rgba;\n\nfloat calculatePointSize(float size) {\n  float pSize;\n\n  if (scalePointsOnZoom > 0.0) { \n    pSize = size * ratio * transformationMatrix[0][0];\n  } else {\n    pSize = size * ratio * min(5.0, max(1.0, transformationMatrix[0][0] * 0.01));\n  }\n\n  return min(pSize, maxPointSize * ratio);\n}\n\nfloat euclideanDistance (float x1, float x2, float y1, float y2) {\n  return sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n}\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, (pointIndices + 0.5) / pointsTextureSize);\n  vec2 point = pointPosition.rg;\n\n  vec2 normalizedPosition = 2.0 * point / spaceSize - 1.0;\n  normalizedPosition *= spaceSize / screenSize;\n  \n  #ifdef USE_UNIFORM_BUFFERS\n  mat3 transformMat3 = mat3(transformationMatrix);\n  vec3 finalPosition = transformMat3 * vec3(normalizedPosition, 1);\n  #else\n  vec3 finalPosition = transformationMatrix * vec3(normalizedPosition, 1);\n  #endif\n\n  float pointRadius = 0.5 * calculatePointSize(size * sizeScale);\n  vec2 pointScreenPosition = (finalPosition.xy + 1.0) * screenSize / 2.0;\n  \n  rgba = vec4(0.0);\n  gl_Position = vec4(0.5, 0.5, 0.0, 1.0);\n  \n  if (euclideanDistance(pointScreenPosition.x, mousePosition.x, pointScreenPosition.y, mousePosition.y) < pointRadius / ratio) {\n    float index = pointIndices.g * pointsTextureSize + pointIndices.r;\n    rgba = vec4(index, size, pointPosition.xy);\n    gl_Position = vec4(-0.5, -0.5, 0.0, 1.0);\n  }\n\n  gl_PointSize = 1.0;\n}",topology:"point-list",vertexCount:s.pointsNumber??0,attributes:{...this.hoveredPointIndices&&{pointIndices:this.hoveredPointIndices},...this.sizeBuffer&&{size:this.sizeBuffer}},bufferLayout:[{name:"pointIndices",format:"float32x2"},{name:"size",format:"float32"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{findHoveredPointUniforms:this.findHoveredPointUniformStore.getManagedUniformBuffer(i,"findHoveredPointUniforms")},parameters:{depthWriteEnabled:!1,depthCompare:"always",blend:!1}})),this.fillSampledPointsUniformStore||(this.fillSampledPointsUniformStore=new Ph({fillSampledPointsUniforms:{uniformTypes:{pointsTextureSize:"f32",transformationMatrix:"mat4x4<f32>",spaceSize:"f32",screenSize:"vec2<f32>"},defaultUniforms:{pointsTextureSize:o.pointsTextureSize??0,transformationMatrix:o.transformationMatrix4x4,spaceSize:o.adjustedSpaceSize??0,screenSize:R_(o.screenSize,[0,0])}}})),this.fillSampledPointsFboCommand||(this.fillSampledPointsFboCommand=new w_(i,{fs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nin vec4 rgba;\n\nout vec4 fragColor;\n\nvoid main() {\n  fragColor = rgba;\n}",vs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nin vec2 pointIndices;\n\nuniform sampler2D positionsTexture;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform fillSampledPointsUniforms {\n  float pointsTextureSize;\n  mat4 transformationMatrix;\n  float spaceSize;\n  vec2 screenSize;\n} fillSampledPoints;\n\n#define pointsTextureSize fillSampledPoints.pointsTextureSize\n#define transformationMatrix fillSampledPoints.transformationMatrix\n#define spaceSize fillSampledPoints.spaceSize\n#define screenSize fillSampledPoints.screenSize\n#else\nuniform float pointsTextureSize;\nuniform float spaceSize;\nuniform vec2 screenSize;\nuniform mat3 transformationMatrix;\n#endif\n\nout vec4 rgba;\n\nvoid main() {\n  vec4 pointPosition = texture(positionsTexture, (pointIndices + 0.5) / pointsTextureSize);\n  vec2 p = 2.0 * pointPosition.rg / spaceSize - 1.0;\n  p *= spaceSize / screenSize;\n  #ifdef USE_UNIFORM_BUFFERS\n  // Convert mat4 to mat3 for vec3 multiplication\n  mat3 transformMat3 = mat3(transformationMatrix);\n  vec3 final = transformMat3 * vec3(p, 1);\n  #else\n  vec3 final = transformationMatrix * vec3(p, 1);\n  #endif\n\n  vec2 pointScreenPosition = (final.xy + 1.0) * screenSize / 2.0;\n  float index = pointIndices.g * pointsTextureSize + pointIndices.r;\n  rgba = vec4(index, 1.0, pointPosition.xy);\n  float i = (pointScreenPosition.x + 0.5) / screenSize.x;\n  float j = (pointScreenPosition.y + 0.5) / screenSize.y;\n  gl_Position = vec4(2.0 * vec2(i, j) - 1.0, 0.0, 1.0);\n\n  gl_PointSize = 1.0;\n}",topology:"point-list",vertexCount:s.pointsNumber??0,attributes:{...this.sampledPointIndices&&{pointIndices:this.sampledPointIndices}},bufferLayout:[{name:"pointIndices",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{fillSampledPointsUniforms:this.fillSampledPointsUniformStore.getManagedUniformBuffer(i,"fillSampledPointsUniforms")},parameters:{depthWriteEnabled:!1,depthCompare:"always"}})),this.drawHighlightedVertexCoordBuffer||(this.drawHighlightedVertexCoordBuffer=i.createBuffer({data:new Float32Array([-1,-1,1,-1,-1,1,1,1])})),this.drawHighlightedUniformStore||(this.drawHighlightedUniformStore=new Ph({drawHighlightedUniforms:{uniformTypes:{size:"f32",transformationMatrix:"mat4x4<f32>",pointsTextureSize:"f32",sizeScale:"f32",spaceSize:"f32",screenSize:"vec2<f32>",scalePointsOnZoom:"f32",pointIndex:"f32",maxPointSize:"f32",color:"vec4<f32>",universalPointOpacity:"f32",greyoutOpacity:"f32",isDarkenGreyout:"f32",backgroundColor:"vec4<f32>",greyoutColor:"vec4<f32>",width:"f32"},defaultUniforms:{size:1,transformationMatrix:o.transformationMatrix4x4,pointsTextureSize:o.pointsTextureSize??0,sizeScale:r.pointSizeScale??1,spaceSize:o.adjustedSpaceSize??0,screenSize:R_(o.screenSize,[0,0]),scalePointsOnZoom:r.scalePointsOnZoom??1?1:0,pointIndex:-1,maxPointSize:o.maxPointSize??100,color:[0,0,0,1],universalPointOpacity:r.pointOpacity??1,greyoutOpacity:r.pointGreyoutOpacity??-1,isDarkenGreyout:o.isDarkenGreyout?1:0,backgroundColor:P_(o.backgroundColor,[0,0,0,1]),greyoutColor:P_(o.greyoutPointColor,[0,0,0,1]),width:.85}}})),this.drawHighlightedCommand||(this.drawHighlightedCommand=new w_(i,{fs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform drawHighlightedUniforms {\n  float size;\n  mat4 transformationMatrix;\n  float pointsTextureSize;\n  float sizeScale;\n  float spaceSize;\n  vec2 screenSize;\n  float scalePointsOnZoom;\n  float pointIndex;\n  float maxPointSize;\n  vec4 color;\n  float universalPointOpacity;\n  float greyoutOpacity;\n  float isDarkenGreyout;\n  vec4 backgroundColor;\n  vec4 greyoutColor;\n  float width;\n} drawHighlighted;\n\n#define width drawHighlighted.width\n#else\nuniform float width;\n#endif\n\nin vec2 vertexPosition;\nin float pointOpacity;\nin vec3 rgbColor;\n\nout vec4 fragColor;\n\nconst float smoothing = 1.05;\n\nvoid main () {\n  float r = dot(vertexPosition, vertexPosition);\n  float opacity = smoothstep(r, r * smoothing, 1.0);\n  float stroke = smoothstep(width, width * smoothing, r);\n  fragColor = vec4(rgbColor, opacity * stroke * pointOpacity);\n}",vs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nin vec2 vertexCoord;\n\nuniform sampler2D positionsTexture;\nuniform sampler2D pointGreyoutStatusTexture;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform drawHighlightedUniforms {\n  float size;\n  mat4 transformationMatrix;\n  float pointsTextureSize;\n  float sizeScale;\n  float spaceSize;\n  vec2 screenSize;\n  float scalePointsOnZoom;\n  float pointIndex;\n  float maxPointSize;\n  vec4 color;\n  float universalPointOpacity;\n  float greyoutOpacity;\n  float isDarkenGreyout;\n  vec4 backgroundColor;\n  vec4 greyoutColor;\n  float width;\n} drawHighlighted;\n\n#define size drawHighlighted.size\n#define transformationMatrix drawHighlighted.transformationMatrix\n#define pointsTextureSize drawHighlighted.pointsTextureSize\n#define sizeScale drawHighlighted.sizeScale\n#define spaceSize drawHighlighted.spaceSize\n#define screenSize drawHighlighted.screenSize\n#define scalePointsOnZoom drawHighlighted.scalePointsOnZoom\n#define pointIndex drawHighlighted.pointIndex\n#define maxPointSize drawHighlighted.maxPointSize\n#define color drawHighlighted.color\n#define universalPointOpacity drawHighlighted.universalPointOpacity\n#define greyoutOpacity drawHighlighted.greyoutOpacity\n#define isDarkenGreyout drawHighlighted.isDarkenGreyout\n#define backgroundColor drawHighlighted.backgroundColor\n#define greyoutColor drawHighlighted.greyoutColor\n#else\nuniform float size;\nuniform mat3 transformationMatrix;\nuniform float pointsTextureSize;\nuniform float sizeScale;\nuniform float spaceSize;\nuniform vec2 screenSize;\nuniform float scalePointsOnZoom;\nuniform float pointIndex;\nuniform float maxPointSize;\nuniform vec4 color;\nuniform float universalPointOpacity;\nuniform float greyoutOpacity;\nuniform float isDarkenGreyout;\nuniform vec4 backgroundColor;\nuniform vec4 greyoutColor;\nuniform float width;\n#endif\nout vec2 vertexPosition;\nout float pointOpacity;\nout vec3 rgbColor;\n\nfloat calculatePointSize(float pointSize) {\n  float pSize;\n\n  if (scalePointsOnZoom > 0.0) { \n    pSize = pointSize * transformationMatrix[0][0];\n  } else {\n    pSize = pointSize * min(5.0, max(1.0, transformationMatrix[0][0] * 0.01));\n  }\n\n  return min(pSize, maxPointSize);\n}\n\nconst float relativeRingRadius = 1.3;\n\nvoid main () {\n  vertexPosition = vertexCoord;\n\n  vec2 textureCoordinates = vec2(mod(pointIndex, pointsTextureSize), floor(pointIndex / pointsTextureSize)) + 0.5;\n  vec4 pointPosition = texture(positionsTexture, textureCoordinates / pointsTextureSize);\n\n  rgbColor = color.rgb;\n  pointOpacity = color.a * universalPointOpacity;\n  vec4 greyoutStatus = texture(pointGreyoutStatusTexture, textureCoordinates / pointsTextureSize);\n  if (greyoutStatus.r > 0.0) {\n    if (greyoutColor[0] != -1.0) {\n      rgbColor = greyoutColor.rgb;\n      pointOpacity = greyoutColor.a;\n    } else {\n      // If greyoutColor is not set, make color lighter or darker based on isDarkenGreyout\n      float blendFactor = 0.65; // Controls how much to modify (0.0 = original, 1.0 = target color)\n      \n      #ifdef USE_UNIFORM_BUFFERS\n      if (isDarkenGreyout > 0.0) {\n        // Darken the color\n        rgbColor = mix(rgbColor, vec3(0.2), blendFactor);\n      } else {\n        // Lighten the color\n        rgbColor = mix(rgbColor, max(backgroundColor.rgb, vec3(0.8)), blendFactor);\n      }\n      #else\n      if (isDarkenGreyout > 0.0) {\n        // Darken the color\n        rgbColor = mix(rgbColor, vec3(0.2), blendFactor);\n      } else {\n        // Lighten the color\n        rgbColor = mix(rgbColor, max(backgroundColor.rgb, vec3(0.8)), blendFactor);\n      }\n      #endif\n    }\n\n    if (greyoutOpacity != -1.0) {\n      pointOpacity *= greyoutOpacity;\n    }\n  }\n\n  // Calculate point radius\n  float pointSize = (calculatePointSize(size * sizeScale) * relativeRingRadius) / transformationMatrix[0][0];\n  float radius = pointSize * 0.5;\n\n  // Calculate point position in screen space\n  vec2 a = pointPosition.xy;\n  vec2 b = pointPosition.xy + vec2(0.0, radius);\n  vec2 xBasis = b - a;\n  vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));\n  vec2 pointPositionInScreenSpace = a + xBasis * vertexCoord.x + yBasis * radius * vertexCoord.y;\n\n  // Transform point position to normalized device coordinates\n  vec2 p = 2.0 * pointPositionInScreenSpace / spaceSize - 1.0;\n  p *= spaceSize / screenSize;\n  #ifdef USE_UNIFORM_BUFFERS\n  mat3 transformMat3 = mat3(transformationMatrix);\n  vec3 final = transformMat3 * vec3(p, 1);\n  #else\n  vec3 final = transformationMatrix * vec3(p, 1);\n  #endif\n  \n  gl_Position = vec4(final.rg, 0, 1);\n}",topology:"triangle-strip",vertexCount:4,attributes:{vertexCoord:this.drawHighlightedVertexCoordBuffer},bufferLayout:[{name:"vertexCoord",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{drawHighlightedUniforms:this.drawHighlightedUniformStore.getManagedUniformBuffer(i,"drawHighlightedUniforms")},parameters:{blend:!0,blendColorOperation:"add",blendColorSrcFactor:"src-alpha",blendColorDstFactor:"one-minus-src-alpha",blendAlphaOperation:"add",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one-minus-src-alpha",depthWriteEnabled:!1,depthCompare:"always"}})),this.trackPointsVertexCoordBuffer||(this.trackPointsVertexCoordBuffer=i.createBuffer({data:new Float32Array([-1,-1,1,-1,-1,1,1,1])})),this.trackPointsUniformStore||(this.trackPointsUniformStore=new Ph({trackPointsUniforms:{uniformTypes:{pointsTextureSize:"f32"},defaultUniforms:{pointsTextureSize:o.pointsTextureSize??0}}})),this.trackPointsCommand||(this.trackPointsCommand=new w_(i,{fs:"#version 300 es\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform sampler2D trackedIndices;\n\n#ifdef USE_UNIFORM_BUFFERS\nlayout(std140) uniform trackPointsUniforms {\n  float pointsTextureSize;\n} trackPoints;\n\n#define pointsTextureSize trackPoints.pointsTextureSize\n#else\nuniform float pointsTextureSize;\n#endif\n\nin vec2 textureCoords;\n\nout vec4 fragColor;\n\nvoid main() {\n  vec4 trackedPointIndices = texture(trackedIndices, textureCoords);\n  if (trackedPointIndices.r < 0.0) discard;\n  vec4 pointPosition = texture(positionsTexture, (trackedPointIndices.rg + 0.5) / pointsTextureSize);\n\n  fragColor = vec4(pointPosition.rg, 1.0, 1.0);\n}\n\n",vs:k_,topology:"triangle-strip",vertexCount:4,attributes:{vertexCoord:this.trackPointsVertexCoordBuffer},bufferLayout:[{name:"vertexCoord",format:"float32x2"}],defines:{USE_UNIFORM_BUFFERS:!0},bindings:{trackPointsUniforms:this.trackPointsUniformStore.getManagedUniformBuffer(i,"trackPointsUniforms")}}))}updateColor(){var e;const{device:t,store:{pointsTextureSize:n},data:i}=this;if(!n)return;const r=i.pointColors,o=r.byteLength;this.colorBuffer&&this.colorBuffer.byteLength===o?this.colorBuffer.write(r):(null==(e=this.colorBuffer)||e.destroy(),this.colorBuffer=t.createBuffer({data:r,usage:bd.VERTEX|bd.COPY_DST})),this.drawCommand&&this.drawCommand.setAttributes({color:this.colorBuffer})}updateGreyoutStatus(){const{device:e,store:{selectedIndices:t,pointsTextureSize:n}}=this;if(!n)return;const i=new Float32Array(n*n*4).fill(t?1:0);if(t)for(const r of t)i[4*r]=0;this.greyoutStatusTexture&&this.greyoutStatusTexture.width===n&&this.greyoutStatusTexture.height===n||(this.greyoutStatusTexture&&this.greyoutStatusTexture.destroy(),this.greyoutStatusTexture=e.createTexture({width:n,height:n,format:"rgba32float"})),this.greyoutStatusTexture.copyImageData({data:i,bytesPerRow:T_("rgba32float",n),mipLevel:0,x:0,y:0})}updatePinnedStatus(){const{device:e,store:{pointsTextureSize:t},data:n}=this;if(!t)return;const i=new Float32Array(t*t*4).fill(0);if(n.inputPinnedPoints&&void 0!==n.pointsNumber)for(const r of n.inputPinnedPoints)r>=0&&r<n.pointsNumber&&(i[4*r]=1);this.pinnedStatusTexture&&this.pinnedStatusTexture.width===t&&this.pinnedStatusTexture.height===t||(this.pinnedStatusTexture&&this.pinnedStatusTexture.destroy(),this.pinnedStatusTexture=e.createTexture({width:t,height:t,format:"rgba32float"})),this.pinnedStatusTexture.copyImageData({data:i,bytesPerRow:T_("rgba32float",t),mipLevel:0,x:0,y:0})}updateSize(){var e;const{device:t,store:{pointsTextureSize:n},data:i}=this;if(!n||void 0===i.pointsNumber||void 0===i.pointSizes)return;const r=i.pointSizes,o=r.byteLength;this.sizeBuffer&&this.sizeBuffer.byteLength===o?this.sizeBuffer.write(r):(null==(e=this.sizeBuffer)||e.destroy(),this.sizeBuffer=t.createBuffer({data:r,usage:bd.VERTEX|bd.COPY_DST})),this.drawCommand&&this.drawCommand.setAttributes({size:this.sizeBuffer});const s=new Float32Array(n*n*4);for(let a=0;a<i.pointsNumber;a++)s[4*a]=i.pointSizes[a];this.sizeTexture&&this.sizeTexture.width===n&&this.sizeTexture.height===n||(this.sizeTexture&&this.sizeTexture.destroy(),this.sizeTexture=t.createTexture({width:n,height:n,format:"rgba32float"})),this.sizeTexture.copyImageData({data:s,bytesPerRow:T_("rgba32float",n),mipLevel:0,x:0,y:0})}updateShape(){var e;const{device:t,data:n}=this;if(void 0===n.pointsNumber||void 0===n.pointShapes)return;const i=n.pointShapes,r=i.byteLength;this.shapeBuffer&&this.shapeBuffer.byteLength===r?this.shapeBuffer.write(i):(null==(e=this.shapeBuffer)||e.destroy(),this.shapeBuffer=t.createBuffer({data:i,usage:bd.VERTEX|bd.COPY_DST})),this.drawCommand&&this.drawCommand.setAttributes({shape:this.shapeBuffer})}updateImageIndices(){var e;const{device:t,data:n}=this;if(void 0===n.pointsNumber||void 0===n.pointImageIndices)return;const i=n.pointImageIndices,r=i.byteLength;this.imageIndicesBuffer&&this.imageIndicesBuffer.byteLength===r?this.imageIndicesBuffer.write(i):(null==(e=this.imageIndicesBuffer)||e.destroy(),this.imageIndicesBuffer=t.createBuffer({data:i,usage:bd.VERTEX|bd.COPY_DST})),this.drawCommand&&this.drawCommand.setAttributes({imageIndex:this.imageIndicesBuffer})}updateImageSizes(){var e;const{device:t,data:n}=this;if(void 0===n.pointsNumber||void 0===n.pointImageSizes)return;const i=n.pointImageSizes,r=i.byteLength;this.imageSizesBuffer&&this.imageSizesBuffer.byteLength===r?this.imageSizesBuffer.write(i):(null==(e=this.imageSizesBuffer)||e.destroy(),this.imageSizesBuffer=t.createBuffer({data:i,usage:bd.VERTEX|bd.COPY_DST})),this.drawCommand&&this.drawCommand.setAttributes({imageSize:this.imageSizesBuffer})}createAtlas(){var e,t,n;const{device:i,data:r,store:o}=this;if(null==(e=r.inputImageData)||!e.length)return this.imageCount=0,this.imageAtlasCoordsTextureSize=0,this.imageAtlasCoordsTexture||(this.imageAtlasCoordsTexture=i.createTexture({data:new Float32Array(4).fill(0),width:1,height:1,format:"rgba32float"})),void(this.imageAtlasTexture||(this.imageAtlasTexture=i.createTexture({data:new Uint8Array(4).fill(0),width:1,height:1,format:"rgba8unorm"})));const s=function(e,t=16384){if(null==e||!e.length)return null;let n=0;for(const l of e){const e=Math.max(l.width,l.height);e>n&&(n=e)}if(0===n)return null;const i=Math.ceil(Math.sqrt(e.length));let r=i*n,o=1;r>t&&(o=t/r,n=Math.max(1,Math.floor(n*o)),r=Math.max(1,Math.floor(r*o)));const s=new Uint8Array(r*r*4).fill(0),a=new Float32Array(i*i*4).fill(-1);for(const[l,c]of e.entries()){const e=c.width,t=c.height;if(0===e||0===t)continue;const o=Math.min(1,n/Math.max(e,t)),u=Math.floor(e*o),d=Math.floor(t*o),h=l%i*n,f=Math.floor(l/i)*n;a[4*l]=h/r,a[4*l+1]=f/r,a[4*l+2]=(h+u)/r,a[4*l+3]=(f+d)/r;for(let n=0;n<d;n++)for(let i=0;i<u;i++){const o=Math.floor(i*(e/u)),a=4*(Math.floor(n*(t/d))*e+o),l=4*((f+n)*r+(h+i));s[l]=c.data[a]??0,s[l+1]=c.data[a+1]??0,s[l+2]=c.data[a+2]??0,s[l+3]=c.data[a+3]??255}}return{atlasData:s,atlasSize:r,atlasCoords:a,atlasCoordsSize:i}}(r.inputImageData,o.webglMaxTextureSize);if(!s)return;this.imageCount=r.inputImageData.length;const{atlasData:a,atlasSize:l,atlasCoords:c,atlasCoordsSize:u}=s;this.imageAtlasCoordsTextureSize=u,null==(t=this.imageAtlasTexture)||t.destroy(),this.imageAtlasTexture=i.createTexture({width:l,height:l,format:"rgba8unorm"}),this.imageAtlasTexture.copyImageData({data:a,bytesPerRow:T_("rgba8unorm",l),rowsPerImage:l,mipLevel:0,x:0,y:0}),null==(n=this.imageAtlasCoordsTexture)||n.destroy(),this.imageAtlasCoordsTexture=i.createTexture({width:u,height:u,format:"rgba32float"}),this.imageAtlasCoordsTexture.copyImageData({data:c,bytesPerRow:T_("rgba32float",u),rowsPerImage:u,mipLevel:0,x:0,y:0})}updateSampledPointsGrid(){const{store:{screenSize:e},config:{pointSamplingDistance:t},device:n}=this;let i=t??Math.min(...e)/2;0===i&&(i=Zh.pointSamplingDistance);const r=Math.ceil(e[0]/i),o=Math.ceil(e[1]/i);(!this.sampledPointsFbo||this.sampledPointsFbo.width!==r||this.sampledPointsFbo.height!==o)&&(this.sampledPointsFbo&&!this.sampledPointsFbo.destroyed&&this.sampledPointsFbo.destroy(),this.sampledPointsFbo=n.createFramebuffer({width:r,height:o,colorAttachments:["rgba32float"]}))}trackPoints(){var e;if(null==(e=this.trackedIndices)||!e.length||!this.trackPointsCommand||!this.trackPointsUniformStore||!this.trackedPositionsFbo||this.trackedPositionsFbo.destroyed||!this.currentPositionTexture||this.currentPositionTexture.destroyed||!this.trackedIndicesTexture||this.trackedIndicesTexture.destroyed)return;this.trackPointsUniformStore.setUniforms({trackPointsUniforms:{pointsTextureSize:this.store.pointsTextureSize??0}}),this.trackPointsCommand.setBindings({positionsTexture:this.currentPositionTexture,trackedIndices:this.trackedIndicesTexture});const t=this.device.beginRenderPass({framebuffer:this.trackedPositionsFbo});this.trackPointsCommand.draw(t),t.end()}draw(e){var t,n;const{data:i,config:r,store:o}=this;if(this.colorBuffer||this.updateColor(),this.sizeBuffer||this.updateSize(),this.shapeBuffer||this.updateShape(),this.imageIndicesBuffer||this.updateImageIndices(),this.imageSizesBuffer||this.updateImageSizes(),!this.drawCommand||!this.drawUniformStore||!this.currentPositionTexture||this.currentPositionTexture.destroyed||!this.greyoutStatusTexture||this.greyoutStatusTexture.destroyed||(!this.imageAtlasTexture||!this.imageAtlasCoordsTexture)&&(this.createAtlas(),!this.imageAtlasTexture||!this.imageAtlasCoordsTexture)||this.imageAtlasTexture.destroyed||this.imageAtlasCoordsTexture.destroyed||!i.pointsNumber||0===i.pointsNumber||!o.screenSize||0===o.screenSize[0]||0===o.screenSize[1])return;this.drawCommand.setVertexCount(i.pointsNumber);const s={ratio:r.pixelRatio??Zh.pixelRatio,transformationMatrix:o.transformationMatrix4x4,pointsTextureSize:o.pointsTextureSize??0,sizeScale:r.pointSizeScale??1,spaceSize:o.adjustedSpaceSize??0,screenSize:R_(o.screenSize,[0,0]),greyoutColor:P_(o.greyoutPointColor,[-1,-1,-1,-1]),backgroundColor:P_(o.backgroundColor,[0,0,0,1]),scalePointsOnZoom:r.scalePointsOnZoom??1?1:0,maxPointSize:o.maxPointSize??100,isDarkenGreyout:o.isDarkenGreyout?1:0,hasImages:this.imageCount>0?1:0,imageCount:this.imageCount,imageAtlasCoordsTextureSize:this.imageAtlasCoordsTextureSize??0},a={greyoutOpacity:r.pointGreyoutOpacity??-1,pointOpacity:r.pointOpacity??1,isDarkenGreyout:o.isDarkenGreyout?1:0,backgroundColor:P_(o.backgroundColor,[0,0,0,1])};if(o.selectedIndices&&o.selectedIndices.length>0?(this.drawUniformStore.setUniforms({drawVertexUniforms:{...s,skipSelected:1,skipUnselected:0},drawFragmentUniforms:a}),this.drawCommand.setBindings({positionsTexture:this.currentPositionTexture,pointGreyoutStatus:this.greyoutStatusTexture,imageAtlasTexture:this.imageAtlasTexture,imageAtlasCoords:this.imageAtlasCoordsTexture}),this.drawCommand.draw(e),this.drawUniformStore.setUniforms({drawVertexUniforms:{...s,skipSelected:0,skipUnselected:1},drawFragmentUniforms:a}),this.drawCommand.setBindings({positionsTexture:this.currentPositionTexture,pointGreyoutStatus:this.greyoutStatusTexture,imageAtlasTexture:this.imageAtlasTexture,imageAtlasCoords:this.imageAtlasCoordsTexture}),this.drawCommand.draw(e)):(this.drawUniformStore.setUniforms({drawVertexUniforms:{...s,skipSelected:0,skipUnselected:0},drawFragmentUniforms:a}),this.drawCommand.setBindings({positionsTexture:this.currentPositionTexture,pointGreyoutStatus:this.greyoutStatusTexture,imageAtlasTexture:this.imageAtlasTexture,imageAtlasCoords:this.imageAtlasCoordsTexture}),this.drawCommand.draw(e)),r.renderHoveredPointRing&&o.hoveredPoint&&this.drawHighlightedCommand&&this.drawHighlightedUniformStore){if(!this.currentPositionTexture||this.currentPositionTexture.destroyed||!this.greyoutStatusTexture||this.greyoutStatusTexture.destroyed)return;const n=(null==(t=i.pointSizes)?void 0:t[o.hoveredPoint.index])??1;this.drawHighlightedUniformStore.setUniforms({drawHighlightedUniforms:{size:n,transformationMatrix:o.transformationMatrix4x4,pointsTextureSize:o.pointsTextureSize??0,sizeScale:r.pointSizeScale??1,spaceSize:o.adjustedSpaceSize??0,screenSize:R_(o.screenSize,[0,0]),scalePointsOnZoom:r.scalePointsOnZoom??1?1:0,pointIndex:o.hoveredPoint.index,maxPointSize:o.maxPointSize??100,color:P_(o.hoveredPointRingColor,[0,0,0,1]),universalPointOpacity:r.pointOpacity??1,greyoutOpacity:r.pointGreyoutOpacity??-1,isDarkenGreyout:o.isDarkenGreyout?1:0,backgroundColor:P_(o.backgroundColor,[0,0,0,1]),greyoutColor:P_(o.greyoutPointColor,[0,0,0,1]),width:.85}}),this.drawHighlightedCommand.setBindings({positionsTexture:this.currentPositionTexture,pointGreyoutStatusTexture:this.greyoutStatusTexture}),this.drawHighlightedCommand.draw(e)}if(o.focusedPoint&&this.drawHighlightedCommand&&this.drawHighlightedUniformStore){if(!this.currentPositionTexture||this.currentPositionTexture.destroyed||!this.greyoutStatusTexture||this.greyoutStatusTexture.destroyed)return;const t=(null==(n=i.pointSizes)?void 0:n[o.focusedPoint.index])??1;this.drawHighlightedUniformStore.setUniforms({drawHighlightedUniforms:{size:t,transformationMatrix:o.transformationMatrix4x4,pointsTextureSize:o.pointsTextureSize??0,sizeScale:r.pointSizeScale??1,spaceSize:o.adjustedSpaceSize??0,screenSize:R_(o.screenSize,[0,0]),scalePointsOnZoom:r.scalePointsOnZoom??1?1:0,pointIndex:o.focusedPoint.index,maxPointSize:o.maxPointSize??100,color:P_(o.focusedPointRingColor,[0,0,0,1]),universalPointOpacity:r.pointOpacity??1,greyoutOpacity:r.pointGreyoutOpacity??-1,isDarkenGreyout:o.isDarkenGreyout?1:0,backgroundColor:P_(o.backgroundColor,[0,0,0,1]),greyoutColor:P_(o.greyoutPointColor,[0,0,0,1]),width:.85}}),this.drawHighlightedCommand.setBindings({positionsTexture:this.currentPositionTexture,pointGreyoutStatusTexture:this.greyoutStatusTexture}),this.drawHighlightedCommand.draw(e)}}updatePosition(){if(!this.updatePositionCommand||!this.updatePositionUniformStore||!this.currentPositionFbo||this.currentPositionFbo.destroyed||!this.previousPositionTexture||this.previousPositionTexture.destroyed||!this.velocityTexture||this.velocityTexture.destroyed||!this.pinnedStatusTexture||this.pinnedStatusTexture.destroyed)return;this.updatePositionUniformStore.setUniforms({updatePositionUniforms:{friction:this.config.simulationFriction??0,spaceSize:this.store.adjustedSpaceSize??0}}),this.updatePositionCommand.setBindings({positionsTexture:this.previousPositionTexture,velocity:this.velocityTexture,pinnedStatusTexture:this.pinnedStatusTexture});const e=this.device.beginRenderPass({framebuffer:this.currentPositionFbo});this.updatePositionCommand.draw(e),e.end(),this.swapFbo(),this.isPositionsUpToDate=!1}drag(){var e;if(!this.dragPointCommand||!this.dragPointUniformStore||!this.currentPositionFbo||this.currentPositionFbo.destroyed||!this.previousPositionTexture||this.previousPositionTexture.destroyed)return;this.dragPointUniformStore.setUniforms({dragPointUniforms:{mousePos:R_(this.store.mousePosition,[0,0]),index:(null==(e=this.store.hoveredPoint)?void 0:e.index)??-1}}),this.dragPointCommand.setBindings({positionsTexture:this.previousPositionTexture});const t=this.device.beginRenderPass({framebuffer:this.currentPositionFbo});this.dragPointCommand.draw(t),t.end(),this.swapFbo(),this.isPositionsUpToDate=!1}findPointsOnAreaSelection(){var e,t;if(!this.findPointsOnAreaSelectionCommand||!this.findPointsOnAreaSelectionUniformStore||!this.selectedFbo||this.selectedFbo.destroyed||!this.currentPositionTexture||this.currentPositionTexture.destroyed||!this.sizeTexture||this.sizeTexture.destroyed)return;this.findPointsOnAreaSelectionUniformStore.setUniforms({findPointsOnAreaSelectionUniforms:{spaceSize:this.store.adjustedSpaceSize??0,screenSize:R_(this.store.screenSize,[0,0]),sizeScale:this.config.pointSizeScale??1,transformationMatrix:this.store.transformationMatrix4x4,ratio:this.config.pixelRatio??Zh.pixelRatio,selection0:R_(null==(e=this.store.selectedArea)?void 0:e[0],[0,0]),selection1:R_(null==(t=this.store.selectedArea)?void 0:t[1],[0,0]),scalePointsOnZoom:this.config.scalePointsOnZoom??1?1:0,maxPointSize:this.store.maxPointSize??100}}),this.findPointsOnAreaSelectionCommand.setBindings({positionsTexture:this.currentPositionTexture,pointSize:this.sizeTexture});const n=this.device.beginRenderPass({framebuffer:this.selectedFbo});this.findPointsOnAreaSelectionCommand.draw(n),n.end()}findPointsOnPolygonSelection(){if(!this.findPointsOnPolygonSelectionCommand||!this.findPointsOnPolygonSelectionUniformStore||!this.selectedFbo||this.selectedFbo.destroyed||!this.currentPositionTexture||this.currentPositionTexture.destroyed||!this.polygonPathTexture||this.polygonPathTexture.destroyed)return;this.findPointsOnPolygonSelectionUniformStore.setUniforms({findPointsOnPolygonSelectionUniforms:{spaceSize:this.store.adjustedSpaceSize??0,screenSize:R_(this.store.screenSize,[0,0]),transformationMatrix:this.store.transformationMatrix4x4,polygonPathLength:this.polygonPathLength}}),this.findPointsOnPolygonSelectionCommand.setBindings({positionsTexture:this.currentPositionTexture,polygonPathTexture:this.polygonPathTexture});const e=this.device.beginRenderPass({framebuffer:this.selectedFbo});this.findPointsOnPolygonSelectionCommand.draw(e),e.end()}updatePolygonPath(e){const{device:t}=this;if(this.polygonPathLength=e.length,0===e.length)return this.polygonPathTexture&&!this.polygonPathTexture.destroyed&&this.polygonPathTexture.destroy(),void(this.polygonPathTexture=void 0);const n=Math.ceil(Math.sqrt(e.length)),i=new Float32Array(n*n*4);for(const[r,o]of e.entries()){const[e,t]=o;i[4*r]=e,i[4*r+1]=t,i[4*r+2]=0,i[4*r+3]=0}this.polygonPathTexture&&this.polygonPathTexture.width===n&&this.polygonPathTexture.height===n||(this.polygonPathTexture&&!this.polygonPathTexture.destroyed&&this.polygonPathTexture.destroy(),this.polygonPathTexture=t.createTexture({width:n,height:n,format:"rgba32float"})),this.polygonPathTexture.copyImageData({data:i,bytesPerRow:T_("rgba32float",n),mipLevel:0,x:0,y:0})}findHoveredPoint(){if(!this.hoveredFbo||this.hoveredFbo.destroyed||!this.findHoveredPointCommand||!this.findHoveredPointUniformStore||!this.currentPositionTexture||this.currentPositionTexture.destroyed)return;this.findHoveredPointCommand.setVertexCount(this.data.pointsNumber??0),this.findHoveredPointCommand.setAttributes({...this.hoveredPointIndices&&{pointIndices:this.hoveredPointIndices},...this.sizeBuffer&&{size:this.sizeBuffer}}),this.findHoveredPointUniformStore.setUniforms({findHoveredPointUniforms:{ratio:this.config.pixelRatio??Zh.pixelRatio,sizeScale:this.config.pointSizeScale??1,pointsTextureSize:this.store.pointsTextureSize??0,transformationMatrix:this.store.transformationMatrix4x4,spaceSize:this.store.adjustedSpaceSize??0,screenSize:R_(this.store.screenSize,[0,0]),scalePointsOnZoom:this.config.scalePointsOnZoom??1?1:0,mousePosition:R_(this.store.screenMousePosition,[0,0]),maxPointSize:this.store.maxPointSize??100}}),this.findHoveredPointCommand.setBindings({positionsTexture:this.currentPositionTexture});const e=this.device.beginRenderPass({framebuffer:this.hoveredFbo,clearColor:[0,0,0,0]});this.findHoveredPointCommand.draw(e),e.end()}trackPointsByIndices(e){const{store:{pointsTextureSize:t},device:n}=this;if(this.trackedIndices=e,this.trackedPositions=void 0,this.isPositionsUpToDate=!1,null==e||!e.length||!t)return;const i=Math.ceil(Math.sqrt(e.length)),r=new Float32Array(i*i*4).fill(-1);for(const[o,s]of e.entries())void 0!==s&&(r[4*o]=s%t,r[4*o+1]=Math.floor(s/t),r[4*o+2]=0,r[4*o+3]=0);this.trackedIndicesTexture&&this.trackedIndicesTexture.width===i&&this.trackedIndicesTexture.height===i||(this.trackedIndicesTexture&&!this.trackedIndicesTexture.destroyed&&this.trackedIndicesTexture.destroy(),this.trackedIndicesTexture=n.createTexture({width:i,height:i,format:"rgba32float"})),this.trackedIndicesTexture.copyImageData({data:r,bytesPerRow:T_("rgba32float",i),mipLevel:0,x:0,y:0}),(!this.trackedPositionsFbo||this.trackedPositionsFbo.width!==i||this.trackedPositionsFbo.height!==i)&&(this.trackedPositionsFbo&&!this.trackedPositionsFbo.destroyed&&this.trackedPositionsFbo.destroy(),this.trackedPositionsFbo=n.createFramebuffer({width:i,height:i,colorAttachments:["rgba32float"]})),this.trackPoints()}getTrackedPositionsMap(){if(!this.trackedIndices)return new Map;const{config:{enableSimulation:e},store:{isSimulationRunning:t}}=this;if((!e||!t)&&this.isPositionsUpToDate&&this.trackedPositions)return this.trackedPositions;if(!this.trackedPositionsFbo||this.trackedPositionsFbo.destroyed)return new Map;const n=ep(this.device,this.trackedPositionsFbo),i=new Map;for(let r=0;r<n.length/4;r+=1){const e=n[4*r],t=n[4*r+1],o=this.trackedIndices[r];void 0!==e&&void 0!==t&&void 0!==o&&i.set(o,[e,t])}return(!e||!t)&&(this.trackedPositions=i,this.isPositionsUpToDate=!0),i}getSampledPointPositionsMap(){const e=new Map;if(!this.sampledPointsFbo||this.sampledPointsFbo.destroyed)return e;if(this.fillSampledPointsFboCommand&&this.fillSampledPointsUniformStore&&this.sampledPointsFbo){if(!this.currentPositionTexture||this.currentPositionTexture.destroyed)return e;this.fillSampledPointsFboCommand.setVertexCount(this.data.pointsNumber??0),this.fillSampledPointsUniformStore.setUniforms({fillSampledPointsUniforms:{pointsTextureSize:this.store.pointsTextureSize??0,transformationMatrix:this.store.transformationMatrix4x4,spaceSize:this.store.adjustedSpaceSize??0,screenSize:R_(this.store.screenSize,[0,0])}}),this.fillSampledPointsFboCommand.setBindings({positionsTexture:this.currentPositionTexture});const t=this.device.beginRenderPass({framebuffer:this.sampledPointsFbo,clearColor:[0,0,0,0]});this.fillSampledPointsFboCommand.draw(t),t.end()}const t=ep(this.device,this.sampledPointsFbo);for(let n=0;n<t.length/4;n++){const i=t[4*n],r=!!t[4*n+1],o=t[4*n+2],s=t[4*n+3];r&&void 0!==i&&void 0!==o&&void 0!==s&&e.set(i,[o,s])}return e}getSampledPoints(){const e=[],t=[];if(!this.sampledPointsFbo||this.sampledPointsFbo.destroyed)return{indices:e,positions:t};if(this.fillSampledPointsFboCommand&&this.fillSampledPointsUniformStore&&this.sampledPointsFbo){if(!this.currentPositionTexture||this.currentPositionTexture.destroyed)return{indices:e,positions:t};this.fillSampledPointsFboCommand.setVertexCount(this.data.pointsNumber??0),this.fillSampledPointsUniformStore.setUniforms({fillSampledPointsUniforms:{pointsTextureSize:this.store.pointsTextureSize??0,transformationMatrix:this.store.transformationMatrix4x4,spaceSize:this.store.adjustedSpaceSize??0,screenSize:R_(this.store.screenSize,[0,0])}}),this.fillSampledPointsFboCommand.setBindings({positionsTexture:this.currentPositionTexture});const n=this.device.beginRenderPass({framebuffer:this.sampledPointsFbo,clearColor:[0,0,0,0]});this.fillSampledPointsFboCommand.draw(n),n.end()}const n=ep(this.device,this.sampledPointsFbo);for(let i=0;i<n.length/4;i++){const r=n[4*i],o=!!n[4*i+1],s=n[4*i+2],a=n[4*i+3];o&&void 0!==r&&void 0!==s&&void 0!==a&&(e.push(r),t.push(s,a))}return{indices:e,positions:t}}getTrackedPositionsArray(){const e=[];if(!this.trackedIndices||!this.trackedPositionsFbo||this.trackedPositionsFbo.destroyed)return e;e.length=2*this.trackedIndices.length;const t=ep(this.device,this.trackedPositionsFbo);for(let n=0;n<t.length/4;n+=1){const i=t[4*n],r=t[4*n+1],o=this.trackedIndices[n];void 0!==i&&void 0!==r&&void 0!==o&&(e[2*n]=i,e[2*n+1]=r)}return e}destroy(){var e,t,n,i,r,o,s,a,l,c,u,d,h,f,p,m,g,_;null==(e=this.drawCommand)||e.destroy(),this.drawCommand=void 0,null==(t=this.drawHighlightedCommand)||t.destroy(),this.drawHighlightedCommand=void 0,null==(n=this.updatePositionCommand)||n.destroy(),this.updatePositionCommand=void 0,null==(i=this.dragPointCommand)||i.destroy(),this.dragPointCommand=void 0,null==(r=this.findPointsOnAreaSelectionCommand)||r.destroy(),this.findPointsOnAreaSelectionCommand=void 0,null==(o=this.findPointsOnPolygonSelectionCommand)||o.destroy(),this.findPointsOnPolygonSelectionCommand=void 0,null==(s=this.findHoveredPointCommand)||s.destroy(),this.findHoveredPointCommand=void 0,null==(a=this.fillSampledPointsFboCommand)||a.destroy(),this.fillSampledPointsFboCommand=void 0,null==(l=this.trackPointsCommand)||l.destroy(),this.trackPointsCommand=void 0,this.currentPositionFbo&&!this.currentPositionFbo.destroyed&&this.currentPositionFbo.destroy(),this.currentPositionFbo=void 0,this.previousPositionFbo&&!this.previousPositionFbo.destroyed&&this.previousPositionFbo.destroy(),this.previousPositionFbo=void 0,this.velocityFbo&&!this.velocityFbo.destroyed&&this.velocityFbo.destroy(),this.velocityFbo=void 0,this.selectedFbo&&!this.selectedFbo.destroyed&&this.selectedFbo.destroy(),this.selectedFbo=void 0,this.hoveredFbo&&!this.hoveredFbo.destroyed&&this.hoveredFbo.destroy(),this.hoveredFbo=void 0,this.trackedPositionsFbo&&!this.trackedPositionsFbo.destroyed&&this.trackedPositionsFbo.destroy(),this.trackedPositionsFbo=void 0,this.sampledPointsFbo&&!this.sampledPointsFbo.destroyed&&this.sampledPointsFbo.destroy(),this.sampledPointsFbo=void 0,this.currentPositionTexture&&!this.currentPositionTexture.destroyed&&this.currentPositionTexture.destroy(),this.currentPositionTexture=void 0,this.previousPositionTexture&&!this.previousPositionTexture.destroyed&&this.previousPositionTexture.destroy(),this.previousPositionTexture=void 0,this.velocityTexture&&!this.velocityTexture.destroyed&&this.velocityTexture.destroy(),this.velocityTexture=void 0,this.selectedTexture&&!this.selectedTexture.destroyed&&this.selectedTexture.destroy(),this.selectedTexture=void 0,this.greyoutStatusTexture&&!this.greyoutStatusTexture.destroyed&&this.greyoutStatusTexture.destroy(),this.greyoutStatusTexture=void 0,this.sizeTexture&&!this.sizeTexture.destroyed&&this.sizeTexture.destroy(),this.sizeTexture=void 0,this.trackedIndicesTexture&&!this.trackedIndicesTexture.destroyed&&this.trackedIndicesTexture.destroy(),this.trackedIndicesTexture=void 0,this.polygonPathTexture&&!this.polygonPathTexture.destroyed&&this.polygonPathTexture.destroy(),this.polygonPathTexture=void 0,this.imageAtlasTexture&&!this.imageAtlasTexture.destroyed&&this.imageAtlasTexture.destroy(),this.imageAtlasTexture=void 0,this.imageAtlasCoordsTexture&&!this.imageAtlasCoordsTexture.destroyed&&this.imageAtlasCoordsTexture.destroy(),this.imageAtlasCoordsTexture=void 0,this.pinnedStatusTexture&&!this.pinnedStatusTexture.destroyed&&this.pinnedStatusTexture.destroy(),this.pinnedStatusTexture=void 0,null==(c=this.updatePositionUniformStore)||c.destroy(),this.updatePositionUniformStore=void 0,null==(u=this.dragPointUniformStore)||u.destroy(),this.dragPointUniformStore=void 0,null==(d=this.drawUniformStore)||d.destroy(),this.drawUniformStore=void 0,null==(h=this.findPointsOnAreaSelectionUniformStore)||h.destroy(),this.findPointsOnAreaSelectionUniformStore=void 0,null==(f=this.findPointsOnPolygonSelectionUniformStore)||f.destroy(),this.findPointsOnPolygonSelectionUniformStore=void 0,null==(p=this.findHoveredPointUniformStore)||p.destroy(),this.findHoveredPointUniformStore=void 0,null==(m=this.fillSampledPointsUniformStore)||m.destroy(),this.fillSampledPointsUniformStore=void 0,null==(g=this.drawHighlightedUniformStore)||g.destroy(),this.drawHighlightedUniformStore=void 0,null==(_=this.trackPointsUniformStore)||_.destroy(),this.trackPointsUniformStore=void 0,this.colorBuffer&&!this.colorBuffer.destroyed&&this.colorBuffer.destroy(),this.colorBuffer=void 0,this.sizeBuffer&&!this.sizeBuffer.destroyed&&this.sizeBuffer.destroy(),this.sizeBuffer=void 0,this.shapeBuffer&&!this.shapeBuffer.destroyed&&this.shapeBuffer.destroy(),this.shapeBuffer=void 0,this.imageIndicesBuffer&&!this.imageIndicesBuffer.destroyed&&this.imageIndicesBuffer.destroy(),this.imageIndicesBuffer=void 0,this.imageSizesBuffer&&!this.imageSizesBuffer.destroyed&&this.imageSizesBuffer.destroy(),this.imageSizesBuffer=void 0,this.drawPointIndices&&!this.drawPointIndices.destroyed&&this.drawPointIndices.destroy(),this.drawPointIndices=void 0,this.hoveredPointIndices&&!this.hoveredPointIndices.destroyed&&this.hoveredPointIndices.destroy(),this.hoveredPointIndices=void 0,this.sampledPointIndices&&!this.sampledPointIndices.destroyed&&this.sampledPointIndices.destroy(),this.sampledPointIndices=void 0,this.updatePositionVertexCoordBuffer&&!this.updatePositionVertexCoordBuffer.destroyed&&this.updatePositionVertexCoordBuffer.destroy(),this.updatePositionVertexCoordBuffer=void 0,this.dragPointVertexCoordBuffer&&!this.dragPointVertexCoordBuffer.destroyed&&this.dragPointVertexCoordBuffer.destroy(),this.dragPointVertexCoordBuffer=void 0,this.findPointsOnAreaSelectionVertexCoordBuffer&&!this.findPointsOnAreaSelectionVertexCoordBuffer.destroyed&&this.findPointsOnAreaSelectionVertexCoordBuffer.destroy(),this.findPointsOnAreaSelectionVertexCoordBuffer=void 0,this.findPointsOnPolygonSelectionVertexCoordBuffer&&!this.findPointsOnPolygonSelectionVertexCoordBuffer.destroyed&&this.findPointsOnPolygonSelectionVertexCoordBuffer.destroy(),this.findPointsOnPolygonSelectionVertexCoordBuffer=void 0,this.drawHighlightedVertexCoordBuffer&&!this.drawHighlightedVertexCoordBuffer.destroyed&&this.drawHighlightedVertexCoordBuffer.destroy(),this.drawHighlightedVertexCoordBuffer=void 0,this.trackPointsVertexCoordBuffer&&!this.trackPointsVertexCoordBuffer.destroyed&&this.trackPointsVertexCoordBuffer.destroy(),this.trackPointsVertexCoordBuffer=void 0}swapFbo(){if(!this.currentPositionTexture||this.currentPositionTexture.destroyed||!this.previousPositionTexture||this.previousPositionTexture.destroyed||!this.currentPositionFbo||this.currentPositionFbo.destroyed||!this.previousPositionFbo||this.previousPositionFbo.destroyed)return;const e=this.previousPositionTexture,t=this.previousPositionFbo;this.previousPositionTexture=this.currentPositionTexture,this.previousPositionFbo=this.currentPositionFbo,this.currentPositionTexture=e,this.currentPositionFbo=t}rescaleInitialNodePositions(){const{config:{spaceSize:e}}=this;if(!this.data.pointPositions||!e)return;const t=this.data.pointPositions,n=t.length/2;let i=1/0,r=-1/0,o=1/0,s=-1/0;for(let f=0;f<t.length;f+=2){const e=t[f],n=t[f+1];i=Math.min(i,e),r=Math.max(r,e),o=Math.min(o,n),s=Math.max(s,n)}const a=r-i,l=s-o,c=Math.max(a,l);if(c>e)return this.scaleX=void 0,void(this.scaleY=void 0);const u=(n>e*e*.001?e*Math.max(1.2,Math.sqrt(n)/e):.1*e)/c,d=(c-a)/2*u,h=(c-l)/2*u;this.scaleX=e=>(e-i)*u+d,this.scaleY=e=>(e-o)*u+h;for(let f=0;f<n;f++)this.data.pointPositions[2*f]=this.scaleX(t[2*f]),this.data.pointPositions[2*f+1]=this.scaleY(t[2*f+1])}}var My=typeof Float32Array<"u"?Float32Array:Array;function Dy(e,t,n){var i=t[0],r=t[1],o=t[2],s=t[3],a=t[4],l=t[5],c=t[6],u=t[7],d=t[8],h=n[0],f=n[1];return e[0]=i,e[1]=r,e[2]=o,e[3]=s,e[4]=a,e[5]=l,e[6]=h*i+f*s+c,e[7]=h*r+f*a+u,e[8]=h*o+f*l+d,e}function Ny(e,t,n){var i=n[0],r=n[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=r*t[3],e[4]=r*t[4],e[5]=r*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var Fy,Oy={exports:{}};var By,zy,Uy,Vy,Hy,Wy={exports:{}},$y={exports:{}},Gy={exports:{}},jy={exports:{}},Yy={exports:{}},qy={exports:{}};const Xy=z_(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var Ky,Zy,Qy,Jy=qy.exports;function ev(){return Ky||(Ky=1,function(e){!function(t,n,i){var r,o=256,s="random",a=i.pow(o,6),l=i.pow(2,52),c=2*l,u=255;function d(e,u,d){var _=[],y=m(p((u=1==u?{entropy:!0}:u||{}).entropy?[e,g(n)]:e??function(){try{var e;return r&&(e=r.randomBytes)?e=e(o):(e=new Uint8Array(o),(t.crypto||t.msCrypto).getRandomValues(e)),g(e)}catch{var i=t.navigator,s=i&&i.plugins;return[+new Date,t,s,t.screen,g(n)]}}(),3),_),v=new h(_),b=function(){for(var e=v.g(6),t=a,n=0;e<l;)e=(e+n)*o,t*=o,n=v.g(1);for(;e>=c;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|v.g(4)},b.quick=function(){return v.g(4)/4294967296},b.double=b,m(g(v.S),n),(u.pass||d||function(e,t,n,r){return r&&(r.S&&f(r,v),e.state=function(){return f(v,{})}),n?(i[s]=e,t):e})(b,y,"global"in u?u.global:this==i,u.state)}function h(e){var t,n=e.length,i=this,r=0,s=i.i=i.j=0,a=i.S=[];for(n||(e=[n++]);r<o;)a[r]=r++;for(r=0;r<o;r++)a[r]=a[s=u&s+e[r%n]+(t=a[r])],a[s]=t;(i.g=function(e){for(var t,n=0,r=i.i,s=i.j,a=i.S;e--;)t=a[r=u&r+1],n=n*o+a[u&(a[r]=a[s=u&s+t])+(a[s]=t)];return i.i=r,i.j=s,n})(o)}function f(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function p(e,t){var n,i=[],r=typeof e;if(t&&"object"==r)for(n in e)try{i.push(p(e[n],t-1))}catch{}return i.length?i:"string"==r?e:e+"\0"}function m(e,t){for(var n,i=e+"",r=0;r<i.length;)t[u&r]=u&(n^=19*t[u&r])+i.charCodeAt(r++);return g(t)}function g(e){return String.fromCharCode.apply(0,e)}if(m(i.random(),n),e.exports){e.exports=d;try{r=Xy}catch{}}else i["seed"+s]=d}(typeof self<"u"?self:Jy,[],Math)}(qy)),qy.exports}var tv=function(){if(Qy)return Zy;Qy=1;var e=(Fy||(Fy=1,function(e,t){function n(e){var t=this,n=function(){var e=4022871197;return function(t){t=String(t);for(var n=0;n<t.length;n++){var i=.02519603282416938*(e+=t.charCodeAt(n));i-=e=i>>>0,e=(i*=e)>>>0,e+=4294967296*(i-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function r(e,t){var r=new n(e),o=t&&t.state,s=r.next;return s.int32=function(){return 4294967296*r.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,o&&("object"==typeof o&&i(o,r),s.state=function(){return i(r,{})}),s}t&&t.exports?t.exports=r:this.alea=r}(0,Oy)),Oy.exports),t=(By||(By=1,function(e,t){function n(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var i=0;i<n.length+64;i++)t.x^=0|n.charCodeAt(i),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function r(e,t){var r=new n(e),o=t&&t.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=r.next,s.quick=s,o&&("object"==typeof o&&i(o,r),s.state=function(){return i(r,{})}),s}t&&t.exports?t.exports=r:this.xor128=r}(0,Wy)),Wy.exports),n=(zy||(zy=1,function(e,t){function n(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var i=0;i<n.length+64;i++)t.x^=0|n.charCodeAt(i),i==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function r(e,t){var r=new n(e),o=t&&t.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=r.next,s.quick=s,o&&("object"==typeof o&&i(o,r),s.state=function(){return i(r,{})}),s}t&&t.exports?t.exports=r:this.xorwow=r}(0,$y)),$y.exports),i=(Uy||(Uy=1,function(e,t){function n(e){var t=this;t.next=function(){var e,n,i=t.x,r=t.i;return e=i[r],n=(e^=e>>>7)^e<<24,n^=(e=i[r+1&7])^e>>>10,n^=(e=i[r+3&7])^e>>>3,n^=(e=i[r+4&7])^e<<7,e=i[r+7&7],n^=(e^=e<<13)^e<<9,i[r]=n,t.i=r+1&7,n},function(e,t){var n,i=[];if(t===(0|t))i[0]=t;else for(t=""+t,n=0;n<t.length;++n)i[7&n]=i[7&n]<<15^t.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n?i[7]=-1:i[n],e.x=i,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function r(e,t){null==e&&(e=+new Date);var r=new n(e),o=t&&t.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=r.next,s.quick=s,o&&(o.x&&i(o,r),s.state=function(){return i(r,{})}),s}t&&t.exports?t.exports=r:this.xorshift7=r}(0,Gy)),Gy.exports),r=(Vy||(Vy=1,function(e,t){function n(e){var t=this;t.next=function(){var e,n,i=t.w,r=t.X,o=t.i;return t.w=i=i+1640531527|0,n=r[o+34&127],e=r[o=o+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=r[o]=n^e,t.i=o,n+(i^i>>>16)|0},function(e,t){var n,i,r,o,s,a=[],l=128;for(t===(0|t)?(i=t,t=null):(t+="\0",i=0,l=Math.max(l,t.length)),r=0,o=-32;o<l;++o)t&&(i^=t.charCodeAt((o+32)%t.length)),0===o&&(s=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,o>=0&&(s=s+1640531527|0,r=0==(n=a[127&o]^=i+s)?r+1:0);for(r>=128&&(a[127&(t&&t.length||0)]=-1),r=127,o=512;o>0;--o)i=a[r+34&127],n=a[r=r+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,a[r]=i^n;e.w=s,e.X=a,e.i=r}(t,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function r(e,t){null==e&&(e=+new Date);var r=new n(e),o=t&&t.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=r.next,s.quick=s,o&&(o.X&&i(o,r),s.state=function(){return i(r,{})}),s}t&&t.exports?t.exports=r:this.xor4096=r}(0,jy)),jy.exports),o=(Hy||(Hy=1,function(e,t){function n(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,i=t.d,r=t.a;return e=e<<25^e>>>7^n,n=n-i|0,i=i<<24^i>>>8^r,r=r-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-i|0,t.d=i<<16^n>>>16^r,t.a=r-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var i=0;i<n.length+20;i++)t.b^=0|n.charCodeAt(i),t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function r(e,t){var r=new n(e),o=t&&t.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=r.next,s.quick=s,o&&("object"==typeof o&&i(o,r),s.state=function(){return i(r,{})}),s}t&&t.exports?t.exports=r:this.tychei=r}(0,Yy)),Yy.exports),s=ev();return s.alea=e,s.xor128=t,s.xorwow=n,s.xorshift7=i,s.xor4096=r,s.tychei=o,Zy=s}();const nv=B_(tv);function iv(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,sv(i.key),i)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function rv(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,ov(e,t)}function ov(e,t){return ov=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ov(e,t)}function sv(e){var t=function(e){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}var av=function(){function e(){}return e.prototype._seed=function(e,t){if(e===(e||0))return e;for(var n=""+e,i=0,r=0;r<n.length;++r)i^=0|n.charCodeAt(r);return i},e}(),lv=function(e){function t(t,n){var i;return(i=e.call(this)||this)._rng=void 0,i.seed(t,n),i}rv(t,e);var n=t.prototype;return n.next=function(){return this._rng()},n.seed=function(e,t){this._rng=e},n.clone=function(e,n){return new t(this._rng,n)},iv(t,[{key:"name",get:function(){return"function"}}]),t}(av),cv=function(){var e=[].slice.call(arguments),t=e[0],n=void 0===t?"default":t;switch(typeof n){case"object":if(n instanceof av)return n;break;case"function":return new lv(n);default:return new lv(nv.apply(void 0,e))}throw new Error('invalid RNG "'+n+'"')},uv=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),function(){return e.next()*(n-t)+t}};function dv(e){return new hv(e)}var hv=function(e){var t=this;this.n=void 0,this.isInt=function(){if(Number.isInteger(t.n))return t;throw new Error("Expected number to be an integer, got "+t.n)},this.isPositive=function(){if(t.n>0)return t;throw new Error("Expected number to be positive, got "+t.n)},this.lessThan=function(e){if(t.n<e)return t;throw new Error("Expected number to be less than "+e+", got "+t.n)},this.greaterThanOrEqual=function(e){if(t.n>=e)return t;throw new Error("Expected number to be greater than or equal to "+e+", got "+t.n)},this.greaterThan=function(e){if(t.n>e)return t;throw new Error("Expected number to be greater than "+e+", got "+t.n)},this.n=e},fv=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),void 0===n&&(n=void 0===t?1:t,t=0),dv(t).isInt(),dv(n).isInt(),function(){return Math.floor(e.next()*(n-t+1)+t)}},pv=function(e){return function(){return e.next()>=.5}},mv=[0,0,.6931471805599453,1.791759469228055,3.1780538303479458,4.787491742782046,6.579251212010101,8.525161361065415,10.60460290274525,12.801827480081469],gv=function(e){return mv[e]},_v=function(e){function t(){return e.apply(this,arguments)||this}rv(t,e);var n=t.prototype;return n.next=function(){return Math.random()},n.seed=function(e,t){},n.clone=function(){return new t},iv(t,[{key:"name",get:function(){return"default"}}]),t}(av),yv=function(){function e(e){var t=this;this._rng=void 0,this._patch=void 0,this._cache={},this.next=function(){return t._rng.next()},this.float=function(e,n){return t.uniform(e,n)()},this.int=function(e,n){return t.uniformInt(e,n)()},this.integer=function(e,n){return t.uniformInt(e,n)()},this.bool=function(){return t.uniformBoolean()()},this.boolean=function(){return t.uniformBoolean()()},this.uniform=function(e,n){return t._memoize("uniform",uv,e,n)},this.uniformInt=function(e,n){return t._memoize("uniformInt",fv,e,n)},this.uniformBoolean=function(){return t._memoize("uniformBoolean",pv)},this.normal=function(e,n){return function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),function(){var i,r,o;do{o=(i=2*e.next()-1)*i+(r=2*e.next()-1)*r}while(!o||o>1);return t+n*r*Math.sqrt(-2*Math.log(o)/o)}}(t,e,n)},this.logNormal=function(e,n){return function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=1);var i=e.normal(t,n);return function(){return Math.exp(i())}}(t,e,n)},this.bernoulli=function(e){return function(e,t){return void 0===t&&(t=.5),dv(t).greaterThanOrEqual(0).lessThan(1),function(){return Math.floor(e.next()+t)}}(t,e)},this.binomial=function(e,n){return function(e,t,n){return void 0===t&&(t=1),void 0===n&&(n=.5),dv(t).isInt().isPositive(),dv(n).greaterThanOrEqual(0).lessThan(1),function(){for(var i=0,r=0;i++<t;)e.next()<n&&r++;return r}}(t,e,n)},this.geometric=function(e){return function(e,t){void 0===t&&(t=.5),dv(t).greaterThan(0).lessThan(1);var n=1/Math.log(1-t);return function(){return Math.floor(1+Math.log(e.next())*n)}}(t,e)},this.poisson=function(e){return function(e,t){if(void 0===t&&(t=1),dv(t).isPositive(),t<10){var n=Math.exp(-t);return function(){for(var i=n,r=0,o=e.next();o>i;)o-=i,i=t*i/++r;return r}}var i=Math.sqrt(t),r=.931+2.53*i,o=.02483*r-.059,s=1.1239+1.1328/(r-3.4),a=.9277-3.6224/(r-2);return function(){for(;;){var n=void 0,l=e.next();if(l<=.86*a)return n=l/a-.43,Math.floor((2*o/(.5-Math.abs(n))+r)*n+t+.445);l>=a?n=e.next()-.5:(n=((n=l/a-.93)<0?-.5:.5)-n,l=e.next()*a);var c=.5-Math.abs(n);if(!(c<.013&&l>c)){var u=Math.floor((2*o/c+r)*n+t+.445);if(l=l*s/(o/(c*c)+r),u>=10){var d=(u+.5)*Math.log(t/u)-t-.9189385332046727+u-(.08333333333333333-(.002777777777777778-1/(1260*u*u))/(u*u))/u;if(Math.log(l*i)<=d)return u}else if(u>=0){var h,f=null!=(h=gv(u))?h:0;if(Math.log(l)<=u*Math.log(t)-t-f)return u}}}}}(t,e)},this.exponential=function(e){return function(e,t){return void 0===t&&(t=1),dv(t).isPositive(),function(){return-Math.log(1-e.next())/t}}(t,e)},this.irwinHall=function(e){return function(e,t){return void 0===t&&(t=1),dv(t).isInt().greaterThanOrEqual(0),function(){for(var n=0,i=0;i<t;++i)n+=e.next();return n}}(t,e)},this.bates=function(e){return function(e,t){void 0===t&&(t=1),dv(t).isInt().isPositive();var n=e.irwinHall(t);return function(){return n()/t}}(t,e)},this.pareto=function(e){return function(e,t){void 0===t&&(t=1),dv(t).greaterThanOrEqual(0);var n=1/t;return function(){return 1/Math.pow(1-e.next(),n)}}(t,e)},e&&e instanceof av?this.use(e):this.use(new _v),this._cache={}}var t=e.prototype;return t.clone=function(){var t=[].slice.call(arguments);return t.length?new e(cv.apply(void 0,t)):new e(this.rng.clone())},t.use=function(){this._rng=cv.apply(void 0,[].slice.call(arguments))},t.patch=function(){if(this._patch)throw new Error("Math.random already patched");this._patch=Math.random,Math.random=this.uniform()},t.unpatch=function(){this._patch&&(Math.random=this._patch,delete this._patch)},t.choice=function(e){if(!Array.isArray(e))throw new Error("Random.choice expected input to be an array, got "+typeof e);var t=null==e?void 0:e.length;return t>0?e[this.uniformInt(0,t-1)()]:void 0},t._memoize=function(e,t){var n=[].slice.call(arguments,2),i=""+n.join(";"),r=this._cache[e];return(void 0===r||r.key!==i)&&(r={key:i,distribution:t.apply(void 0,[this].concat(n))},this._cache[e]=r),r.distribution},iv(e,[{key:"rng",get:function(){return this._rng}}]),e}();new yv;const vv=.001;class bv{constructor(){this.pointsTextureSize=0,this.linksTextureSize=0,this.alpha=1,this.transform=function(){var e=new My(9);return My!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}(),this.screenSize=[0,0],this.mousePosition=[0,0],this.screenMousePosition=[0,0],this.selectedArea=[[0,0],[0,0]],this.isSimulationRunning=!1,this.simulationProgress=0,this.selectedIndices=null,this.maxPointSize=64,this.hoveredPoint=void 0,this.focusedPoint=void 0,this.draggingPointIndex=void 0,this.hoveredLinkIndex=void 0,this.adjustedSpaceSize=Zh.spaceSize,this.isSpaceKeyPressed=!1,this.webglMaxTextureSize=16384,this.hoveredPointRingColor=[1,1,1,.7],this.focusedPointRingColor=[1,1,1,.95],this.hoveredLinkColor=[-1,-1,-1,-1],this.greyoutPointColor=[-1,-1,-1,-1],this.isDarkenGreyout=!1,this.isLinkHoveringEnabled=!1,this.alphaTarget=0,this.scalePointX=Ty(),this.scalePointY=Ty(),this.random=new yv,this._backgroundColor=[0,0,0,0],this.alphaDecay=e=>1-Math.pow(vv,1/e)}get backgroundColor(){return this._backgroundColor}get transformationMatrix4x4(){const e=this.transform;if(9!==e.length)throw new Error(`Transform must be a 9-element array (3x3 matrix), got ${e.length} elements`);return[e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,0,0,0,1]}set backgroundColor(e){this._backgroundColor=e;const t=function(e,t,n){return.2126*e+.7152*t+.0722*n}(e[0],e[1],e[2]);document.documentElement.style.setProperty("--cosmosgl-attribution-color",t>.65?"black":"white"),document.documentElement.style.setProperty("--cosmosgl-error-message-color",t>.65?"black":"white"),this.div&&(this.div.style.backgroundColor=`rgba(${255*e[0]}, ${255*e[1]}, ${255*e[2]}, ${e[3]})`),this.isDarkenGreyout=t<.65}addRandomSeed(e){this.random=this.random.clone(e)}getRandomFloat(e,t){return this.random.float(e,t)}adjustSpaceSize(e,t){(e<=0||!isFinite(e))&&(e=Zh.spaceSize),e<2&&(e=2),this.adjustedSpaceSize=e>=t?Math.max(t/2,2):e}setWebGLMaxTextureSize(e){this.webglMaxTextureSize=e}updateScreenSize(e,t){const{adjustedSpaceSize:n}=this;this.screenSize=[e,t],this.scalePointX.domain([0,n]).range([(e-n)/2,(e+n)/2]),this.scalePointY.domain([n,0]).range([(t-n)/2,(t+n)/2])}scaleX(e){return this.scalePointX(e)}scaleY(e){return this.scalePointY(e)}setHoveredPointRingColor(e){const t=Jf(e);this.hoveredPointRingColor[0]=t[0],this.hoveredPointRingColor[1]=t[1],this.hoveredPointRingColor[2]=t[2]}setFocusedPointRingColor(e){const t=Jf(e);this.focusedPointRingColor[0]=t[0],this.focusedPointRingColor[1]=t[1],this.focusedPointRingColor[2]=t[2]}setGreyoutPointColor(e){if(void 0===e)return void(this.greyoutPointColor=[-1,-1,-1,-1]);const t=Jf(e);this.greyoutPointColor[0]=t[0],this.greyoutPointColor[1]=t[1],this.greyoutPointColor[2]=t[2],this.greyoutPointColor[3]=t[3]}updateLinkHoveringEnabled(e){this.isLinkHoveringEnabled=!!(e.onLinkClick||e.onLinkMouseOver||e.onLinkMouseOut),this.isLinkHoveringEnabled||(this.hoveredLinkIndex=void 0)}setHoveredLinkColor(e){if(void 0===e)return void(this.hoveredLinkColor=[-1,-1,-1,-1]);const t=Jf(e);this.hoveredLinkColor[0]=t[0],this.hoveredLinkColor[1]=t[1],this.hoveredLinkColor[2]=t[2],this.hoveredLinkColor[3]=t[3]}setFocusedPoint(e){this.focusedPoint=void 0!==e?{index:e}:void 0}addAlpha(e){return(this.alphaTarget-this.alpha)*this.alphaDecay(e)}}const xv={passive:!1},wv={capture:!0,passive:!1};function Sv(e){e.stopImmediatePropagation()}function Ev(e){e.preventDefault(),e.stopImmediatePropagation()}function Cv(e){var t=e.document.documentElement,n=Bl(e).on("dragstart.drag",Ev,wv);"onselectstart"in t?n.on("selectstart.drag",Ev,wv):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Tv(e,t){var n=e.document.documentElement,i=Bl(e).on("dragstart.drag",null);t&&(i.on("click.drag",Ev,wv),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const kv=e=>()=>e;function Iv(e,{sourceEvent:t,subject:n,target:i,identifier:r,active:o,x:s,y:a,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}function Av(e){return!e.ctrlKey&&!e.button}function Lv(){return this.parentNode}function Rv(e,t){return t??{x:e.x,y:e.y}}function Pv(){return navigator.maxTouchPoints||"ontouchstart"in this}Iv.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};const Mv=e=>()=>e;function Dv(e,{sourceEvent:t,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function Nv(e,t,n){this.k=e,this.x=t,this.y=n}Nv.prototype={constructor:Nv,scale:function(e){return 1===e?this:new Nv(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new Nv(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Fv=new Nv(1,0,0);function Ov(e){e.stopImmediatePropagation()}function Bv(e){e.preventDefault(),e.stopImmediatePropagation()}function zv(e){return!(e.ctrlKey&&"wheel"!==e.type||e.button)}function Uv(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function Vv(){return this.__zoom||Fv}function Hv(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Wv(){return navigator.maxTouchPoints||"ontouchstart"in this}function $v(e,t,n){var i=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}Nv.prototype;class Gv{constructor(e,t){this.eventTransform=Fv,this.behavior=function(){var e,t,n,i=zv,r=Uv,o=$v,s=Hv,a=Wv,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,d=_u,h=Vl("start","zoom","end"),f=0,p=10;function m(e){e.property("__zoom",Vv).on("wheel.zoom",w,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",E).filter(a).on("touchstart.zoom",C).on("touchmove.zoom",T).on("touchend.zoom touchcancel.zoom",k).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(e,t){return(t=Math.max(l[0],Math.min(l[1],t)))===e.k?e:new Nv(t,e.x,e.y)}function _(e,t,n){var i=t[0]-n[0]*e.k,r=t[1]-n[1]*e.k;return i===e.x&&r===e.y?e:new Nv(e.k,i,r)}function y(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function v(e,t,n,i){e.on("start.zoom",function(){b(this,arguments).event(i).start()}).on("interrupt.zoom end.zoom",function(){b(this,arguments).event(i).end()}).tween("zoom",function(){var e=this,o=arguments,s=b(e,o).event(i),a=r.apply(e,o),l=null==n?y(a):"function"==typeof n?n.apply(e,o):n,c=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),u=e.__zoom,h="function"==typeof t?t.apply(e,o):t,f=d(u.invert(l).concat(c/u.k),h.invert(l).concat(c/h.k));return function(e){if(1===e)e=h;else{var t=f(e),n=c/t[2];e=new Nv(n,l[0]-t[0]*n,l[1]-t[1]*n)}s.zoom(null,e)}})}function b(e,t,n){return!n&&e.__zooming||new x(e,t)}function x(e,t){this.that=e,this.args=t,this.active=0,this.sourceEvent=null,this.extent=r.apply(e,t),this.taps=0}function w(e,...t){if(i.apply(this,arguments)){var n=b(this,t).event(e),r=this.__zoom,a=Math.max(l[0],Math.min(l[1],r.k*Math.pow(2,s.apply(this,arguments)))),u=zl(e);if(n.wheel)(n.mouse[0][0]!==u[0]||n.mouse[0][1]!==u[1])&&(n.mouse[1]=r.invert(n.mouse[0]=u)),clearTimeout(n.wheel);else{if(r.k===a)return;n.mouse=[u,r.invert(u)],mc(this),n.start()}Bv(e),n.wheel=setTimeout(function(){n.wheel=null,n.end()},150),n.zoom("mouse",o(_(g(r,a),n.mouse[0],n.mouse[1]),n.extent,c))}}function S(e,...t){if(!n&&i.apply(this,arguments)){var r=e.currentTarget,s=b(this,t,!0).event(e),a=Bl(e.view).on("mousemove.zoom",function(e){if(Bv(e),!s.moved){var t=e.clientX-u,n=e.clientY-d;s.moved=t*t+n*n>f}s.event(e).zoom("mouse",o(_(s.that.__zoom,s.mouse[0]=zl(e,r),s.mouse[1]),s.extent,c))},!0).on("mouseup.zoom",function(e){a.on("mousemove.zoom mouseup.zoom",null),Tv(e.view,s.moved),Bv(e),s.event(e).end()},!0),l=zl(e,r),u=e.clientX,d=e.clientY;Cv(e.view),Ov(e),s.mouse=[l,this.__zoom.invert(l)],mc(this),s.start()}}function E(e,...t){if(i.apply(this,arguments)){var n=this.__zoom,s=zl(e.changedTouches?e.changedTouches[0]:e,this),a=n.invert(s),l=n.k*(e.shiftKey?.5:2),d=o(_(g(n,l),s,a),r.apply(this,t),c);Bv(e),u>0?Bl(this).transition().duration(u).call(v,d,s,e):Bl(this).call(m.transform,d,s,e)}}function C(n,...r){if(i.apply(this,arguments)){var o,s,a,l,c=n.touches,u=c.length,d=b(this,r,n.changedTouches.length===u).event(n);for(Ov(n),s=0;s<u;++s)l=[l=zl(a=c[s],this),this.__zoom.invert(l),a.identifier],d.touch0?!d.touch1&&d.touch0[2]!==l[2]&&(d.touch1=l,d.taps=0):(d.touch0=l,o=!0,d.taps=1+!!e);e&&(e=clearTimeout(e)),o&&(d.taps<2&&(t=l[0],e=setTimeout(function(){e=null},500)),mc(this),d.start())}}function T(e,...t){if(this.__zooming){var n,i,r,s,a=b(this,t).event(e),l=e.changedTouches,u=l.length;for(Bv(e),n=0;n<u;++n)r=zl(i=l[n],this),a.touch0&&a.touch0[2]===i.identifier?a.touch0[0]=r:a.touch1&&a.touch1[2]===i.identifier&&(a.touch1[0]=r);if(i=a.that.__zoom,a.touch1){var d=a.touch0[0],h=a.touch0[1],f=a.touch1[0],p=a.touch1[1],m=(m=f[0]-d[0])*m+(m=f[1]-d[1])*m,y=(y=p[0]-h[0])*y+(y=p[1]-h[1])*y;i=g(i,Math.sqrt(m/y)),r=[(d[0]+f[0])/2,(d[1]+f[1])/2],s=[(h[0]+p[0])/2,(h[1]+p[1])/2]}else{if(!a.touch0)return;r=a.touch0[0],s=a.touch0[1]}a.zoom("touch",o(_(i,r,s),a.extent,c))}}function k(e,...i){if(this.__zooming){var r,o,s=b(this,i).event(e),a=e.changedTouches,l=a.length;for(Ov(e),n&&clearTimeout(n),n=setTimeout(function(){n=null},500),r=0;r<l;++r)o=a[r],s.touch0&&s.touch0[2]===o.identifier?delete s.touch0:s.touch1&&s.touch1[2]===o.identifier&&delete s.touch1;if(s.touch1&&!s.touch0&&(s.touch0=s.touch1,delete s.touch1),s.touch0)s.touch0[1]=this.__zoom.invert(s.touch0[0]);else if(s.end(),2===s.taps&&(o=zl(o,this),Math.hypot(t[0]-o[0],t[1]-o[1])<p)){var c=Bl(this).on("dblclick.zoom");c&&c.apply(this,arguments)}}}return m.transform=function(e,t,n,i){var r=e.selection?e.selection():e;r.property("__zoom",Vv),e!==r?v(e,t,n,i):r.interrupt().each(function(){b(this,arguments).event(i).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()})},m.scaleBy=function(e,t,n,i){m.scaleTo(e,function(){return this.__zoom.k*("function"==typeof t?t.apply(this,arguments):t)},n,i)},m.scaleTo=function(e,t,n,i){m.transform(e,function(){var e=r.apply(this,arguments),i=this.__zoom,s=null==n?y(e):"function"==typeof n?n.apply(this,arguments):n,a=i.invert(s),l="function"==typeof t?t.apply(this,arguments):t;return o(_(g(i,l),s,a),e,c)},n,i)},m.translateBy=function(e,t,n,i){m.transform(e,function(){return o(this.__zoom.translate("function"==typeof t?t.apply(this,arguments):t,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),c)},null,i)},m.translateTo=function(e,t,n,i,s){m.transform(e,function(){var e=r.apply(this,arguments),s=this.__zoom,a=null==i?y(e):"function"==typeof i?i.apply(this,arguments):i;return o(Fv.translate(a[0],a[1]).scale(s.k).translate("function"==typeof t?-t.apply(this,arguments):-t,"function"==typeof n?-n.apply(this,arguments):-n),e,c)},i,s)},x.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var t=Bl(this.that).datum();h.call(e,this.that,new Dv(e,{sourceEvent:this.sourceEvent,target:m,transform:this.that.__zoom,dispatch:h}),t)}},m.wheelDelta=function(e){return arguments.length?(s="function"==typeof e?e:Mv(+e),m):s},m.filter=function(e){return arguments.length?(i="function"==typeof e?e:Mv(!!e),m):i},m.touchable=function(e){return arguments.length?(a="function"==typeof e?e:Mv(!!e),m):a},m.extent=function(e){return arguments.length?(r="function"==typeof e?e:Mv([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),m):r},m.scaleExtent=function(e){return arguments.length?(l[0]=+e[0],l[1]=+e[1],m):[l[0],l[1]]},m.translateExtent=function(e){return arguments.length?(c[0][0]=+e[0][0],c[1][0]=+e[1][0],c[0][1]=+e[0][1],c[1][1]=+e[1][1],m):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},m.constrain=function(e){return arguments.length?(o=e,m):o},m.duration=function(e){return arguments.length?(u=+e,m):u},m.interpolate=function(e){return arguments.length?(d=e,m):d},m.on=function(){var e=h.on.apply(h,arguments);return e===h?m:e},m.clickDistance=function(e){return arguments.length?(f=(e=+e)*e,m):Math.sqrt(f)},m.tapDistance=function(e){return arguments.length?(p=+e,m):p},m}().scaleExtent([.001,1/0]).on("start",e=>{var t,n;this.isRunning=!0;const i=!!e.sourceEvent;null==(n=null==(t=this.config)?void 0:t.onZoomStart)||n.call(t,e,i)}).on("zoom",e=>{var t,n;this.eventTransform=e.transform;const{eventTransform:{x:i,y:r,k:o},store:{transform:s,screenSize:a}}=this,l=a[0],c=a[1];if(!l||!c)return;(function(e,t,n){e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/n,e[5]=0,e[6]=-1,e[7]=1,e[8]=1})(s,l,c),Dy(s,s,[i,r]),Ny(s,s,[o,o]),Dy(s,s,[l/2,c/2]),Ny(s,s,[l/2,c/2]),Ny(s,s,[1,-1]);const u=!!e.sourceEvent;null==(n=null==(t=this.config)?void 0:t.onZoom)||n.call(t,e,u)}).on("end",e=>{var t,n;this.isRunning=!1;const i=!!e.sourceEvent;null==(n=null==(t=this.config)?void 0:t.onZoomEnd)||n.call(t,e,i)}),this.isRunning=!1,this.store=e,this.config=t}getTransform(e,t,n=.1){if(0===e.length)return this.eventTransform;const{store:{screenSize:i}}=this,r=i[0],o=i[1],s=Z_(e.map(e=>e[0])),a=Z_(e.map(e=>e[1]));s[0]=this.store.scaleX(s[0]),s[1]=this.store.scaleX(s[1]),a[0]=this.store.scaleY(a[0]),a[1]=this.store.scaleY(a[1]),s[0]===s[1]&&(s[0]-=.5,s[1]+=.5),a[0]===a[1]&&(a[0]+=.5,a[1]-=.5);const l=r*(1-2*n)/(s[1]-s[0]),c=o*(1-2*n)/(a[0]-a[1]),u=function(e,t,n){return Math.min(Math.max(e,t),n)}(t??Math.min(l,c),...this.behavior.scaleExtent()),d=r/2-(s[1]+s[0])/2*u,h=o/2-(a[1]+a[0])/2*u;return Fv.translate(d,h).scale(u)}getDistanceToPoint(e){const{x:t,y:n,k:i}=this.eventTransform,r=this.getTransform([e],i),o=t-r.x,s=n-r.y;return Math.sqrt(o*o+s*s)}getMiddlePointTransform(e){const{store:{screenSize:t},eventTransform:{x:n,y:i,k:r}}=this,o=t[0],s=t[1],a=(s/2-i)/r,l=o/2-((o/2-n)/r+this.store.scaleX(e[0]))/2*1,c=s/2-(a+this.store.scaleY(e[1]))/2*1;return Fv.translate(l,c).scale(1)}convertScreenToSpacePosition(e){const{eventTransform:{x:t,y:n,k:i},store:{screenSize:r}}=this,o=r[0],s=r[1],a=[(e[0]-t)/i,s-(e[1]-n)/i];return a[0]-=(o-this.store.adjustedSpaceSize)/2,a[1]-=(s-this.store.adjustedSpaceSize)/2,a}convertSpaceToScreenPosition(e){return[this.eventTransform.applyX(this.store.scaleX(e[0])),this.eventTransform.applyY(this.store.scaleY(e[1]))]}convertSpaceToScreenRadius(e){const{config:{scalePointsOnZoom:t},store:{maxPointSize:n},eventTransform:{k:i}}=this;let r=2*e;return r*=t?i:Math.min(5,Math.max(1,.01*i)),Math.min(r,n)/2}}class jv{constructor(e,t){this.isActive=!1,this.behavior=function(){var e,t,n,i,r=Av,o=Lv,s=Rv,a=Pv,l={},c=Vl("start","drag","end"),u=0,d=0;function h(e){e.on("mousedown.drag",f).filter(a).on("touchstart.drag",g).on("touchmove.drag",_,xv).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(s,a){if(!i&&r.call(this,s,a)){var l=v(this,o.call(this,s,a),s,a,"mouse");l&&(Bl(s.view).on("mousemove.drag",p,wv).on("mouseup.drag",m,wv),Cv(s.view),Sv(s),n=!1,e=s.clientX,t=s.clientY,l("start",s))}}function p(i){if(Ev(i),!n){var r=i.clientX-e,o=i.clientY-t;n=r*r+o*o>d}l.mouse("drag",i)}function m(e){Bl(e.view).on("mousemove.drag mouseup.drag",null),Tv(e.view,n),Ev(e),l.mouse("end",e)}function g(e,t){if(r.call(this,e,t)){var n,i,s=e.changedTouches,a=o.call(this,e,t),l=s.length;for(n=0;n<l;++n)(i=v(this,a,e,t,s[n].identifier,s[n]))&&(Sv(e),i("start",e,s[n]))}}function _(e){var t,n,i=e.changedTouches,r=i.length;for(t=0;t<r;++t)(n=l[i[t].identifier])&&(Ev(e),n("drag",e,i[t]))}function y(e){var t,n,r=e.changedTouches,o=r.length;for(i&&clearTimeout(i),i=setTimeout(function(){i=null},500),t=0;t<o;++t)(n=l[r[t].identifier])&&(Sv(e),n("end",e,r[t]))}function v(e,t,n,i,r,o){var a,d,f,p=c.copy(),m=zl(o||n,t);if(null!=(f=s.call(e,new Iv("beforestart",{sourceEvent:n,target:h,identifier:r,active:u,x:m[0],y:m[1],dx:0,dy:0,dispatch:p}),i)))return a=f.x-m[0]||0,d=f.y-m[1]||0,function n(o,s,c){var g,_=m;switch(o){case"start":l[r]=n,g=u++;break;case"end":delete l[r],--u;case"drag":m=zl(c||s,t),g=u}p.call(o,e,new Iv(o,{sourceEvent:s,subject:f,target:h,identifier:r,active:g,x:m[0]+a,y:m[1]+d,dx:m[0]-_[0],dy:m[1]-_[1],dispatch:p}),i)}}return h.filter=function(e){return arguments.length?(r="function"==typeof e?e:kv(!!e),h):r},h.container=function(e){return arguments.length?(o="function"==typeof e?e:kv(e),h):o},h.subject=function(e){return arguments.length?(s="function"==typeof e?e:kv(e),h):s},h.touchable=function(e){return arguments.length?(a="function"==typeof e?e:kv(!!e),h):a},h.on=function(){var e=c.on.apply(c,arguments);return e===c?h:e},h.clickDistance=function(e){return arguments.length?(d=(e=+e)*e,h):Math.sqrt(d)},h}().subject(e=>this.store.hoveredPoint&&!this.store.isSpaceKeyPressed?{x:e.x,y:e.y}:void 0).on("start",e=>{var t,n;this.store.hoveredPoint&&(this.store.draggingPointIndex=this.store.hoveredPoint.index,this.isActive=!0,null==(n=null==(t=this.config)?void 0:t.onDragStart)||n.call(t,e))}).on("drag",e=>{var t,n;null==(n=null==(t=this.config)?void 0:t.onDrag)||n.call(t,e)}).on("end",e=>{var t,n;this.isActive=!1,this.store.draggingPointIndex=void 0,null==(n=null==(t=this.config)?void 0:t.onDragEnd)||n.call(t,e)}),this.store=e,this.config=t}}class Yv{constructor(e,t,n){if(this.config=new np,this.graph=new G_(this.config),this.requestAnimationFrameId=0,this.isRightClickMouse=!1,this.store=new bv,this.zoomInstance=new Gv(this.store,this.config),this.dragInstance=new jv(this.store,this.config),this._findHoveredItemExecutionCount=0,this._isMouseOnCanvas=!1,this._isFirstRenderAfterInit=!0,this.isPointPositionsUpdateNeeded=!1,this.isPointColorUpdateNeeded=!1,this.isPointSizeUpdateNeeded=!1,this.isPointShapeUpdateNeeded=!1,this.isPointImageIndicesUpdateNeeded=!1,this.isLinksUpdateNeeded=!1,this.isLinkColorUpdateNeeded=!1,this.isLinkWidthUpdateNeeded=!1,this.isLinkArrowUpdateNeeded=!1,this.isPointClusterUpdateNeeded=!1,this.isForceManyBodyUpdateNeeded=!1,this.isForceLinkUpdateNeeded=!1,this.isForceCenterUpdateNeeded=!1,this.isPointImageSizesUpdateNeeded=!1,this._isDestroyed=!1,t&&this.config.init(t),n)this.deviceInitPromise=n;else{const e=document.createElement("canvas");this.deviceInitPromise=this.createDevice(e)}this.deviceInitPromise.then(t=>{if(this._isDestroyed)return t.destroy(),t;this.device=t;const i=this.validateDevice(t);n&&i.setProps({useDevicePixels:this.config.pixelRatio}),this.store.div=e;const r=i.canvas;r.parentNode!==this.store.div&&(r.parentNode&&r.parentNode.removeChild(r),this.store.div.appendChild(r)),this.addAttribution(),r.style.width="100%",r.style.height="100%",this.canvas=r;const o=this.canvas.clientWidth,s=this.canvas.clientHeight;this.store.adjustSpaceSize(this.config.spaceSize,this.device.limits.maxTextureDimension2D),this.store.setWebGLMaxTextureSize(this.device.limits.maxTextureDimension2D),this.store.updateScreenSize(o,s),this.canvasD3Selection=Bl(this.canvas),this.canvasD3Selection.on("mouseenter.cosmos",()=>{this._isMouseOnCanvas=!0}).on("mousemove.cosmos",()=>{this._isMouseOnCanvas=!0}).on("mouseleave.cosmos",e=>{this._isMouseOnCanvas=!1,this.currentEvent=e,void 0!==this.store.hoveredPoint&&this.config.onPointMouseOut&&this.config.onPointMouseOut(e),void 0!==this.store.hoveredLinkIndex&&this.config.onLinkMouseOut&&this.config.onLinkMouseOut(e),this.isRightClickMouse=!1,this.store.hoveredPoint=void 0,this.store.hoveredLinkIndex=void 0,this.updateCanvasCursor()}),Bl(document).on("keydown.cosmos",e=>{"Space"===e.code&&(this.store.isSpaceKeyPressed=!0)}).on("keyup.cosmos",e=>{"Space"===e.code&&(this.store.isSpaceKeyPressed=!1)}),this.zoomInstance.behavior.on("start.detect",e=>{this.currentEvent=e}).on("zoom.detect",e=>{!!e.sourceEvent&&this.updateMousePosition(e.sourceEvent),this.currentEvent=e}).on("end.detect",e=>{this.currentEvent=e}),this.dragInstance.behavior.on("start.detect",e=>{this.currentEvent=e,this.updateCanvasCursor()}).on("drag.detect",e=>{this.dragInstance.isActive&&this.updateMousePosition(e),this.currentEvent=e}).on("end.detect",e=>{this.currentEvent=e,this.updateCanvasCursor()}),this.canvasD3Selection.call(this.dragInstance.behavior).call(this.zoomInstance.behavior).on("click",this.onClick.bind(this)).on("mousemove",this.onMouseMove.bind(this)).on("contextmenu",this.onRightClickMouse.bind(this)),(!this.config.enableZoom||!this.config.enableDrag)&&this.updateZoomDragBehaviors(),this.setZoomLevel(this.config.initialZoomLevel??1);const a=t.gl.getParameter(Mh.ALIASED_POINT_SIZE_RANGE);return this.store.maxPointSize=((null==a?void 0:a[1])??64)/this.config.pixelRatio,this.store.isSimulationRunning=this.config.enableSimulation,this.points=new Py(t,this.config,this.store,this.graph),this.lines=new Ry(t,this.config,this.store,this.graph,this.points),this.config.enableSimulation&&(this.forceGravity=new A_(t,this.config,this.store,this.graph,this.points),this.forceCenter=new I_(t,this.config,this.store,this.graph,this.points),this.forceManyBody=new N_(t,this.config,this.store,this.graph,this.points),this.forceLinkIncoming=new D_(t,this.config,this.store,this.graph,this.points),this.forceLinkOutgoing=new D_(t,this.config,this.store,this.graph,this.points),this.forceMouse=new F_(t,this.config,this.store,this.graph,this.points)),this.clusters=new O_(t,this.config,this.store,this.graph,this.points),this.store.backgroundColor=Jf(this.config.backgroundColor),this.store.setHoveredPointRingColor(this.config.hoveredPointRingColor??Zh.hoveredPointRingColor),this.store.setFocusedPointRingColor(this.config.focusedPointRingColor??Zh.focusedPointRingColor),void 0!==this.config.focusedPointIndex&&this.store.setFocusedPoint(this.config.focusedPointIndex),this.store.setGreyoutPointColor(this.config.pointGreyoutColor??Xh),this.store.setHoveredLinkColor(this.config.hoveredLinkColor??Zh.hoveredLinkColor),this.store.updateLinkHoveringEnabled(this.config),this.config.showFPSMonitor&&(this.fpsMonitor=new $_(this.canvas)),void 0!==this.config.randomSeed&&this.store.addRandomSeed(this.config.randomSeed),t}).catch(e=>{throw e})}get progress(){return this._isDestroyed?0:this.store.simulationProgress}get isSimulationRunning(){return!this._isDestroyed&&this.store.isSimulationRunning}get maxPointSize(){return this._isDestroyed?0:this.store.maxPointSize}setConfig(e){var t,n,i,r,o,s,a,l,c;if(this._isDestroyed||this.ensureDevice(()=>this.setConfig(e)))return;const u={...this.config};if(this.config.init(e),(u.pointDefaultColor!==this.config.pointDefaultColor||u.pointColor!==this.config.pointColor)&&(this.graph.updatePointColor(),null==(t=this.points)||t.updateColor()),(u.pointDefaultSize!==this.config.pointDefaultSize||u.pointSize!==this.config.pointSize)&&(this.graph.updatePointSize(),null==(n=this.points)||n.updateSize()),(u.linkDefaultColor!==this.config.linkDefaultColor||u.linkColor!==this.config.linkColor)&&(this.graph.updateLinkColor(),null==(i=this.lines)||i.updateColor()),(u.linkDefaultWidth!==this.config.linkDefaultWidth||u.linkWidth!==this.config.linkWidth)&&(this.graph.updateLinkWidth(),null==(r=this.lines)||r.updateWidth()),(u.linkDefaultArrows!==this.config.linkDefaultArrows||u.linkArrows!==this.config.linkArrows)&&(this.graph.updateArrows(),null==(o=this.lines)||o.updateArrow()),(u.curvedLinkSegments!==this.config.curvedLinkSegments||u.curvedLinks!==this.config.curvedLinks)&&(null==(s=this.lines)||s.updateCurveLineGeometry()),u.backgroundColor!==this.config.backgroundColor&&(this.store.backgroundColor=Jf(this.config.backgroundColor??Kh)),u.hoveredPointRingColor!==this.config.hoveredPointRingColor&&this.store.setHoveredPointRingColor(this.config.hoveredPointRingColor??Zh.hoveredPointRingColor),u.focusedPointRingColor!==this.config.focusedPointRingColor&&this.store.setFocusedPointRingColor(this.config.focusedPointRingColor??Zh.focusedPointRingColor),u.pointGreyoutColor!==this.config.pointGreyoutColor&&this.store.setGreyoutPointColor(this.config.pointGreyoutColor??Xh),u.hoveredLinkColor!==this.config.hoveredLinkColor&&this.store.setHoveredLinkColor(this.config.hoveredLinkColor??Zh.hoveredLinkColor),u.focusedPointIndex!==this.config.focusedPointIndex&&this.store.setFocusedPoint(this.config.focusedPointIndex),u.pixelRatio!==this.config.pixelRatio&&null!=(a=this.device)&&a.canvasContext){this.device.canvasContext.setProps({useDevicePixels:this.config.pixelRatio});const e=this.device.gl.getParameter(Mh.ALIASED_POINT_SIZE_RANGE);this.store.maxPointSize=((null==e?void 0:e[1])??64)/this.config.pixelRatio}u.spaceSize!==this.config.spaceSize&&(this.store.adjustSpaceSize(this.config.spaceSize,(null==(l=this.device)?void 0:l.limits.maxTextureDimension2D)??4096),this.resizeCanvas(!0),this.update(this.store.isSimulationRunning?this.store.alpha:0)),u.showFPSMonitor!==this.config.showFPSMonitor&&(this.config.showFPSMonitor?this.fpsMonitor=new $_(this.canvas):(null==(c=this.fpsMonitor)||c.destroy(),this.fpsMonitor=void 0)),(u.enableZoom!==this.config.enableZoom||u.enableDrag!==this.config.enableDrag)&&this.updateZoomDragBehaviors(),(u.onLinkClick!==this.config.onLinkClick||u.onLinkMouseOver!==this.config.onLinkMouseOver||u.onLinkMouseOut!==this.config.onLinkMouseOut)&&this.store.updateLinkHoveringEnabled(this.config)}setPointPositions(e,t){this._isDestroyed||this.ensureDevice(()=>this.setPointPositions(e,t))||(this.graph.inputPointPositions=e,this.points.shouldSkipRescale=t,this.isPointPositionsUpdateNeeded=!0,this.isLinksUpdateNeeded=!0,this.isPointColorUpdateNeeded=!0,this.isPointSizeUpdateNeeded=!0,this.isPointShapeUpdateNeeded=!0,this.isPointImageIndicesUpdateNeeded=!0,this.isPointImageSizesUpdateNeeded=!0,this.isPointClusterUpdateNeeded=!0,this.isForceManyBodyUpdateNeeded=!0,this.isForceLinkUpdateNeeded=!0,this.isForceCenterUpdateNeeded=!0)}setPointColors(e){this._isDestroyed||this.ensureDevice(()=>this.setPointColors(e))||(this.graph.inputPointColors=e,this.isPointColorUpdateNeeded=!0)}getPointColors(){return this._isDestroyed?new Float32Array:this.graph.pointColors??new Float32Array}setPointSizes(e){this._isDestroyed||this.ensureDevice(()=>this.setPointSizes(e))||(this.graph.inputPointSizes=e,this.isPointSizeUpdateNeeded=!0)}setPointShapes(e){this._isDestroyed||this.ensureDevice(()=>this.setPointShapes(e))||(this.graph.inputPointShapes=e,this.isPointShapeUpdateNeeded=!0)}setImageData(e){var t;this._isDestroyed||this.ensureDevice(()=>this.setImageData(e))||(this.graph.inputImageData=e,null==(t=this.points)||t.createAtlas())}setPointImageIndices(e){this._isDestroyed||this.ensureDevice(()=>this.setPointImageIndices(e))||(this.graph.inputPointImageIndices=e,this.isPointImageIndicesUpdateNeeded=!0)}setPointImageSizes(e){this._isDestroyed||this.ensureDevice(()=>this.setPointImageSizes(e))||(this.graph.inputPointImageSizes=e,this.isPointImageSizesUpdateNeeded=!0)}getPointSizes(){return this._isDestroyed?new Float32Array:this.graph.pointSizes??new Float32Array}setLinks(e){this._isDestroyed||this.ensureDevice(()=>this.setLinks(e))||(this.graph.inputLinks=e,this.isLinksUpdateNeeded=!0,this.isLinkColorUpdateNeeded=!0,this.isLinkWidthUpdateNeeded=!0,this.isLinkArrowUpdateNeeded=!0,this.isForceLinkUpdateNeeded=!0)}setLinkColors(e){this._isDestroyed||this.ensureDevice(()=>this.setLinkColors(e))||(this.graph.inputLinkColors=e,this.isLinkColorUpdateNeeded=!0)}getLinkColors(){return this._isDestroyed?new Float32Array:this.graph.linkColors??new Float32Array}setLinkWidths(e){this._isDestroyed||this.ensureDevice(()=>this.setLinkWidths(e))||(this.graph.inputLinkWidths=e,this.isLinkWidthUpdateNeeded=!0)}getLinkWidths(){return this._isDestroyed?new Float32Array:this.graph.linkWidths??new Float32Array}setLinkArrows(e){this._isDestroyed||this.ensureDevice(()=>this.setLinkArrows(e))||(this.graph.linkArrowsBoolean=e,this.isLinkArrowUpdateNeeded=!0)}setLinkStrength(e){this._isDestroyed||this.ensureDevice(()=>this.setLinkStrength(e))||(this.graph.inputLinkStrength=e,this.isForceLinkUpdateNeeded=!0)}setPointClusters(e){this._isDestroyed||this.ensureDevice(()=>this.setPointClusters(e))||(this.graph.inputPointClusters=e,this.isPointClusterUpdateNeeded=!0)}setClusterPositions(e){this._isDestroyed||this.ensureDevice(()=>this.setClusterPositions(e))||(this.graph.inputClusterPositions=e,this.isPointClusterUpdateNeeded=!0)}setPointClusterStrength(e){this._isDestroyed||this.ensureDevice(()=>this.setPointClusterStrength(e))||(this.graph.inputClusterStrength=e,this.isPointClusterUpdateNeeded=!0)}setPinnedPoints(e){var t;this._isDestroyed||this.ensureDevice(()=>this.setPinnedPoints(e))||(this.graph.inputPinnedPoints=e&&e.length>0?e:void 0,null==(t=this.points)||t.updatePinnedStatus())}render(e){if(this._isDestroyed||this.ensureDevice(()=>this.render(e)))return;this.graph.update();const{fitViewOnInit:t,fitViewDelay:n,fitViewPadding:i,fitViewDuration:r,fitViewByPointsInRect:o,fitViewByPointIndices:s,initialZoomLevel:a}=this.config;if(!this.graph.pointsNumber&&!this.graph.linksNumber)return this.stopFrames(),Bl(this.canvas).style("cursor",null),void(this.device&&this.device.beginRenderPass({clearColor:this.store.backgroundColor,clearDepth:1,clearStencil:0}).end());this._isFirstRenderAfterInit&&t&&void 0===a&&(this._fitViewOnInitTimeoutID=window.setTimeout(()=>{s?this.fitViewByPointIndices(s,r,i):o?this.setZoomTransformByPointPositions(o,r,void 0,i):this.fitView(r,i)},n)),this.update(e),this.startFrames(),this._isFirstRenderAfterInit=!1}zoomToPointByIndex(e,t=700,n=3,i=!0){if(this._isDestroyed||this.ensureDevice(()=>this.zoomToPointByIndex(e,t,n,i))||!this.device||!this.points||!this.canvasD3Selection)return;const{store:{screenSize:r}}=this,o=ep(this.device,this.points.currentPositionFbo);if(void 0===e)return;const s=o[4*e+0],a=o[4*e+1];if(void 0===s||void 0===a)return;const l=this.zoomInstance.getDistanceToPoint([s,a]),c=i?n:Math.max(this.getZoomLevel(),n);if(l<Math.min(r[0],r[1]))this.setZoomTransformByPointPositions([s,a],t,c);else{const e=this.zoomInstance.getTransform([[s,a]],c),n=this.zoomInstance.getMiddlePointTransform([s,a]);this.canvasD3Selection.transition().ease(Uu).duration(t/2).call(this.zoomInstance.behavior.transform,n).transition().ease(Vu).duration(t/2).call(this.zoomInstance.behavior.transform,e)}}zoom(e,t=0){this._isDestroyed||this.setZoomLevel(e,t)}setZoomLevel(e,t=0){this._isDestroyed||this.ensureDevice(()=>this.setZoomLevel(e,t))||this.canvasD3Selection&&(0===t?this.canvasD3Selection.call(this.zoomInstance.behavior.scaleTo,e):this.canvasD3Selection.transition().duration(t).call(this.zoomInstance.behavior.scaleTo,e))}getZoomLevel(){return this._isDestroyed?0:this.zoomInstance.eventTransform.k}getPointPositions(){if(this._isDestroyed||!this.device||!this.points)return[];if(void 0===this.graph.pointsNumber)return[];const e=[],t=ep(this.device,this.points.currentPositionFbo);e.length=2*this.graph.pointsNumber;for(let n=0;n<this.graph.pointsNumber;n+=1){const i=t[4*n+0],r=t[4*n+1];void 0!==i&&void 0!==r&&(e[2*n]=i,e[2*n+1]=r)}return e}getClusterPositions(){if(this._isDestroyed||!this.device||!this.clusters)return[];if(void 0===this.graph.pointClusters||void 0===this.clusters.clusterCount)return[];this.clusters.calculateCentermass();const e=[],t=ep(this.device,this.clusters.centermassFbo);e.length=2*this.clusters.clusterCount;for(let n=0;n<e.length/2;n+=1){const i=t[4*n+0],r=t[4*n+1],o=t[4*n+2];void 0!==i&&void 0!==r&&void 0!==o&&(e[2*n]=i/o,e[2*n+1]=r/o)}return e}fitView(e=250,t=.1){this._isDestroyed||this.ensureDevice(()=>this.fitView(e,t))||this.setZoomTransformByPointPositions(this.getPointPositions(),e,void 0,t)}fitViewByPointIndices(e,t=250,n=.1){if(this._isDestroyed||this.ensureDevice(()=>this.fitViewByPointIndices(e,t,n)))return;const i=this.getPointPositions(),r=new Array(2*e.length);for(const[o,s]of e.entries())r[2*o]=i[2*s],r[2*o+1]=i[2*s+1];this.setZoomTransformByPointPositions(r,t,void 0,n)}fitViewByPointPositions(e,t=250,n=.1){this._isDestroyed||this.ensureDevice(()=>this.fitViewByPointPositions(e,t,n))||this.setZoomTransformByPointPositions(e,t,void 0,n)}getPointsInRect(e){if(this._isDestroyed||!this.device||!this.points)return new Float32Array;const t=this.store.screenSize[1];return this.store.selectedArea=[[e[0][0],t-e[1][1]],[e[1][0],t-e[0][1]]],this.points.findPointsOnAreaSelection(),ep(this.device,this.points.selectedFbo).map((e,t)=>t%4==0&&0!==e?t/4:-1).filter(e=>-1!==e)}getPointsInRange(e){return this.getPointsInRect(e)}getPointsInPolygon(e){if(this._isDestroyed||!this.device||!this.points)return new Float32Array;if(e.length<3)return new Float32Array;const t=this.store.screenSize[1],n=e.map(([e,n])=>[e,t-n]);return this.points.updatePolygonPath(n),this.points.findPointsOnPolygonSelection(),ep(this.device,this.points.selectedFbo).map((e,t)=>t%4==0&&0!==e?t/4:-1).filter(e=>-1!==e)}selectPointsInRect(e){if(!this._isDestroyed&&!this.ensureDevice(()=>this.selectPointsInRect(e))&&this.device&&this.points){if(e){const t=this.store.screenSize[1];this.store.selectedArea=[[e[0][0],t-e[1][1]],[e[1][0],t-e[0][1]]],this.points.findPointsOnAreaSelection();const n=ep(this.device,this.points.selectedFbo);this.store.selectedIndices=n.map((e,t)=>t%4==0&&0!==e?t/4:-1).filter(e=>-1!==e)}else this.store.selectedIndices=null;this.points.updateGreyoutStatus()}}selectPointsInRange(e){return this.selectPointsInRect(e)}selectPointsInPolygon(e){if(!this._isDestroyed&&!this.ensureDevice(()=>this.selectPointsInPolygon(e))&&this.device&&this.points){if(e){if(e.length<3)return;const t=this.store.screenSize[1],n=e.map(([e,n])=>[e,t-n]);this.points.updatePolygonPath(n),this.points.findPointsOnPolygonSelection();const i=ep(this.device,this.points.selectedFbo);this.store.selectedIndices=i.map((e,t)=>t%4==0&&0!==e?t/4:-1).filter(e=>-1!==e)}else this.store.selectedIndices=null;this.points.updateGreyoutStatus()}}selectPointByIndex(e,t=!1){if(!this._isDestroyed&&!this.ensureDevice(()=>this.selectPointByIndex(e,t)))if(t){const t=this.graph.getAdjacentIndices(e)??[];this.selectPointsByIndices([e,...t])}else this.selectPointsByIndices([e])}selectPointsByIndices(e){this._isDestroyed||this.ensureDevice(()=>this.selectPointsByIndices(e))||this.points&&(e?0===e.length?this.store.selectedIndices=new Float32Array:this.store.selectedIndices=new Float32Array(e.filter(e=>void 0!==e)):this.store.selectedIndices=null,this.points.updateGreyoutStatus())}unselectPoints(){this._isDestroyed||this.ensureDevice(()=>this.unselectPoints())||this.points&&(this.store.selectedIndices=null,this.points.updateGreyoutStatus())}getSelectedIndices(){if(this._isDestroyed)return null;const{selectedIndices:e}=this.store;return e?Array.from(e):null}getAdjacentIndices(e){if(!this._isDestroyed)return this.graph.getAdjacentIndices(e)}spaceToScreenPosition(e){return this._isDestroyed?[0,0]:this.zoomInstance.convertSpaceToScreenPosition(e)}screenToSpacePosition(e){return this._isDestroyed?[0,0]:this.zoomInstance.convertScreenToSpacePosition(e)}spaceToScreenRadius(e){return this._isDestroyed?0:this.zoomInstance.convertSpaceToScreenRadius(e)}getPointRadiusByIndex(e){var t;if(!this._isDestroyed)return null==(t=this.graph.pointSizes)?void 0:t[e]}trackPointPositionsByIndices(e){this._isDestroyed||this.ensureDevice(()=>this.trackPointPositionsByIndices(e))||this.points&&this.points.trackPointsByIndices(e)}getTrackedPointPositionsMap(){return this._isDestroyed||!this.points?new Map:this.points.getTrackedPositionsMap()}getTrackedPointPositionsArray(){return this._isDestroyed||!this.points?[]:this.points.getTrackedPositionsArray()}getSampledPointPositionsMap(){return this._isDestroyed||!this.points?new Map:this.points.getSampledPointPositionsMap()}getSampledPoints(){return this._isDestroyed||!this.points?{indices:[],positions:[]}:this.points.getSampledPoints()}getScaleX(){if(!this._isDestroyed&&this.points)return this.points.scaleX}getScaleY(){if(!this._isDestroyed&&this.points)return this.points.scaleY}start(e=1){var t,n;this._isDestroyed||this.ensureDevice(()=>this.start(e))||this.graph.pointsNumber&&(this.store.isSimulationRunning=!0,this.store.simulationProgress=0,this.store.alpha=e,null==(n=(t=this.config).onSimulationStart)||n.call(t))}stop(){var e,t;this._isDestroyed||(this.store.isSimulationRunning=!1,this.store.simulationProgress=0,this.store.alpha=0,null==(t=(e=this.config).onSimulationEnd)||t.call(e))}pause(){var e,t;this._isDestroyed||this.ensureDevice(()=>this.pause())||(this.store.isSimulationRunning=!1,null==(t=(e=this.config).onSimulationPause)||t.call(e))}unpause(){var e,t;this._isDestroyed||this.ensureDevice(()=>this.unpause())||(this.store.isSimulationRunning=!0,null==(t=(e=this.config).onSimulationUnpause)||t.call(e))}restart(){var e,t;this._isDestroyed||this.ensureDevice(()=>this.restart())||(this.store.isSimulationRunning=!0,null==(t=(e=this.config).onSimulationRestart)||t.call(e))}step(){this._isDestroyed||this.ensureDevice(()=>this.step())||this.config.enableSimulation&&this.store.pointsTextureSize&&this.runSimulationStep(!0)}destroy(){var e,t,n,i,r,o,s,a,l,c,u,d,h;this._isDestroyed||(this._isDestroyed=!0,window.clearTimeout(this._fitViewOnInitTimeoutID),this.stopFrames(),this.canvasD3Selection&&this.canvasD3Selection.on("mouseenter.cosmos",null).on("mousemove.cosmos",null).on("mouseleave.cosmos",null).on("click",null).on("mousemove",null).on("contextmenu",null).on(".drag",null).on(".zoom",null),Bl(document).on("keydown.cosmos",null).on("keyup.cosmos",null),null!=(e=this.zoomInstance)&&e.behavior&&this.zoomInstance.behavior.on("start.detect",null).on("zoom.detect",null).on("end.detect",null),null!=(t=this.dragInstance)&&t.behavior&&this.dragInstance.behavior.on("start.detect",null).on("drag.detect",null).on("end.detect",null),null==(n=this.fpsMonitor)||n.destroy(),null==(i=this.points)||i.destroy(),null==(r=this.lines)||r.destroy(),null==(o=this.clusters)||o.destroy(),null==(s=this.forceGravity)||s.destroy(),null==(a=this.forceCenter)||a.destroy(),null==(l=this.forceManyBody)||l.destroy(),null==(c=this.forceLinkIncoming)||c.destroy(),null==(u=this.forceLinkOutgoing)||u.destroy(),null==(d=this.forceMouse)||d.destroy(),this.device&&(this.device.beginRenderPass({clearColor:this.store.backgroundColor,clearDepth:1,clearStencil:0}).end(),this.device.destroy()),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.attributionDivElement&&this.attributionDivElement.parentNode&&this.attributionDivElement.parentNode.removeChild(this.attributionDivElement),null==(h=document.getElementById("gl-bench-style"))||h.remove(),this.canvasD3Selection=void 0,this.attributionDivElement=void 0)}create(){var e,t,n,i,r;this._isDestroyed||this.ensureDevice(()=>this.create())||this.points&&this.lines&&(this.isPointPositionsUpdateNeeded&&this.points.updatePositions(),this.isPointColorUpdateNeeded&&this.points.updateColor(),this.isPointSizeUpdateNeeded&&this.points.updateSize(),this.isPointShapeUpdateNeeded&&this.points.updateShape(),this.isPointImageIndicesUpdateNeeded&&this.points.updateImageIndices(),this.isPointImageSizesUpdateNeeded&&this.points.updateImageSizes(),this.isLinksUpdateNeeded&&this.lines.updatePointsBuffer(),this.isLinkColorUpdateNeeded&&this.lines.updateColor(),this.isLinkWidthUpdateNeeded&&this.lines.updateWidth(),this.isLinkArrowUpdateNeeded&&this.lines.updateArrow(),this.isForceManyBodyUpdateNeeded&&(null==(e=this.forceManyBody)||e.create()),this.isForceLinkUpdateNeeded&&(null==(t=this.forceLinkIncoming)||t.create(M_.INCOMING),null==(n=this.forceLinkOutgoing)||n.create(M_.OUTGOING)),this.isForceCenterUpdateNeeded&&(null==(i=this.forceCenter)||i.create()),this.isPointClusterUpdateNeeded&&(null==(r=this.clusters)||r.create()),this.isPointPositionsUpdateNeeded=!1,this.isPointColorUpdateNeeded=!1,this.isPointSizeUpdateNeeded=!1,this.isPointShapeUpdateNeeded=!1,this.isPointImageIndicesUpdateNeeded=!1,this.isPointImageSizesUpdateNeeded=!1,this.isLinksUpdateNeeded=!1,this.isLinkColorUpdateNeeded=!1,this.isLinkWidthUpdateNeeded=!1,this.isLinkArrowUpdateNeeded=!1,this.isPointClusterUpdateNeeded=!1,this.isForceManyBodyUpdateNeeded=!1,this.isForceLinkUpdateNeeded=!1,this.isForceCenterUpdateNeeded=!1)}flatten(e){return e.flat()}pair(e){const t=new Array(e.length/2);for(let n=0;n<e.length/2;n++)t[n]=[e[2*n],e[2*n+1]];return t}ensureDevice(e){return!this.device&&(this.deviceInitPromise.then(()=>{this._isDestroyed||e()}).catch(e=>{}),!0)}validateDevice(e){const t=e.canvasContext;if(null===t||"offscreen-canvas"===t.type)throw new Error("Device must have an HTMLCanvasElement canvas context. OffscreenCanvas and compute-only devices are not supported.");return t}async createDevice(e){return await Qd.createDevice({type:"webgl",adapters:[qh],createCanvasContext:{canvas:e,useDevicePixels:this.config.pixelRatio,autoResize:!0,width:void 0,height:void 0}})}update(e=this.store.alpha){const{graph:t}=this;this.store.pointsTextureSize=Math.ceil(Math.sqrt(t.pointsNumber??0)),this.store.linksTextureSize=Math.ceil(Math.sqrt(2*(t.linksNumber??0))),this.create(),this.initPrograms(),this.store.hoveredPoint=void 0,this.store.alpha=e}runSimulationStep(e=!1){var t,n,i,r,o,s,a,l,c,u,d,h,f,p,m,g,_,y,v;const{config:{simulationGravity:b,simulationCenter:x,enableSimulation:w},store:{isSimulationRunning:S}}=this;w&&(this.isRightClickMouse&&this.config.enableRightClickRepulsion&&(null==(t=this.forceMouse)||t.run(),null==(n=this.points)||n.updatePosition()),(e||S&&!(this.zoomInstance.isRunning&&!this.config.enableSimulationDuringZoom))&&(b&&(null==(i=this.forceGravity)||i.run(),null==(r=this.points)||r.updatePosition()),x&&(null==(o=this.forceCenter)||o.run(),null==(s=this.points)||s.updatePosition()),null==(a=this.forceManyBody)||a.run(),null==(l=this.points)||l.updatePosition(),this.store.linksTextureSize&&(null==(c=this.forceLinkIncoming)||c.run(),null==(u=this.points)||u.updatePosition(),null==(d=this.forceLinkOutgoing)||d.run(),null==(h=this.points)||h.updatePosition()),(this.graph.pointClusters||this.graph.clusterPositions)&&(null==(f=this.clusters)||f.run(),null==(p=this.points)||p.updatePosition()),this.store.alpha+=this.store.addAlpha(this.config.simulationDecay??Zh.simulation.decay),this.isRightClickMouse&&this.config.enableRightClickRepulsion&&(this.store.alpha=Math.max(this.store.alpha,.1)),this.store.simulationProgress=Math.sqrt(Math.min(1,vv/this.store.alpha)),null==(y=(_=this.config).onSimulationTick)||y.call(_,this.store.alpha,null==(m=this.store.hoveredPoint)?void 0:m.index,null==(g=this.store.hoveredPoint)?void 0:g.position)),null==(v=this.points)||v.trackPoints())}initPrograms(){var e,t,n,i,r,o;this._isDestroyed||!this.points||!this.lines||!this.clusters||(this.points.initPrograms(),this.lines.initPrograms(),null==(e=this.forceGravity)||e.initPrograms(),null==(t=this.forceManyBody)||t.initPrograms(),null==(n=this.forceCenter)||n.initPrograms(),null==(i=this.forceLinkIncoming)||i.initPrograms(),null==(r=this.forceLinkOutgoing)||r.initPrograms(),null==(o=this.forceMouse)||o.initPrograms(),this.clusters.initPrograms())}frame(){if(this._isDestroyed)return;const{store:{alpha:e,isSimulationRunning:t}}=this;e<vv&&t&&this.end(),this.requestAnimationFrameId=window.requestAnimationFrame(e=>{this.renderFrame(e),this._isDestroyed||this.frame()})}renderFrame(e){var t,n,i,r,o,s,a;if(!this._isDestroyed&&this.store.pointsTextureSize){if(null==(t=this.fpsMonitor)||t.begin(),this.resizeCanvas(),this.dragInstance.isActive||this.findHoveredItem(),this.runSimulationStep(!1),this.device){const e=this.store.backgroundColor??[0,0,0,1],t=this.device.beginRenderPass({clearColor:e,clearDepth:1,clearStencil:0}),{config:{renderLinks:a}}=this;!1!==a&&!!this.store.linksTextureSize&&!!this.graph.linksNumber&&this.graph.linksNumber>0&&(null==(n=this.lines)||n.draw(t)),null==(i=this.points)||i.draw(t),this.dragInstance.isActive&&(null==(r=this.points)||r.drag(),null==(o=this.points)||o.drag(),null==(s=this.points)||s.trackPoints()),t.end(),this.device.submit()}null==(a=this.fpsMonitor)||a.end(e??performance.now()),this.currentEvent=void 0}}stopFrames(){this.requestAnimationFrameId&&(window.cancelAnimationFrame(this.requestAnimationFrameId),this.requestAnimationFrameId=0)}startFrames(){this._isDestroyed||(this.stopFrames(),this.frame())}end(){var e,t;this.store.isSimulationRunning=!1,this.store.simulationProgress=1,null==(t=(e=this.config).onSimulationEnd)||t.call(e)}onClick(e){var t,n,i,r,o,s,a,l,c,u;null==(r=(i=this.config).onClick)||r.call(i,null==(t=this.store.hoveredPoint)?void 0:t.index,null==(n=this.store.hoveredPoint)?void 0:n.position,e),this.store.hoveredPoint?null==(s=(o=this.config).onPointClick)||s.call(o,this.store.hoveredPoint.index,this.store.hoveredPoint.position,e):void 0!==this.store.hoveredLinkIndex?null==(l=(a=this.config).onLinkClick)||l.call(a,this.store.hoveredLinkIndex,e):null==(u=(c=this.config).onBackgroundClick)||u.call(c,e)}updateMousePosition(e){if(!e)return;const t=e.offsetX??e.x,n=e.offsetY??e.y;void 0===t||void 0===n||(this.store.mousePosition=this.zoomInstance.convertScreenToSpacePosition([t,n]),this.store.screenMousePosition=[t,this.store.screenSize[1]-n])}onMouseMove(e){var t,n,i,r;this.currentEvent=e,this.updateMousePosition(e),this.isRightClickMouse=3===e.which,null==(r=(i=this.config).onMouseMove)||r.call(i,null==(t=this.store.hoveredPoint)?void 0:t.index,null==(n=this.store.hoveredPoint)?void 0:n.position,this.currentEvent)}onRightClickMouse(e){e.preventDefault()}resizeCanvas(e=!1){var t,n,i;if(this._isDestroyed)return;const r=this.canvas.clientWidth,o=this.canvas.clientHeight,[s,a]=this.store.screenSize;if(e||s!==r||a!==o){const{k:e}=this.zoomInstance.eventTransform,l=this.zoomInstance.convertScreenToSpacePosition([s/2,a/2]);this.store.updateScreenSize(r,o),null==(t=this.canvasD3Selection)||t.call(this.zoomInstance.behavior.transform,this.zoomInstance.getTransform([l],e)),null==(n=this.points)||n.updateSampledPointsGrid(),this.store.isLinkHoveringEnabled&&(null==(i=this.lines)||i.updateLinkIndexFbo())}}setZoomTransformByPointPositions(e,t=250,n,i){var r;this.resizeCanvas();const o=this.zoomInstance.getTransform(this.pair(e),n,i);null==(r=this.canvasD3Selection)||r.transition().ease(Hu).duration(t).call(this.zoomInstance.behavior.transform,o)}updateZoomDragBehaviors(){var e,t,n,i;this.config.enableDrag?null==(e=this.canvasD3Selection)||e.call(this.dragInstance.behavior):null==(t=this.canvasD3Selection)||t.call(this.dragInstance.behavior).on(".drag",null),this.config.enableZoom?null==(n=this.canvasD3Selection)||n.call(this.zoomInstance.behavior):null==(i=this.canvasD3Selection)||i.call(this.zoomInstance.behavior).on("wheel.zoom",null)}findHoveredItem(){if(!this._isDestroyed&&this._isMouseOnCanvas){if(this._findHoveredItemExecutionCount<4)return void(this._findHoveredItemExecutionCount+=1);if(this._findHoveredItemExecutionCount=0,this.findHoveredPoint(),this.graph.linksNumber&&this.store.isLinkHoveringEnabled)this.findHoveredLine();else if(void 0!==this.store.hoveredLinkIndex){const e=void 0!==this.store.hoveredLinkIndex;this.store.hoveredLinkIndex=void 0,e&&this.config.onLinkMouseOut&&this.config.onLinkMouseOut(this.currentEvent)}this.updateCanvasCursor()}}findHoveredPoint(){var e,t,n,i;if(this._isDestroyed||!this.device||!this.points)return;this.points.findHoveredPoint();let r=!1,o=!1;const s=ep(this.device,this.points.hoveredFbo,0,0,2,2),a=s[0],l=s[1],c=s[2],u=s[3];l>0?((void 0===this.store.hoveredPoint||this.store.hoveredPoint.index!==a)&&(r=!0),this.store.hoveredPoint={index:a,position:[c,u]}):(this.store.hoveredPoint&&(o=!0),this.store.hoveredPoint=void 0),r&&this.store.hoveredPoint&&(null==(t=(e=this.config).onPointMouseOver)||t.call(e,this.store.hoveredPoint.index,this.store.hoveredPoint.position,this.currentEvent)),o&&(null==(i=(n=this.config).onPointMouseOut)||i.call(n,this.currentEvent))}findHoveredLine(){var e,t,n,i,r,o;if(this._isDestroyed||!this.lines)return;if(this.store.hoveredPoint)return void(void 0!==this.store.hoveredLinkIndex&&(this.store.hoveredLinkIndex=void 0,null==(t=(e=this.config).onLinkMouseOut)||t.call(e,this.currentEvent)));this.lines.findHoveredLine();let s=!1,a=!1;if(!this.device)return;const l=ep(this.device,this.lines.hoveredLineIndexFbo)[0];l>=0?(this.store.hoveredLinkIndex!==l&&(s=!0),this.store.hoveredLinkIndex=l):(void 0!==this.store.hoveredLinkIndex&&(a=!0),this.store.hoveredLinkIndex=void 0),s&&void 0!==this.store.hoveredLinkIndex&&(null==(i=(n=this.config).onLinkMouseOver)||i.call(n,this.store.hoveredLinkIndex)),a&&(null==(o=(r=this.config).onLinkMouseOut)||o.call(r,this.currentEvent))}updateCanvasCursor(){const{hoveredPointCursor:e,hoveredLinkCursor:t}=this.config;this.dragInstance.isActive?Bl(this.canvas).style("cursor","grabbing"):this.store.hoveredPoint?!this.config.enableDrag||this.store.isSpaceKeyPressed?Bl(this.canvas).style("cursor",e):Bl(this.canvas).style("cursor","grab"):this.store.isLinkHoveringEnabled&&void 0!==this.store.hoveredLinkIndex?Bl(this.canvas).style("cursor",t):Bl(this.canvas).style("cursor",null)}addAttribution(){var e;this.config.attribution&&(this.attributionDivElement=document.createElement("div"),this.attributionDivElement.style.cssText="\n      user-select: none;\n      position: absolute;\n      bottom: 0;\n      right: 0;\n      color: var(--cosmosgl-attribution-color);\n      margin: 0 0.6rem 0.6rem 0;\n      font-size: 0.7rem;\n      font-family: inherit;\n    ",this.attributionDivElement.innerHTML=function(e){return Kf.sanitize(e,{ALLOWED_TAGS:["a","b","i","em","strong","span","div","p","br"],ALLOWED_ATTR:["href","target","class","id","style"],ALLOW_DATA_ATTR:!1,ALLOWED_TAGS:["a","b","i","em","strong","span","div","p","br","img"],ALLOWED_ATTR:["href","target","class","id","style","src","alt","title"]})}(this.config.attribution),null==(e=this.store.div)||e.appendChild(this.attributionDivElement))}}const qv={};function Xv(e,t=!1){let n,i,r=qv;function o(t){var r;n=(null==(r=e(t))?void 0:r.catch(()=>{}).finally(()=>{if(i){const{event:e}=i;i=null,o(e)}else n=null}))||null}function s(e){n?function(e){i={event:e}}(e):o(e)}return t?function(e){r!==e&&requestAnimationFrame(()=>{const e=r;r=qv,s(e)}),r=e}:s}class Kv{constructor(e){s(this,"_filterBy"),s(this,"_requestUpdate"),s(this,"_coordinator"),s(this,"_pending"),s(this,"_enabled"),s(this,"_initialized"),s(this,"_request"),this._filterBy=e,this._requestUpdate=Xv(()=>this.requestQuery(),!0),this._coordinator=null,this._pending=Promise.resolve(),this._enabled=!0,this._initialized=!1,this._request=null}get coordinator(){return this._coordinator}set coordinator(e){this._coordinator=e}get enabled(){return this._enabled}set enabled(e){e=!!e,this._enabled!==e&&(this._enabled=e,e&&(this._initialized?this._request&&this.requestQuery(!0===this._request?void 0:this._request):this.initialize(),this._request=null))}get pending(){return this._pending}get filterBy(){return this._filterBy}get filterStable(){return!0}async prepare(){}query(e){return null}queryPending(){return this}queryResult(e){return this}queryError(e){return this}requestQuery(e){var t;if(this._enabled){const n=e||this.query(null==(t=this.filterBy)?void 0:t.predicate(this));return this._coordinator.requestQuery(this,n)}return this._request=e??!0,null}requestUpdate(){this._enabled?this._requestUpdate():this.requestQuery()}initialize(){this._enabled?this._coordinator&&(this._initialized=!0,this._pending=this.prepare().then(()=>this.requestQuery())):this._initialized=!1}destroy(){var e;this._enabled=!1,null==(e=this.coordinator)||e.disconnect(this)}update(){return this}}const Zv=Uint8Array.of(65,82,82,79,87,49),Qv={NONE:0,Schema:1,DictionaryBatch:2,RecordBatch:3,Tensor:4,SparseTensor:5},Jv={Dictionary:-1,NONE:0,Null:1,Int:2,Float:3,Binary:4,Utf8:5,Bool:6,Decimal:7,Date:8,Time:9,Timestamp:10,Interval:11,List:12,Struct:13,Union:14,FixedSizeBinary:15,FixedSizeList:16,Map:17,Duration:18,LargeBinary:19,LargeUtf8:20,LargeList:21,RunEndEncoded:22,BinaryView:23,Utf8View:24,ListView:25,LargeListView:26},eb={HALF:0,SINGLE:1,DOUBLE:2},tb={DAY:0,MILLISECOND:1},nb={SECOND:0,MILLISECOND:1,MICROSECOND:2,NANOSECOND:3},ib={YEAR_MONTH:0,DAY_TIME:1,MONTH_DAY_NANO:2},rb={Sparse:0,Dense:1},ob={LZ4_FRAME:0,ZSTD:1},sb=Uint8Array,ab=Uint16Array,lb=Uint32Array,cb=BigUint64Array,ub=Int8Array,db=Int16Array,hb=Int32Array,fb=BigInt64Array,pb=Float32Array,mb=Float64Array;function gb(e,t){const n=Math.log2(e)-3;return(t?[ub,db,hb,fb]:[sb,ab,lb,cb])[n]}function _b(e,t){let n=0,i=e.length;if(i<=2147483648)do{const r=n+i>>>1;e[r]<=t?n=r+1:i=r}while(n<i);else do{const r=Math.trunc((n+i)/2);e[r]<=t?n=r+1:i=r}while(n<i);return n}function yb(e,t,n){if(t(e))return e;throw new Error(n(e))}function vb(e,t,n){return t=Array.isArray(t)?t:Object.values(t),yb(e,e=>t.includes(e),n??(()=>`${e} must be one of ${t}`))}function bb(e,t){for(const[n,i]of Object.entries(e))if(i===t)return n;return"<Unknown>"}const xb=e=>`Unsupported data type: "${bb(Jv,e)}" (id ${e})`,wb=(e,t,n=!0,i=null)=>({name:e,type:t,nullable:n,metadata:i});function Sb(e){return Object.hasOwn(e,"name")&&Eb(e.type)}function Eb(e){return"number"==typeof(null==e?void 0:e.typeId)}function Cb(e,t="",n=!0){return Sb(e)?e:wb(t,yb(e,Eb,()=>"Data type expected."),n)}const Tb=(e=32,t=!0)=>({typeId:Jv.Int,bitWidth:vb(e,[8,16,32,64]),signed:t,values:gb(e,t)}),kb=()=>Tb(32),Ib=new mb(2).buffer;function Ab(e){if(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)throw Error(`BigInt exceeds integer number representation: ${e}`);return Number(e)}function Lb(e,t){return Number(e/t)+Number(e%t)/Number(t)}new fb(Ib);const Rb=e=>BigInt.asUintN(64,e);function Pb(e,t){return BigInt.asIntN(64,e[t])}function Mb(e,t){const n=t<<1;let i;return BigInt.asIntN(64,e[n+1])<0?(i=Rb(~e[n])|Rb(~e[n+1])<<64n,i=-(i+1n)):i=e[n]|e[n+1]<<64n,i}function Db(e,t){const n=t<<2;let i;return BigInt.asIntN(64,e[n+3])<0?(i=Rb(~e[n])|Rb(~e[n+1])<<64n|Rb(~e[n+2])<<128n|Rb(~e[n+3])<<192n,i=-(i+1n)):i=e[n]|e[n+1]<<64n|e[n+2]<<128n|e[n+3]<<192n,i}const Nb=new TextDecoder("utf-8");function Fb(e){return Nb.decode(e)}function Ob(e,t){return!!(e[t>>3]&1<<t%8)}function Bb(e,t){const n=t+$b(e,t),i=n-$b(e,n),r=Wb(e,i);return(t,o,s=null)=>{if(t<r){const r=Wb(e,i+t);if(r)return o(e,n+r)}return s}}function zb(e,t){return t}function Ub(e,t){return!!Vb(e,t)}function Vb(e,t){return Hb(e,t)<<24>>24}function Hb(e,t){return e[t]}function Wb(e,t){return function(e,t){return e[t]|e[t+1]<<8}(e,t)<<16>>16}function $b(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24}function Gb(e,t){return $b(e,t)>>>0}function jb(e,t){return Ab(BigInt.asIntN(64,BigInt(Gb(e,t))+(BigInt(Gb(e,t+4))<<32n)))}function Yb(e,t){let n=t+$b(e,t);const i=$b(e,n);return n+=4,Fb(e.subarray(n,n+i))}function qb(e,t,n,i){if(!t)return[];const r=t+$b(e,t);return Array.from({length:$b(e,r)},(t,o)=>i(e,r+4+o*n))}new TextEncoder;const Xb=Symbol("rowIndex");function Kb(e,t){class n{constructor(e){this[Xb]=e}toJSON(){return Qb(e,t,this[Xb])}}const i=n.prototype;for(let r=0;r<e.length;++r){if(Object.hasOwn(i,e[r]))continue;const n=t[r];Object.defineProperty(i,e[r],{get(){return n.at(this[Xb])},enumerable:!0})}return e=>new n(e)}function Zb(e,t){return n=>Qb(e,t,n)}function Qb(e,t,n){const i={};for(let r=0;r<e.length;++r)i[e[r]]=t[r].at(n);return i}class Jb{constructor({length:e,nullCount:t,type:n,validity:i,values:r,offsets:o,sizes:s,children:a}){this.length=e,this.nullCount=t,this.type=n,this.validity=i,this.values=r,this.offsets=o,this.sizes=s,this.children=a,t&&this.validity||(this.at=e=>this.value(e))}get[Symbol.toStringTag](){return"Batch"}at(e){return this.isValid(e)?this.value(e):null}isValid(e){return Ob(this.validity,e)}value(e){return this.values[e]}slice(e,t){const n=t-e,i=Array(n);for(let r=0;r<n;++r)i[r]=this.at(e+r);return i}*[Symbol.iterator](){for(let e=0;e<this.length;++e)yield this.at(e)}}s(Jb,"ArrayType",null);class ex extends Jb{constructor(e){super(e);const{length:t,values:n}=this;this.values=n.subarray(0,t)}slice(e,t){return this.nullCount?super.slice(e,t):this.values.subarray(e,t)}[Symbol.iterator](){return this.nullCount?super[Symbol.iterator]():this.values[Symbol.iterator]()}}class tx extends Jb{}s(tx,"ArrayType",mb);class nx extends Jb{}s(nx,"ArrayType",Array);class ix extends nx{value(e){return null}}class rx extends tx{value(e){return Ab(this.values[e])}}class ox extends tx{value(e){const t=this.values[e],n=(31744&t)>>10,i=(1023&t)/1024,r=(-1)**((32768&t)>>15);switch(n){case 31:return r*(i?Number.NaN:1/0);case 0:return r*(i?6103515625e-14*i:0)}return r*2**(n-15)*(1+i)}}class sx extends nx{value(e){return Ob(this.values,e)}}class ax extends tx{constructor(e){super(e);const{scale:t}=this.type;this.scale=10**t}value(e){return this.values[e]/this.scale}}class lx extends Jb{constructor(e){super(e);const{bitWidth:t,scale:n}=this.type;this.decimal=64===t?Pb:128===t?Mb:Db,this.scale=10n**BigInt(n)}}class cx extends lx{value(e){return Lb(this.decimal(this.values,e),this.scale)}}s(cx,"ArrayType",mb);class ux extends lx{value(e){return this.decimal(this.values,e)}}s(ux,"ArrayType",Array);class dx extends nx{constructor(e){super(e),this.source=e}value(e){return new Date(this.source.value(e))}}class hx extends tx{value(e){return 864e5*this.values[e]}}const fx=rx;class px extends rx{value(e){return 1e3*super.value(e)}}const mx=rx;class gx extends rx{value(e){return Lb(this.values[e],1000n)}}class _x extends rx{value(e){return Lb(this.values[e],1000000n)}}class yx extends nx{value(e){return this.values.subarray(e<<1,e+1<<1)}}class vx extends nx{value(e){const t=this.values,n=e<<4;return Float64Array.of($b(t,n),$b(t,n+4),jb(t,n+8))}}const bx=({values:e,offsets:t},n)=>e.subarray(t[n],t[n+1]),xx=({values:e,offsets:t},n)=>e.subarray(Ab(t[n]),Ab(t[n+1]));class wx extends nx{value(e){return bx(this,e)}}class Sx extends nx{value(e){return xx(this,e)}}class Ex extends nx{value(e){return Fb(bx(this,e))}}class Cx extends nx{value(e){return Fb(xx(this,e))}}class Tx extends nx{value(e){const t=this.offsets;return this.children[0].slice(t[e],t[e+1])}}class kx extends nx{value(e){const t=this.offsets;return this.children[0].slice(Ab(t[e]),Ab(t[e+1]))}}class Ix extends nx{value(e){const t=this.offsets[e],n=t+this.sizes[e];return this.children[0].slice(t,n)}}class Ax extends nx{value(e){const t=this.offsets[e],n=t+this.sizes[e];return this.children[0].slice(Ab(t),Ab(n))}}class Lx extends nx{constructor(e){super(e),this.stride=this.type.stride}}class Rx extends Lx{value(e){const{stride:t,values:n}=this;return n.subarray(e*t,(e+1)*t)}}class Px extends Lx{value(e){const{children:t,stride:n}=this;return t[0].slice(e*n,(e+1)*n)}}function Mx({children:e,offsets:t},n){const[i,r]=e[0].children,o=t[n],s=t[n+1],a=[];for(let l=o;l<s;++l)a.push([i.at(l),r.at(l)]);return a}class Dx extends nx{value(e){return Mx(this,e)}}class Nx extends nx{value(e){return new Map(Mx(this,e))}}class Fx extends nx{constructor({typeIds:e,...t}){super(t),this.typeIds=e,this.typeMap=this.type.typeMap}value(e,t=e){const{typeIds:n,children:i,typeMap:r}=this;return i[r[n[e]]].at(t)}}class Ox extends Fx{value(e){return super.value(e,this.offsets[e])}}class Bx extends nx{constructor(e,t=Zb){super(e),this.names=this.type.children.map(e=>e.name),this.factory=t(this.names,this.children)}value(e){return this.factory(e)}}class zx extends Bx{constructor(e){super(e,Kb)}}class Ux extends nx{value(e){const[{values:t},n]=this.children;return n.at(_b(t,e))}}let Vx=class extends nx{setDictionary(e){return this.dictionary=e,this.cache=e.cache(),this}value(e){return this.cache[this.key(e)]}key(e){return this.values[e]}};class Hx extends nx{constructor({data:e,...t}){super(t),this.data=e}view(e){const{values:t,data:n}=this,i=e<<4;let r=i+4,o=t;const s=$b(o,i);return s>12&&(r=$b(o,i+12),o=n[$b(o,i+8)]),o.subarray(r,r+s)}}class Wx extends Hx{value(e){return this.view(e)}}class $x extends Hx{value(e){return Fb(this.view(e))}}function Gx(e){let t=[];return{add(e){return t.push(e),this},clear:()=>t=[],done:()=>new jx(t,e)}}class jx{constructor(e,t=(t=>null==(t=e[0])?void 0:t.type)()){this.type=t,this.length=e.reduce((e,t)=>e+t.length,0),this.nullCount=e.reduce((e,t)=>e+t.nullCount,0),this.data=e;const n=e.length,i=new Int32Array(n+1);if(1===n){const[t]=e;i[1]=t.length,this.at=e=>t.at(e)}else for(let r=0,o=0;r<n;++r)i[r+1]=o+=e[r].length;this.offsets=i}get[Symbol.toStringTag](){return"Column"}[Symbol.iterator](){const e=this.data;return 1===e.length?e[0][Symbol.iterator]():function*(e){for(let t=0;t<e.length;++t){const n=e[t][Symbol.iterator]();for(let e=n.next();!e.done;e=n.next())yield e.value}}(e)}at(e){var t;const{data:n,offsets:i}=this,r=_b(i,e)-1;return null==(t=n[r])?void 0:t.at(e-i[r])}get(e){return this.at(e)}toArray(){const{length:e,nullCount:t,data:n}=this,i=!t&&n[0]instanceof ex,r=n.length;if(i&&1===r)return n[0].values;const o=new(!r||t>0?Array:n[0].constructor.ArrayType??n[0].values.constructor)(e);return i?function(e,t){for(let n=0,i=0;n<t.length;++n){const{values:r}=t[n];e.set(r,i),i+=r.length}return e}(o,n):function(e,t){let n=-1;for(let i=0;i<t.length;++i){const r=t[i];for(let t=0;t<r.length;++t)e[++n]=r.at(t)}return e}(o,n)}cache(){return this._cache??(this._cache=this.toArray())}}let Yx=class e{constructor(e,t,n=!1){const i=e.fields.map(e=>e.name);this.schema=e,this.names=i,this.children=t,this.factory=n?Kb:Zb;const r=[];this.getFactory=e=>r[e]??(r[e]=this.factory(i,t.map(t=>t.data[e])))}get[Symbol.toStringTag](){return"Table"}get numCols(){return this.names.length}get numRows(){var e;return(null==(e=this.children[0])?void 0:e.length)??0}getChildAt(e){return this.children[e]}getChild(e){const t=this.names.findIndex(t=>t===e);return t>-1?this.children[t]:void 0}selectAt(t,n=[]){const{children:i,factory:r,schema:o}=this,{fields:s}=o;return new e({...o,fields:t.map((e,t)=>{return i=s[e],null!=(r=n[t])&&r!==i.name?{...i,name:r}:i;var i,r})},t.map(e=>i[e]),r===Kb)}select(e,t){const n=this.names,i=e.map(e=>n.indexOf(e));return this.selectAt(i,t)}toColumns(){const{children:e,names:t}=this,n={};return t.forEach((t,i)=>{var r;return n[t]=(null==(r=e[i])?void 0:r.toArray())??[]}),n}toArray(){var e;const{children:t,getFactory:n,numRows:i}=this,r=(null==(e=t[0])?void 0:e.data)??[],o=Array(i);for(let s=0,a=-1;s<r.length;++s){const e=n(s);for(let t=0;t<r[s].length;++t)o[++a]=e(t)}return o}*[Symbol.iterator](){var e;const{children:t,getFactory:n}=this,i=(null==(e=t[0])?void 0:e.data)??[];for(let r=0;r<i.length;++r){const e=n(r);for(let t=0;t<i[r].length;++t)yield e(t)}}at(e){const{children:t,getFactory:n,numRows:i}=this;if(e<0||e>=i)return null;const[{offsets:r}]=t,o=_b(r,e)-1;return n(o)(e-r[o])}get(e){return this.at(e)}};function qx(e,t){return t?class extends t{constructor(t){super(new e(t))}}:e}const Xx=new Map;function Kx(e,t){return{offset:jb(e,t),metadataLength:$b(e,t+8),bodyLength:jb(e,t+16)}}function Zx(e,t){return qb(e,t,24,Kx)}function Qx(e,t){const n=Bb(e,t);return{codec:n(4,Vb,ob.LZ4_FRAME),method:n(6,Vb,0)}}function Jx(e,t,n){const i=Bb(e,t),r=n<3?8:0;return{length:i(4,jb,0),nodes:qb(e,i(6,zb),16,(e,t)=>({length:jb(e,t),nullCount:jb(e,t+8)})),regions:qb(e,i(8,zb),16+r,(e,t)=>({offset:jb(e,t+r),length:jb(e,t+r+8)})),compression:i(10,Qx),variadic:qb(e,i(12,zb),8,jb)}}function ew(e,t,n){const i=Bb(e,t);return{id:i(4,jb,0),data:i(6,(e,t)=>Jx(e,t,n)),isDelta:i(8,Ub,!1)}}function tw(e,t,n,i){vb(n,Jv,xb);const r=Bb(e,t);switch(n){case Jv.Binary:return{typeId:Jv.Binary,offsets:hb};case Jv.Utf8:return{typeId:Jv.Utf8,offsets:hb};case Jv.LargeBinary:return{typeId:Jv.LargeBinary,offsets:fb};case Jv.LargeUtf8:return{typeId:Jv.LargeUtf8,offsets:fb};case Jv.List:return c=i[0],{typeId:Jv.List,children:[Cb(c)],offsets:hb};case Jv.ListView:return(e=>({typeId:Jv.ListView,children:[Cb(e,"value")],offsets:hb}))(i[0]);case Jv.LargeList:return(e=>({typeId:Jv.LargeList,children:[Cb(e)],offsets:fb}))(i[0]);case Jv.LargeListView:return(e=>({typeId:Jv.LargeListView,children:[Cb(e,"value")],offsets:fb}))(i[0]);case Jv.Struct:return(e=>({typeId:Jv.Struct,children:Array.isArray(e)&&e.length>0&&Sb(e[0])?e:Object.entries(e).map(([e,t])=>wb(e,t))}))(i);case Jv.RunEndEncoded:return a=i[0],l=i[1],{typeId:Jv.RunEndEncoded,children:[yb(Cb(a,"run_ends"),e=>e.type.typeId===Jv.Int,()=>"Run-ends must have an integer type."),Cb(l,"values")]};case Jv.Int:return Tb(r(4,$b,0),r(6,Ub,!1));case Jv.Float:return((e=2)=>({typeId:Jv.Float,precision:vb(e,eb),values:[ab,pb,mb][e]}))(r(4,Wb,eb.HALF));case Jv.Decimal:return((e,t,n=128)=>({typeId:Jv.Decimal,precision:e,scale:t,bitWidth:vb(n,[32,64,128,256]),values:32===n?hb:cb}))(r(4,$b,0),r(6,$b,0),r(8,$b,128));case Jv.Date:return s=r(4,Wb,tb.MILLISECOND),{typeId:Jv.Date,unit:vb(s,tb),values:s===tb.DAY?hb:fb};case Jv.Time:return((e=nb.MILLISECOND)=>{const t=(e=vb(e,nb))===nb.SECOND||e===nb.MILLISECOND?32:64;return{typeId:Jv.Time,unit:e,bitWidth:t,values:32===t?hb:fb}})(r(4,Wb,nb.MILLISECOND));case Jv.Timestamp:return((e=nb.MILLISECOND,t=null)=>({typeId:Jv.Timestamp,unit:vb(e,nb),timezone:t,values:fb}))(r(4,Wb,nb.SECOND),r(6,Yb));case Jv.Interval:return((e=ib.MONTH_DAY_NANO)=>({typeId:Jv.Interval,unit:vb(e,ib),values:e===ib.MONTH_DAY_NANO?void 0:hb}))(r(4,Wb,ib.YEAR_MONTH));case Jv.Duration:return((e=nb.MILLISECOND)=>({typeId:Jv.Duration,unit:vb(e,nb),values:fb}))(r(4,Wb,nb.MILLISECOND));case Jv.FixedSizeBinary:return o=r(4,$b,0),{typeId:Jv.FixedSizeBinary,stride:o};case Jv.FixedSizeList:return((e,t)=>({typeId:Jv.FixedSizeList,stride:t,children:[Cb(e)]}))(i[0],r(4,$b,0));case Jv.Map:return((e,t)=>({typeId:Jv.Map,keysSorted:e,children:[t],offsets:hb}))(r(4,Ub,!1),i[0]);case Jv.Union:return((e,t,n)=>(n??(n=t.map((e,t)=>t)),{typeId:Jv.Union,mode:vb(e,rb),typeIds:n,typeMap:n.reduce((e,t,n)=>(e[t]=n,e),{}),children:t.map((e,t)=>Cb(e,`_${t}`)),typeIdForValue:void 0,offsets:hb}))(r(4,Wb,rb.Sparse),i,qb(e,r(6,zb),4,$b))}var o,s,a,l,c;return{typeId:n}}function nw(e,t){const n=qb(e,t,4,(e,t)=>{const n=Bb(e,t);return[n(4,Yb),n(6,Yb)]});return n.length?new Map(n):null}function iw(e,t,n){const i=Bb(e,t);return{version:n,endianness:i(4,Wb,0),fields:i(6,rw,[]),metadata:i(8,nw)}}function rw(e,t){return qb(e,t,4,ow)}function ow(e,t){const n=Bb(e,t),i=n(8,Hb,Jv.NONE),r=n(10,zb,0),o=n(12,aw);let s=tw(e,r,i,n(14,sw,[]));return o&&(o.dictionary=s,s=o),{name:n(4,Yb),type:s,nullable:n(6,Ub,!1),metadata:n(16,nw)}}function sw(e,t){return qb(e,t,4,ow)}function aw(e,t){if(!t)return null;const n=Bb(e,t);return((e,t,n=!1,i=-1)=>({typeId:Jv.Dictionary,id:i,dictionary:e,indices:t||kb(),ordered:n}))(null,n(6,lw,kb()),n(8,Ub,!1),n(4,jb,0))}function lw(e,t){return tw(e,t,Jv.Int)}function cw(e,t){let n=$b(e,t)||0;if(t+=4,-1===n&&(n=$b(e,t)||0,t+=4),0===n)return null;const i=e.subarray(t,t+=n);if(i.byteLength<n)throw new Error(`Expected to read ${n} metadata bytes, but only read ${i.byteLength}.`);const r=Bb(i,0),o=r(4,Wb,0),s=r(6,Hb,Qv.NONE),a=r(8,zb,0),l=r(10,jb,0);let c;if(a){const n=s===Qv.Schema?iw:s===Qv.DictionaryBatch?ew:s===Qv.RecordBatch?Jx:null;if(!n)throw new Error((e=>`Unsupported message type: ${e} (${bb(Qv,e)})`)(s));if(c=n(i,a,o),l>0){const n=e.subarray(t,t+=l);if(n.byteLength<l)throw new Error(((e,t)=>`Expected to read ${e} bytes for message body, but only read ${t}.`)(l,n.byteLength));c.body=n}else s!==Qv.Schema&&(c.body=new Uint8Array(0))}return{version:o,type:s,index:t,content:c}}function uw(e,t){return function(e,t={}){const{schema:n={fields:[]},dictionaries:i,records:r}=e,{version:o,fields:s}=n,a=new Map,l=function(e,t,n){const i={version:t,options:e,dictionary:e=>n.get(e)};return e=>{const{length:t,nodes:n,regions:r,compression:o,variadic:s,body:a}=e;let l=-1,c=-1,u=-1;return{...i,length:t,node:()=>n[++l],buffer:e=>{const{bytes:t,length:n,offset:i}=function(e,t,n){if(n){if(0!==n.method)throw new Error(`Unknown compression method (${n.method})`);{const r=n.codec,o=null!=(i=r)&&Xx.get(i)||null;if(!o)throw new Error(function(e){return`Missing compression codec "${bb(ob,e)}" (id ${e})`}(r));return function(e,{offset:t,length:n},i){if(0===n)return{bytes:new Uint8Array(0),offset:0,length:0};const r=jb(e,t),o=e.subarray(t+8,t+n),s=-1===r?o:i.decode(o);return{bytes:s,offset:0,length:s.length}}(e,t,o)}}return{bytes:e,...t};var i}(a,r[++c],o);return e?new e(t.buffer,t.byteOffset+i,n/e.BYTES_PER_ELEMENT):t.subarray(i,i+n)},variadic:()=>s[++u],visit(e){return e.map(e=>dw(e.type,this))}}}}(t,o,a),c=new Map;!function(e){e.fields.forEach(function e(t){var n,i,r;(e=>{const t=e.type;t.typeId===Jv.Dictionary&&c.set(t.id,t.dictionary)})(t),null==(i=null==(n=t.type.dictionary)?void 0:n.children)||i.forEach(e),null==(r=t.type.children)||r.forEach(e)})}(n);const u=new Map;for(const h of i){const{id:e,data:t,isDelta:n,body:i}=h,r=c.get(e),o=dw(r,l({...t,body:i}));if(u.has(e)){const t=u.get(e);n||t.clear(),t.add(o)}else{if(n)throw new Error("Delta update can not be first dictionary batch.");u.set(e,Gx(r).add(o))}}u.forEach((e,t)=>a.set(t,e.done()));const d=s.map(e=>Gx(e.type));for(const h of r){const e=l(h);s.forEach((t,n)=>d[n].add(dw(t.type,e)))}return new Yx(n,d.map(e=>e.done()),t.useProxy)}(function(e){const t=function(e){return e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer}(e)?new Uint8Array(e):e;return t instanceof Uint8Array&&function(e){if(!e||e.length<4)return!1;for(let t=0;t<6;++t)if(Zv[t]!==e[t])return!1;return!0}(t)?function(e){const t=e.byteLength-(Zv.length+4),n=$b(e,t),i=Bb(e,t-n),r=i(4,Wb,0),o=i(8,Zx,[]),s=i(10,Zx,[]);return{schema:i(6,(e,t)=>iw(e,t,r)),dictionaries:o.map(({offset:t})=>cw(e,t).content),records:s.map(({offset:t})=>cw(e,t).content),metadata:i(12,nw)}}(t):function(e){const t=[e].flat();let n;const i=[],r=[];for(const o of t){if(!(o instanceof Uint8Array))throw new Error("IPC data batch was not a Uint8Array.");let e=0;for(;;){const t=cw(o,e);if(null===t)break;if(e=t.index,t.content)switch(t.type){case Qv.Schema:n||(n=t.content);break;case Qv.RecordBatch:i.push(t.content);break;case Qv.DictionaryBatch:r.push(t.content)}}}return{schema:n,dictionaries:r,records:i,metadata:null}}(t)}(e),t)}function dw(e,t){const{typeId:n}=e,{options:i,node:r,buffer:o,variadic:s,version:a}=t,l=function(e,t={}){const{typeId:n,bitWidth:i,mode:r,precision:o,unit:s}=e,{useBigInt:a,useDate:l,useDecimalInt:c,useMap:u,useProxy:d}=t;switch(n){case Jv.Null:return ix;case Jv.Bool:return sx;case Jv.Int:case Jv.Time:case Jv.Duration:return a||i<64?ex:rx;case Jv.Float:return o?ex:ox;case Jv.Date:return qx(s===tb.DAY?hx:fx,l&&dx);case Jv.Timestamp:return qx(s===nb.SECOND?px:s===nb.MILLISECOND?mx:s===nb.MICROSECOND?gx:_x,l&&dx);case Jv.Decimal:return 32===i?c?ex:ax:c?ux:cx;case Jv.Interval:return s===ib.DAY_TIME?yx:s===ib.YEAR_MONTH?ex:vx;case Jv.FixedSizeBinary:return Rx;case Jv.Utf8:return Ex;case Jv.LargeUtf8:return Cx;case Jv.Binary:return wx;case Jv.LargeBinary:return Sx;case Jv.BinaryView:return Wx;case Jv.Utf8View:return $x;case Jv.List:return Tx;case Jv.LargeList:return kx;case Jv.Map:return u?Nx:Dx;case Jv.ListView:return Ix;case Jv.LargeListView:return Ax;case Jv.FixedSizeList:return Px;case Jv.Struct:return d?zx:Bx;case Jv.RunEndEncoded:return Ux;case Jv.Dictionary:return Vx;case Jv.Union:return r?Ox:Fx}throw new Error(xb(n))}(e,i),c={...r(),type:e};if(n===Jv.Null)return new l({...c,nullCount:c.length});switch(n){case Jv.Bool:case Jv.Int:case Jv.Time:case Jv.Duration:case Jv.Float:case Jv.Decimal:case Jv.Date:case Jv.Timestamp:case Jv.Interval:case Jv.FixedSizeBinary:return new l({...c,validity:o(),values:o(e.values)});case Jv.Utf8:case Jv.LargeUtf8:case Jv.Binary:case Jv.LargeBinary:return new l({...c,validity:o(),offsets:o(e.offsets),values:o()});case Jv.BinaryView:case Jv.Utf8View:return new l({...c,validity:o(),values:o(),data:Array.from({length:s()},()=>o())});case Jv.List:case Jv.LargeList:case Jv.Map:return new l({...c,validity:o(),offsets:o(e.offsets),children:t.visit(e.children)});case Jv.ListView:case Jv.LargeListView:return new l({...c,validity:o(),offsets:o(e.offsets),sizes:o(e.offsets),children:t.visit(e.children)});case Jv.FixedSizeList:case Jv.Struct:return new l({...c,validity:o(),children:t.visit(e.children)});case Jv.RunEndEncoded:return new l({...c,children:t.visit(e.children)});case Jv.Dictionary:{const{id:n,indices:i}=e;return new l({...c,validity:o(),values:o(i.values)}).setDictionary(t.dictionary(n))}case Jv.Union:return a<4&&o(),new l({...c,typeIds:o(ub),offsets:e.mode===rb.Sparse?null:o(e.offsets),children:t.visit(e.children)});default:throw new Error(xb(n))}}function hw(e,t={useDate:!0}){return uw(e,t)}new Uint16Array(new Uint8Array([1,0]).buffer)[0];class fw{constructor({uri:e="ws://localhost:3000/",ipc:t}={}){s(this,"_uri"),s(this,"_queue"),s(this,"_connected"),s(this,"_request"),s(this,"_ws"),s(this,"_events"),this._uri=e,this._queue=[],this._connected=!1,this._request=null,this._ws=null;const n=this;this._events={open(){n._connected=!0,n.next()},close(){for(n._connected=!1,n._request=null,n._ws=null;n._queue.length;)n._queue.shift().reject("Socket closed")},error(e){if(n._request){const{reject:t}=n._request;n._request=null,n.next(),t(e)}},message(e){const{data:i}=e;if(n._request){const{query:e,resolve:r,reject:o}=n._request;if(n._request=null,n.next(),"string"==typeof i){const e=JSON.parse(i);e.error?o(e.error):r(e)}else if("exec"===e.type)r();else{if("arrow"!==e.type)throw new Error(`Unexpected socket data: ${i}`);r(hw(i,t))}}}}}get connected(){return this._connected}init(){this._ws=new WebSocket(this._uri),this._ws.binaryType="arraybuffer";for(const e in this._events)this._ws.addEventListener(e,this._events[e])}enqueue(e,t,n){null==this._ws&&this.init(),this._queue.push({query:e,resolve:t,reject:n}),this._connected&&!this._request&&this.next()}next(){this._queue.length&&(this._request=this._queue.shift(),this._ws.send(JSON.stringify(this._request.query)))}query(e){return new Promise((t,n)=>this.enqueue(e,t,n))}}function pw(e){return e instanceof gw}let mw;class gw{constructor(e){s(this,"type"),this.type=e}clone(){const e=new this.constructor(this.type);for(const t in this)"type"!==t&&(e[t]=this[t]);return e}toString(e=mw){if(!e)throw new Error("No visitor provided and no default visitor set.");return e.toString(this)}}class _w extends gw{}function yw(e){return e.split(".")}function vw(e){return`"${e.replaceAll('"','""')}"`}function bw(e){return e&&function(e){return'"'===e[0]&&'"'===e[e.length-1]}(e)?e.slice(1,-1):e}const xw="COLUMN_REF",ww="COLUMN_PARAM",Sw="TABLE_REF",Ew="LITERAL",Cw="UNNEST",Tw="ORDER_BY",kw="CAST",Iw="CASE",Aw="WHEN",Lw="COLLATE",Rw="UNARY",Pw="UNARY_POSTFIX",Mw="BINARY",Dw="BETWEEN",Nw="NOT_BETWEEN",Fw="LOGICAL_OPERATOR",Ow="IN",Bw="FUNCTION",zw="AGGREGATE",Uw="WINDOW",Vw="WINDOW_FUNCTION",Hw="WINDOW_DEF",Ww="WINDOW_FRAME",$w="WINDOW_EXTENT_EXPR",Gw="EXPRESSION",jw="FRAGMENT",Yw="VERBATIM",qw="PARAM",Xw="WITH_CLAUSE",Kw="WINDOW_CLAUSE",Zw="SELECT_CLAUSE",Qw="FROM_CLAUSE",Jw="JOIN_CLAUSE",eS="SAMPLE_CLAUSE",tS="SELECT_QUERY",nS="DESCRIBE_QUERY",iS="SET_OPERATION",rS="SCALAR_SUBQUERY";class oS extends _w{constructor(e){super(Ew),s(this,"value"),this.value=e}}function sS(e){switch(typeof e){case"number":return Number.isFinite(e)?`${e}`:"NULL";case"string":return`'${e.replaceAll("'","''")}'`;case"boolean":return e?"TRUE":"FALSE";default:if(null==e)return"NULL";if(e instanceof Date){const t=+e;if(Number.isNaN(t))return"NULL";const n=e.getUTCFullYear(),i=e.getUTCMonth(),r=e.getUTCDate();return t===Date.UTC(n,i,r)?`DATE '${n}-${i+1}-${r}'`:`epoch_ms(${t})`}return e instanceof RegExp?`'${e.source}'`:`${e}`}}class aS{toString(e){if(!e)throw new Error("Node is null or undefined");if("string"!=typeof e.type)throw new Error(`Node type is not a string: ${typeof e.type}, value: ${e.type}`);if("CUSTOM"===e.type)return e.toString(this);const t=this.getVisitMethod(e.type);if("function"==typeof t)return t.call(this,e);throw new Error(`No visitor method for node type: '${e.type}'`)}getVisitMethod(e){switch(e){case zw:return this.visitAggregate;case Dw:return this.visitBetween;case Mw:return this.visitBinary;case Iw:return this.visitCase;case kw:return this.visitCast;case Lw:return this.visitCollate;case ww:return this.visitColumnParam;case xw:return this.visitColumnRef;case nS:return this.visitDescribeQuery;case Gw:return this.visitExpression;case jw:return this.visitFragment;case Qw:return this.visitFromClause;case Bw:return this.visitFunction;case Ow:return this.visitIn;case"INTERVAL":return this.visitInterval;case Jw:return this.visitJoinClause;case"LIST":return this.visitList;case Ew:return this.visitLiteral;case Fw:return this.visitLogicalOperator;case Nw:return this.visitNotBetween;case Tw:return this.visitOrderBy;case qw:return this.visitParam;case eS:return this.visitSampleClause;case rS:return this.visitScalarSubquery;case Zw:return this.visitSelectClause;case tS:return this.visitSelectQuery;case iS:return this.visitSetOperation;case Sw:return this.visitTableRef;case Rw:return this.visitUnary;case Pw:return this.visitUnaryPostfix;case Cw:return this.visitUnnest;case Yw:return this.visitVerbatim;case Aw:return this.visitWhen;case Uw:return this.visitWindow;case Kw:return this.visitWindowClause;case Hw:return this.visitWindowDef;case $w:return this.visitWindowExtentExpr;case Ww:return this.visitWindowFrame;case Vw:return this.visitWindowFunction;case Xw:return this.visitWithClause;default:throw new Error(`Unknown node type: '${e}'`)}}mapToString(e){return e.map(e=>this.toString(e))}}function lS(e){return"string"==typeof e}function cS(e){return Array.isArray(e)}function uS(e){if(e){const t=e;return"function"==typeof(null==t?void 0:t.addEventListener)&&!1!==t.dynamic&&"value"in t}return!1}class dS extends _w{constructor(e){super(qw),s(this,"param"),this.param=e}get value(){return this.param.value}}const hS="CURRENT ROW",fS="UNBOUNDED";function pS(e,t,n){const{extent:i,expr:r}=t;if(!i)return"";const[o,s]=e.mapToString(i);return`(${e.toString(r)} ${n} ${o} AND ${s})`}function mS(e,t,n){const i=pw(t)?e.toString(t):t;return pw(t)&&t.type===$w?i:null!=i&&"number"!=typeof i?`${i} ${n}`:0===i?hS:i&&Number.isFinite(i)?`${Math.abs(i)} ${n}`:`${fS} ${n}`}const gS=new class extends aS{visitAggregate(e){const{name:t,args:n,isDistinct:i,filter:r,order:o}=e,s=[i?"DISTINCT":"",(null==n?void 0:n.length)?this.mapToString(n).join(", "):"count"===t.toLowerCase()?"*":"",o.length?`ORDER BY ${this.mapToString(o).join(", ")}`:""].filter(e=>e).join(" ");return`${t}(${s})${r?` FILTER (WHERE ${this.toString(r)})`:""}`}visitBetween(e){return pS(this,e,"BETWEEN")}visitBinary(e){const{left:t,right:n,op:i}=e;return`(${this.toString(t)} ${i} ${this.toString(n)})`}visitCase(e){const{expr:t,_when:n,_else:i}=e;return"CASE "+(t?`${this.toString(t)} `:"")+this.mapToString(n).join(" ")+(i?` ELSE ${this.toString(i)}`:"")+" END"}visitCast(e){const{expr:t,cast:n}=e;return`(${this.toString(t)})::${n}`}visitCollate(e){const{expr:t,collation:n}=e;return`${this.toString(t)} COLLATE ${n}`}visitColumnParam(e){return this.visitColumnRef(e)}visitColumnRef(e){const{column:t,table:n}=e;return`${n?`${this.toString(n)}.`:""}${"*"===t?"*":vw(t)}`}visitDescribeQuery(e){const{query:t}=e;return`DESC ${this.toString(t)}`}visitExpression(e){throw new Error(`Unexpected EXPRESSION node type. Node: ${JSON.stringify(e)}`)}visitFragment(e){const{spans:t}=e;return t.map(e=>"string"==typeof e?e:this.toString(e)).join("")}visitFromClause(e){var t;const{expr:n,alias:i,sample:r}=e,o=nE(n)?`(${this.toString(n)})`:`${this.toString(n)}`;return`${!i||DS(n)&&(null==(t=n.table)?void 0:t.join("."))===i?`${o}`:`${o} AS ${vw(i)}`}${r?` TABLESAMPLE ${this.toString(r)}`:""}`}visitFunction(e){const{name:t,args:n}=e;return`${t}(${this.mapToString(n).join(", ")})`}visitIn(e){const{expr:t,values:n}=e;return`(${this.toString(t)} IN (${this.mapToString(n).join(", ")}))`}visitInterval(e){const{steps:t,name:n}=e;return`INTERVAL ${t} ${n}`}visitJoinClause(e){const{left:t,right:n,joinVariant:i,joinType:r,condition:o,using:s,sample:a}=e,l="REGULAR"===i?"":`${i} `;let c="",u="";"CROSS"!==i&&(c="INNER"!==r?`${r} `:"",u=o?` ON ${this.toString(o)}`:s?` USING (${this.mapToString(s).join(", ")})`:"");const d=a?` USING SAMPLE ${this.toString(a)}`:"";return`${this.toString(t)} ${l}${c}JOIN ${this.toString(n)}${u}${d}`}visitList(e){const{values:t}=e;return`[${this.mapToString(t).join(", ")}]`}visitLiteral(e){const{value:t}=e;return sS(t)}visitLogicalOperator(e){const{clauses:t,op:n}=e,i=this.mapToString(t);return 0===i.length?"":1===i.length?`${i[0]}`:`(${i.join(` ${n} `)})`}visitNotBetween(e){return pS(this,e,"NOT BETWEEN")}visitOrderBy(e){const{expr:t,desc:n,nullsFirst:i}=e,r=n?" DESC":!1===n?" ASC":"",o=i?" NULLS FIRST":!1===i?" NULLS LAST":"";return`${this.toString(t)}${r}${o}`}visitParam(e){const{param:t}=e;return sS(t.value)}visitSampleClause(e){const{size:t,perc:n,method:i,seed:r}=e;return`${i?`${i} `:""}(${t}${n?"%":" ROWS"})${null!=r?` REPEATABLE (${r})`:""}`}visitScalarSubquery(e){return`(${this.toString(e.subquery)})`}visitSelectClause(e){const{expr:t,alias:n}=e;return!n||function(e,t){return e instanceof IS&&null==e.table&&e.column===t}(t,n)?this.toString(t):`${this.toString(t)} AS ${vw(n)}`}visitSelectQuery(e){const{_with:t,_select:n,_distinct:i,_from:r,_sample:o,_where:s,_groupby:a,_having:l,_window:c,_qualify:u,_orderby:d,_limitPerc:h,_limit:f,_offset:p}=e,m=[];if(t.length&&m.push(`WITH ${this.mapToString(t).join(", ")}`),m.push(`SELECT${i?" DISTINCT":""} ${this.mapToString(n).join(", ")}`),r.length&&m.push(`FROM ${this.mapToString(r).join(", ")}`),o&&m.push(`USING SAMPLE ${this.toString(o)}`),s.length){const e=this.mapToString(s).filter(e=>e).join(" AND ");e&&m.push(`WHERE ${e}`)}if(a.length&&m.push(`GROUP BY ${this.mapToString(a).join(", ")}`),l.length){const e=this.mapToString(l).filter(e=>e).join(" AND ");e&&m.push(`HAVING ${e}`)}if(c.length&&m.push(`WINDOW ${this.mapToString(c).join(", ")}`),u.length){const e=this.mapToString(u).filter(e=>e).join(" AND ");e&&m.push(`QUALIFY ${e}`)}return d.length&&m.push(`ORDER BY ${this.mapToString(d).join(", ")}`),f&&m.push(`LIMIT ${this.toString(f)}${h?"%":""}`),null!=p&&m.push(`OFFSET ${this.toString(p)}`),m.join(" ")}visitSetOperation(e){const{op:t,queries:n,_with:i,_orderby:r,_limitPerc:o,_limit:s,_offset:a}=e,l=[];return i.length&&l.push(`WITH ${this.mapToString(i).join(", ")}`),l.push(n.join(` ${t} `)),r.length&&l.push(`ORDER BY ${this.mapToString(r).join(", ")}`),s&&l.push(`LIMIT ${this.toString(s)}${o?"%":""}`),a&&l.push(`OFFSET ${this.toString(a)}`),l.join(" ")}visitTableRef(e){const{table:t}=e;return t.map(e=>vw(e)).join(".")}visitUnary(e){const{expr:t,op:n}=e;return`(${n} ${this.toString(t)})`}visitUnaryPostfix(e){const{expr:t,op:n}=e;return`(${this.toString(t)} ${n})`}visitUnnest(e){const{expr:t,recursive:n,maxDepth:i}=e,r=[this.toString(t)];return n&&r.push("recursive := true"),null!=i&&i>0&&r.push(`max_depth := ${i}`),`UNNEST(${r.join(", ")})`}visitVerbatim(e){const{value:t}=e;return t}visitWhen(e){const{when:t,then:n}=e;return`WHEN ${this.toString(t)} THEN ${this.toString(n)}`}visitWindow(e){const{func:t,def:n}=e;return`${this.toString(t)} OVER ${this.toString(n)}`}visitWindowClause(e){const{name:t,def:n}=e;return`${vw(t)} AS ${this.toString(n)}`}visitWindowDef(e){const{name:t,partition:n,order:i,framedef:r}=e,o=t&&vw(t),s=[o,(null==n?void 0:n.length)&&`PARTITION BY ${this.mapToString(n).join(", ")}`,(null==i?void 0:i.length)&&`ORDER BY ${this.mapToString(i).join(", ")}`,r&&this.toString(r)].filter(e=>e);return o&&s.length<2?o:`(${s.join(" ")})`}visitWindowExtentExpr(e){const{scope:t,expr:n}=e;return t===hS?t:`${pw(n)?this.toString(n):n??fS} ${t}`}visitWindowFrame(e){const{frameType:t,exclude:n,extent:i}=e,[r,o]=pw(i)?i.value:i;return`${t} BETWEEN ${mS(this,r,"PRECEDING")} AND ${mS(this,o,"FOLLOWING")}${n?` ${n}`:""}`}visitWindowFunction(e){const{name:t,args:n,ignoreNulls:i,order:r}=e;return`${t}(${[this.mapToString(n).join(", "),r.length?`ORDER BY ${this.mapToString(r).join(", ")}`:"",i?"IGNORE NULLS":""].filter(e=>e).join(" ")})`}visitWithClause(e){const{name:t,query:n,materialized:i}=e,r=!0===i?"MATERIALIZED ":!1===i?"NOT MATERIALIZED ":"";return`${vw(t)} AS ${r}(${this.toString(n)})`}};mw=gS;class _S extends _w{constructor(e,t=[]){super(Bw),s(this,"name"),s(this,"args"),this.name=e,this.args=t}}function yS(e,...t){return new _S(e,wS(t).map(OS))}function vS(e,...t){return new VS(e,wS(t).map(OS))}function bS(e,t){return e.flat().filter(e=>null!=e).map(e=>t(e))}function xS(e){return bS(e,OS)}function wS(e){const t=e.length;let n=t;for(;n>0&&void 0===e[n-1];--n);return n<t?e.slice(0,n):e}class SS extends gw{constructor(e,t){super(Kw),s(this,"name"),s(this,"def"),this.name=e,this.def=t}}class ES extends _w{constructor(e,t=new CS){super(Uw),s(this,"func"),s(this,"def"),this.func=e,this.def=t}over(e){return new ES(this.func,this.def.over(e))}partitionby(...e){return new ES(this.func,this.def.partitionby(...e))}orderby(...e){return new ES(this.func,this.def.orderby(...e))}frame(e){return new ES(this.func,this.def.frame(e))}}class CS extends gw{constructor(e,t,n,i){super(Hw),s(this,"name"),s(this,"partition"),s(this,"order"),s(this,"framedef"),this.name=e,this.partition=t,this.order=n,this.framedef=i}over(e){return TS(this,{name:e})}partitionby(...e){return TS(this,{partition:xS(e)})}orderby(...e){return TS(this,{order:xS(e)})}frame(e){return TS(this,{framedef:e})}}function TS(e,t){return new CS(t.name??e.name,t.partition??e.partition,t.order??e.order,t.framedef??e.framedef)}function kS(e){return e instanceof IS}class IS extends _w{constructor(e,t){super(e),s(this,"table"),this.table=t}get column(){return""}}class AS extends IS{constructor(e,t){super(xw,t),s(this,"name"),this.name=e}get column(){return this.name}}class LS extends IS{constructor(e,t){super(ww,t),s(this,"param"),this.param=e}get column(){return`${this.param.value}`}}function RS(e,t){const n=US(t);return uS(e)?new LS(new dS(e),n):new AS(e,n)}class PS extends _w{constructor(e,t){super(Yw),s(this,"value"),s(this,"hint"),this.value=e,this.hint=t}}function MS(e){return new oS(e)}function DS(e){return e instanceof NS}class NS extends _w{constructor(e){super(Sw),s(this,"table"),this.table=[e].flat()}get name(){return this.table[this.table.length-1]}}function FS(...e){const t=bS(e,String);return(null==t?void 0:t.length)?new NS(t):void 0}function OS(e){return lS(e)?function(e){const t=yw(e);return RS(t.pop(),FS(t))}(e):zS(e)}function BS(e){return lS(e)?function(e){return new PS(e,void 0)}(e):zS(e)}function zS(e){return e instanceof _w?e:uS(e)?new dS(e):MS(e)}function US(e){return lS(e)?FS(yw(e)):cS(e)?FS(e):e}class VS extends _w{constructor(e,t,n=!1,i=null,r=[]){super(zw),s(this,"name"),s(this,"args"),s(this,"isDistinct"),s(this,"filter"),s(this,"order"),this.name=e,this.args=t,this.isDistinct=n,this.filter=i,this.order=xS([r])}distinct(e=!0){return new VS(this.name,this.args,e,this.filter,this.order)}where(e){return lS(e)&&(e=BS(e)),new VS(this.name,this.args,this.isDistinct,e,this.order)}argOrder(e){return new VS(this.name,this.args,this.isDistinct,this.filter,e)}window(){return new ES(this)}partitionby(...e){return this.window().partitionby(...e)}orderby(...e){return this.window().orderby(...e)}frame(e){return this.window().frame(e)}}class HS extends _w{constructor(e,t,n){super(e),s(this,"expr"),s(this,"extent"),this.expr=t,this.extent=n}toSQL(e){const{extent:t,expr:n}=this;return t?`(${n} ${e} ${t[0]} AND ${t[1]})`:""}}class WS extends HS{constructor(e,t){super(Dw,e,t)}}class $S extends _w{constructor(e,t,n){super(Mw),s(this,"op"),s(this,"left"),s(this,"right"),this.op=e,this.left=t,this.right=n}}class GS extends _w{constructor(e,t){super(kw),s(this,"expr"),s(this,"cast"),this.expr=e,this.cast=t}}class jS extends _w{constructor(e){super(jw),s(this,"spans"),this.spans=e}}class YS extends gw{}class qS extends YS{constructor(e,t,n){super(Qw),s(this,"expr"),s(this,"alias"),s(this,"sample"),this.expr=e,this.alias=t,this.sample=n}as(e){return new qS(this.expr,e,this.sample)}}class XS extends _w{constructor(e,t){super(Ow),s(this,"expr"),s(this,"values"),this.expr=e,this.values=t}}class KS extends _w{constructor(e,t){super(Fw),s(this,"op"),s(this,"clauses"),this.op=e,this.clauses=t}}class ZS extends KS{constructor(e){super("AND",e)}}class QS extends KS{constructor(e){super("OR",e)}}class JS extends gw{constructor(e,t=!1,n,i){super(eS),s(this,"size"),s(this,"perc"),s(this,"method"),s(this,"seed"),this.size=e,this.perc=t,this.method=n,this.seed=i}}class eE extends gw{constructor(e,t){super(Zw),s(this,"expr"),s(this,"alias"),this.expr=e,this.alias=t}}class tE extends gw{constructor(e,t,n=null){super(Xw),s(this,"name"),s(this,"query"),s(this,"materialized"),this.name=e,this.query=t,this.materialized=n}}function nE(e){return e instanceof rE}function iE(e){return e instanceof oE}class rE extends _w{constructor(e){super(e),s(this,"_with",[]),s(this,"_orderby",[]),s(this,"_limitPerc",!1),s(this,"_limit"),s(this,"_offset"),s(this,"cteFor",null)}static with(...e){return new lE(...e)}static select(...e){return(new oE).select(...e)}static from(...e){return(new oE).from(...e)}static union(...e){return new aE("UNION",e.flat())}static unionByName(...e){return new aE("UNION BY NAME",e.flat())}static unionAll(...e){return new aE("UNION ALL",e.flat())}static unionAllByName(...e){return new aE("UNION ALL BY NAME",e.flat())}static intersect(...e){return new aE("INTERSECT",e.flat())}static intersectAll(...e){return new aE("INTERSECT ALL",e.flat())}static except(...e){return new aE("EXCEPT",e.flat())}static exceptAll(...e){return new aE("EXCEPT ALL",e.flat())}static describe(e){return new sE(e)}get subqueries(){return[]}clone(){return this}setCteFor(e){this.cteFor=e}with(...e){const t=[],n=(e,n)=>{const i=n.clone();i.setCteFor(this),t.push(new tE(e,i))};return e.flat().forEach(e=>{if(e instanceof tE)t.push(e);else if(null!=e)for(const t in e)n(t,e[t])}),this._with=this._with.concat(t),this}orderby(...e){return this._orderby=this._orderby.concat(xS(e)),this}limitPercent(e){return this._limitPerc=!0,this._limit=OS(e),this}limit(e){return this._limitPerc=!1,this._limit=OS(e),this}offset(e){return this._offset=OS(e),this}}class oE extends rE{constructor(){super(tS),s(this,"_select",[]),s(this,"_from",[]),s(this,"_where",[]),s(this,"_sample"),s(this,"_groupby",[]),s(this,"_having",[]),s(this,"_window",[]),s(this,"_qualify",[]),s(this,"_distinct",!1)}get subqueries(){const e=this.cteFor||this,t=(e instanceof oE?e._with:[]).reduce((e,t)=>(e[t.name]=t.query,e),{}),n=[];return this._from.forEach(e=>{if(e instanceof qS){const{expr:i}=e;if(nE(i))n.push(i);else if(DS(i)){const e=t[i.name];e&&n.push(e)}}}),n}clone(){return Object.assign(new oE,this)}select(...e){const t=new Set,n=[],i=(e,i)=>{const r=bw(i);t.add(r),e&&n.push(new eE(OS(e),r))};return e.flat().forEach(e=>{if(null!=e)if(lS(e))i(e,e);else if(kS(e))i(e,e.column);else if(cS(e))i(e[1],e[0]);else if(pw(e))i(e,`${e}`);else for(const t in e)i(e[t],t)}),this._select=this._select.filter(e=>!t.has(e.alias)).concat(n),this}setSelect(...e){return this._select=[],this.select(...e)}distinct(e=!0){return this._distinct=!!e,this}from(...e){const t=[],n=(e,n)=>{t.push(new qS(US(e),bw(n)))};return e.flat().forEach(e=>{if(null!=e)if(e instanceof YS)t.push(e);else if(lS(e))n(e,e);else if(DS(e))n(e,e.name);else if(pw(e))n(e);else if(cS(e))n(e[1],e[0]);else for(const t in e)n(e[t],t)}),this._from=this._from.concat(t),this}setFrom(...e){return this._from=[],this.from(...e)}sample(e,t,n){let i;if("number"==typeof e){const r=e>0&&e<1,o=r?100*e:Math.floor(e);i=new JS(o,r,t,n)}else i=e;return this._sample=i??void 0,this}where(...e){return this._where=this._where.concat(bS(e,BS)),this}setWhere(...e){return this._where=[],this.where(...e)}groupby(...e){return this._groupby=this._groupby.concat(xS(e)),this}setGroupby(...e){return this._groupby=[],this.groupby(...e)}having(...e){return this._having=this._having.concat(bS(e,BS)),this}window(...e){const t=[];return e.flat().forEach(e=>{if(null!=e)for(const n in e)t.push(new SS(bw(n),e[n]))}),this._window=this._window.concat(t),this}qualify(...e){return this._qualify=this._qualify.concat(bS(e,BS)),this}}class sE extends gw{constructor(e){super(nS),s(this,"query"),this.query=e}clone(){return new sE(this.query.clone())}}class aE extends rE{constructor(e,t){super(iS),s(this,"op"),s(this,"queries"),this.op=e,this.queries=t}setCteFor(e){super.setCteFor(e);const{queries:t,cteFor:n}=this;n&&t.forEach(e=>e.setCteFor(n))}get subqueries(){return this.queries}clone(){const{op:e,queries:t,...n}=this;return Object.assign(new aE(e,t),n)}}class lE{constructor(...e){s(this,"_with"),this._with=e}select(...e){return rE.select(...e).with(...this._with)}from(...e){return rE.from(...e).with(...this._with)}union(...e){return rE.union(...e).with(...this._with)}unionByName(...e){return rE.unionByName(...e).with(...this._with)}unionAll(...e){return rE.unionAll(...e).with(...this._with)}unionAllByName(...e){return rE.unionAllByName(...e).with(...this._with)}intersect(...e){return rE.intersect(...e).with(...this._with)}intersectAll(...e){return rE.intersectAll(...e).with(...this._with)}except(...e){return rE.except(...e).with(...this._with)}exceptAll(...e){return rE.exceptAll(...e).with(...this._with)}}class cE extends _w{constructor(e,t,n){super(e),s(this,"op"),s(this,"expr"),this.op=t,this.expr=n}}class uE extends cE{constructor(e,t){super(Pw,e,t)}}function dE(e){return vS("avg",e)}function hE(e){return vS("count",e)}function fE(e){return vS("sum",e)}function pE(e,t){return new GS(OS(e),t)}function mE(e){return pE(e,"DOUBLE")}function gE(e){return yS("exp",e)}function _E(e){return yS("ln",e)}function yE(e){return yS("sign",e)}function vE(e){return yS("abs",e)}function bE(e){return yS("sqrt",e)}function xE(e){return yS("floor",e)}function wE(e,t){return new uE(e,OS(t))}function SE(e,t,n){return new $S(e,OS(t),OS(n))}function EE(...e){return new ZS(xS(e))}function CE(e){return wE("IS NOT NULL",e)}function TE(e,t){return SE("-",e,t)}function kE(e,t){return SE("*",e,t)}function IE(e,t){return SE("/",e,t)}function AE(e,t){return SE("**",e,t)}function LE(e,t){return SE("<=",e,t)}function RE(e,t){return SE(">=",e,t)}function PE(e,t){return new WS(OS(e),null==t?void 0:t.map(OS))}function ME(e,t){return new XS(OS(e),t.map(OS))}function DE(e,...t){return new jS(function(e,t){const n=[e[0]],i=t.length;for(let r=0,o=0;r<i;){const i=t[r];pw(i)?n[++o]=i:uS(i)?n[++o]=new dS(i):n[o]+=lS(i)?i:`${MS(i)}`;const s=e[++r];pw(n[o])?n[++o]=s:n[o]+=s}return n.filter(e=>e).map(e=>lS(e)?new PS(e):e)}(e,t))}function NE(...e){return yS("coalesce",...e)}const FE={[zw]:["args","order","filter"],[Dw]:["expr","extent"],[Mw]:["left","right"],[Iw]:["expr","_when","_else"],[kw]:["expr"],[Lw]:["expr"],[ww]:["param","table"],[xw]:["table"],[nS]:["query"],[Gw]:["node"],[jw]:["spans"],[Qw]:["expr"],[Bw]:["args"],[Ow]:["expr","values"],[Jw]:["left","right","on","using","sample"],[Fw]:["clauses"],[Nw]:["expr","extent"],[Tw]:["expr"],[qw]:["value"],[rS]:["subquery"],[Zw]:["expr"],[tS]:["_with","_select","_from","_where","_sample","_groupby","_having","_window","_qualify","_orderby"],[iS]:["queries","_orderby"],[Rw]:["expr"],[Pw]:["expr"],[Cw]:["expr"],[Aw]:["when","then"],[Uw]:["func","def"],[Kw]:["def"],[Hw]:["partition","order","framedef"],[$w]:["expr"],[Ww]:["extent"],[Vw]:["args"],[Xw]:["query"]};function OE(e,t){if(t.has(e))return t.get(e);if(pw(e)){const n=FE[e.type],i=(null==n?void 0:n.length)??0;if(i>0){e=e.clone();for(let r=0;r<i;++r){const i=n[r],o=e[i];if(Array.isArray(o)){const n=e[i]=o.slice(),r=o.length;for(let e=0;e<r;++e)n[e]=OE(o[e],t)}else o&&(e[i]=OE(o,t))}}}return e}function BE(e,t){if(!pw(e))return;const n=t(e);if(n)return n;const i=FE[e.type],r=(null==i?void 0:i.length)??0;for(let o=0;o<r;++o){const r=e[i[o]];if(Array.isArray(r)){const e=r.length;for(let i=0;i<e;++i)if(r[i]&&Number(BE(r[i],t))<0)return n}else if(r&&Number(BE(r,t))<0)return-1}}const zE=new RegExp(`^(${["any_value","approx_count_distinct","approx_quantile","arbitrary","arg_max","arg_max_null","arg_min","arg_min_null","array_agg","avg","bit_and","bit_or","bit_xor","bitstring_agg","bool_and","bool_or","corr","count","count_star","covar_pop","covar_samp","entropy","favg","first","fsum","geomean","kurtosis_pop","kurtosis","last","mad","max","max_by","median","min","min_by","mode","product","quantile","quantile_cont","quantile_disc","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_sxx","regr_sxy","regr_syy","regr_slope","reservoir_quantile","skewness","stddev","stddev_pop","stddev_samp","string_agg","sum","variance","var_pop","var_samp"].join("|")})$`),UE=/(\\'|\\"|"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\w+\()/g;function VE(e){let t=0;return BE(e,e=>{switch(e.type){case Uw:return-1;case zw:return t|=1,-1;case jw:case Yw:{let n=`${e}`.toLowerCase();const i=n.indexOf("(select ");return i>=0&&(n=n.slice(0,i)),n.includes(") over ")?-1:function(e){return e.split(UE).some(e=>e.endsWith("(")&&zE.test(e.slice(0,-1)))}(n)?(t|=2,-1):1}}}),t}function HE(e){const t=new Set;return BE(e,e=>{e.type===zw&&t.add(e)}),Array.from(t)}function WE(e){const t={};return BE(e,e=>{e.type!==xw&&e.type!==ww||(t[`${e}`]=e)}),Object.values(t)}function $E(e,t,{replace:n=!1,temp:i=!1,view:r=!1}={}){return"CREATE"+(n?" OR REPLACE ":" ")+(i?"TEMP ":"")+(r?"VIEW":"TABLE")+(n?" ":" IF NOT EXISTS ")+e+" AS "+t}function GE(e){return e}function jE(){return{apply:GE,invert:GE,sqlApply:OS,sqlInvert:GE}}function YE(){return{apply:e=>Number(e),invert:e=>new Date(e),sqlApply:e=>{return e instanceof Date?MS(+e):(t=e)instanceof oS&&t.value instanceof Date?MS(Number(e.value)):yS("epoch_ms",e);var t},sqlInvert:GE}}const qE={identity:jE,linear:jE,log:function({base:e=null}={}){if(null==e||e===Math.E)return{apply:Math.log,invert:Math.exp,sqlApply:e=>_E(e),sqlInvert:e=>gE(e)};if(10===e)return{apply:Math.log10,invert:e=>Math.pow(10,e),sqlApply:e=>yS("log",e),sqlInvert:e=>AE(10,e)};{const t=+e;return{apply:e=>Math.log(e)/Math.log(t),invert:e=>Math.pow(t,e),sqlApply:e=>IE(_E(e),_E(t)),sqlInvert:e=>AE(t,e)}}},symlog:function({constant:e=1}={}){const t=+e;return{apply:e=>Math.sign(e)*Math.log1p(Math.abs(e)),invert:e=>Math.sign(e)*Math.exp(Math.abs(e)-t),sqlApply:e=>kE(yE(e=OS(e)),_E(SE("+",t,vE(e)))),sqlInvert:e=>kE(yE(e),TE(gE(vE(e)),t))}},sqrt:function(){return{apply:e=>Math.sign(e)*Math.sqrt(Math.abs(e)),invert:e=>Math.sign(e)*e*e,sqlApply:e=>kE(yE(e=OS(e)),bE(vE(e))),sqlInvert:e=>kE(yE(e),AE(e,2))}},pow:function({exponent:e=1}={}){const t=+e;return{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),t),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/t),sqlApply:e=>kE(yE(e=OS(e)),AE(vE(e),t)),sqlInvert:e=>kE(yE(e),AE(vE(e),IE(1,t)))}},time:YE,utc:YE};function XE(e){let t=2166136261;for(let n=0,i=e.length;n<i;++n){const i=e.charCodeAt(n),r=65280&i;r&&(t=KE(t^r>>8)),t=KE(t^255&i)}return function(e){return e+=e<<13,e^=e>>>7,e+=e<<3,e^=e>>>17,4294967295&(e+=e<<5)}(t)>>>0}function KE(e){return e+(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24)}function ZE(e,t,n){switch(e.name){case"count":case"count_star":return function(e,t){return NE(tC(e,t),0)}(t,e);case"sum":return tC(t,e);case"avg":return function(e,t){const n=JE(e,t),{expr:i,name:r}=eC(e,t);return IE(fE(kE(n,r)),i)}(t,e);case"geomean":return function(e,t){const n=JE(e,fE(_E(t.args[0])),t),{expr:i}=eC(e,t);return gE(IE(fE(n),i))}(t,e);case"arg_max":return function(e,t){const n=JE(e,t),i=JE(e,function(e){return vS("max",e)}(t.args[1]),t);return vS("arg_max",n,i)}(t,e);case"arg_min":return function(e,t){const n=JE(e,t),i=JE(e,function(e){return vS("min",e)}(t.args[1]),t);return vS("arg_min",n,i)}(t,e);case"variance":case"var_samp":return nC(t,e,n);case"var_pop":return nC(t,e,n,!1);case"stddev":case"stddev_samp":return bE(nC(t,e,n));case"stddev_pop":return bE(nC(t,e,n,!1));case"covar_samp":return iC(t,e,n);case"covar_pop":return iC(t,e,n,!1);case"corr":return rC(t,e,n);case"regr_count":return oC(t,e).expr;case"regr_avgx":return cC(t,e);case"regr_avgy":return uC(t,e);case"regr_syy":return dC(t,0,e,n);case"regr_sxx":return dC(t,1,e,n);case"regr_sxy":return iC(t,e,n,null);case"regr_slope":return hC(t,e,n);case"regr_intercept":return function(e,t,n){const i=cC(e,t);return TE(uC(e,t),kE(hC(e,t,n),i))}(t,e,n);case"regr_r2":return AE(rC(t,e,n),2);case"max":case"min":case"bit_and":case"bit_or":case"bit_xor":case"bool_and":case"bool_or":case"product":{const n=QE(e);return t[n]=e,DE`${e.name}("${n}")`}default:return null}}function QE(e){return"pre_"+XE(`${e}`).toString(16)}function JE(e,t,n){const i=null==n?void 0:n.filter;i&&(t=t.filter?t.where(EE(i,t.filter)):t.where(i));const r=QE(t);return e[r]=t,r}function eC(e,t){const n=JE(e,hE(t.args[0]),t);return{expr:NE(fE(n),0),name:n}}function tC(e,t){return fE(JE(e,t))}function nC(e,t,n,i=!0){const r=t.args[0],{expr:o}=eC(e,t),s=TE(r,n(r)),a=JE(e,fE(AE(s,2)),t),l=JE(e,fE(s),t),c=i?TE(o,1):o;return IE(TE(fE(a),IE(AE(fE(l),2),o)),c)}function iC(e,t,n,i=!0){const{expr:r}=oC(e,t),o=TE(lC(e,t,n),IE(kE(sC(e,1,t,n),sC(e,0,t,n)),r));return null===i?o:IE(o,i?TE(r,1):r)}function rC(e,t,n){const{expr:i}=oC(e,t),r=lC(e,t,n),o=aC(e,1,t,n),s=aC(e,0,t,n),a=sC(e,1,t,n),l=sC(e,0,t,n),c=TE(o,IE(AE(a,2),i)),u=TE(s,IE(AE(l,2),i));return IE(TE(r,IE(kE(a,l),i)),bE(kE(c,u)))}function oC(e,t){const[n,i]=t.args,r=JE(e,function(e,t){return vS("regr_count",e,t)}(n,i),t);return{expr:fE(r),name:r}}function sC(e,t,n,i){const r=n.args,o=r[t],s=r[1-t],a=fE(TE(o,i(o))).where(CE(s));return fE(JE(e,a,n))}function aC(e,t,n,i){const r=n.args,o=r[t],s=r[1-t],a=fE(AE(TE(o,i(o)),2)).where(CE(s));return fE(JE(e,a,n))}function lC(e,t,n){const[i,r]=t.args,o=fE(kE(TE(r,n(r)),TE(i,n(i))));return fE(JE(e,o,t))}function cC(e,t){const[n,i]=t.args,{expr:r,name:o}=oC(e,t),s=JE(e,function(e,t){return vS("regr_avgx",e,t)}(n,i),t);return IE(fE(kE(s,o)),r)}function uC(e,t){const[n,i]=t.args,{expr:r,name:o}=oC(e,t),s=JE(e,function(e,t){return vS("regr_avgy",e,t)}(n,i),t);return IE(fE(kE(s,o)),r)}function dC(e,t,n,i){const{expr:r}=oC(e,n),o=sC(e,t,n,i);return TE(aC(e,t,n,i),IE(AE(o,2),r))}function hC(e,t,n){return IE(iC(e,t,n,null),dC(e,1,t,n))}function fC(e,t){const n=e.subqueries;if(iE(e)&&0===n.length)return t(e);const i=fC(n[0],t);for(let r=1;r<n.length;++r){const e=fC(n[r],t);if(void 0!==e&&e!==i)return NaN}return i}const pC={skip:!0,result:null};class mC{constructor(e,{schema:t="mosaic",enabled:n=!0}={}){s(this,"entries"),s(this,"active"),s(this,"mc"),s(this,"_schema"),s(this,"_enabled"),this.entries=new Map,this.active=null,this.mc=e,this._schema=t,this._enabled=n}set enabled(e){this._enabled!==e&&(e||this.clear(),this._enabled=e)}get enabled(){return this._enabled}set schema(e){this._schema!==e&&(this.clear(),this._schema=e)}get schema(){return this._schema}dropSchema(){return this.clear(),this.mc.exec(`DROP SCHEMA IF EXISTS "${this.schema}" CASCADE`)}clear(){this.entries.clear(),this.active=null}request(e,t,n){var i;if(!this.enabled||null==n)return null;const{entries:r,mc:o,schema:s}=this,{source:a}=n;if(!a)return null;if(this.active&&(this.active.source!==a&&this.clear(),null===(null==(i=this.active)?void 0:i.source)))return null;let{active:l}=this;if(!l){if(null==n.predicate)return null;if(this.active=l=function(e){const{source:t,meta:n}=e,i=e.predicate,r=WE(i).map(e=>e.column);let o,s;if(!n||!r)return{source:null,columns:s,predicate:o};switch(n.type){case"point":o=e=>e,s=Object.fromEntries(r.map(e=>[`${e}`,OS(e)]));break;case"interval":{const{scales:e,bin:t,pixelSize:r=1}=n;if(!e)break;const a=e.map(e=>function(e,t,n){const{type:i,domain:r,range:o,apply:s,sqlApply:a}=function(e){const t=qE[e.type];if(!t)throw new Error(`Unrecognized scale type: ${e.type}`);return{...e,...t(e)}}(e);if(!s)return;const l=gC[`${n}`.toLowerCase()]||xE,c=r.map(e=>Number(e)),u=s(Math.min(...c)),d=s(Math.max(...c)),h=("identity"===i?1:Math.abs(o[1]-o[0])/(d-u))/t,f=1===h?e=>e:e=>kE(mE(h),e),p=0===u?e=>e:e=>TE(e,mE(u));return e=>pE(l(f(p(a(e)))),"INTEGER")}(e,r,t));a.some(e=>!e)||(1===a.length?(o=e=>{var t;return e?PE("active0",null==(t=e.extent)?void 0:t.map(a[0])):[]},s={active0:a[0](i.expr)}):(o=e=>e?EE(e.clauses.map((e,t)=>{var n;return PE(`active${t}`,null==(n=e.extent)?void 0:n.map(a[t]))})):[],s=Object.fromEntries(i.clauses.map((e,t)=>[`active${t}`,a[t](e.expr)]))))}}return{source:s?t:null,columns:s,predicate:o}}(n),null===l.source)return null}if(r.has(e))return r.get(e);const c=function(e){if(!e.filterStable)return null;const t=e.query();if(!iE(t))return null;const n=fC(t,e=>{const t=e._from[0],n=t instanceof qS&&t.expr;return DS(n)?n.name:n});if("string"!=typeof n)return null;const i=new Map,r={},o={},s=[],a=e=>{const i=e.column;return DE`(SELECT avg(${fC(t,e=>{var t;return null==(t=e._select.find(e=>e.alias===i))?void 0:t.expr})??e}) FROM "${n}")`};for(const{alias:l,expr:c}of t._select){if(VE(c)>1)return null;const e=HE(c);if(0===e.length)s.push(l),r[l]=c;else{for(const t of e){if(t.isDistinct)return null;const e=ZE(t,r,a);if(!e)return null;i.set(t,e)}o[l]=OE(c,i)}}return i.size?{group:s,preagg:r,output:o}:null}(e);let u;if(c)if(t.skip(e,n))u=pC;else{const n=t.remove(a).predicate(e);u=function(e,t,n,i){const{group:r,output:o,preagg:s}=n,{columns:a}=t,l=e.setSelect({...s,...a}).groupby(Object.keys(a)),[c]=l.subqueries;c&&function(e,t){const n=new Set,i=e=>{if(!n.has(e)){if(n.add(e),iE(e)&&e._from.length&&(e.select(t),function(e){return e._groupby.length>0||e._select.some(e=>VE(e))}(e))){const n=new Set(e._groupby.flatMap(e=>e instanceof AS?[e.name]:[]));e.groupby(t.filter(e=>!n.has(e)))}e.subqueries.forEach(i)}};i(e)}(c,Object.values(a).flatMap(e=>WE(e).map(e=>e.column)));const u=l._having,d=l._orderby;l._having=[],l._orderby=[];const h=l.toString(),f=`${i}.preagg_${(XE(h)>>>0).toString(16)}`,p=rE.select(r,o).from(f).groupby(r).having(u).orderby(d);return new _C({table:f,create:h,active:t,select:p})}(e.query(n),l,c,s),u.result=o.exec([`CREATE SCHEMA IF NOT EXISTS ${s}`,$E(u.table,u.create,{temp:!1})]),u.result.catch(e=>o.logger().error(e))}else u=null;return r.set(e,u),u}}const gC={ceil:function(e){return yS("ceil",e)},round:function(e,t){return yS("round",e,t)}};class _C{constructor({table:e,create:t,active:n,select:i}){s(this,"table"),s(this,"create"),s(this,"result"),s(this,"active"),s(this,"select"),s(this,"skip"),this.table=e,this.create=t,this.result=null,this.active=n,this.select=i,this.skip=!1}query(e){return this.select.clone().where(this.active.predicate(e))}}function yC(){return{debug(){},info(){},log(){},warn(){},error(){},group(){},groupCollapsed(){},groupEnd(){}}}const vC=Object.freeze({pending:Symbol("pending"),ready:Symbol("ready"),error:Symbol("error"),done:Symbol("done")});class bC extends Promise{constructor(){let e,t;super((n,i)=>{e=n,t=i}),s(this,"_resolve"),s(this,"_reject"),s(this,"_state"),s(this,"_value"),this._resolve=e,this._reject=t,this._state=vC.pending,this._value=void 0}fulfill(e){if(void 0!==this._value){if(void 0!==e)throw Error("Promise is ready and fulfill has a provided value");this._resolve(this._value)}else{if(void 0===e)throw Error("Promise is neither ready nor has provided value");this._resolve(e)}return this._state=vC.done,this}ready(e){return this._state=vC.ready,this._value=e,this}reject(e){return this._state=vC.error,this._reject(e),this}get state(){return this._state}}function xC(e,t){let n=[],i=0;return{add(r,o){var s;"arrow"===r.request.type?(i||(s=()=>function(){const r=function(e,t){const n=[],i=new Map;for(const r of e){const{entry:{request:e}}=r,o=wC(e.query,t);if(!i.has(o)){const e=[];n.push(e),i.set(o,e)}i.get(o).push(r)}return n}(n,t);n=[],i=0;for(const n of r)SC(n,e),CC(n,t)}(),i="undefined"!=typeof requestAnimationFrame?requestAnimationFrame(s):"undefined"!=typeof setImmediate?setImmediate(s):setTimeout(s)),n.push({entry:r,priority:o,index:n.length})):e(r,o)}}}function wC(e,t){const n=`${e}`;if(iE(e)&&!t.get(n)){if(e._where.length||e._qualify.length||e._having.length||e._orderby.length||e._distinct)return n;const t=e.clone().setSelect("*"),i=e._groupby;if(i.length){const n={};e._select.forEach(({alias:e,expr:t})=>n[e]=t),t.setGroupby(i.map(e=>kS(e)&&n[e.column]||e))}else e._select.some(e=>VE(e.expr))&&t.setGroupby("ALL");return`${t}`}return n}function SC(e,t){if(function(e){if(e.length>1){const t=`${e[0].entry.request.query}`;for(let n=1;n<e.length;++n)if(t!==`${e[n].entry.request.query}`)return!0}return!1}(e))t({request:{type:"arrow",cache:!1,query:e.query=EC(e)},result:e.result=new bC});else for(const{entry:n,priority:i}of e)t(n,i)}function EC(e){const t=e.maps=[],n=new Map;for(const o of e){const e=o.entry.request.query,i=[];t.push(i);for(const{alias:t,expr:r}of e._select){const e=`${r}`;n.has(e)||n.set(e,[`col${n.size}`,r]);const[o]=n.get(e);i.push([o,t])}}const i=e[0].entry.request.query.clone(),r=i._groupby;if(r.length){const t={};e.maps[0].forEach(([e,n])=>t[n]=e),i.setGroupby(r.map(e=>kS(e)&&t[e.column]||e))}return i.setSelect(Array.from(n.values()))}async function CC(e,t){const{maps:n,query:i,result:r}=e;if(!n)return;let o;try{o=await r}catch(a){for(const{entry:t}of e)t.result.reject(a);return}const s=i instanceof sE;e.forEach(({entry:e},i)=>{const{request:r,result:a}=e,l=n[i],c=s&&l?function(e,t){const n=new Map(t),i=[];for(const r of e)n.has(r.column_name)&&i.push({...r,column_name:n.get(r.column_name)});return i}(o,l):l?function(e,t){return e.select(t.map(e=>e[0]),t.map(e=>e[1]))}(o,l):o;r.cache&&t.set(String(r.query),c),a.fulfill(c)})}bC.prototype.constructor=Promise;const TC="undefined"!=typeof requestIdleCallback?requestIdleCallback:setTimeout;class kC{constructor(e){s(this,"queue"),this.queue=Array.from({length:e},()=>({head:null,tail:null}))}isEmpty(){return this.queue.every(e=>!e.head)}insert(e,t){const n=this.queue[t];if(!n)throw new Error(`Invalid queue priority rank: ${t}`);const i={item:e,next:null};null===n.head?n.head=n.tail=i:n.tail=n.tail.next=i}remove(e){for(const t of this.queue){let{head:n,tail:i}=t;for(let t=null,r=n;r;t=r,r=r.next)e(r.item)&&(r===n?n=r.next:t.next=r.next,r===i&&(i=t||n));t.head=n,t.tail=i}}next(){for(const e of this.queue){const{head:t}=e;if(null!==t)return e.head=t.next,e.tail===t&&(e.tail=null),t.item}}}const IC=Object.freeze({High:0,Normal:1,Low:2});class AC{constructor(e=32){s(this,"queue"),s(this,"db"),s(this,"clientCache"),s(this,"_logger"),s(this,"_logQueries"),s(this,"_consolidate"),s(this,"pendingResults"),s(this,"maxConcurrentRequests"),s(this,"pendingExec"),this.queue=new kC(3),this.db=null,this.clientCache=null,this._logger=yC(),this._logQueries=!1,this._consolidate=null,this.pendingResults=[],this.maxConcurrentRequests=e,this.pendingExec=!1}next(){if(this.queue.isEmpty()||this.pendingResults.length>this.maxConcurrentRequests||this.pendingExec)return;const e=this.queue.next();if(!e)return;const{request:t,result:n}=e;this.pendingResults.push(n),"exec"===t.type&&(this.pendingExec=!0),this.submit(t,n).finally(()=>{for(;this.pendingResults.length&&this.pendingResults[0].state!==vC.pending;){const e=this.pendingResults.shift();e.state===vC.ready?e.fulfill():e.state===vC.done&&this._logger.warn("Found resolved query in pending results.")}"exec"===t.type&&(this.pendingExec=!1),this.next()})}enqueue(e,t=IC.Normal){this.queue.insert(e,t),this.next()}async submit(e,t){try{const{query:n,type:i,cache:r=!1,options:o}=e,s=n?`${n}`:null;if(r){const e=this.clientCache.get(s);if(e){const n=await e;return this._logger.debug("Cache"),void t.ready(n)}}const a=performance.now();this._logQueries&&this._logger.debug("Query",{type:i,sql:s,...o});const l=this.db.query({type:i,sql:s,...o});r&&this.clientCache.set(s,l);const c=await l;r&&this.clientCache.set(s,c),this._logger.debug(`Request: ${(performance.now()-a).toFixed(1)}`),t.ready("exec"===i?null:c)}catch(n){t.reject(n)}}cache(e){return void 0!==e?this.clientCache=!0===e?function({max:e=1e3,ttl:t=108e5}={}){let n=new Map;function i(){const e=performance.now()-t;let i=null,r=1/0;for(const[t,o]of n){const{last:s}=o;s<r&&(i=t,r=s),e>s&&n.delete(t)}i&&n.delete(i)}return{get(e){const t=n.get(e);if(t)return t.last=performance.now(),t.value},set:(t,r)=>(n.set(t,{last:performance.now(),value:r}),n.size>e&&TC(i),r),clear(){n=new Map}}}():e||{get:()=>{},set:(e,t)=>t,clear:()=>{}}:this.clientCache}logger(e){return e?this._logger=e:this._logger}logQueries(e){return void 0!==e?this._logQueries=!!e:this._logQueries}connector(e){return e?this.db=e:this.db}consolidate(e){e&&!this._consolidate?this._consolidate=xC(this.enqueue.bind(this),this.clientCache):!e&&this._consolidate&&(this._consolidate=null)}request(e,t=IC.Normal){const n=new bC,i={request:e,result:n};return this._consolidate?this._consolidate.add(i,t):this.enqueue(i,t),n}cancel(e){const t=new Set(e);if(t.size){this.queue.remove(({result:e})=>!!t.has(e)&&(e.reject("Canceled"),!0));for(const e of this.pendingResults)t.has(e)&&e.reject("Canceled")}}clear(){this.queue.remove(({result:e})=>(e.reject("Cleared"),!0));for(const e of this.pendingResults)e.reject("Cleared");this.pendingResults=[]}}let LC;function RC(e){return e?LC=e:null==LC&&(LC=new PC),LC}class PC{constructor(e=new fw,t={}){s(this,"manager"),s(this,"preaggregator"),s(this,"clients",new Set),s(this,"filterGroups",new Map),s(this,"_logger",yC());const{logger:n=console,manager:i=new AC,cache:r=!0,consolidate:o=!0,preagg:a={}}=t;this.manager=i,this.manager.cache(r),this.manager.consolidate(o),this.databaseConnector(e),this.logger(n),this.clear(),this.preaggregator=new mC(this,a)}clear(e={}){var t,n;const{clients:i=!0,cache:r=!0}=e;this.manager.clear(),i&&(null==(t=this.filterGroups)||t.forEach(e=>e.disconnect()),this.filterGroups=new Map,null==(n=this.clients)||n.forEach(e=>this.disconnect(e)),this.clients=new Set),r&&this.manager.cache().clear()}databaseConnector(e){return e?this.manager.connector(e):this.manager.connector()}logger(e){return arguments.length&&(this._logger=e||yC(),this.manager.logger(this._logger)),this._logger}cancel(e){this.manager.cancel(e)}exec(e,t={}){const{priority:n=IC.Normal}=t;return e=Array.isArray(e)?e.filter(e=>e).join(";\n"):e,this.manager.request({type:"exec",query:e},n)}query(e,t={}){const{type:n="arrow",cache:i=!0,priority:r=IC.Normal,...o}=t;return this.manager.request({type:n,query:e,cache:i,options:o},r)}prefetch(e,t={}){return this.query(e,{...t,cache:!0,priority:IC.Low})}updateClient(e,t,n=IC.Normal){return e.queryPending(),e._pending=this.query(t,{priority:n}).then(t=>e.queryResult(t).update(),t=>{var n;null==(n=this._logger)||n.error(t),e.queryError(t)}).catch(e=>{var t;return null==(t=this._logger)?void 0:t.error(e)})}requestQuery(e,t){return this.preaggregator.clear(),t?this.updateClient(e,t):Promise.resolve(e.update())}connect(e){const{clients:t}=this;if(null==t?void 0:t.has(e))throw new Error("Client already connected.");null==t||t.add(e),e.coordinator=this,e.initialize(),function(e,t,n){var i,r;if(!t)return;let o=null==(i=e.filterGroups)?void 0:i.get(t);if(!o){const n=n=>function(e,t,n){const{preaggregator:i,filterGroups:r}=e,{clients:o}=r.get(t);for(const s of o)s.enabled&&i.request(s,t,n)}(e,t,n),i=()=>function(e,t){const{preaggregator:n,filterGroups:i}=e,{clients:r}=i.get(t),{active:o}=t;return Promise.allSettled(Array.from(r,i=>{if(!i.enabled)return i.requestQuery();const r=n.request(i,t,o),s=r?null:t.predicate(i);if((null==r?void 0:r.skip)||!r&&!s)return;const a=(null==r?void 0:r.query(o.predicate))??i.query(s);return e.updateClient(i,a)}))}(e,t);t.addEventListener("activate",n),t.addEventListener("value",i),o={selection:t,clients:new Set,disconnect(){t.removeEventListener("activate",n),t.removeEventListener("value",i)}},null==(r=e.filterGroups)||r.set(t,o)}o.clients.add(n)}(this,e.filterBy,e)}disconnect(e){const{clients:t,filterGroups:n}=this;if(!(null==t?void 0:t.has(e)))return;t.delete(e),e.coordinator=null;const i=null==n?void 0:n.get(e.filterBy);i&&i.clients.delete(e)}}class MC extends Kv{constructor({selection:e,enabled:t=!0,filterStable:n=!0,...i}){super(e),s(this,"_methods"),s(this,"_filterStable"),this.enabled=t,this._methods=i,this._filterStable=n}get filterStable(){return this._filterStable}async prepare(){var e,t;await(null==(t=(e=this._methods).prepare)?void 0:t.call(e))}query(e){var t,n;return(null==(n=(t=this._methods).query)?void 0:n.call(t,e))??null}queryResult(e){var t,n;return null==(n=(t=this._methods).queryResult)||n.call(t,e),this}queryPending(){var e,t;return null==(t=(e=this._methods).queryPending)||t.call(e),this}queryError(e){var t,n;return null==(n=(t=this._methods).queryError)||n.call(t,e),this}}class DC{constructor(){s(this,"_callbacks"),this._callbacks=new Map}addEventListener(e,t){this._callbacks.has(e)||this._callbacks.set(e,{callbacks:new Set,pending:null,queue:new NC}),this._callbacks.get(e).callbacks.add(t)}removeEventListener(e,t){const n=this._callbacks.get(e);n&&n.callbacks.delete(t)}willEmit(e,t){return t}emitQueueFilter(e,t){return null}cancel(e){const t=this._callbacks.get(e);null==t||t.queue.clear()}async pending(e){var t;await(null==(t=this._callbacks.get(e))?void 0:t.pending)}emit(e,t){const n=this._callbacks.get(e)||{};if(n.pending)n.queue.enqueue(t,this.emitQueueFilter(e,t));else{const i=this.willEmit(e,t),{callbacks:r,queue:o}=n;if(null==r?void 0:r.size){const t=Array.from(r,e=>e(i));n.pending=Promise.allSettled(t).then(()=>{n.pending=null,o.isEmpty()||this.emit(e,o.dequeue())})}}}}class NC{constructor(){s(this,"next",null),this.clear()}clear(){this.next=null}isEmpty(){return!this.next}enqueue(e,t){const n={value:e};if(t&&this.next){let e=this;for(;e.next;)t(e.next.value)?e=e.next:e.next=e.next.next;e.next=n}else this.next=n}dequeue(){const{next:e}=this;return this.next=(null==e?void 0:e.next)||null,null==e?void 0:e.value}}function FC(e){return e instanceof OC}class OC extends DC{constructor(e){super(),s(this,"_value"),this._value=e}static value(e){return new OC(e)}static array(e){if(e.some(e=>FC(e))){const t=new OC,n=()=>{t.update(e.map(e=>FC(e)?e.value:e))};return n(),e.forEach(e=>FC(e)?e.addEventListener("value",n):0),t}return new OC(e)}get value(){return this._value}update(e,{force:t}={}){const n=function(e,t){return e!==t&&(e instanceof Date&&t instanceof Date?+e!==+t:!Array.isArray(e)||!Array.isArray(t)||function(e,t){if(e.length!==t.length)return!0;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!0;return!1}(e,t))}(this._value,e)||t;return n?this.emit("value",e):this.cancel("value"),this}willEmit(e,t){return"value"===e&&(this._value=t),t}}function BC(e,t){return new zC(new UC(e),t?[t].flat():void 0)}let zC=class e extends OC{constructor(e=new UC,t=[]){if(super([]),s(this,"_resolved"),s(this,"_resolver"),s(this,"_relay"),this._resolved=this._value,this._resolver=e,this._relay=new Set,Array.isArray(t))for(const n of t)n._relay.add(this)}static intersect({cross:e=!1,empty:t=!1,include:n=[]}={}){return BC({cross:e,empty:t},n)}static union({cross:e=!1,empty:t=!1,include:n=[]}={}){return BC({cross:e,empty:t,union:!0},n)}static single({cross:e=!1,empty:t=!1,include:n=[]}={}){return BC({cross:e,empty:t,single:!0},n)}static crossfilter({empty:e=!1,include:t=[]}={}){return BC({cross:!0,empty:e},t)}clone(){const t=new e(this._resolver);return t._value=t._resolved=this._value,t}remove(e){const t=this.clone();return t._value=t._resolved=t._resolver.resolve(this._resolved,{source:e}),t._value.active={source:e},t}get resolver(){return this._resolver}get single(){return this._resolver.single}get clauses(){return super.value}get active(){return this.clauses.active}get value(){var e;return null==(e=this.active)?void 0:e.value}valueFor(e){var t;return null==(t=this.clauses.find(t=>t.source===e))?void 0:t.value}activate(e){this.emit("activate",e),this._relay.forEach(t=>t.activate(e))}update(e){return this._resolved=this._resolver.resolve(this._resolved,e,!0),this._resolved.active=e,this._relay.forEach(t=>t.update(e)),super.update(this._resolved)}reset(e){return e??(e=this._resolved),e.forEach(e=>{var t,n;return null==(n=null==(t=e.source)?void 0:t.reset)?void 0:n.call(t)}),this._resolved=this._resolved.filter(t=>!e.includes(t)),this._relay.forEach(t=>t.reset(e)),super.update(this._resolved)}willEmit(e,t){return"value"===e?(this._value=t,this.value):t}emitQueueFilter(e,t){return"value"===e?this._resolver.queueFilter(t):null}skip(e,t){return this._resolver.skip(e,t)}predicate(e=void 0,t=!1){const{clauses:n}=this,i=t?null:n.active;return this._resolver.predicate(n,i,e)}};class UC{constructor({union:e,cross:t,single:n,empty:i}={}){s(this,"union"),s(this,"cross"),s(this,"single"),s(this,"empty"),this.union=!!e,this.cross=!!t,this.single=!!n,this.empty=!!i}resolve(e,t,n=!1){const{source:i,predicate:r}=t,o=e.filter(e=>i!==e.source),s=this.single?[]:o;return this.single&&n&&o.forEach(e=>{var t,n;return null==(n=null==(t=e.source)?void 0:t.reset)?void 0:n.call(t)}),r&&s.push(t),s}skip(e,t){var n;return null!=e&&Boolean(this.cross&&(null==(n=null==t?void 0:t.clients)?void 0:n.has(e)))}predicate(e,t,n){const{empty:i,union:r}=this;if(i&&!e.length)return[MS(!1)];if(this.skip(n,t))return;const o=e.filter(e=>!this.skip(n,e)).map(e=>e.predicate);return r&&o.length>1?function(...e){return new QS(xS(e))}(o):o}queueFilter(e){var t;if(this.cross){const n=null==(t=e.active)?void 0:t.source;return e=>{var t;return(null==(t=e.active)?void 0:t.source)!==n}}return null}}class VC{constructor({uri:e="http://localhost:3000/",ipc:t}={}){s(this,"_uri"),s(this,"_ipc"),this._uri=e,this._ipc=t}async query(e){const t=fetch(this._uri,{method:"POST",mode:"cors",credentials:"omit",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await t;if(!n.ok)throw new Error(`Query failed with HTTP status ${n.status}: ${await n.text()}`);return"exec"===e.type?t:"arrow"===e.type?hw(await n.arrayBuffer(),this._ipc):n.json()}}function HC(e,t,n,i){return new(n||(n=Promise))(function(r,o){function s(e){try{l(i.next(e))}catch(qe){o(qe)}}function a(e){try{l(i.throw(e))}catch(qe){o(qe)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})}function WC(e){return this instanceof WC?(this.v=e,this):new WC(e)}function $C(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),o=[];return i=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),i[Symbol.asyncIterator]=function(){return this},i;function s(e,t){r[e]&&(i[e]=function(t){return new Promise(function(n,i){o.push([e,t,n,i])>1||a(e,t)})},t&&(i[e]=t(i[e])))}function a(e,t){try{!function(e){e.value instanceof WC?Promise.resolve(e.value.v).then(l,c):u(o[0][2],e)}(r[e](t))}catch(qe){u(o[0][3],qe)}}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function GC(e){var t,n;return t={},i("next"),i("throw",function(e){throw e}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,r){t[i]=e[i]?function(t){return(n=!n)?{value:WC(e[i](t)),done:!1}:r?r(t):t}:r}}function jC(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise(function(i,r){!function(e,t,n,i){Promise.resolve(i).then(function(t){e({value:t,done:n})},t)}(i,r,(t=e[n](t)).done,t.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const YC=new TextDecoder("utf-8"),qC=e=>YC.decode(e),XC=new TextEncoder,KC=e=>XC.encode(e),ZC=e=>"boolean"==typeof e,QC=e=>"function"==typeof e,JC=e=>null!=e&&Object(e)===e,eT=e=>JC(e)&&QC(e.then),tT=e=>JC(e)&&QC(e[Symbol.iterator]),nT=e=>JC(e)&&QC(e[Symbol.asyncIterator]),iT=e=>JC(e)&&JC(e.schema),rT=e=>JC(e)&&"done"in e&&"value"in e,oT=e=>JC(e)&&QC(e.stat)&&(e=>"number"==typeof e)(e.fd),sT=e=>JC(e)&&lT(e.body),aT=e=>"_getDOMStream"in e&&"_getNodeStream"in e,lT=e=>JC(e)&&QC(e.cancel)&&QC(e.getReader)&&!aT(e),cT=e=>JC(e)&&QC(e.read)&&QC(e.pipe)&&ZC(e.readable)&&!aT(e),uT="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function dT(e,t,n=0,i=t.byteLength){const r=e.byteLength,o=new Uint8Array(e.buffer,e.byteOffset,r),s=new Uint8Array(t.buffer,t.byteOffset,Math.min(i,r));return o.set(s,n),e}function hT(e,t){const n=function(e){const t=e[0]?[e[0]]:[];let n,i,r,o;for(let s,a,l=0,c=0,u=e.length;++l<u;)s=t[c],a=e[l],!s||!a||s.buffer!==a.buffer||a.byteOffset<s.byteOffset?a&&(t[++c]=a):(({byteOffset:n,byteLength:r}=s),({byteOffset:i,byteLength:o}=a),n+r<i||i+o<n?a&&(t[++c]=a):t[c]=new Uint8Array(s.buffer,n,i-n+o));return t}(e),i=n.reduce((e,t)=>e+t.byteLength,0);let r,o,s,a=0,l=-1;const c=Math.min(t||Number.POSITIVE_INFINITY,i);for(const u=n.length;++l<u;){if(r=n[l],o=r.subarray(0,Math.min(r.length,c-a)),c<=a+o.length){o.length<r.length?n[l]=r.subarray(o.length):o.length===r.length&&l++,s?dT(s,o,a):s=o;break}dT(s||(s=new Uint8Array(c)),o,a),a+=o.length}return[s||new Uint8Array(0),n.slice(l),i-(s?s.byteLength:0)]}function fT(e,t){let n=rT(t)?t.value:t;return n instanceof e?e===Uint8Array?new e(n.buffer,n.byteOffset,n.byteLength):n:n?("string"==typeof n&&(n=KC(n)),n instanceof ArrayBuffer||n instanceof uT?new e(n):JC(i=n)&&QC(i.clear)&&QC(i.bytes)&&QC(i.position)&&QC(i.setPosition)&&QC(i.capacity)&&QC(i.getBufferIdentifier)&&QC(i.createLong)?fT(e,n.bytes()):ArrayBuffer.isView(n)?n.byteLength<=0?new e(0):new e(n.buffer,n.byteOffset,n.byteLength/e.BYTES_PER_ELEMENT):e.from(n)):new e(0);var i}const pT=e=>fT(Int32Array,e),mT=e=>fT(BigInt64Array,e),gT=e=>fT(Uint8Array,e),_T=e=>(e.next(),e);function yT(e,t){return $C(this,arguments,function*(){if(eT(t))return yield WC(yield WC(yield*GC(jC(yT(e,yield WC(t))))));const n=function(e){return $C(this,arguments,function*(){yield yield WC(yield WC(e))})},i="string"==typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof uT?n(t):tT(t)?function(e){return $C(this,arguments,function*(){yield WC(yield*GC(jC(_T(function*(e){let t=null;do{t=e.next(yield null==t?void 0:t.value)}while(!t.done)}(e[Symbol.iterator]())))))})}(t):nT(t)?t:n(t);return yield WC(yield*GC(jC(_T(function(t){return $C(this,arguments,function*(){let n=null;do{n=yield WC(t.next(yield yield WC(fT(e,n))))}while(!n.done)})}(i[Symbol.asyncIterator]()))))),yield WC(new e)})}const vT=e=>yT(Uint8Array,e);function bT(e,t,n){if(0!==e)for(let i=-1,r=(n=n.slice(0,t)).length;++i<r;)n[i]+=e;return n.subarray(0,t)}const xT={fromIterable:e=>wT(function*(e){let t,n,i,r,o=!1,s=[],a=0;function l(){return"peek"===i?hT(s,r)[0]:([n,s,a]=hT(s,r),n)}({cmd:i,size:r}=(yield(()=>null)())||{cmd:"read",size:0});const c=(u=e,function*(e,t){const n=function*(e){yield e},i="string"==typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof uT?n(t):tT(t)?t:n(t);return yield*_T(function*(t){let n=null;do{n=t.next(yield fT(e,n))}while(!n.done)}(i[Symbol.iterator]())),new e}(Uint8Array,u))[Symbol.iterator]();var u;try{do{if(({done:t,value:n}=Number.isNaN(r-a)?c.next():c.next(r-a)),!t&&n.byteLength>0&&(s.push(n),a+=n.byteLength),t||r<=a)do{({cmd:i,size:r}=yield l())}while(r<a)}while(!t)}catch(qe){(o=!0)&&"function"==typeof c.throw&&c.throw(qe)}finally{!1===o&&"function"==typeof c.return&&c.return(null)}return null}(e)),fromAsyncIterable:e=>wT(function(e){return $C(this,arguments,function*(){let t,n,i,r,o=!1,s=[],a=0;function l(){return"peek"===i?hT(s,r)[0]:([n,s,a]=hT(s,r),n)}({cmd:i,size:r}=(yield yield WC((()=>null)()))||{cmd:"read",size:0});const c=vT(e)[Symbol.asyncIterator]();try{do{if(({done:t,value:n}=Number.isNaN(r-a)?yield WC(c.next()):yield WC(c.next(r-a))),!t&&n.byteLength>0&&(s.push(n),a+=n.byteLength),t||r<=a)do{({cmd:i,size:r}=yield yield WC(l()))}while(r<a)}while(!t)}catch(qe){(o=!0)&&"function"==typeof c.throw&&(yield WC(c.throw(qe)))}finally{!1===o&&"function"==typeof c.return&&(yield WC(c.return(new Uint8Array(0))))}return yield WC(null)})}(e)),fromDOMStream:e=>wT(function(e){return $C(this,arguments,function*(){let t,n,i,r=!1,o=!1,s=[],a=0;function l(){return"peek"===n?hT(s,i)[0]:([t,s,a]=hT(s,i),t)}({cmd:n,size:i}=(yield yield WC((()=>null)()))||{cmd:"read",size:0});const c=new ST(e);try{do{if(({done:r,value:t}=Number.isNaN(i-a)?yield WC(c.read()):yield WC(c.read(i-a))),!r&&t.byteLength>0&&(s.push(gT(t)),a+=t.byteLength),r||i<=a)do{({cmd:n,size:i}=yield yield WC(l()))}while(i<a)}while(!r)}catch(qe){(o=!0)&&(yield WC(c.cancel(qe)))}finally{!1===o?yield WC(c.cancel()):e.locked&&c.releaseLock()}return yield WC(null)})}(e)),fromNodeStream:e=>wT(function(e){return $C(this,arguments,function*(){const t=[];let n,i,r,o="error",s=!1,a=null,l=0,c=[];function u(){return"peek"===n?hT(c,i)[0]:([r,c,l]=hT(c,i),r)}if(({cmd:n,size:i}=(yield yield WC((()=>null)()))||{cmd:"read",size:0}),e.isTTY)return yield yield WC(new Uint8Array(0)),yield WC(null);try{t[0]=ET(e,"end"),t[1]=ET(e,"error");do{if(t[2]=ET(e,"readable"),[o,a]=yield WC(Promise.race(t.map(e=>e[2]))),"error"===o)break;if((s="end"===o)||(Number.isFinite(i-l)?(r=gT(e.read(i-l)),r.byteLength<i-l&&(r=gT(e.read()))):r=gT(e.read()),r.byteLength>0&&(c.push(r),l+=r.byteLength)),s||i<=l)do{({cmd:n,size:i}=yield yield WC(u()))}while(i<l)}while(!s)}finally{yield WC((d=t,h="error"===o?a:null,r=c=null,new Promise((t,n)=>{for(const[i,r]of d)e.off(i,r);try{const t=e.destroy;t&&t.call(e,h),h=void 0}catch(qe){h=qe||h}finally{null!=h?n(h):t()}})))}var d,h;return yield WC(null)})}(e)),toDOMStream(e,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(e,t){throw new Error('"toNodeStream" not available in this environment')}},wT=e=>(e.next(),e);class ST{constructor(e){this.source=e,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(e){return HC(this,void 0,void 0,function*(){const{reader:t,source:n}=this;t&&(yield t.cancel(e).catch(()=>{})),n&&n.locked&&this.releaseLock()})}read(e){return HC(this,void 0,void 0,function*(){if(0===e)return{done:null==this.reader,value:new Uint8Array(0)};const t=yield this.reader.read();return!t.done&&(t.value=gT(t)),t})}}const ET=(e,t)=>{const n=e=>i([t,e]);let i;return[t,n,new Promise(r=>(i=r)&&e.once(t,n))]};var CT,TT,kT,IT,AT,LT,RT,PT,MT,DT,NT,FT;(TT=CT||(CT={}))[TT.V1=0]="V1",TT[TT.V2=1]="V2",TT[TT.V3=2]="V3",TT[TT.V4=3]="V4",TT[TT.V5=4]="V5",(IT=kT||(kT={}))[IT.Sparse=0]="Sparse",IT[IT.Dense=1]="Dense",(LT=AT||(AT={}))[LT.HALF=0]="HALF",LT[LT.SINGLE=1]="SINGLE",LT[LT.DOUBLE=2]="DOUBLE",(PT=RT||(RT={}))[PT.DAY=0]="DAY",PT[PT.MILLISECOND=1]="MILLISECOND",(DT=MT||(MT={}))[DT.SECOND=0]="SECOND",DT[DT.MILLISECOND=1]="MILLISECOND",DT[DT.MICROSECOND=2]="MICROSECOND",DT[DT.NANOSECOND=3]="NANOSECOND",(FT=NT||(NT={}))[FT.YEAR_MONTH=0]="YEAR_MONTH",FT[FT.DAY_TIME=1]="DAY_TIME",FT[FT.MONTH_DAY_NANO=2]="MONTH_DAY_NANO";const OT=new Int32Array(2),BT=new Float32Array(OT.buffer),zT=new Float64Array(OT.buffer),UT=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0];var VT,HT;(HT=VT||(VT={}))[HT.UTF8_BYTES=1]="UTF8_BYTES",HT[HT.UTF16_STRING=2]="UTF16_STRING";let WT=class e{constructor(e){this.bytes_=e,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new e(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(e){this.position_=e}capacity(){return this.bytes_.length}readInt8(e){return this.readUint8(e)<<24>>24}readUint8(e){return this.bytes_[e]}readInt16(e){return this.readUint16(e)<<16>>16}readUint16(e){return this.bytes_[e]|this.bytes_[e+1]<<8}readInt32(e){return this.bytes_[e]|this.bytes_[e+1]<<8|this.bytes_[e+2]<<16|this.bytes_[e+3]<<24}readUint32(e){return this.readInt32(e)>>>0}readInt64(e){return BigInt.asIntN(64,BigInt(this.readUint32(e))+(BigInt(this.readUint32(e+4))<<BigInt(32)))}readUint64(e){return BigInt.asUintN(64,BigInt(this.readUint32(e))+(BigInt(this.readUint32(e+4))<<BigInt(32)))}readFloat32(e){return OT[0]=this.readInt32(e),BT[0]}readFloat64(e){return OT[UT?0:1]=this.readInt32(e),OT[UT?1:0]=this.readInt32(e+4),zT[0]}writeInt8(e,t){this.bytes_[e]=t}writeUint8(e,t){this.bytes_[e]=t}writeInt16(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8}writeUint16(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8}writeInt32(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24}writeUint32(e,t){this.bytes_[e]=t,this.bytes_[e+1]=t>>8,this.bytes_[e+2]=t>>16,this.bytes_[e+3]=t>>24}writeInt64(e,t){this.writeInt32(e,Number(BigInt.asIntN(32,t))),this.writeInt32(e+4,Number(BigInt.asIntN(32,t>>BigInt(32))))}writeUint64(e,t){this.writeUint32(e,Number(BigInt.asUintN(32,t))),this.writeUint32(e+4,Number(BigInt.asUintN(32,t>>BigInt(32))))}writeFloat32(e,t){BT[0]=t,this.writeInt32(e,OT[0])}writeFloat64(e,t){zT[0]=t,this.writeInt32(e,OT[UT?0:1]),this.writeInt32(e+4,OT[UT?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let e="";for(let t=0;t<4;t++)e+=String.fromCharCode(this.readInt8(this.position_+4+t));return e}__offset(e,t){const n=e-this.readInt32(e);return t<this.readInt16(n)?this.readInt16(n+t):0}__union(e,t){return e.bb_pos=t+this.readInt32(t),e.bb=this,e}__string(e,t){e+=this.readInt32(e);const n=this.readInt32(e);e+=4;const i=this.bytes_.subarray(e,e+n);return t===VT.UTF8_BYTES?i:this.text_decoder_.decode(i)}__union_with_string(e,t){return"string"==typeof e?this.__string(t):this.__union(e,t)}__indirect(e){return e+this.readInt32(e)}__vector(e){return e+this.readInt32(e)+4}__vector_len(e){return this.readInt32(e+this.readInt32(e))}__has_identifier(e){if(4!=e.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let t=0;t<4;t++)if(e.charCodeAt(t)!=this.readInt8(this.position()+4+t))return!1;return!0}createScalarList(e,t){const n=[];for(let i=0;i<t;++i){const t=e(i);null!==t&&n.push(t)}return n}createObjList(e,t){const n=[];for(let i=0;i<t;++i){const t=e(i);null!==t&&n.push(t.unpack())}return n}},$T=class e{constructor(e){let t;this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder,t=e||1024,this.bb=WT.allocate(t),this.space=t}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(e){this.force_defaults=e}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,n){t>this.minalign&&(this.minalign=t);const i=1+~(this.bb.capacity()-this.space+n)&t-1;for(;this.space<i+t+n;){const t=this.bb.capacity();this.bb=e.growByteBuffer(this.bb),this.space+=this.bb.capacity()-t}this.pad(i)}pad(e){for(let t=0;t<e;t++)this.bb.writeInt8(--this.space,0)}writeInt8(e){this.bb.writeInt8(this.space-=1,e)}writeInt16(e){this.bb.writeInt16(this.space-=2,e)}writeInt32(e){this.bb.writeInt32(this.space-=4,e)}writeInt64(e){this.bb.writeInt64(this.space-=8,e)}writeFloat32(e){this.bb.writeFloat32(this.space-=4,e)}writeFloat64(e){this.bb.writeFloat64(this.space-=8,e)}addInt8(e){this.prep(1,0),this.writeInt8(e)}addInt16(e){this.prep(2,0),this.writeInt16(e)}addInt32(e){this.prep(4,0),this.writeInt32(e)}addInt64(e){this.prep(8,0),this.writeInt64(e)}addFloat32(e){this.prep(4,0),this.writeFloat32(e)}addFloat64(e){this.prep(8,0),this.writeFloat64(e)}addFieldInt8(e,t,n){(this.force_defaults||t!=n)&&(this.addInt8(t),this.slot(e))}addFieldInt16(e,t,n){(this.force_defaults||t!=n)&&(this.addInt16(t),this.slot(e))}addFieldInt32(e,t,n){(this.force_defaults||t!=n)&&(this.addInt32(t),this.slot(e))}addFieldInt64(e,t,n){(this.force_defaults||t!==n)&&(this.addInt64(t),this.slot(e))}addFieldFloat32(e,t,n){(this.force_defaults||t!=n)&&(this.addFloat32(t),this.slot(e))}addFieldFloat64(e,t,n){(this.force_defaults||t!=n)&&(this.addFloat64(t),this.slot(e))}addFieldOffset(e,t,n){(this.force_defaults||t!=n)&&(this.addOffset(t),this.slot(e))}addFieldStruct(e,t,n){t!=n&&(this.nested(t),this.slot(e))}nested(e){if(e!=this.offset())throw new TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new TypeError("FlatBuffers: object serialization must not be nested.")}slot(e){null!==this.vtable&&(this.vtable[e]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(e){const t=e.capacity();if(3221225472&t)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const n=t<<1,i=WT.allocate(n);return i.setPosition(n-t),i.bytes().set(e.bytes(),n-t),i}addOffset(e){this.prep(4,0),this.writeInt32(this.offset()-e+4)}startObject(e){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=e;for(let t=0;t<e;t++)this.vtable[t]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const e=this.offset();let t=this.vtable_in_use-1;for(;t>=0&&0==this.vtable[t];t--);const n=t+1;for(;t>=0;t--)this.addInt16(0!=this.vtable[t]?e-this.vtable[t]:0);this.addInt16(e-this.object_start);const i=2*(n+2);this.addInt16(i);let r=0;const o=this.space;e:for(t=0;t<this.vtables.length;t++){const e=this.bb.capacity()-this.vtables[t];if(i==this.bb.readInt16(e)){for(let t=2;t<i;t+=2)if(this.bb.readInt16(o+t)!=this.bb.readInt16(e+t))continue e;r=this.vtables[t];break}}return r?(this.space=this.bb.capacity()-e,this.bb.writeInt32(this.space,r-e)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-e,this.offset()-e)),this.isNested=!1,e}finish(e,t,n){const i=n?4:0;if(t){const e=t;if(this.prep(this.minalign,8+i),4!=e.length)throw new TypeError("FlatBuffers: file identifier must be length 4");for(let t=3;t>=0;t--)this.writeInt8(e.charCodeAt(t))}this.prep(this.minalign,4+i),this.addOffset(e),i&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(e,t){this.finish(e,t,!0)}requiredField(e,t){const n=this.bb.capacity()-e,i=n-this.bb.readInt32(n);if(!(t<this.bb.readInt16(i)&&0!=this.bb.readInt16(i+t)))throw new TypeError("FlatBuffers: field "+t+" must be set")}startVector(e,t,n){this.notNested(),this.vector_num_elems=t,this.prep(4,e*t),this.prep(n,e*t)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(e){if(!e)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(e))return this.string_maps.get(e);const t=this.createString(e);return this.string_maps.set(e,t),t}createString(e){if(null==e)return 0;let t;return t=e instanceof Uint8Array?e:this.text_encoder.encode(e),this.addInt8(0),this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length),this.bb.bytes().set(t,this.space),this.endVector()}createByteVector(e){return null==e?0:(this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length),this.bb.bytes().set(e,this.space),this.endVector())}createObjectOffset(e){return null===e?0:"string"==typeof e?this.createString(e):e.pack(this)}createObjectOffsetList(e){const t=[];for(let n=0;n<e.length;++n){const i=e[n];if(null===i)throw new TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.");t.push(this.createObjectOffset(i))}return t}createStructOffsetList(e,t){return t(this,e.length),this.createObjectOffsetList(e.slice().reverse()),this.endVector()}};var GT,jT,YT,qT;(jT=GT||(GT={}))[jT.BUFFER=0]="BUFFER",(qT=YT||(YT={}))[qT.LZ4_FRAME=0]="LZ4_FRAME",qT[qT.ZSTD=1]="ZSTD";class XT{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsBodyCompression(e,t){return(t||new XT).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsBodyCompression(e,t){return e.setPosition(e.position()+4),(t||new XT).__init(e.readInt32(e.position())+e.position(),e)}codec(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt8(this.bb_pos+e):YT.LZ4_FRAME}method(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt8(this.bb_pos+e):GT.BUFFER}static startBodyCompression(e){e.startObject(2)}static addCodec(e,t){e.addFieldInt8(0,t,YT.LZ4_FRAME)}static addMethod(e,t){e.addFieldInt8(1,t,GT.BUFFER)}static endBodyCompression(e){return e.endObject()}static createBodyCompression(e,t,n){return XT.startBodyCompression(e),XT.addCodec(e,t),XT.addMethod(e,n),XT.endBodyCompression(e)}}class KT{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(e,t,n){return e.prep(8,16),e.writeInt64(BigInt(null!=n?n:0)),e.writeInt64(BigInt(null!=t?t:0)),e.offset()}}let ZT=class{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(e,t,n){return e.prep(8,16),e.writeInt64(BigInt(null!=n?n:0)),e.writeInt64(BigInt(null!=t?t:0)),e.offset()}},QT=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsRecordBatch(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}length(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}nodes(e,t){const n=this.bb.__offset(this.bb_pos,6);return n?(t||new ZT).__init(this.bb.__vector(this.bb_pos+n)+16*e,this.bb):null}nodesLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}buffers(e,t){const n=this.bb.__offset(this.bb_pos,8);return n?(t||new KT).__init(this.bb.__vector(this.bb_pos+n)+16*e,this.bb):null}buffersLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}compression(e){const t=this.bb.__offset(this.bb_pos,10);return t?(e||new XT).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}static startRecordBatch(e){e.startObject(4)}static addLength(e,t){e.addFieldInt64(0,t,BigInt("0"))}static addNodes(e,t){e.addFieldOffset(1,t,0)}static startNodesVector(e,t){e.startVector(16,t,8)}static addBuffers(e,t){e.addFieldOffset(2,t,0)}static startBuffersVector(e,t){e.startVector(16,t,8)}static addCompression(e,t){e.addFieldOffset(3,t,0)}static endRecordBatch(e){return e.endObject()}},JT=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDictionaryBatch(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}id(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}data(e){const t=this.bb.__offset(this.bb_pos,6);return t?(e||new QT).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}isDelta(){const e=this.bb.__offset(this.bb_pos,8);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}static startDictionaryBatch(e){e.startObject(3)}static addId(e,t){e.addFieldInt64(0,t,BigInt("0"))}static addData(e,t){e.addFieldOffset(1,t,0)}static addIsDelta(e,t){e.addFieldInt8(2,+t,0)}static endDictionaryBatch(e){return e.endObject()}};var ek,tk,nk,ik;(tk=ek||(ek={}))[tk.Little=0]="Little",tk[tk.Big=1]="Big",(ik=nk||(nk={}))[ik.DenseArray=0]="DenseArray";class rk{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsInt(e,t){return(t||new rk).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInt(e,t){return e.setPosition(e.position()+4),(t||new rk).__init(e.readInt32(e.position())+e.position(),e)}bitWidth(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}isSigned(){const e=this.bb.__offset(this.bb_pos,6);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}static startInt(e){e.startObject(2)}static addBitWidth(e,t){e.addFieldInt32(0,t,0)}static addIsSigned(e,t){e.addFieldInt8(1,+t,0)}static endInt(e){return e.endObject()}static createInt(e,t,n){return rk.startInt(e),rk.addBitWidth(e,t),rk.addIsSigned(e,n),rk.endInt(e)}}class ok{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDictionaryEncoding(e,t){return(t||new ok).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsDictionaryEncoding(e,t){return e.setPosition(e.position()+4),(t||new ok).__init(e.readInt32(e.position())+e.position(),e)}id(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}indexType(e){const t=this.bb.__offset(this.bb_pos,6);return t?(e||new rk).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}isOrdered(){const e=this.bb.__offset(this.bb_pos,8);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}dictionaryKind(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt16(this.bb_pos+e):nk.DenseArray}static startDictionaryEncoding(e){e.startObject(4)}static addId(e,t){e.addFieldInt64(0,t,BigInt("0"))}static addIndexType(e,t){e.addFieldOffset(1,t,0)}static addIsOrdered(e,t){e.addFieldInt8(2,+t,0)}static addDictionaryKind(e,t){e.addFieldInt16(3,t,nk.DenseArray)}static endDictionaryEncoding(e){return e.endObject()}}class sk{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsKeyValue(e,t){return(t||new sk).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsKeyValue(e,t){return e.setPosition(e.position()+4),(t||new sk).__init(e.readInt32(e.position())+e.position(),e)}key(e){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}value(e){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}static startKeyValue(e){e.startObject(2)}static addKey(e,t){e.addFieldOffset(0,t,0)}static addValue(e,t){e.addFieldOffset(1,t,0)}static endKeyValue(e){return e.endObject()}static createKeyValue(e,t,n){return sk.startKeyValue(e),sk.addKey(e,t),sk.addValue(e,n),sk.endKeyValue(e)}}let ak=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsBinary(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(e){e.startObject(0)}static endBinary(e){return e.endObject()}static createBinary(t){return e.startBinary(t),e.endBinary(t)}},lk=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsBool(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static startBool(e){e.startObject(0)}static endBool(e){return e.endObject()}static createBool(t){return e.startBool(t),e.endBool(t)}},ck=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDate(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):RT.MILLISECOND}static startDate(e){e.startObject(1)}static addUnit(e,t){e.addFieldInt16(0,t,RT.MILLISECOND)}static endDate(e){return e.endObject()}static createDate(t,n){return e.startDate(t),e.addUnit(t,n),e.endDate(t)}},uk=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDecimal(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}precision(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}scale(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):0}bitWidth(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readInt32(this.bb_pos+e):128}static startDecimal(e){e.startObject(3)}static addPrecision(e,t){e.addFieldInt32(0,t,0)}static addScale(e,t){e.addFieldInt32(1,t,0)}static addBitWidth(e,t){e.addFieldInt32(2,t,128)}static endDecimal(e){return e.endObject()}static createDecimal(t,n,i,r){return e.startDecimal(t),e.addPrecision(t,n),e.addScale(t,i),e.addBitWidth(t,r),e.endDecimal(t)}},dk=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsDuration(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDuration(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):MT.MILLISECOND}static startDuration(e){e.startObject(1)}static addUnit(e,t){e.addFieldInt16(0,t,MT.MILLISECOND)}static endDuration(e){return e.endObject()}static createDuration(t,n){return e.startDuration(t),e.addUnit(t,n),e.endDuration(t)}},hk=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFixedSizeBinary(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeBinary(e){e.startObject(1)}static addByteWidth(e,t){e.addFieldInt32(0,t,0)}static endFixedSizeBinary(e){return e.endObject()}static createFixedSizeBinary(t,n){return e.startFixedSizeBinary(t),e.addByteWidth(t,n),e.endFixedSizeBinary(t)}},fk=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFixedSizeList(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}listSize(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt32(this.bb_pos+e):0}static startFixedSizeList(e){e.startObject(1)}static addListSize(e,t){e.addFieldInt32(0,t,0)}static endFixedSizeList(e){return e.endObject()}static createFixedSizeList(t,n){return e.startFixedSizeList(t),e.addListSize(t,n),e.endFixedSizeList(t)}};class pk{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFloatingPoint(e,t){return(t||new pk).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFloatingPoint(e,t){return e.setPosition(e.position()+4),(t||new pk).__init(e.readInt32(e.position())+e.position(),e)}precision(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):AT.HALF}static startFloatingPoint(e){e.startObject(1)}static addPrecision(e,t){e.addFieldInt16(0,t,AT.HALF)}static endFloatingPoint(e){return e.endObject()}static createFloatingPoint(e,t){return pk.startFloatingPoint(e),pk.addPrecision(e,t),pk.endFloatingPoint(e)}}class mk{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsInterval(e,t){return(t||new mk).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsInterval(e,t){return e.setPosition(e.position()+4),(t||new mk).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):NT.YEAR_MONTH}static startInterval(e){e.startObject(1)}static addUnit(e,t){e.addFieldInt16(0,t,NT.YEAR_MONTH)}static endInterval(e){return e.endObject()}static createInterval(e,t){return mk.startInterval(e),mk.addUnit(e,t),mk.endInterval(e)}}let gk=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsLargeBinary(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsLargeBinary(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static startLargeBinary(e){e.startObject(0)}static endLargeBinary(e){return e.endObject()}static createLargeBinary(t){return e.startLargeBinary(t),e.endLargeBinary(t)}},_k=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsLargeUtf8(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsLargeUtf8(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static startLargeUtf8(e){e.startObject(0)}static endLargeUtf8(e){return e.endObject()}static createLargeUtf8(t){return e.startLargeUtf8(t),e.endLargeUtf8(t)}},yk=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsList(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static startList(e){e.startObject(0)}static endList(e){return e.endObject()}static createList(t){return e.startList(t),e.endList(t)}},vk=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsMap(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){const e=this.bb.__offset(this.bb_pos,4);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}static startMap(e){e.startObject(1)}static addKeysSorted(e,t){e.addFieldInt8(0,+t,0)}static endMap(e){return e.endObject()}static createMap(t,n){return e.startMap(t),e.addKeysSorted(t,n),e.endMap(t)}},bk=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsNull(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static startNull(e){e.startObject(0)}static endNull(e){return e.endObject()}static createNull(t){return e.startNull(t),e.endNull(t)}};class xk{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsStruct_(e,t){return(t||new xk).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsStruct_(e,t){return e.setPosition(e.position()+4),(t||new xk).__init(e.readInt32(e.position())+e.position(),e)}static startStruct_(e){e.startObject(0)}static endStruct_(e){return e.endObject()}static createStruct_(e){return xk.startStruct_(e),xk.endStruct_(e)}}class wk{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTime(e,t){return(t||new wk).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTime(e,t){return e.setPosition(e.position()+4),(t||new wk).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):MT.MILLISECOND}bitWidth(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb_pos+e):32}static startTime(e){e.startObject(2)}static addUnit(e,t){e.addFieldInt16(0,t,MT.MILLISECOND)}static addBitWidth(e,t){e.addFieldInt32(1,t,32)}static endTime(e){return e.endObject()}static createTime(e,t,n){return wk.startTime(e),wk.addUnit(e,t),wk.addBitWidth(e,n),wk.endTime(e)}}class Sk{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsTimestamp(e,t){return(t||new Sk).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsTimestamp(e,t){return e.setPosition(e.position()+4),(t||new Sk).__init(e.readInt32(e.position())+e.position(),e)}unit(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):MT.SECOND}timezone(e){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__string(this.bb_pos+t,e):null}static startTimestamp(e){e.startObject(2)}static addUnit(e,t){e.addFieldInt16(0,t,MT.SECOND)}static addTimezone(e,t){e.addFieldOffset(1,t,0)}static endTimestamp(e){return e.endObject()}static createTimestamp(e,t,n){return Sk.startTimestamp(e),Sk.addUnit(e,t),Sk.addTimezone(e,n),Sk.endTimestamp(e)}}class Ek{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsUnion(e,t){return(t||new Ek).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsUnion(e,t){return e.setPosition(e.position()+4),(t||new Ek).__init(e.readInt32(e.position())+e.position(),e)}mode(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):kT.Sparse}typeIds(e){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb.__vector(this.bb_pos+t)+4*e):0}typeIdsLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}typeIdsArray(){const e=this.bb.__offset(this.bb_pos,6);return e?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+e),this.bb.__vector_len(this.bb_pos+e)):null}static startUnion(e){e.startObject(2)}static addMode(e,t){e.addFieldInt16(0,t,kT.Sparse)}static addTypeIds(e,t){e.addFieldOffset(1,t,0)}static createTypeIdsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addInt32(t[n]);return e.endVector()}static startTypeIdsVector(e,t){e.startVector(4,t,4)}static endUnion(e){return e.endObject()}static createUnion(e,t,n){return Ek.startUnion(e),Ek.addMode(e,t),Ek.addTypeIds(e,n),Ek.endUnion(e)}}let Ck=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsUtf8(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(e){e.startObject(0)}static endUtf8(e){return e.endObject()}static createUtf8(t){return e.startUtf8(t),e.endUtf8(t)}};var Tk,kk;(kk=Tk||(Tk={}))[kk.NONE=0]="NONE",kk[kk.Null=1]="Null",kk[kk.Int=2]="Int",kk[kk.FloatingPoint=3]="FloatingPoint",kk[kk.Binary=4]="Binary",kk[kk.Utf8=5]="Utf8",kk[kk.Bool=6]="Bool",kk[kk.Decimal=7]="Decimal",kk[kk.Date=8]="Date",kk[kk.Time=9]="Time",kk[kk.Timestamp=10]="Timestamp",kk[kk.Interval=11]="Interval",kk[kk.List=12]="List",kk[kk.Struct_=13]="Struct_",kk[kk.Union=14]="Union",kk[kk.FixedSizeBinary=15]="FixedSizeBinary",kk[kk.FixedSizeList=16]="FixedSizeList",kk[kk.Map=17]="Map",kk[kk.Duration=18]="Duration",kk[kk.LargeBinary=19]="LargeBinary",kk[kk.LargeUtf8=20]="LargeUtf8",kk[kk.LargeList=21]="LargeList",kk[kk.RunEndEncoded=22]="RunEndEncoded";let Ik=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsField(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}name(e){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.__string(this.bb_pos+t,e):null}nullable(){const e=this.bb.__offset(this.bb_pos,6);return!!e&&!!this.bb.readInt8(this.bb_pos+e)}typeType(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.readUint8(this.bb_pos+e):Tk.NONE}type(e){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__union(e,this.bb_pos+t):null}dictionary(e){const t=this.bb.__offset(this.bb_pos,12);return t?(e||new ok).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}children(t,n){const i=this.bb.__offset(this.bb_pos,14);return i?(n||new e).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+4*t),this.bb):null}childrenLength(){const e=this.bb.__offset(this.bb_pos,14);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,t){const n=this.bb.__offset(this.bb_pos,16);return n?(t||new sk).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,16);return e?this.bb.__vector_len(this.bb_pos+e):0}static startField(e){e.startObject(7)}static addName(e,t){e.addFieldOffset(0,t,0)}static addNullable(e,t){e.addFieldInt8(1,+t,0)}static addTypeType(e,t){e.addFieldInt8(2,t,Tk.NONE)}static addType(e,t){e.addFieldOffset(3,t,0)}static addDictionary(e,t){e.addFieldOffset(4,t,0)}static addChildren(e,t){e.addFieldOffset(5,t,0)}static createChildrenVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startChildrenVector(e,t){e.startVector(4,t,4)}static addCustomMetadata(e,t){e.addFieldOffset(6,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static endField(e){return e.endObject()}},Ak=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsSchema(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}endianness(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):ek.Little}fields(e,t){const n=this.bb.__offset(this.bb_pos,6);return n?(t||new Ik).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}fieldsLength(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,t){const n=this.bb.__offset(this.bb_pos,8);return n?(t||new sk).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}features(e){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb.__vector(this.bb_pos+t)+8*e):BigInt(0)}featuresLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}static startSchema(e){e.startObject(4)}static addEndianness(e,t){e.addFieldInt16(0,t,ek.Little)}static addFields(e,t){e.addFieldOffset(1,t,0)}static createFieldsVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startFieldsVector(e,t){e.startVector(4,t,4)}static addCustomMetadata(e,t){e.addFieldOffset(2,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static addFeatures(e,t){e.addFieldOffset(3,t,0)}static createFeaturesVector(e,t){e.startVector(8,t.length,8);for(let n=t.length-1;n>=0;n--)e.addInt64(t[n]);return e.endVector()}static startFeaturesVector(e,t){e.startVector(8,t,8)}static endSchema(e){return e.endObject()}static finishSchemaBuffer(e,t){e.finish(t)}static finishSizePrefixedSchemaBuffer(e,t){e.finish(t,void 0,!0)}static createSchema(t,n,i,r,o){return e.startSchema(t),e.addEndianness(t,n),e.addFields(t,i),e.addCustomMetadata(t,r),e.addFeatures(t,o),e.endSchema(t)}};var Lk,Rk,Pk,Mk,Dk;function Nk(e){if(null===e)return"null";if(void 0===e)return"undefined";switch(typeof e){case"number":case"bigint":return`${e}`;case"string":return`"${e}"`}return"function"==typeof e[Symbol.toPrimitive]?e[Symbol.toPrimitive]("string"):ArrayBuffer.isView(e)?e instanceof BigInt64Array||e instanceof BigUint64Array?`[${[...e].map(e=>Nk(e))}]`:`[${e}]`:ArrayBuffer.isView(e)?`[${e}]`:JSON.stringify(e,(e,t)=>"bigint"==typeof t?`${t}`:t)}function Fk(e){if("bigint"==typeof e&&(e<Number.MIN_SAFE_INTEGER||e>Number.MAX_SAFE_INTEGER))throw new TypeError(`${e} is not safe to convert to a number.`);return Number(e)}function Ok(e,t){return Fk(e/t)+Fk(e%t)/Fk(t)}(Rk=Lk||(Lk={}))[Rk.NONE=0]="NONE",Rk[Rk.Schema=1]="Schema",Rk[Rk.DictionaryBatch=2]="DictionaryBatch",Rk[Rk.RecordBatch=3]="RecordBatch",Rk[Rk.Tensor=4]="Tensor",Rk[Rk.SparseTensor=5]="SparseTensor",function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct=13]="Struct",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.Dictionary=-1]="Dictionary",e[e.Int8=-2]="Int8",e[e.Int16=-3]="Int16",e[e.Int32=-4]="Int32",e[e.Int64=-5]="Int64",e[e.Uint8=-6]="Uint8",e[e.Uint16=-7]="Uint16",e[e.Uint32=-8]="Uint32",e[e.Uint64=-9]="Uint64",e[e.Float16=-10]="Float16",e[e.Float32=-11]="Float32",e[e.Float64=-12]="Float64",e[e.DateDay=-13]="DateDay",e[e.DateMillisecond=-14]="DateMillisecond",e[e.TimestampSecond=-15]="TimestampSecond",e[e.TimestampMillisecond=-16]="TimestampMillisecond",e[e.TimestampMicrosecond=-17]="TimestampMicrosecond",e[e.TimestampNanosecond=-18]="TimestampNanosecond",e[e.TimeSecond=-19]="TimeSecond",e[e.TimeMillisecond=-20]="TimeMillisecond",e[e.TimeMicrosecond=-21]="TimeMicrosecond",e[e.TimeNanosecond=-22]="TimeNanosecond",e[e.DenseUnion=-23]="DenseUnion",e[e.SparseUnion=-24]="SparseUnion",e[e.IntervalDayTime=-25]="IntervalDayTime",e[e.IntervalYearMonth=-26]="IntervalYearMonth",e[e.DurationSecond=-27]="DurationSecond",e[e.DurationMillisecond=-28]="DurationMillisecond",e[e.DurationMicrosecond=-29]="DurationMicrosecond",e[e.DurationNanosecond=-30]="DurationNanosecond"}(Pk||(Pk={})),(Dk=Mk||(Mk={}))[Dk.OFFSET=0]="OFFSET",Dk[Dk.DATA=1]="DATA",Dk[Dk.VALIDITY=2]="VALIDITY",Dk[Dk.TYPE=3]="TYPE";const Bk=Symbol.for("isArrowBigNum");function zk(e,...t){return 0===t.length?Object.setPrototypeOf(fT(this.TypedArray,e),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(e,...t),this.constructor.prototype)}function Uk(...e){return zk.apply(this,e)}function Vk(...e){return zk.apply(this,e)}function Hk(...e){return zk.apply(this,e)}zk.prototype[Bk]=!0,zk.prototype.toJSON=function(){return`"${Gk(this)}"`},zk.prototype.valueOf=function(e){return $k(this,e)},zk.prototype.toString=function(){return Gk(this)},zk.prototype[Symbol.toPrimitive]=function(e="default"){switch(e){case"number":return $k(this);case"string":return Gk(this);case"default":return function(e){return 8===e.byteLength?new e.BigIntArray(e.buffer,e.byteOffset,1)[0]:Gk(e)}(this)}return Gk(this)},Object.setPrototypeOf(Uk.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf(Vk.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf(Hk.prototype,Object.create(Uint32Array.prototype)),Object.assign(Uk.prototype,zk.prototype,{constructor:Uk,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array}),Object.assign(Vk.prototype,zk.prototype,{constructor:Vk,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array}),Object.assign(Hk.prototype,zk.prototype,{constructor:Hk,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});const Wk=BigInt(4294967296)*BigInt(4294967296)-BigInt(1);function $k(e,t){const{buffer:n,byteOffset:i,byteLength:r,signed:o}=e,s=new BigUint64Array(n,i,r/8),a=o&&s.at(-1)&BigInt(1)<<BigInt(63);let l=BigInt(0),c=0;if(a){for(const e of s)l|=(e^Wk)*(BigInt(1)<<BigInt(64*c++));l*=BigInt(-1),l-=BigInt(1)}else for(const u of s)l|=u*(BigInt(1)<<BigInt(64*c++));if("number"==typeof t){const e=BigInt(Math.pow(10,t)),n=l%e;return Fk(l/e)+Fk(n)/Fk(e)}return Fk(l)}function Gk(e){if(8===e.byteLength)return`${new e.BigIntArray(e.buffer,e.byteOffset,1)[0]}`;if(!e.signed)return jk(e);let t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);if(new Int16Array([t.at(-1)])[0]>=0)return jk(e);t=t.slice();let n=1;for(let i=0;i<t.length;i++){const e=t[i],r=~e+n;t[i]=r,n&=0===e?1:0}return`-${jk(t)}`}function jk(e){let t="";const n=new Uint32Array(2);let i=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);const r=new Uint32Array((i=new Uint16Array(i).reverse()).buffer);let o=-1;const s=i.length-1;do{for(n[0]=i[o=0];o<s;)i[o++]=n[1]=n[0]/10,n[0]=(n[0]-10*n[1]<<16)+i[o];i[o]=n[1]=n[0]/10,n[0]=n[0]-10*n[1],t=`${n[0]}${t}`}while(r[0]||r[1]||r[2]||r[3]);return null!=t?t:"0"}class Yk{static new(e,t){switch(t){case!0:return new Uk(e);case!1:return new Vk(e)}switch(e.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new Uk(e)}return 16===e.byteLength?new Hk(e):new Vk(e)}static signed(e){return new Uk(e)}static unsigned(e){return new Vk(e)}static decimal(e){return new Hk(e)}constructor(e,t){return Yk.new(e,t)}}var qk,Xk,Kk,Zk,Qk,Jk,eI,tI,nI,iI,rI,oI,sI,aI,lI,cI,uI,dI,hI,fI,pI,mI,gI;class _I{static isNull(e){return(null==e?void 0:e.typeId)===Pk.Null}static isInt(e){return(null==e?void 0:e.typeId)===Pk.Int}static isFloat(e){return(null==e?void 0:e.typeId)===Pk.Float}static isBinary(e){return(null==e?void 0:e.typeId)===Pk.Binary}static isLargeBinary(e){return(null==e?void 0:e.typeId)===Pk.LargeBinary}static isUtf8(e){return(null==e?void 0:e.typeId)===Pk.Utf8}static isLargeUtf8(e){return(null==e?void 0:e.typeId)===Pk.LargeUtf8}static isBool(e){return(null==e?void 0:e.typeId)===Pk.Bool}static isDecimal(e){return(null==e?void 0:e.typeId)===Pk.Decimal}static isDate(e){return(null==e?void 0:e.typeId)===Pk.Date}static isTime(e){return(null==e?void 0:e.typeId)===Pk.Time}static isTimestamp(e){return(null==e?void 0:e.typeId)===Pk.Timestamp}static isInterval(e){return(null==e?void 0:e.typeId)===Pk.Interval}static isDuration(e){return(null==e?void 0:e.typeId)===Pk.Duration}static isList(e){return(null==e?void 0:e.typeId)===Pk.List}static isStruct(e){return(null==e?void 0:e.typeId)===Pk.Struct}static isUnion(e){return(null==e?void 0:e.typeId)===Pk.Union}static isFixedSizeBinary(e){return(null==e?void 0:e.typeId)===Pk.FixedSizeBinary}static isFixedSizeList(e){return(null==e?void 0:e.typeId)===Pk.FixedSizeList}static isMap(e){return(null==e?void 0:e.typeId)===Pk.Map}static isDictionary(e){return(null==e?void 0:e.typeId)===Pk.Dictionary}static isDenseUnion(e){return _I.isUnion(e)&&e.mode===kT.Dense}static isSparseUnion(e){return _I.isUnion(e)&&e.mode===kT.Sparse}constructor(e){this.typeId=e}}qk=Symbol.toStringTag,_I[qk]=((gI=_I.prototype).children=null,gI.ArrayType=Array,gI.OffsetArrayType=Int32Array,gI[Symbol.toStringTag]="DataType");class yI extends _I{constructor(){super(Pk.Null)}toString(){return"Null"}}Xk=Symbol.toStringTag,yI[Xk]=yI.prototype[Symbol.toStringTag]="Null";class vI extends _I{constructor(e,t){super(Pk.Int),this.isSigned=e,this.bitWidth=t}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}Kk=Symbol.toStringTag,vI[Kk]=(e=>(e.isSigned=null,e.bitWidth=null,e[Symbol.toStringTag]="Int"))(vI.prototype);class bI extends vI{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}class xI extends vI{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}class wI extends vI{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}let SI=class extends vI{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}};class EI extends vI{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}class CI extends vI{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}class TI extends vI{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}let kI=class extends vI{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}};Object.defineProperty(bI.prototype,"ArrayType",{value:Int8Array}),Object.defineProperty(xI.prototype,"ArrayType",{value:Int16Array}),Object.defineProperty(wI.prototype,"ArrayType",{value:Int32Array}),Object.defineProperty(SI.prototype,"ArrayType",{value:BigInt64Array}),Object.defineProperty(EI.prototype,"ArrayType",{value:Uint8Array}),Object.defineProperty(CI.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(TI.prototype,"ArrayType",{value:Uint32Array}),Object.defineProperty(kI.prototype,"ArrayType",{value:BigUint64Array});class II extends _I{constructor(e){super(Pk.Float),this.precision=e}get ArrayType(){switch(this.precision){case AT.HALF:return Uint16Array;case AT.SINGLE:return Float32Array;case AT.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}Zk=Symbol.toStringTag,II[Zk]=(e=>(e.precision=null,e[Symbol.toStringTag]="Float"))(II.prototype);class AI extends II{constructor(){super(AT.SINGLE)}}class LI extends II{constructor(){super(AT.DOUBLE)}}Object.defineProperty(AI.prototype,"ArrayType",{value:Float32Array}),Object.defineProperty(LI.prototype,"ArrayType",{value:Float64Array});class RI extends _I{constructor(){super(Pk.Binary)}toString(){return"Binary"}}Qk=Symbol.toStringTag,RI[Qk]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Binary"))(RI.prototype);class PI extends _I{constructor(){super(Pk.LargeBinary)}toString(){return"LargeBinary"}}Jk=Symbol.toStringTag,PI[Jk]=(e=>(e.ArrayType=Uint8Array,e.OffsetArrayType=BigInt64Array,e[Symbol.toStringTag]="LargeBinary"))(PI.prototype);class MI extends _I{constructor(){super(Pk.Utf8)}toString(){return"Utf8"}}eI=Symbol.toStringTag,MI[eI]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Utf8"))(MI.prototype);class DI extends _I{constructor(){super(Pk.LargeUtf8)}toString(){return"LargeUtf8"}}tI=Symbol.toStringTag,DI[tI]=(e=>(e.ArrayType=Uint8Array,e.OffsetArrayType=BigInt64Array,e[Symbol.toStringTag]="LargeUtf8"))(DI.prototype);class NI extends _I{constructor(){super(Pk.Bool)}toString(){return"Bool"}}nI=Symbol.toStringTag,NI[nI]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Bool"))(NI.prototype);class FI extends _I{constructor(e,t,n=128){super(Pk.Decimal),this.scale=e,this.precision=t,this.bitWidth=n}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}iI=Symbol.toStringTag,FI[iI]=(e=>(e.scale=null,e.precision=null,e.ArrayType=Uint32Array,e[Symbol.toStringTag]="Decimal"))(FI.prototype);class OI extends _I{constructor(e){super(Pk.Date),this.unit=e}toString(){return`Date${32*(this.unit+1)}<${RT[this.unit]}>`}get ArrayType(){return this.unit===RT.DAY?Int32Array:BigInt64Array}}rI=Symbol.toStringTag,OI[rI]=(e=>(e.unit=null,e[Symbol.toStringTag]="Date"))(OI.prototype);class BI extends _I{constructor(e,t){super(Pk.Time),this.unit=e,this.bitWidth=t}toString(){return`Time${this.bitWidth}<${MT[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}oI=Symbol.toStringTag,BI[oI]=(e=>(e.unit=null,e.bitWidth=null,e[Symbol.toStringTag]="Time"))(BI.prototype);class zI extends _I{constructor(e,t){super(Pk.Timestamp),this.unit=e,this.timezone=t}toString(){return`Timestamp<${MT[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}sI=Symbol.toStringTag,zI[sI]=(e=>(e.unit=null,e.timezone=null,e.ArrayType=BigInt64Array,e[Symbol.toStringTag]="Timestamp"))(zI.prototype);class UI extends zI{constructor(e){super(MT.MILLISECOND,e)}}class VI extends _I{constructor(e){super(Pk.Interval),this.unit=e}toString(){return`Interval<${NT[this.unit]}>`}}aI=Symbol.toStringTag,VI[aI]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Interval"))(VI.prototype);class HI extends _I{constructor(e){super(Pk.Duration),this.unit=e}toString(){return`Duration<${MT[this.unit]}>`}}lI=Symbol.toStringTag,HI[lI]=(e=>(e.unit=null,e.ArrayType=BigInt64Array,e[Symbol.toStringTag]="Duration"))(HI.prototype);class WI extends _I{constructor(e){super(Pk.List),this.children=[e]}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}cI=Symbol.toStringTag,WI[cI]=(e=>(e.children=null,e[Symbol.toStringTag]="List"))(WI.prototype);class $I extends _I{constructor(e){super(Pk.Struct),this.children=e}toString(){return`Struct<{${this.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}}uI=Symbol.toStringTag,$I[uI]=(e=>(e.children=null,e[Symbol.toStringTag]="Struct"))($I.prototype);class GI extends _I{constructor(e,t,n){super(Pk.Union),this.mode=e,this.children=n,this.typeIds=t=Int32Array.from(t),this.typeIdToChildIndex=t.reduce((e,t,n)=>(e[t]=n)&&e||e,Object.create(null))}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(e=>`${e.type}`).join(" | ")}>`}}dI=Symbol.toStringTag,GI[dI]=(e=>(e.mode=null,e.typeIds=null,e.children=null,e.typeIdToChildIndex=null,e.ArrayType=Int8Array,e[Symbol.toStringTag]="Union"))(GI.prototype);class jI extends _I{constructor(e){super(Pk.FixedSizeBinary),this.byteWidth=e}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}hI=Symbol.toStringTag,jI[hI]=(e=>(e.byteWidth=null,e.ArrayType=Uint8Array,e[Symbol.toStringTag]="FixedSizeBinary"))(jI.prototype);class YI extends _I{constructor(e,t){super(Pk.FixedSizeList),this.listSize=e,this.children=[t]}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}fI=Symbol.toStringTag,YI[fI]=(e=>(e.children=null,e.listSize=null,e[Symbol.toStringTag]="FixedSizeList"))(YI.prototype);class qI extends _I{constructor(e,t=!1){var n,i,r;if(super(Pk.Map),this.children=[e],this.keysSorted=t,e&&(e.name="entries",null===(n=null==e?void 0:e.type)||void 0===n?void 0:n.children)){const t=null===(i=null==e?void 0:e.type)||void 0===i?void 0:i.children[0];t&&(t.name="key");const n=null===(r=null==e?void 0:e.type)||void 0===r?void 0:r.children[1];n&&(n.name="value")}}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(e=>`${e.name}:${e.type}`).join(", ")}}>`}}pI=Symbol.toStringTag,qI[pI]=(e=>(e.children=null,e.keysSorted=null,e[Symbol.toStringTag]="Map_"))(qI.prototype);const XI=(e=>()=>++e)(-1);class KI extends _I{constructor(e,t,n,i){super(Pk.Dictionary),this.indices=t,this.dictionary=e,this.isOrdered=i||!1,this.id=null==n?XI():Fk(n)}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}function ZI(e){const t=e;switch(e.typeId){case Pk.Decimal:return e.bitWidth/32;case Pk.Interval:return 1+t.unit;case Pk.FixedSizeList:return t.listSize;case Pk.FixedSizeBinary:return t.byteWidth;default:return 1}}mI=Symbol.toStringTag,KI[mI]=(e=>(e.id=null,e.indices=null,e.isOrdered=null,e.dictionary=null,e[Symbol.toStringTag]="Dictionary"))(KI.prototype);class QI{visitMany(e,...t){return e.map((e,n)=>this.visit(e,...t.map(e=>e[n])))}visit(...e){return this.getVisitFn(e[0],!1).apply(this,e)}getVisitFn(e,t=!0){return function(e,t,n=!0){return"number"==typeof t?JI(e,t,n):"string"==typeof t&&t in Pk?JI(e,Pk[t],n):t&&t instanceof _I?JI(e,eA(t),n):(null==t?void 0:t.type)&&t.type instanceof _I?JI(e,eA(t.type),n):JI(e,Pk.NONE,n)}(this,e,t)}getVisitFnByTypeId(e,t=!0){return JI(this,e,t)}visitNull(e,...t){return null}visitBool(e,...t){return null}visitInt(e,...t){return null}visitFloat(e,...t){return null}visitUtf8(e,...t){return null}visitLargeUtf8(e,...t){return null}visitBinary(e,...t){return null}visitLargeBinary(e,...t){return null}visitFixedSizeBinary(e,...t){return null}visitDate(e,...t){return null}visitTimestamp(e,...t){return null}visitTime(e,...t){return null}visitDecimal(e,...t){return null}visitList(e,...t){return null}visitStruct(e,...t){return null}visitUnion(e,...t){return null}visitDictionary(e,...t){return null}visitInterval(e,...t){return null}visitDuration(e,...t){return null}visitFixedSizeList(e,...t){return null}visitMap(e,...t){return null}}function JI(e,t,n=!0){let i=null;switch(t){case Pk.Null:i=e.visitNull;break;case Pk.Bool:i=e.visitBool;break;case Pk.Int:i=e.visitInt;break;case Pk.Int8:i=e.visitInt8||e.visitInt;break;case Pk.Int16:i=e.visitInt16||e.visitInt;break;case Pk.Int32:i=e.visitInt32||e.visitInt;break;case Pk.Int64:i=e.visitInt64||e.visitInt;break;case Pk.Uint8:i=e.visitUint8||e.visitInt;break;case Pk.Uint16:i=e.visitUint16||e.visitInt;break;case Pk.Uint32:i=e.visitUint32||e.visitInt;break;case Pk.Uint64:i=e.visitUint64||e.visitInt;break;case Pk.Float:i=e.visitFloat;break;case Pk.Float16:i=e.visitFloat16||e.visitFloat;break;case Pk.Float32:i=e.visitFloat32||e.visitFloat;break;case Pk.Float64:i=e.visitFloat64||e.visitFloat;break;case Pk.Utf8:i=e.visitUtf8;break;case Pk.LargeUtf8:i=e.visitLargeUtf8;break;case Pk.Binary:i=e.visitBinary;break;case Pk.LargeBinary:i=e.visitLargeBinary;break;case Pk.FixedSizeBinary:i=e.visitFixedSizeBinary;break;case Pk.Date:i=e.visitDate;break;case Pk.DateDay:i=e.visitDateDay||e.visitDate;break;case Pk.DateMillisecond:i=e.visitDateMillisecond||e.visitDate;break;case Pk.Timestamp:i=e.visitTimestamp;break;case Pk.TimestampSecond:i=e.visitTimestampSecond||e.visitTimestamp;break;case Pk.TimestampMillisecond:i=e.visitTimestampMillisecond||e.visitTimestamp;break;case Pk.TimestampMicrosecond:i=e.visitTimestampMicrosecond||e.visitTimestamp;break;case Pk.TimestampNanosecond:i=e.visitTimestampNanosecond||e.visitTimestamp;break;case Pk.Time:i=e.visitTime;break;case Pk.TimeSecond:i=e.visitTimeSecond||e.visitTime;break;case Pk.TimeMillisecond:i=e.visitTimeMillisecond||e.visitTime;break;case Pk.TimeMicrosecond:i=e.visitTimeMicrosecond||e.visitTime;break;case Pk.TimeNanosecond:i=e.visitTimeNanosecond||e.visitTime;break;case Pk.Decimal:i=e.visitDecimal;break;case Pk.List:i=e.visitList;break;case Pk.Struct:i=e.visitStruct;break;case Pk.Union:i=e.visitUnion;break;case Pk.DenseUnion:i=e.visitDenseUnion||e.visitUnion;break;case Pk.SparseUnion:i=e.visitSparseUnion||e.visitUnion;break;case Pk.Dictionary:i=e.visitDictionary;break;case Pk.Interval:i=e.visitInterval;break;case Pk.IntervalDayTime:i=e.visitIntervalDayTime||e.visitInterval;break;case Pk.IntervalYearMonth:i=e.visitIntervalYearMonth||e.visitInterval;break;case Pk.Duration:i=e.visitDuration;break;case Pk.DurationSecond:i=e.visitDurationSecond||e.visitDuration;break;case Pk.DurationMillisecond:i=e.visitDurationMillisecond||e.visitDuration;break;case Pk.DurationMicrosecond:i=e.visitDurationMicrosecond||e.visitDuration;break;case Pk.DurationNanosecond:i=e.visitDurationNanosecond||e.visitDuration;break;case Pk.FixedSizeList:i=e.visitFixedSizeList;break;case Pk.Map:i=e.visitMap}if("function"==typeof i)return i;if(!n)return()=>null;throw new Error(`Unrecognized type '${Pk[t]}'`)}function eA(e){switch(e.typeId){case Pk.Null:return Pk.Null;case Pk.Int:{const{bitWidth:t,isSigned:n}=e;switch(t){case 8:return n?Pk.Int8:Pk.Uint8;case 16:return n?Pk.Int16:Pk.Uint16;case 32:return n?Pk.Int32:Pk.Uint32;case 64:return n?Pk.Int64:Pk.Uint64}return Pk.Int}case Pk.Float:switch(e.precision){case AT.HALF:return Pk.Float16;case AT.SINGLE:return Pk.Float32;case AT.DOUBLE:return Pk.Float64}return Pk.Float;case Pk.Binary:return Pk.Binary;case Pk.LargeBinary:return Pk.LargeBinary;case Pk.Utf8:return Pk.Utf8;case Pk.LargeUtf8:return Pk.LargeUtf8;case Pk.Bool:return Pk.Bool;case Pk.Decimal:return Pk.Decimal;case Pk.Time:switch(e.unit){case MT.SECOND:return Pk.TimeSecond;case MT.MILLISECOND:return Pk.TimeMillisecond;case MT.MICROSECOND:return Pk.TimeMicrosecond;case MT.NANOSECOND:return Pk.TimeNanosecond}return Pk.Time;case Pk.Timestamp:switch(e.unit){case MT.SECOND:return Pk.TimestampSecond;case MT.MILLISECOND:return Pk.TimestampMillisecond;case MT.MICROSECOND:return Pk.TimestampMicrosecond;case MT.NANOSECOND:return Pk.TimestampNanosecond}return Pk.Timestamp;case Pk.Date:switch(e.unit){case RT.DAY:return Pk.DateDay;case RT.MILLISECOND:return Pk.DateMillisecond}return Pk.Date;case Pk.Interval:switch(e.unit){case NT.DAY_TIME:return Pk.IntervalDayTime;case NT.YEAR_MONTH:return Pk.IntervalYearMonth}return Pk.Interval;case Pk.Duration:switch(e.unit){case MT.SECOND:return Pk.DurationSecond;case MT.MILLISECOND:return Pk.DurationMillisecond;case MT.MICROSECOND:return Pk.DurationMicrosecond;case MT.NANOSECOND:return Pk.DurationNanosecond}return Pk.Duration;case Pk.Map:return Pk.Map;case Pk.List:return Pk.List;case Pk.Struct:return Pk.Struct;case Pk.Union:switch(e.mode){case kT.Dense:return Pk.DenseUnion;case kT.Sparse:return Pk.SparseUnion}return Pk.Union;case Pk.FixedSizeBinary:return Pk.FixedSizeBinary;case Pk.FixedSizeList:return Pk.FixedSizeList;case Pk.Dictionary:return Pk.Dictionary}throw new Error(`Unrecognized type '${Pk[e.typeId]}'`)}QI.prototype.visitInt8=null,QI.prototype.visitInt16=null,QI.prototype.visitInt32=null,QI.prototype.visitInt64=null,QI.prototype.visitUint8=null,QI.prototype.visitUint16=null,QI.prototype.visitUint32=null,QI.prototype.visitUint64=null,QI.prototype.visitFloat16=null,QI.prototype.visitFloat32=null,QI.prototype.visitFloat64=null,QI.prototype.visitDateDay=null,QI.prototype.visitDateMillisecond=null,QI.prototype.visitTimestampSecond=null,QI.prototype.visitTimestampMillisecond=null,QI.prototype.visitTimestampMicrosecond=null,QI.prototype.visitTimestampNanosecond=null,QI.prototype.visitTimeSecond=null,QI.prototype.visitTimeMillisecond=null,QI.prototype.visitTimeMicrosecond=null,QI.prototype.visitTimeNanosecond=null,QI.prototype.visitDenseUnion=null,QI.prototype.visitSparseUnion=null,QI.prototype.visitIntervalDayTime=null,QI.prototype.visitIntervalYearMonth=null,QI.prototype.visitDuration=null,QI.prototype.visitDurationSecond=null,QI.prototype.visitDurationMillisecond=null,QI.prototype.visitDurationMicrosecond=null,QI.prototype.visitDurationNanosecond=null;const tA=new Float64Array(1),nA=new Uint32Array(tA.buffer);function iA(e){const t=(31744&e)>>10,n=(1023&e)/1024,i=Math.pow(-1,(32768&e)>>15);switch(t){case 31:return i*(n?Number.NaN:1/0);case 0:return i*(n?6103515625e-14*n:0)}return i*Math.pow(2,t-15)*(1+n)}function rA(e){if(e!=e)return 32256;tA[0]=e;const t=(2147483648&nA[1])>>16&65535;let n=2146435072&nA[1],i=0;return n>=1089470464?nA[0]>0?n=31744:(n=(2080374784&n)>>16,i=(1048575&nA[1])>>10):n<=1056964608?(i=1048576+(1048575&nA[1]),i=1048576+(i<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,i=512+(1048575&nA[1])>>10),t|n|65535&i}class oA extends QI{}function sA(e){return(t,n,i)=>{if(t.setValid(n,null!=i))return e(t,n,i)}}const aA=(e,t,n,i)=>{if(n+1<t.length){const r=Fk(t[n]),o=Fk(t[n+1]);e.set(i.subarray(0,o-r),r)}},lA=({values:e},t,n)=>{e[t]=n},cA=({values:e},t,n)=>{e[t]=n},uA=({values:e},t,n)=>{e[t]=rA(n)},dA=({values:e},t,n)=>{((e,t,n)=>{e[t]=Math.floor(n/864e5)})(e,t,n.valueOf())},hA=({values:e},t,n)=>{e[t]=BigInt(n)},fA=({stride:e,values:t},n,i)=>{t.set(i.subarray(0,e),e*n)},pA=({values:e,valueOffsets:t},n,i)=>aA(e,t,n,i),mA=({values:e,valueOffsets:t},n,i)=>aA(e,t,n,KC(i)),gA=(e,t,n)=>{e.type.unit===RT.DAY?dA(e,t,n):hA(e,t,n)},_A=({values:e},t,n)=>{e[t]=BigInt(n/1e3)},yA=({values:e},t,n)=>{e[t]=BigInt(n)},vA=({values:e},t,n)=>{e[t]=BigInt(1e3*n)},bA=({values:e},t,n)=>{e[t]=BigInt(1e6*n)},xA=(e,t,n)=>{switch(e.type.unit){case MT.SECOND:return _A(e,t,n);case MT.MILLISECOND:return yA(e,t,n);case MT.MICROSECOND:return vA(e,t,n);case MT.NANOSECOND:return bA(e,t,n)}},wA=({values:e},t,n)=>{e[t]=n},SA=({values:e},t,n)=>{e[t]=n},EA=({values:e},t,n)=>{e[t]=n},CA=({values:e},t,n)=>{e[t]=n},TA=(e,t,n)=>{switch(e.type.unit){case MT.SECOND:return wA(e,t,n);case MT.MILLISECOND:return SA(e,t,n);case MT.MICROSECOND:return EA(e,t,n);case MT.NANOSECOND:return CA(e,t,n)}},kA=({values:e,stride:t},n,i)=>{e.set(i.subarray(0,t),t*n)},IA=(e,t,n)=>{const i=e.type.typeIdToChildIndex[e.typeIds[t]],r=e.children[i];BA.visit(r,e.valueOffsets[t],n)},AA=(e,t,n)=>{const i=e.type.typeIdToChildIndex[e.typeIds[t]],r=e.children[i];BA.visit(r,t,n)},LA=(e,t,n)=>{e.type.unit===NT.DAY_TIME?RA(e,t,n):PA(e,t,n)},RA=({values:e},t,n)=>{e.set(n.subarray(0,2),2*t)},PA=({values:e},t,n)=>{e[t]=12*n[0]+n[1]%12},MA=({values:e},t,n)=>{e[t]=n},DA=({values:e},t,n)=>{e[t]=n},NA=({values:e},t,n)=>{e[t]=n},FA=({values:e},t,n)=>{e[t]=n},OA=(e,t,n)=>{switch(e.type.unit){case MT.SECOND:return MA(e,t,n);case MT.MILLISECOND:return DA(e,t,n);case MT.MICROSECOND:return NA(e,t,n);case MT.NANOSECOND:return FA(e,t,n)}};oA.prototype.visitBool=sA(({offset:e,values:t},n,i)=>{const r=e+n;i?t[r>>3]|=1<<r%8:t[r>>3]&=~(1<<r%8)}),oA.prototype.visitInt=sA(lA),oA.prototype.visitInt8=sA(lA),oA.prototype.visitInt16=sA(lA),oA.prototype.visitInt32=sA(lA),oA.prototype.visitInt64=sA(lA),oA.prototype.visitUint8=sA(lA),oA.prototype.visitUint16=sA(lA),oA.prototype.visitUint32=sA(lA),oA.prototype.visitUint64=sA(lA),oA.prototype.visitFloat=sA((e,t,n)=>{switch(e.type.precision){case AT.HALF:return uA(e,t,n);case AT.SINGLE:case AT.DOUBLE:return cA(e,t,n)}}),oA.prototype.visitFloat16=sA(uA),oA.prototype.visitFloat32=sA(cA),oA.prototype.visitFloat64=sA(cA),oA.prototype.visitUtf8=sA(mA),oA.prototype.visitLargeUtf8=sA(mA),oA.prototype.visitBinary=sA(pA),oA.prototype.visitLargeBinary=sA(pA),oA.prototype.visitFixedSizeBinary=sA(fA),oA.prototype.visitDate=sA(gA),oA.prototype.visitDateDay=sA(dA),oA.prototype.visitDateMillisecond=sA(hA),oA.prototype.visitTimestamp=sA(xA),oA.prototype.visitTimestampSecond=sA(_A),oA.prototype.visitTimestampMillisecond=sA(yA),oA.prototype.visitTimestampMicrosecond=sA(vA),oA.prototype.visitTimestampNanosecond=sA(bA),oA.prototype.visitTime=sA(TA),oA.prototype.visitTimeSecond=sA(wA),oA.prototype.visitTimeMillisecond=sA(SA),oA.prototype.visitTimeMicrosecond=sA(EA),oA.prototype.visitTimeNanosecond=sA(CA),oA.prototype.visitDecimal=sA(kA),oA.prototype.visitList=sA((e,t,n)=>{const i=e.children[0],r=e.valueOffsets,o=BA.getVisitFn(i);if(Array.isArray(n))for(let s=-1,a=r[t],l=r[t+1];a<l;)o(i,a++,n[++s]);else for(let s=-1,a=r[t],l=r[t+1];a<l;)o(i,a++,n.get(++s))}),oA.prototype.visitStruct=sA((e,t,n)=>{const i=e.type.children.map(e=>BA.getVisitFn(e.type)),r=n instanceof Map?((e,t)=>(n,i,r,o)=>i&&n(i,e,t.get(r.name)))(t,n):n instanceof aR?((e,t)=>(n,i,r,o)=>i&&n(i,e,t.get(o)))(t,n):Array.isArray(n)?((e,t)=>(n,i,r,o)=>i&&n(i,e,t[o]))(t,n):((e,t)=>(n,i,r,o)=>i&&n(i,e,t[r.name]))(t,n);e.type.children.forEach((t,n)=>r(i[n],e.children[n],t,n))}),oA.prototype.visitUnion=sA((e,t,n)=>{e.type.mode===kT.Dense?IA(e,t,n):AA(e,t,n)}),oA.prototype.visitDenseUnion=sA(IA),oA.prototype.visitSparseUnion=sA(AA),oA.prototype.visitDictionary=sA((e,t,n)=>{var i;null===(i=e.dictionary)||void 0===i||i.set(e.values[t],n)}),oA.prototype.visitInterval=sA(LA),oA.prototype.visitIntervalDayTime=sA(RA),oA.prototype.visitIntervalYearMonth=sA(PA),oA.prototype.visitDuration=sA(OA),oA.prototype.visitDurationSecond=sA(MA),oA.prototype.visitDurationMillisecond=sA(DA),oA.prototype.visitDurationMicrosecond=sA(NA),oA.prototype.visitDurationNanosecond=sA(FA),oA.prototype.visitFixedSizeList=sA((e,t,n)=>{const{stride:i}=e,r=e.children[0],o=BA.getVisitFn(r);if(Array.isArray(n))for(let s=-1,a=t*i;++s<i;)o(r,a+s,n[s]);else for(let s=-1,a=t*i;++s<i;)o(r,a+s,n.get(s))}),oA.prototype.visitMap=sA((e,t,n)=>{const i=e.children[0],{valueOffsets:r}=e,o=BA.getVisitFn(i);let{[t]:s,[t+1]:a}=r;const l=n instanceof Map?n.entries():Object.entries(n);for(const c of l)if(o(i,s,c),++s>=a)break});const BA=new oA,zA=Symbol.for("parent"),UA=Symbol.for("rowIndex");class VA{constructor(e,t){return this[zA]=e,this[UA]=t,new Proxy(this,new WA)}toArray(){return Object.values(this.toJSON())}toJSON(){const e=this[UA],t=this[zA],n=t.type.children,i={};for(let r=-1,o=n.length;++r<o;)i[n[r].name]=mL.visit(t.children[r],e);return i}toString(){return`{${[...this].map(([e,t])=>`${Nk(e)}: ${Nk(t)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new HA(this[zA],this[UA])}}class HA{constructor(e,t){this.childIndex=0,this.children=e.children,this.rowIndex=t,this.childFields=e.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const e=this.childIndex;return e<this.numChildren?(this.childIndex=e+1,{done:!1,value:[this.childFields[e].name,mL.visit(this.children[e],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(VA.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[zA]:{writable:!0,enumerable:!1,configurable:!1,value:null},[UA]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class WA{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(e){return e[zA].type.children.map(e=>e.name)}has(e,t){return-1!==e[zA].type.children.findIndex(e=>e.name===t)}getOwnPropertyDescriptor(e,t){if(-1!==e[zA].type.children.findIndex(e=>e.name===t))return{writable:!0,enumerable:!0,configurable:!0}}get(e,t){if(Reflect.has(e,t))return e[t];const n=e[zA].type.children.findIndex(e=>e.name===t);if(-1!==n){const i=mL.visit(e[zA].children[n],e[UA]);return Reflect.set(e,t,i),i}}set(e,t,n){const i=e[zA].type.children.findIndex(e=>e.name===t);return-1!==i?(BA.visit(e[zA].children[i],e[UA],n),Reflect.set(e,t,n)):!(!Reflect.has(e,t)&&"symbol"!=typeof t)&&Reflect.set(e,t,n)}}class $A extends QI{}function GA(e){return(t,n)=>t.getValid(n)?e(t,n):null}const jA=(e,t,n)=>{if(n+1>=t.length)return null;const i=Fk(t[n]),r=Fk(t[n+1]);return e.subarray(i,r)},YA=({values:e},t)=>((e,t)=>864e5*e[t])(e,t),qA=({values:e},t)=>Fk(e[t]),XA=({stride:e,values:t},n)=>t[e*n],KA=({values:e},t)=>e[t],ZA=({values:e,valueOffsets:t},n)=>jA(e,t,n),QA=({values:e,valueOffsets:t},n)=>{const i=jA(e,t,n);return null!==i?qC(i):null},JA=({values:e},t)=>1e3*Fk(e[t]),eL=({values:e},t)=>Fk(e[t]),tL=({values:e},t)=>Ok(e[t],BigInt(1e3)),nL=({values:e},t)=>Ok(e[t],BigInt(1e6)),iL=({values:e},t)=>e[t],rL=({values:e},t)=>e[t],oL=({values:e},t)=>e[t],sL=({values:e},t)=>e[t],aL=(e,t)=>{const n=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[n];return mL.visit(i,e.valueOffsets[t])},lL=(e,t)=>{const n=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[n];return mL.visit(i,t)},cL=({values:e},t)=>e.subarray(2*t,2*(t+1)),uL=({values:e},t)=>{const n=e[t],i=new Int32Array(2);return i[0]=Math.trunc(n/12),i[1]=Math.trunc(n%12),i},dL=({values:e},t)=>e[t],hL=({values:e},t)=>e[t],fL=({values:e},t)=>e[t],pL=({values:e},t)=>e[t];$A.prototype.visitNull=GA((e,t)=>null),$A.prototype.visitBool=GA(({offset:e,values:t},n)=>{const i=e+n;return!!(t[i>>3]&1<<i%8)}),$A.prototype.visitInt=GA(({values:e},t)=>e[t]),$A.prototype.visitInt8=GA(XA),$A.prototype.visitInt16=GA(XA),$A.prototype.visitInt32=GA(XA),$A.prototype.visitInt64=GA(KA),$A.prototype.visitUint8=GA(XA),$A.prototype.visitUint16=GA(XA),$A.prototype.visitUint32=GA(XA),$A.prototype.visitUint64=GA(KA),$A.prototype.visitFloat=GA(({type:e,values:t},n)=>e.precision!==AT.HALF?t[n]:iA(t[n])),$A.prototype.visitFloat16=GA(({stride:e,values:t},n)=>iA(t[e*n])),$A.prototype.visitFloat32=GA(XA),$A.prototype.visitFloat64=GA(XA),$A.prototype.visitUtf8=GA(QA),$A.prototype.visitLargeUtf8=GA(QA),$A.prototype.visitBinary=GA(ZA),$A.prototype.visitLargeBinary=GA(ZA),$A.prototype.visitFixedSizeBinary=GA(({stride:e,values:t},n)=>t.subarray(e*n,e*(n+1))),$A.prototype.visitDate=GA((e,t)=>e.type.unit===RT.DAY?YA(e,t):qA(e,t)),$A.prototype.visitDateDay=GA(YA),$A.prototype.visitDateMillisecond=GA(qA),$A.prototype.visitTimestamp=GA((e,t)=>{switch(e.type.unit){case MT.SECOND:return JA(e,t);case MT.MILLISECOND:return eL(e,t);case MT.MICROSECOND:return tL(e,t);case MT.NANOSECOND:return nL(e,t)}}),$A.prototype.visitTimestampSecond=GA(JA),$A.prototype.visitTimestampMillisecond=GA(eL),$A.prototype.visitTimestampMicrosecond=GA(tL),$A.prototype.visitTimestampNanosecond=GA(nL),$A.prototype.visitTime=GA((e,t)=>{switch(e.type.unit){case MT.SECOND:return iL(e,t);case MT.MILLISECOND:return rL(e,t);case MT.MICROSECOND:return oL(e,t);case MT.NANOSECOND:return sL(e,t)}}),$A.prototype.visitTimeSecond=GA(iL),$A.prototype.visitTimeMillisecond=GA(rL),$A.prototype.visitTimeMicrosecond=GA(oL),$A.prototype.visitTimeNanosecond=GA(sL),$A.prototype.visitDecimal=GA(({values:e,stride:t},n)=>Yk.decimal(e.subarray(t*n,t*(n+1)))),$A.prototype.visitList=GA((e,t)=>{const{valueOffsets:n,stride:i,children:r}=e,{[t*i]:o,[t*i+1]:s}=n,a=r[0].slice(o,s-o);return new aR([a])}),$A.prototype.visitStruct=GA((e,t)=>new VA(e,t)),$A.prototype.visitUnion=GA((e,t)=>e.type.mode===kT.Dense?aL(e,t):lL(e,t)),$A.prototype.visitDenseUnion=GA(aL),$A.prototype.visitSparseUnion=GA(lL),$A.prototype.visitDictionary=GA((e,t)=>{var n;return null===(n=e.dictionary)||void 0===n?void 0:n.get(e.values[t])}),$A.prototype.visitInterval=GA((e,t)=>e.type.unit===NT.DAY_TIME?cL(e,t):uL(e,t)),$A.prototype.visitIntervalDayTime=GA(cL),$A.prototype.visitIntervalYearMonth=GA(uL),$A.prototype.visitDuration=GA((e,t)=>{switch(e.type.unit){case MT.SECOND:return dL(e,t);case MT.MILLISECOND:return hL(e,t);case MT.MICROSECOND:return fL(e,t);case MT.NANOSECOND:return pL(e,t)}}),$A.prototype.visitDurationSecond=GA(dL),$A.prototype.visitDurationMillisecond=GA(hL),$A.prototype.visitDurationMicrosecond=GA(fL),$A.prototype.visitDurationNanosecond=GA(pL),$A.prototype.visitFixedSizeList=GA((e,t)=>{const{stride:n,children:i}=e,r=i[0].slice(t*n,n);return new aR([r])}),$A.prototype.visitMap=GA((e,t)=>{const{valueOffsets:n,children:i}=e,{[t]:r,[t+1]:o}=n,s=i[0];return new bL(s.slice(r,o-r))});const mL=new $A,gL=Symbol.for("keys"),_L=Symbol.for("vals"),yL=Symbol.for("kKeysAsStrings"),vL=Symbol.for("_kKeysAsStrings");class bL{constructor(e){return this[gL]=new aR([e.children[0]]).memoize(),this[_L]=e.children[1],new Proxy(this,new wL)}get[yL](){return this[vL]||(this[vL]=Array.from(this[gL].toArray(),String))}[Symbol.iterator](){return new xL(this[gL],this[_L])}get size(){return this[gL].length}toArray(){return Object.values(this.toJSON())}toJSON(){const e=this[gL],t=this[_L],n={};for(let i=-1,r=e.length;++i<r;)n[e.get(i)]=mL.visit(t,i);return n}toString(){return`{${[...this].map(([e,t])=>`${Nk(e)}: ${Nk(t)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class xL{constructor(e,t){this.keys=e,this.vals=t,this.keyIndex=0,this.numKeys=e.length}[Symbol.iterator](){return this}next(){const e=this.keyIndex;return e===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(e),mL.visit(this.vals,e)]})}}class wL{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(e){return e[yL]}has(e,t){return e[yL].includes(t)}getOwnPropertyDescriptor(e,t){if(-1!==e[yL].indexOf(t))return{writable:!0,enumerable:!0,configurable:!0}}get(e,t){if(Reflect.has(e,t))return e[t];const n=e[yL].indexOf(t);if(-1!==n){const i=mL.visit(Reflect.get(e,_L),n);return Reflect.set(e,t,i),i}}set(e,t,n){const i=e[yL].indexOf(t);return-1!==i?(BA.visit(Reflect.get(e,_L),i,n),Reflect.set(e,t,n)):!!Reflect.has(e,t)&&Reflect.set(e,t,n)}}let SL;function EL(e,t,n,i){const{length:r=0}=e;let o="number"!=typeof t?0:t,s="number"!=typeof n?r:n;return o<0&&(o=(o%r+r)%r),s<0&&(s=(s%r+r)%r),s<o&&(SL=o,o=s,s=SL),s>r&&(s=r),i?i(e,o,s):[o,s]}Object.defineProperties(bL.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[gL]:{writable:!0,enumerable:!1,configurable:!1,value:null},[_L]:{writable:!0,enumerable:!1,configurable:!1,value:null},[vL]:{writable:!0,enumerable:!1,configurable:!1,value:null}});const CL=(e,t)=>e<0?t+e:e,TL=e=>e!=e;function kL(e){if("object"!=typeof e||null===e)return TL(e)?TL:t=>t===e;if(e instanceof Date){const t=e.valueOf();return e=>e instanceof Date&&e.valueOf()===t}return ArrayBuffer.isView(e)?t=>!!t&&function(e,t){let n=0;const i=e.length;if(i!==t.length)return!1;if(i>0)do{if(e[n]!==t[n])return!1}while(++n<i);return!0}(e,t):e instanceof Map?function(e){let t=-1;const n=[];for(const i of e.values())n[++t]=kL(i);return IL(n)}(e):Array.isArray(e)?function(e){const t=[];for(let n=-1,i=e.length;++n<i;)t[n]=kL(e[n]);return IL(t)}(e):e instanceof aR?function(e){const t=[];for(let n=-1,i=e.length;++n<i;)t[n]=kL(e.get(n));return IL(t)}(e):function(e,t=!1){const n=Object.keys(e);if(!t&&0===n.length)return()=>!1;const i=[];for(let r=-1,o=n.length;++r<o;)i[r]=kL(e[n[r]]);return IL(i,n)}(e,!0)}function IL(e,t){return n=>{if(!n||"object"!=typeof n)return!1;switch(n.constructor){case Array:return function(e,t){const n=e.length;if(t.length!==n)return!1;for(let i=-1;++i<n;)if(!e[i](t[i]))return!1;return!0}(e,n);case Map:return AL(e,n,n.keys());case bL:case VA:case Object:case void 0:return AL(e,n,t||Object.keys(n))}return n instanceof aR&&function(e,t){const n=e.length;if(t.length!==n)return!1;for(let i=-1;++i<n;)if(!e[i](t.get(i)))return!1;return!0}(e,n)}}function AL(e,t,n){const i=n[Symbol.iterator](),r=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),o=t instanceof Map?t.values():Object.values(t)[Symbol.iterator]();let s=0;const a=e.length;let l=o.next(),c=i.next(),u=r.next();for(;s<a&&!c.done&&!u.done&&!l.done&&c.value===u.value&&e[s](l.value);++s,c=i.next(),u=r.next(),l=o.next());return!!(s===a&&c.done&&u.done&&l.done)||(i.return&&i.return(),r.return&&r.return(),o.return&&o.return(),!1)}function LL(e,t,n,i){return!!(n&1<<i)}function RL(e,t,n,i){return(n&1<<i)>>i}function PL(e,t,n){const i=n.byteLength+7&-8;if(e>0||n.byteLength<i){const r=new Uint8Array(i);return r.set(e%8==0?n.subarray(e>>3):ML(new DL(n,e,t,null,LL)).subarray(0,i)),r}return n}function ML(e){const t=[];let n=0,i=0,r=0;for(const s of e)s&&(r|=1<<i),8===++i&&(t[n++]=r,r=i=0);(0===n||i>0)&&(t[n++]=r);const o=new Uint8Array(t.length+7&-8);return o.set(t),o}class DL{constructor(e,t,n,i,r){this.bytes=e,this.length=n,this.context=i,this.get=r,this.bit=t%8,this.byteIndex=t>>3,this.byte=e[this.byteIndex++],this.index=0}next(){return this.index<this.length?(8===this.bit&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function NL(e,t,n){if(n-t<=0)return 0;if(n-t<8){let i=0;for(const r of new DL(e,t,n-t,e,RL))i+=r;return i}const i=n>>3<<3,r=t+(t%8==0?0:8-t%8);return NL(e,t,r)+NL(e,i,n)+function(e,t,n){let i=0,r=Math.trunc(t);const o=new DataView(e.buffer,e.byteOffset,e.byteLength),s=void 0===n?e.byteLength:r+n;for(;s-r>=4;)i+=FL(o.getUint32(r)),r+=4;for(;s-r>=2;)i+=FL(o.getUint16(r)),r+=2;for(;s-r>=1;)i+=FL(o.getUint8(r)),r+=1;return i}(e,r>>3,i-r>>3)}function FL(e){let t=Math.trunc(e);return t-=t>>>1&1431655765,t=(858993459&t)+(t>>>2&858993459),16843009*(t+(t>>>4)&252645135)>>>24}class OL{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(0!==this._nullCount){const{type:e}=this;return _I.isSparseUnion(e)||_I.isDenseUnion(e)?this.children.some(e=>e.nullable):this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let e=0;const{valueOffsets:t,values:n,nullBitmap:i,typeIds:r}=this;return t&&(e+=t.byteLength),n&&(e+=n.byteLength),i&&(e+=i.byteLength),r&&(e+=r.byteLength),this.children.reduce((e,t)=>e+t.byteLength,e)}get nullCount(){if(_I.isUnion(this.type))return this.children.reduce((e,t)=>e+t.nullCount,0);let e,t=this._nullCount;return t<=-1&&(e=this.nullBitmap)&&(this._nullCount=t=0===e.length?0:this.length-NL(e,this.offset,this.offset+this.length)),t}constructor(e,t,n,i,r,o=[],s){let a;this.type=e,this.children=o,this.dictionary=s,this.offset=Math.floor(Math.max(t||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(i||0,-1)),r instanceof OL?(this.stride=r.stride,this.values=r.values,this.typeIds=r.typeIds,this.nullBitmap=r.nullBitmap,this.valueOffsets=r.valueOffsets):(this.stride=ZI(e),r&&((a=r[0])&&(this.valueOffsets=a),(a=r[1])&&(this.values=a),(a=r[2])&&(this.nullBitmap=a),(a=r[3])&&(this.typeIds=a)))}getValid(e){const{type:t}=this;if(_I.isUnion(t)){const n=t,i=this.children[n.typeIdToChildIndex[this.typeIds[e]]],r=n.mode===kT.Dense?this.valueOffsets[e]:e;return i.getValid(r)}if(this.nullable&&this.nullCount>0){const t=this.offset+e;return!!(this.nullBitmap[t>>3]&1<<t%8)}return!0}setValid(e,t){let n;const{type:i}=this;if(_I.isUnion(i)){const r=i,o=this.children[r.typeIdToChildIndex[this.typeIds[e]]],s=r.mode===kT.Dense?this.valueOffsets[e]:e;n=o.getValid(s),o.setValid(s,t)}else{let{nullBitmap:i}=this;const{offset:r,length:o}=this,s=r+e,a=1<<s%8,l=s>>3;(!i||i.byteLength<=l)&&(i=new Uint8Array((r+o+63&-64)>>3).fill(255),this.nullCount>0?(i.set(PL(r,o,this.nullBitmap),0),Object.assign(this,{nullBitmap:i})):Object.assign(this,{nullBitmap:i,_nullCount:0}));const c=i[l];n=0!==(c&a),i[l]=t?c|a:c&~a}return n!==!!t&&(this._nullCount=this.nullCount+(t?-1:1)),t}clone(e=this.type,t=this.offset,n=this.length,i=this._nullCount,r=this,o=this.children){return new OL(e,t,n,i,r,o,this.dictionary)}slice(e,t){const{stride:n,typeId:i,children:r}=this,o=+(0===this._nullCount)-1,s=16===i?n:1,a=this._sliceBuffers(e,t,n,i);return this.clone(this.type,this.offset+e,t,o,a,0===r.length||this.valueOffsets?r:this._sliceChildren(r,s*e,s*t))}_changeLengthAndBackfillNullBitmap(e){if(this.typeId===Pk.Null)return this.clone(this.type,0,e,0);const{length:t,nullCount:n}=this,i=new Uint8Array((e+63&-64)>>3).fill(255,0,t>>3);i[t>>3]=(1<<t-(-8&t))-1,n>0&&i.set(PL(this.offset,t,this.nullBitmap),0);const r=this.buffers;return r[Mk.VALIDITY]=i,this.clone(this.type,0,e,n+(e-t),r)}_sliceBuffers(e,t,n,i){let r;const{buffers:o}=this;return(r=o[Mk.TYPE])&&(o[Mk.TYPE]=r.subarray(e,e+t)),(r=o[Mk.OFFSET])&&(o[Mk.OFFSET]=r.subarray(e,e+t+1))||(r=o[Mk.DATA])&&(o[Mk.DATA]=6===i?r:r.subarray(n*e,n*(e+t))),o}_sliceChildren(e,t,n){return e.map(e=>e.slice(t,n))}}OL.prototype.children=Object.freeze([]);class BL extends QI{visit(e){return this.getVisitFn(e.type).call(this,e)}visitNull(e){const{type:t,offset:n=0,length:i=0}=e;return new OL(t,n,i,i)}visitBool(e){const{type:t,offset:n=0}=e,i=gT(e.nullBitmap),r=fT(t.ArrayType,e.data),{length:o=r.length>>3,nullCount:s=(e.nullBitmap?-1:0)}=e;return new OL(t,n,o,s,[void 0,r,i])}visitInt(e){const{type:t,offset:n=0}=e,i=gT(e.nullBitmap),r=fT(t.ArrayType,e.data),{length:o=r.length,nullCount:s=(e.nullBitmap?-1:0)}=e;return new OL(t,n,o,s,[void 0,r,i])}visitFloat(e){const{type:t,offset:n=0}=e,i=gT(e.nullBitmap),r=fT(t.ArrayType,e.data),{length:o=r.length,nullCount:s=(e.nullBitmap?-1:0)}=e;return new OL(t,n,o,s,[void 0,r,i])}visitUtf8(e){const{type:t,offset:n=0}=e,i=gT(e.data),r=gT(e.nullBitmap),o=pT(e.valueOffsets),{length:s=o.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new OL(t,n,s,a,[o,i,r])}visitLargeUtf8(e){const{type:t,offset:n=0}=e,i=gT(e.data),r=gT(e.nullBitmap),o=mT(e.valueOffsets),{length:s=o.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new OL(t,n,s,a,[o,i,r])}visitBinary(e){const{type:t,offset:n=0}=e,i=gT(e.data),r=gT(e.nullBitmap),o=pT(e.valueOffsets),{length:s=o.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new OL(t,n,s,a,[o,i,r])}visitLargeBinary(e){const{type:t,offset:n=0}=e,i=gT(e.data),r=gT(e.nullBitmap),o=mT(e.valueOffsets),{length:s=o.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new OL(t,n,s,a,[o,i,r])}visitFixedSizeBinary(e){const{type:t,offset:n=0}=e,i=gT(e.nullBitmap),r=fT(t.ArrayType,e.data),{length:o=r.length/ZI(t),nullCount:s=(e.nullBitmap?-1:0)}=e;return new OL(t,n,o,s,[void 0,r,i])}visitDate(e){const{type:t,offset:n=0}=e,i=gT(e.nullBitmap),r=fT(t.ArrayType,e.data),{length:o=r.length/ZI(t),nullCount:s=(e.nullBitmap?-1:0)}=e;return new OL(t,n,o,s,[void 0,r,i])}visitTimestamp(e){const{type:t,offset:n=0}=e,i=gT(e.nullBitmap),r=fT(t.ArrayType,e.data),{length:o=r.length/ZI(t),nullCount:s=(e.nullBitmap?-1:0)}=e;return new OL(t,n,o,s,[void 0,r,i])}visitTime(e){const{type:t,offset:n=0}=e,i=gT(e.nullBitmap),r=fT(t.ArrayType,e.data),{length:o=r.length/ZI(t),nullCount:s=(e.nullBitmap?-1:0)}=e;return new OL(t,n,o,s,[void 0,r,i])}visitDecimal(e){const{type:t,offset:n=0}=e,i=gT(e.nullBitmap),r=fT(t.ArrayType,e.data),{length:o=r.length/ZI(t),nullCount:s=(e.nullBitmap?-1:0)}=e;return new OL(t,n,o,s,[void 0,r,i])}visitList(e){const{type:t,offset:n=0,child:i}=e,r=gT(e.nullBitmap),o=pT(e.valueOffsets),{length:s=o.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new OL(t,n,s,a,[o,void 0,r],[i])}visitStruct(e){const{type:t,offset:n=0,children:i=[]}=e,r=gT(e.nullBitmap),{length:o=i.reduce((e,{length:t})=>Math.max(e,t),0),nullCount:s=(e.nullBitmap?-1:0)}=e;return new OL(t,n,o,s,[void 0,void 0,r],i)}visitUnion(e){const{type:t,offset:n=0,children:i=[]}=e,r=fT(t.ArrayType,e.typeIds),{length:o=r.length,nullCount:s=-1}=e;if(_I.isSparseUnion(t))return new OL(t,n,o,s,[void 0,void 0,void 0,r],i);const a=pT(e.valueOffsets);return new OL(t,n,o,s,[a,void 0,void 0,r],i)}visitDictionary(e){const{type:t,offset:n=0}=e,i=gT(e.nullBitmap),r=fT(t.indices.ArrayType,e.data),{dictionary:o=new aR([(new BL).visit({type:t.dictionary})])}=e,{length:s=r.length,nullCount:a=(e.nullBitmap?-1:0)}=e;return new OL(t,n,s,a,[void 0,r,i],[],o)}visitInterval(e){const{type:t,offset:n=0}=e,i=gT(e.nullBitmap),r=fT(t.ArrayType,e.data),{length:o=r.length/ZI(t),nullCount:s=(e.nullBitmap?-1:0)}=e;return new OL(t,n,o,s,[void 0,r,i])}visitDuration(e){const{type:t,offset:n=0}=e,i=gT(e.nullBitmap),r=fT(t.ArrayType,e.data),{length:o=r.length,nullCount:s=(e.nullBitmap?-1:0)}=e;return new OL(t,n,o,s,[void 0,r,i])}visitFixedSizeList(e){const{type:t,offset:n=0,child:i=(new BL).visit({type:t.valueType})}=e,r=gT(e.nullBitmap),{length:o=i.length/ZI(t),nullCount:s=(e.nullBitmap?-1:0)}=e;return new OL(t,n,o,s,[void 0,void 0,r],[i])}visitMap(e){const{type:t,offset:n=0,child:i=(new BL).visit({type:t.childType})}=e,r=gT(e.nullBitmap),o=pT(e.valueOffsets),{length:s=o.length-1,nullCount:a=(e.nullBitmap?-1:0)}=e;return new OL(t,n,s,a,[o,void 0,r],[i])}}const zL=new BL;function UL(e){return zL.visit(e)}class VL{constructor(e=0,t){this.numChunks=e,this.getChunkIterator=t,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const e=this.chunkIterator.next();if(!e.done)return e;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function HL(e){return e.reduce((e,t)=>e+t.nullCount,0)}function WL(e){return e.reduce((e,t,n)=>(e[n+1]=e[n]+t.length,e),new Uint32Array(e.length+1))}function $L(e,t,n,i){const r=[];for(let o=-1,s=e.length;++o<s;){const s=e[o],a=t[o],{length:l}=s;if(a>=i)break;if(n>=a+l)continue;if(a>=n&&a+l<=i){r.push(s);continue}const c=Math.max(0,n-a),u=Math.min(i-a,l);r.push(s.slice(c,u-c))}return 0===r.length&&r.push(e[0].slice(0,0)),r}function GL(e,t,n,i){let r=0,o=0,s=t.length-1;do{if(r>=s-1)return n<t[s]?i(e,r,n-t[r]):null;o=r+Math.trunc(.5*(s-r)),n<t[o]?s=o:r=o}while(r<s)}function jL(e,t){return e.getValid(t)}function YL(e){function t(t,n,i){return e(t[n],i)}return function(e){return GL(this.data,this._offsets,e,t)}}function qL(e){let t;function n(n,i,r){return e(n[i],r,t)}return function(e,i){const r=this.data;t=i;const o=GL(r,this._offsets,e,n);return t=void 0,o}}function XL(e){let t;function n(n,i,r){let o=r,s=0,a=0;for(let l=i-1,c=n.length;++l<c;){const i=n[l];if(~(s=e(i,t,o)))return a+s;o=0,a+=i.length}return-1}return function(e,i){t=e;const r=this.data,o="number"!=typeof i?n(r,0,0):GL(r,this._offsets,i,n);return t=void 0,o}}class KL extends QI{}function ZL(e,t,n){if(void 0===t)return-1;if(null===t)switch(e.typeId){case Pk.Union:case Pk.Dictionary:break;default:return function(e,t){const{nullBitmap:n}=e;if(!n||e.nullCount<=0)return-1;let i=0;for(const r of new DL(n,e.offset+(t||0),e.length,n,LL)){if(!r)return i;++i}return-1}(e,n)}const i=mL.getVisitFn(e),r=kL(t);for(let o=(n||0)-1,s=e.length;++o<s;)if(r(i(e,o)))return o;return-1}function QL(e,t,n){const i=mL.getVisitFn(e),r=kL(t);for(let o=(n||0)-1,s=e.length;++o<s;)if(r(i(e,o)))return o;return-1}KL.prototype.visitNull=function(e,t){return null===t&&e.length>0?0:-1},KL.prototype.visitBool=ZL,KL.prototype.visitInt=ZL,KL.prototype.visitInt8=ZL,KL.prototype.visitInt16=ZL,KL.prototype.visitInt32=ZL,KL.prototype.visitInt64=ZL,KL.prototype.visitUint8=ZL,KL.prototype.visitUint16=ZL,KL.prototype.visitUint32=ZL,KL.prototype.visitUint64=ZL,KL.prototype.visitFloat=ZL,KL.prototype.visitFloat16=ZL,KL.prototype.visitFloat32=ZL,KL.prototype.visitFloat64=ZL,KL.prototype.visitUtf8=ZL,KL.prototype.visitLargeUtf8=ZL,KL.prototype.visitBinary=ZL,KL.prototype.visitLargeBinary=ZL,KL.prototype.visitFixedSizeBinary=ZL,KL.prototype.visitDate=ZL,KL.prototype.visitDateDay=ZL,KL.prototype.visitDateMillisecond=ZL,KL.prototype.visitTimestamp=ZL,KL.prototype.visitTimestampSecond=ZL,KL.prototype.visitTimestampMillisecond=ZL,KL.prototype.visitTimestampMicrosecond=ZL,KL.prototype.visitTimestampNanosecond=ZL,KL.prototype.visitTime=ZL,KL.prototype.visitTimeSecond=ZL,KL.prototype.visitTimeMillisecond=ZL,KL.prototype.visitTimeMicrosecond=ZL,KL.prototype.visitTimeNanosecond=ZL,KL.prototype.visitDecimal=ZL,KL.prototype.visitList=ZL,KL.prototype.visitStruct=ZL,KL.prototype.visitUnion=ZL,KL.prototype.visitDenseUnion=QL,KL.prototype.visitSparseUnion=QL,KL.prototype.visitDictionary=ZL,KL.prototype.visitInterval=ZL,KL.prototype.visitIntervalDayTime=ZL,KL.prototype.visitIntervalYearMonth=ZL,KL.prototype.visitDuration=ZL,KL.prototype.visitDurationSecond=ZL,KL.prototype.visitDurationMillisecond=ZL,KL.prototype.visitDurationMicrosecond=ZL,KL.prototype.visitDurationNanosecond=ZL,KL.prototype.visitFixedSizeList=ZL,KL.prototype.visitMap=ZL;const JL=new KL;class eR extends QI{}function tR(e){const{type:t}=e;if(0===e.nullCount&&1===e.stride&&(_I.isInt(t)&&64!==t.bitWidth||_I.isTime(t)&&64!==t.bitWidth||_I.isFloat(t)&&t.precision!==AT.HALF))return new VL(e.data.length,t=>{const n=e.data[t];return n.values.subarray(0,n.length)[Symbol.iterator]()});let n=0;return new VL(e.data.length,t=>{const i=e.data[t].length,r=e.slice(n,n+i);return n+=i,new nR(r)})}class nR{constructor(e){this.vector=e,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}eR.prototype.visitNull=tR,eR.prototype.visitBool=tR,eR.prototype.visitInt=tR,eR.prototype.visitInt8=tR,eR.prototype.visitInt16=tR,eR.prototype.visitInt32=tR,eR.prototype.visitInt64=tR,eR.prototype.visitUint8=tR,eR.prototype.visitUint16=tR,eR.prototype.visitUint32=tR,eR.prototype.visitUint64=tR,eR.prototype.visitFloat=tR,eR.prototype.visitFloat16=tR,eR.prototype.visitFloat32=tR,eR.prototype.visitFloat64=tR,eR.prototype.visitUtf8=tR,eR.prototype.visitLargeUtf8=tR,eR.prototype.visitBinary=tR,eR.prototype.visitLargeBinary=tR,eR.prototype.visitFixedSizeBinary=tR,eR.prototype.visitDate=tR,eR.prototype.visitDateDay=tR,eR.prototype.visitDateMillisecond=tR,eR.prototype.visitTimestamp=tR,eR.prototype.visitTimestampSecond=tR,eR.prototype.visitTimestampMillisecond=tR,eR.prototype.visitTimestampMicrosecond=tR,eR.prototype.visitTimestampNanosecond=tR,eR.prototype.visitTime=tR,eR.prototype.visitTimeSecond=tR,eR.prototype.visitTimeMillisecond=tR,eR.prototype.visitTimeMicrosecond=tR,eR.prototype.visitTimeNanosecond=tR,eR.prototype.visitDecimal=tR,eR.prototype.visitList=tR,eR.prototype.visitStruct=tR,eR.prototype.visitUnion=tR,eR.prototype.visitDenseUnion=tR,eR.prototype.visitSparseUnion=tR,eR.prototype.visitDictionary=tR,eR.prototype.visitInterval=tR,eR.prototype.visitIntervalDayTime=tR,eR.prototype.visitIntervalYearMonth=tR,eR.prototype.visitDuration=tR,eR.prototype.visitDurationSecond=tR,eR.prototype.visitDurationMillisecond=tR,eR.prototype.visitDurationMicrosecond=tR,eR.prototype.visitDurationNanosecond=tR,eR.prototype.visitFixedSizeList=tR,eR.prototype.visitMap=tR;const iR=new eR;var rR;const oR={},sR={};class aR{constructor(e){var t,n,i;const r=e[0]instanceof aR?e.flatMap(e=>e.data):e;if(0===r.length||r.some(e=>!(e instanceof OL)))throw new TypeError("Vector constructor expects an Array of Data instances.");const o=null===(t=r[0])||void 0===t?void 0:t.type;switch(r.length){case 0:this._offsets=[0];break;case 1:{const{get:e,set:t,indexOf:n}=oR[o.typeId],i=r[0];this.isValid=e=>jL(i,e),this.get=t=>e(i,t),this.set=(e,n)=>t(i,e,n),this.indexOf=e=>n(i,e),this._offsets=[0,i.length];break}default:Object.setPrototypeOf(this,sR[o.typeId]),this._offsets=WL(r)}this.data=r,this.type=o,this.stride=ZI(o),this.numChildren=null!==(i=null===(n=o.children)||void 0===n?void 0:n.length)&&void 0!==i?i:0,this.length=this._offsets.at(-1)}get byteLength(){return this.data.reduce((e,t)=>e+t.byteLength,0)}get nullable(){return this.data.some(e=>e.nullable)}get nullCount(){return HL(this.data)}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${Pk[this.type.typeId]}Vector`}isValid(e){return!1}get(e){return null}at(e){return this.get(CL(e,this.length))}set(e,t){}indexOf(e,t){return-1}includes(e,t){return this.indexOf(e,t)>-1}[Symbol.iterator](){return iR.visit(this)}concat(...e){return new aR(this.data.concat(e.flatMap(e=>e.data).flat(Number.POSITIVE_INFINITY)))}slice(e,t){return new aR(EL(this,e,t,({data:e,_offsets:t},n,i)=>$L(e,t,n,i)))}toJSON(){return[...this]}toArray(){const{type:e,data:t,length:n,stride:i,ArrayType:r}=this;switch(e.typeId){case Pk.Int:case Pk.Float:case Pk.Decimal:case Pk.Time:case Pk.Timestamp:switch(t.length){case 0:return new r;case 1:return t[0].values.subarray(0,n*i);default:return t.reduce((e,{values:t,length:n})=>(e.array.set(t.subarray(0,n*i),e.offset),e.offset+=n*i,e),{array:new r(n*i),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(e){var t;return this.getChildAt(null===(t=this.type.children)||void 0===t?void 0:t.findIndex(t=>t.name===e))}getChildAt(e){return e>-1&&e<this.numChildren?new aR(this.data.map(({children:t})=>t[e])):null}get isMemoized(){return!!_I.isDictionary(this.type)&&this.data[0].dictionary.isMemoized}memoize(){if(_I.isDictionary(this.type)){const e=new lR(this.data[0].dictionary),t=this.data.map(t=>{const n=t.clone();return n.dictionary=e,n});return new aR(t)}return new lR(this)}unmemoize(){if(_I.isDictionary(this.type)&&this.isMemoized){const e=this.data[0].dictionary.unmemoize(),t=this.data.map(t=>{const n=t.clone();return n.dictionary=e,n});return new aR(t)}return this}}rR=Symbol.toStringTag,aR[rR]=(e=>{e.type=_I.prototype,e.data=[],e.length=0,e.stride=1,e.numChildren=0,e._offsets=new Uint32Array([0]),e[Symbol.isConcatSpreadable]=!0;const t=Object.keys(Pk).map(e=>Pk[e]).filter(e=>"number"==typeof e&&e!==Pk.NONE);for(const n of t){const t=mL.getVisitFnByTypeId(n),i=BA.getVisitFnByTypeId(n),r=JL.getVisitFnByTypeId(n);oR[n]={get:t,set:i,indexOf:r},sR[n]=Object.create(e,{isValid:{value:YL(jL)},get:{value:YL(mL.getVisitFnByTypeId(n))},set:{value:qL(BA.getVisitFnByTypeId(n))},indexOf:{value:XL(JL.getVisitFnByTypeId(n))}})}return"Vector"})(aR.prototype);class lR extends aR{constructor(e){super(e.data);const t=this.get,n=this.set,i=this.slice,r=new Array(this.length);Object.defineProperty(this,"get",{value(e){const n=r[e];if(void 0!==n)return n;const i=t.call(this,e);return r[e]=i,i}}),Object.defineProperty(this,"set",{value(e,t){n.call(this,e,t),r[e]=t}}),Object.defineProperty(this,"slice",{value:(e,t)=>new lR(i.call(this,e,t))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new aR(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}function cR(e){if(e){if(e instanceof OL)return new aR([e]);if(e instanceof aR)return new aR(e.data);if(e.type instanceof _I)return new aR([UL(e)]);if(Array.isArray(e))return new aR(e.flatMap(e=>{return(t=e)instanceof OL?[t]:t instanceof aR?t.data:cR(t).data;var t}));if(ArrayBuffer.isView(e)){e instanceof DataView&&(e=new Uint8Array(e.buffer));const t={offset:0,length:e.length,nullCount:-1,data:e};if(e instanceof Int8Array)return new aR([UL(Object.assign(Object.assign({},t),{type:new bI}))]);if(e instanceof Int16Array)return new aR([UL(Object.assign(Object.assign({},t),{type:new xI}))]);if(e instanceof Int32Array)return new aR([UL(Object.assign(Object.assign({},t),{type:new wI}))]);if(e instanceof BigInt64Array)return new aR([UL(Object.assign(Object.assign({},t),{type:new SI}))]);if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return new aR([UL(Object.assign(Object.assign({},t),{type:new EI}))]);if(e instanceof Uint16Array)return new aR([UL(Object.assign(Object.assign({},t),{type:new CI}))]);if(e instanceof Uint32Array)return new aR([UL(Object.assign(Object.assign({},t),{type:new TI}))]);if(e instanceof BigUint64Array)return new aR([UL(Object.assign(Object.assign({},t),{type:new kI}))]);if(e instanceof Float32Array)return new aR([UL(Object.assign(Object.assign({},t),{type:new AI}))]);if(e instanceof Float64Array)return new aR([UL(Object.assign(Object.assign({},t),{type:new LI}))]);throw new Error("Unrecognized input")}}throw new Error("Unrecognized input")}function uR(e,t){const n=Math.ceil(e)*t-1;return(n-n%64+64||64)/t}function dR(e,t=0){return e.length>=t?e.subarray(0,t):dT(new e.constructor(t),e,0)}class hR{constructor(e,t=0,n=1){this.length=Math.ceil(t/n),this.buffer=new e(this.length),this.stride=n,this.BYTES_PER_ELEMENT=e.BYTES_PER_ELEMENT,this.ArrayType=e}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(e,t){return this}append(e){return this.set(this.length,e)}reserve(e){if(e>0){this.length+=e;const t=this.stride,n=this.length*t,i=this.buffer.length;n>=i&&this._resize(uR(0===i?1*n:2*n,this.BYTES_PER_ELEMENT))}return this}flush(e=this.length){e=uR(e*this.stride,this.BYTES_PER_ELEMENT);const t=dR(this.buffer,e);return this.clear(),t}clear(){return this.length=0,this.buffer=new this.ArrayType,this}_resize(e){return this.buffer=dR(this.buffer,e)}}class fR extends hR{last(){return this.get(this.length-1)}get(e){return this.buffer[e]}set(e,t){return this.reserve(e-this.length+1),this.buffer[e*this.stride]=t,this}}class pR extends fR{constructor(){super(Uint8Array,0,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get(e){return this.buffer[e>>3]>>e%8&1}set(e,t){const{buffer:n}=this.reserve(e-this.length+1),i=e>>3,r=e%8,o=n[i]>>r&1;return t?0===o&&(n[i]|=1<<r,++this.numValid):1===o&&(n[i]&=~(1<<r),--this.numValid),this}clear(){return this.numValid=0,super.clear()}}class mR extends fR{constructor(e){super(e.OffsetArrayType,1,1)}append(e){return this.set(this.length-1,e)}set(e,t){const n=this.length-1,i=this.reserve(e-n+1).buffer;return n<e++&&n>=0&&i.fill(i[n],n,e),i[e]=i[e-1]+t,this}flush(e=this.length-1){return e>this.length&&this.set(e-1,this.BYTES_PER_ELEMENT>4?BigInt(0):0),super.flush(e+1)}}let gR=class{static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e){throw new Error('"throughDOM" not available in this environment')}constructor({type:e,nullValues:t}){this.length=0,this.finished=!1,this.type=e,this.children=[],this.nullValues=t,this.stride=ZI(e),this._nulls=new pR,t&&t.length>0&&(this._isValid=function(e){if(!e||e.length<=0)return function(e){return!0};let t="";const n=e.filter(e=>e==e);return n.length>0&&(t=`\n    switch (x) {${n.map(e=>`\n        case ${function(e){return"bigint"!=typeof e?Nk(e):`${Nk(e)}n`}(e)}:`).join("")}\n            return false;\n    }`),e.length!==n.length&&(t=`if (x !== x) return false;\n${t}`),new Function("x",`${t}\nreturn true;`)}(t))}toVector(){return new aR([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let e=0;const{_offsets:t,_values:n,_nulls:i,_typeIds:r,children:o}=this;return t&&(e+=t.byteLength),n&&(e+=n.byteLength),i&&(e+=i.byteLength),r&&(e+=r.byteLength),o.reduce((e,t)=>e+t.byteLength,e)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let e=0;return this._offsets&&(e+=this._offsets.reservedByteLength),this._values&&(e+=this._values.reservedByteLength),this._nulls&&(e+=this._nulls.reservedByteLength),this._typeIds&&(e+=this._typeIds.reservedByteLength),this.children.reduce((e,t)=>e+t.reservedByteLength,e)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(e){return this.set(this.length,e)}isValid(e){return this._isValid(e)}set(e,t){return this.setValid(e,this.isValid(t))&&this.setValue(e,t),this}setValue(e,t){this._setValue(this,e,t)}setValid(e,t){return this.length=this._nulls.set(e,+t).length,t}addChild(e,t=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(e){return this.children[e]||null}flush(){let e,t,n,i;const{type:r,length:o,nullCount:s,_typeIds:a,_offsets:l,_values:c,_nulls:u}=this;(t=null==a?void 0:a.flush(o))?i=null==l?void 0:l.flush(o):e=(i=null==l?void 0:l.flush(o))?null==c?void 0:c.flush(l.last()):null==c?void 0:c.flush(o),s>0&&(n=null==u?void 0:u.flush(o));const d=this.children.map(e=>e.flush());return this.clear(),UL({type:r,length:o,nullCount:s,children:d,child:d[0],data:e,typeIds:t,nullBitmap:n,valueOffsets:i})}finish(){this.finished=!0;for(const e of this.children)e.finish();return this}clear(){var e,t,n,i;this.length=0,null===(e=this._nulls)||void 0===e||e.clear(),null===(t=this._values)||void 0===t||t.clear(),null===(n=this._offsets)||void 0===n||n.clear(),null===(i=this._typeIds)||void 0===i||i.clear();for(const r of this.children)r.clear();return this}};gR.prototype.length=1,gR.prototype.stride=1,gR.prototype.children=null,gR.prototype.finished=!1,gR.prototype.nullValues=null,gR.prototype._isValid=()=>!0;class _R extends gR{constructor(e){super(e),this._values=new fR(this.ArrayType,0,this.stride)}setValue(e,t){const n=this._values;return n.reserve(e-n.length+1),super.setValue(e,t)}}class yR extends gR{constructor(e){super(e),this._pendingLength=0,this._offsets=new mR(e.type)}setValue(e,t){const n=this._pending||(this._pending=new Map),i=n.get(e);i&&(this._pendingLength-=i.length),this._pendingLength+=t instanceof bL?t[gL].length:t.length,n.set(e,t)}setValid(e,t){return!!super.setValid(e,t)||((this._pending||(this._pending=new Map)).set(e,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){const e=this._pending,t=this._pendingLength;return this._pendingLength=0,this._pending=void 0,e&&e.size>0&&this._flushPending(e,t),this}}class vR{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(e,t,n,i){return e.prep(8,24),e.writeInt64(BigInt(null!=i?i:0)),e.pad(4),e.writeInt32(n),e.writeInt64(BigInt(null!=t?t:0)),e.offset()}}class bR{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsFooter(e,t){return(t||new bR).__init(e.readInt32(e.position())+e.position(),e)}static getSizePrefixedRootAsFooter(e,t){return e.setPosition(e.position()+4),(t||new bR).__init(e.readInt32(e.position())+e.position(),e)}version(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):CT.V1}schema(e){const t=this.bb.__offset(this.bb_pos,6);return t?(e||new Ak).__init(this.bb.__indirect(this.bb_pos+t),this.bb):null}dictionaries(e,t){const n=this.bb.__offset(this.bb_pos,8);return n?(t||new vR).__init(this.bb.__vector(this.bb_pos+n)+24*e,this.bb):null}dictionariesLength(){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__vector_len(this.bb_pos+e):0}recordBatches(e,t){const n=this.bb.__offset(this.bb_pos,10);return n?(t||new vR).__init(this.bb.__vector(this.bb_pos+n)+24*e,this.bb):null}recordBatchesLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__vector_len(this.bb_pos+e):0}customMetadata(e,t){const n=this.bb.__offset(this.bb_pos,12);return n?(t||new sk).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}static startFooter(e){e.startObject(5)}static addVersion(e,t){e.addFieldInt16(0,t,CT.V1)}static addSchema(e,t){e.addFieldOffset(1,t,0)}static addDictionaries(e,t){e.addFieldOffset(2,t,0)}static startDictionariesVector(e,t){e.startVector(24,t,8)}static addRecordBatches(e,t){e.addFieldOffset(3,t,0)}static startRecordBatchesVector(e,t){e.startVector(24,t,8)}static addCustomMetadata(e,t){e.addFieldOffset(4,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static endFooter(e){return e.endObject()}static finishFooterBuffer(e,t){e.finish(t)}static finishSizePrefixedFooterBuffer(e,t){e.finish(t,void 0,!0)}}class xR{constructor(e=[],t,n,i=CT.V5){this.fields=e||[],this.metadata=t||new Map,n||(n=ER(this.fields)),this.dictionaries=n,this.metadataVersion=i}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(e=>e.name)}toString(){return`Schema<{ ${this.fields.map((e,t)=>`${t}: ${e}`).join(", ")} }>`}select(e){const t=new Set(e),n=this.fields.filter(e=>t.has(e.name));return new xR(n,this.metadata)}selectAt(e){const t=e.map(e=>this.fields[e]).filter(Boolean);return new xR(t,this.metadata)}assign(...e){const t=e[0]instanceof xR?e[0]:Array.isArray(e[0])?new xR(e[0]):new xR(e),n=[...this.fields],i=SR(SR(new Map,this.metadata),t.metadata),r=t.fields.filter(e=>{const t=n.findIndex(t=>t.name===e.name);return!~t||(n[t]=e.clone({metadata:SR(SR(new Map,n[t].metadata),e.metadata)}))&&!1}),o=ER(r,new Map);return new xR([...n,...r],i,new Map([...this.dictionaries,...o]))}}xR.prototype.fields=null,xR.prototype.metadata=null,xR.prototype.dictionaries=null;class wR{static new(...e){let[t,n,i,r]=e;return e[0]&&"object"==typeof e[0]&&(({name:t}=e[0]),void 0===n&&(n=e[0].type),void 0===i&&(i=e[0].nullable),void 0===r&&(r=e[0].metadata)),new wR(`${t}`,n,i,r)}constructor(e,t,n=!1,i){this.name=e,this.type=t,this.nullable=n,this.metadata=i||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...e){let[t,n,i,r]=e;return e[0]&&"object"==typeof e[0]?({name:t=this.name,type:n=this.type,nullable:i=this.nullable,metadata:r=this.metadata}=e[0]):[t=this.name,n=this.type,i=this.nullable,r=this.metadata]=e,wR.new(t,n,i,r)}}function SR(e,t){return new Map([...e||new Map,...t||new Map])}function ER(e,t=new Map){for(let n=-1,i=e.length;++n<i;){const i=e[n].type;if(_I.isDictionary(i))if(t.has(i.id)){if(t.get(i.id)!==i.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else t.set(i.id,i.dictionary);i.children&&i.children.length>0&&ER(i.children,t)}return t}wR.prototype.type=null,wR.prototype.name=null,wR.prototype.nullable=null,wR.prototype.metadata=null;var CR=$T,TR=WT;class kR{static decode(e){e=new TR(gT(e));const t=bR.getRootAsFooter(e),n=xR.decode(t.schema(),new Map,t.version());return new IR(n,t)}static encode(e){const t=new CR,n=xR.encode(t,e.schema);bR.startRecordBatchesVector(t,e.numRecordBatches);for(const o of[...e.recordBatches()].slice().reverse())AR.encode(t,o);const i=t.endVector();bR.startDictionariesVector(t,e.numDictionaries);for(const o of[...e.dictionaryBatches()].slice().reverse())AR.encode(t,o);const r=t.endVector();return bR.startFooter(t),bR.addSchema(t,n),bR.addVersion(t,CT.V5),bR.addRecordBatches(t,i),bR.addDictionaries(t,r),bR.finishFooterBuffer(t,bR.endFooter(t)),t.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}constructor(e,t=CT.V5,n,i){this.schema=e,this.version=t,n&&(this._recordBatches=n),i&&(this._dictionaryBatches=i)}*recordBatches(){for(let e,t=-1,n=this.numRecordBatches;++t<n;)(e=this.getRecordBatch(t))&&(yield e)}*dictionaryBatches(){for(let e,t=-1,n=this.numDictionaries;++t<n;)(e=this.getDictionaryBatch(t))&&(yield e)}getRecordBatch(e){return e>=0&&e<this.numRecordBatches&&this._recordBatches[e]||null}getDictionaryBatch(e){return e>=0&&e<this.numDictionaries&&this._dictionaryBatches[e]||null}}class IR extends kR{get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}constructor(e,t){super(e,t.version()),this._footer=t}getRecordBatch(e){if(e>=0&&e<this.numRecordBatches){const t=this._footer.recordBatches(e);if(t)return AR.decode(t)}return null}getDictionaryBatch(e){if(e>=0&&e<this.numDictionaries){const t=this._footer.dictionaries(e);if(t)return AR.decode(t)}return null}}class AR{static decode(e){return new AR(e.metaDataLength(),e.bodyLength(),e.offset())}static encode(e,t){const{metaDataLength:n}=t,i=BigInt(t.offset),r=BigInt(t.bodyLength);return vR.createBlock(e,i,n,r)}constructor(e,t,n){this.metaDataLength=e,this.offset=Fk(n),this.bodyLength=Fk(t)}}const LR=Object.freeze({done:!0,value:void 0});class RR{constructor(e){this._json=e}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class PR{tee(){return this._getDOMStream().tee()}pipe(e,t){return this._getNodeStream().pipe(e,t)}pipeTo(e,t){return this._getDOMStream().pipeTo(e,t)}pipeThrough(e,t){return this._getDOMStream().pipeThrough(e,t)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class MR extends PR{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}get closed(){return this._closedPromise}cancel(e){return HC(this,void 0,void 0,function*(){yield this.return(e)})}write(e){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(e):this.resolvers.shift().resolve({done:!1,value:e}))}abort(e){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:e}:this.resolvers.shift().reject({done:!0,value:e}))}close(){if(this._closedPromiseResolve){const{resolvers:e}=this;for(;e.length>0;)e.shift().resolve(LR);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(e){return xT.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,e)}toNodeStream(e){return xT.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,e)}throw(e){return HC(this,void 0,void 0,function*(){return yield this.abort(e),LR})}return(e){return HC(this,void 0,void 0,function*(){return yield this.close(),LR})}read(e){return HC(this,void 0,void 0,function*(){return(yield this.next(e,"read")).value})}peek(e){return HC(this,void 0,void 0,function*(){return(yield this.next(e,"peek")).value})}next(...e){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((e,t)=>{this.resolvers.push({resolve:e,reject:t})}):Promise.resolve(LR)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class DR extends MR{write(e){if((e=gT(e)).byteLength>0)return super.write(e)}toString(e=!1){return e?qC(this.toUint8Array(!0)):this.toUint8Array(!1).then(qC)}toUint8Array(e=!1){return e?hT(this._values)[0]:(()=>HC(this,void 0,void 0,function*(){var e,t,n,i;const r=[];let o=0;try{for(var s,a=!0,l=jC(this);!(e=(s=yield l.next()).done);a=!0){i=s.value,a=!1;const e=i;r.push(e),o+=e.byteLength}}catch(c){t={error:c}}finally{try{a||e||!(n=l.return)||(yield n.call(l))}finally{if(t)throw t.error}}return hT(r,o)[0]}))()}}class NR{constructor(e){e&&(this.source=new OR(xT.fromIterable(e)))}[Symbol.iterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}}class FR{constructor(e){e instanceof FR?this.source=e.source:e instanceof DR?this.source=new BR(xT.fromAsyncIterable(e)):cT(e)?this.source=new BR(xT.fromNodeStream(e)):lT(e)?this.source=new BR(xT.fromDOMStream(e)):sT(e)?this.source=new BR(xT.fromDOMStream(e.body)):tT(e)?this.source=new BR(xT.fromIterable(e)):(eT(e)||nT(e))&&(this.source=new BR(xT.fromAsyncIterable(e)))}[Symbol.asyncIterator](){return this}next(e){return this.source.next(e)}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}get closed(){return this.source.closed}cancel(e){return this.source.cancel(e)}peek(e){return this.source.peek(e)}read(e){return this.source.read(e)}}class OR{constructor(e){this.source=e}cancel(e){this.return(e)}peek(e){return this.next(e,"peek").value}read(e){return this.next(e,"read").value}next(e,t="read"){return this.source.next({cmd:t,size:e})}throw(e){return Object.create(this.source.throw&&this.source.throw(e)||LR)}return(e){return Object.create(this.source.return&&this.source.return(e)||LR)}}class BR{constructor(e){this.source=e,this._closedPromise=new Promise(e=>this._closedPromiseResolve=e)}cancel(e){return HC(this,void 0,void 0,function*(){yield this.return(e)})}get closed(){return this._closedPromise}read(e){return HC(this,void 0,void 0,function*(){return(yield this.next(e,"read")).value})}peek(e){return HC(this,void 0,void 0,function*(){return(yield this.next(e,"peek")).value})}next(e){return HC(this,arguments,void 0,function*(e,t="read"){return yield this.source.next({cmd:t,size:e})})}throw(e){return HC(this,void 0,void 0,function*(){const t=this.source.throw&&(yield this.source.throw(e))||LR;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(t)})}return(e){return HC(this,void 0,void 0,function*(){const t=this.source.return&&(yield this.source.return(e))||LR;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(t)})}}class zR extends NR{constructor(e,t){super(),this.position=0,this.buffer=gT(e),this.size=void 0===t?this.buffer.byteLength:t}readInt32(e){const{buffer:t,byteOffset:n}=this.readAt(e,4);return new DataView(t,n).getInt32(0,!0)}seek(e){return this.position=Math.min(e,this.size),e<this.size}read(e){const{buffer:t,size:n,position:i}=this;return t&&i<n?("number"!=typeof e&&(e=Number.POSITIVE_INFINITY),this.position=Math.min(n,i+Math.min(n-i,e)),t.subarray(i,this.position)):null}readAt(e,t){const n=this.buffer,i=Math.min(this.size,e+t);return n?n.subarray(e,i):new Uint8Array(t)}close(){this.buffer&&(this.buffer=null)}throw(e){return this.close(),{done:!0,value:e}}return(e){return this.close(),{done:!0,value:e}}}class UR extends FR{constructor(e,t){super(),this.position=0,this._handle=e,"number"==typeof t?this.size=t:this._pending=(()=>HC(this,void 0,void 0,function*(){this.size=(yield e.stat()).size,delete this._pending}))()}readInt32(e){return HC(this,void 0,void 0,function*(){const{buffer:t,byteOffset:n}=yield this.readAt(e,4);return new DataView(t,n).getInt32(0,!0)})}seek(e){return HC(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(e,this.size),e<this.size})}read(e){return HC(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:t,size:n,position:i}=this;if(t&&i<n){"number"!=typeof e&&(e=Number.POSITIVE_INFINITY);let r=i,o=0,s=0;const a=Math.min(n,r+Math.min(n-r,e)),l=new Uint8Array(Math.max(0,(this.position=a)-r));for(;(r+=s)<a&&(o+=s)<l.byteLength;)({bytesRead:s}=yield t.read(l,o,l.byteLength-o,r));return l}return null})}readAt(e,t){return HC(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:n,size:i}=this;if(n&&e+t<i){const r=Math.min(i,e+t),o=new Uint8Array(r-e);return(yield n.read(o,0,t,e)).buffer}return new Uint8Array(t)})}close(){return HC(this,void 0,void 0,function*(){const e=this._handle;this._handle=null,e&&(yield e.close())})}throw(e){return HC(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:e}})}return(e){return HC(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:e}})}}function VR(e){return e<0&&(e=4294967295+e+1),`0x${e.toString(16)}`}const HR=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class WR{constructor(e){this.buffer=e}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(e){const t=new Uint32Array([this.buffer[1]>>>16,65535&this.buffer[1],this.buffer[0]>>>16,65535&this.buffer[0]]),n=new Uint32Array([e.buffer[1]>>>16,65535&e.buffer[1],e.buffer[0]>>>16,65535&e.buffer[0]]);let i=t[3]*n[3];this.buffer[0]=65535&i;let r=i>>>16;return i=t[2]*n[3],r+=i,i=t[3]*n[2]>>>0,r+=i,this.buffer[0]+=r<<16,this.buffer[1]=r>>>0<i?65536:0,this.buffer[1]+=r>>>16,this.buffer[1]+=t[1]*n[3]+t[2]*n[2]+t[3]*n[1],this.buffer[1]+=t[0]*n[3]+t[1]*n[2]+t[2]*n[1]+t[3]*n[0]<<16,this}_plus(e){const t=this.buffer[0]+e.buffer[0]>>>0;this.buffer[1]+=e.buffer[1],t<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=t}lessThan(e){return this.buffer[1]<e.buffer[1]||this.buffer[1]===e.buffer[1]&&this.buffer[0]<e.buffer[0]}equals(e){return this.buffer[1]===e.buffer[1]&&this.buffer[0]==e.buffer[0]}greaterThan(e){return e.lessThan(this)}hex(){return`${VR(this.buffer[1])} ${VR(this.buffer[0])}`}}class $R extends WR{times(e){return this._times(e),this}plus(e){return this._plus(e),this}static from(e,t=new Uint32Array(2)){return $R.fromString("string"==typeof e?e:e.toString(),t)}static fromNumber(e,t=new Uint32Array(2)){return $R.fromString(e.toString(),t)}static fromString(e,t=new Uint32Array(2)){const n=e.length,i=new $R(t);for(let r=0;r<n;){const t=8<n-r?8:n-r,o=new $R(new Uint32Array([Number.parseInt(e.slice(r,r+t),10),0])),s=new $R(new Uint32Array([HR[t],0]));i.times(s),i.plus(o),r+=t}return i}static convertArray(e){const t=new Uint32Array(2*e.length);for(let n=-1,i=e.length;++n<i;)$R.from(e[n],new Uint32Array(t.buffer,t.byteOffset+2*n*4,2));return t}static multiply(e,t){return new $R(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new $R(new Uint32Array(e.buffer)).plus(t)}}class GR extends WR{negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],0==this.buffer[0]&&++this.buffer[1],this}times(e){return this._times(e),this}plus(e){return this._plus(e),this}lessThan(e){const t=0|this.buffer[1],n=0|e.buffer[1];return t<n||t===n&&this.buffer[0]<e.buffer[0]}static from(e,t=new Uint32Array(2)){return GR.fromString("string"==typeof e?e:e.toString(),t)}static fromNumber(e,t=new Uint32Array(2)){return GR.fromString(e.toString(),t)}static fromString(e,t=new Uint32Array(2)){const n=e.startsWith("-"),i=e.length,r=new GR(t);for(let o=n?1:0;o<i;){const t=8<i-o?8:i-o,n=new GR(new Uint32Array([Number.parseInt(e.slice(o,o+t),10),0])),s=new GR(new Uint32Array([HR[t],0]));r.times(s),r.plus(n),o+=t}return n?r.negate():r}static convertArray(e){const t=new Uint32Array(2*e.length);for(let n=-1,i=e.length;++n<i;)GR.from(e[n],new Uint32Array(t.buffer,t.byteOffset+2*n*4,2));return t}static multiply(e,t){return new GR(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new GR(new Uint32Array(e.buffer)).plus(t)}}class jR{constructor(e){this.buffer=e}high(){return new GR(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new GR(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],0==this.buffer[0]&&++this.buffer[1],0==this.buffer[1]&&++this.buffer[2],0==this.buffer[2]&&++this.buffer[3],this}times(e){const t=new $R(new Uint32Array([this.buffer[3],0])),n=new $R(new Uint32Array([this.buffer[2],0])),i=new $R(new Uint32Array([this.buffer[1],0])),r=new $R(new Uint32Array([this.buffer[0],0])),o=new $R(new Uint32Array([e.buffer[3],0])),s=new $R(new Uint32Array([e.buffer[2],0])),a=new $R(new Uint32Array([e.buffer[1],0])),l=new $R(new Uint32Array([e.buffer[0],0]));let c=$R.multiply(r,l);this.buffer[0]=c.low();const u=new $R(new Uint32Array([c.high(),0]));return c=$R.multiply(i,l),u.plus(c),c=$R.multiply(r,a),u.plus(c),this.buffer[1]=u.low(),this.buffer[3]=u.lessThan(c)?1:0,this.buffer[2]=u.high(),new $R(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus($R.multiply(n,l)).plus($R.multiply(i,a)).plus($R.multiply(r,s)),this.buffer[3]+=$R.multiply(t,l).plus($R.multiply(n,a)).plus($R.multiply(i,s)).plus($R.multiply(r,o)).low(),this}plus(e){const t=new Uint32Array(4);return t[3]=this.buffer[3]+e.buffer[3]>>>0,t[2]=this.buffer[2]+e.buffer[2]>>>0,t[1]=this.buffer[1]+e.buffer[1]>>>0,t[0]=this.buffer[0]+e.buffer[0]>>>0,t[0]<this.buffer[0]>>>0&&++t[1],t[1]<this.buffer[1]>>>0&&++t[2],t[2]<this.buffer[2]>>>0&&++t[3],this.buffer[3]=t[3],this.buffer[2]=t[2],this.buffer[1]=t[1],this.buffer[0]=t[0],this}hex(){return`${VR(this.buffer[3])} ${VR(this.buffer[2])} ${VR(this.buffer[1])} ${VR(this.buffer[0])}`}static multiply(e,t){return new jR(new Uint32Array(e.buffer)).times(t)}static add(e,t){return new jR(new Uint32Array(e.buffer)).plus(t)}static from(e,t=new Uint32Array(4)){return jR.fromString("string"==typeof e?e:e.toString(),t)}static fromNumber(e,t=new Uint32Array(4)){return jR.fromString(e.toString(),t)}static fromString(e,t=new Uint32Array(4)){const n=e.startsWith("-"),i=e.length,r=new jR(t);for(let o=n?1:0;o<i;){const t=8<i-o?8:i-o,n=new jR(new Uint32Array([Number.parseInt(e.slice(o,o+t),10),0,0,0])),s=new jR(new Uint32Array([HR[t],0,0,0]));r.times(s),r.plus(n),o+=t}return n?r.negate():r}static convertArray(e){const t=new Uint32Array(4*e.length);for(let n=-1,i=e.length;++n<i;)jR.from(e[n],new Uint32Array(t.buffer,t.byteOffset+16*n,4));return t}}class YR extends QI{constructor(e,t,n,i,r=CT.V5){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=e,this.nodes=t,this.buffers=n,this.dictionaries=i,this.metadataVersion=r}visit(e){return super.visit(e instanceof wR?e.type:e)}visitNull(e,{length:t}=this.nextFieldNode()){return UL({type:e,length:t})}visitBool(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitInt(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitFloat(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitUtf8(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitLargeUtf8(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitBinary(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitLargeBinary(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),data:this.readData(e)})}visitFixedSizeBinary(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitDate(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitTimestamp(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitTime(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitDecimal(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitList(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),child:this.visit(e.children[0])})}visitStruct(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),children:this.visitMany(e.children)})}visitUnion(e,{length:t,nullCount:n}=this.nextFieldNode()){return this.metadataVersion<CT.V5&&this.readNullBitmap(e,n),e.mode===kT.Sparse?this.visitSparseUnion(e,{length:t,nullCount:n}):this.visitDenseUnion(e,{length:t,nullCount:n})}visitDenseUnion(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,typeIds:this.readTypeIds(e),valueOffsets:this.readOffsets(e),children:this.visitMany(e.children)})}visitSparseUnion(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,typeIds:this.readTypeIds(e),children:this.visitMany(e.children)})}visitDictionary(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e.indices),dictionary:this.readDictionary(e)})}visitInterval(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitDuration(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),data:this.readData(e)})}visitFixedSizeList(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),child:this.visit(e.children[0])})}visitMap(e,{length:t,nullCount:n}=this.nextFieldNode()){return UL({type:e,length:t,nullCount:n,nullBitmap:this.readNullBitmap(e,n),valueOffsets:this.readOffsets(e),child:this.visit(e.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(e,t,n=this.nextBufferRange()){return t>0&&this.readData(e,n)||new Uint8Array(0)}readOffsets(e,t){return this.readData(e,t)}readTypeIds(e,t){return this.readData(e,t)}readData(e,{length:t,offset:n}=this.nextBufferRange()){return this.bytes.subarray(n,n+t)}readDictionary(e){return this.dictionaries.get(e.id)}}class qR extends YR{constructor(e,t,n,i,r){super(new Uint8Array(0),t,n,i,r),this.sources=e}readNullBitmap(e,t,{offset:n}=this.nextBufferRange()){return t<=0?new Uint8Array(0):ML(this.sources[n])}readOffsets(e,{offset:t}=this.nextBufferRange()){return fT(Uint8Array,fT(e.OffsetArrayType,this.sources[t]))}readTypeIds(e,{offset:t}=this.nextBufferRange()){return fT(Uint8Array,fT(e.ArrayType,this.sources[t]))}readData(e,{offset:t}=this.nextBufferRange()){const{sources:n}=this;return _I.isTimestamp(e)||(_I.isInt(e)||_I.isTime(e))&&64===e.bitWidth||_I.isDuration(e)||_I.isDate(e)&&e.unit===RT.MILLISECOND?fT(Uint8Array,GR.convertArray(n[t])):_I.isDecimal(e)?fT(Uint8Array,jR.convertArray(n[t])):_I.isBinary(e)||_I.isLargeBinary(e)||_I.isFixedSizeBinary(e)?function(e){const t=e.join(""),n=new Uint8Array(t.length/2);for(let i=0;i<t.length;i+=2)n[i>>1]=Number.parseInt(t.slice(i,i+2),16);return n}(n[t]):_I.isBool(e)?ML(n[t]):_I.isUtf8(e)||_I.isLargeUtf8(e)?KC(n[t].join("")):fT(Uint8Array,fT(e.ArrayType,n[t].map(e=>+e)))}}class XR extends yR{constructor(e){super(e),this._values=new hR(Uint8Array)}get byteLength(){let e=this._pendingLength+4*this.length;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,t){return super.setValue(e,gT(t))}_flushPending(e,t){const n=this._offsets,i=this._values.reserve(t).buffer;let r=0;for(const[o,s]of e)if(void 0===s)n.set(o,0);else{const e=s.length;i.set(s,r),n.set(o,e),r+=e}}}class KR extends yR{constructor(e){super(e),this._values=new hR(Uint8Array)}get byteLength(){let e=this._pendingLength+4*this.length;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,t){return super.setValue(e,gT(t))}_flushPending(e,t){const n=this._offsets,i=this._values.reserve(t).buffer;let r=0;for(const[o,s]of e)if(void 0===s)n.set(o,BigInt(0));else{const e=s.length;i.set(s,r),n.set(o,BigInt(e)),r+=e}}}class ZR extends gR{constructor(e){super(e),this._values=new pR}setValue(e,t){this._values.set(e,+t)}}class QR extends _R{}QR.prototype._setValue=gA;class JR extends QR{}JR.prototype._setValue=dA;class eP extends QR{}eP.prototype._setValue=hA;class tP extends _R{}tP.prototype._setValue=kA;class nP extends gR{constructor({type:e,nullValues:t,dictionaryHashFunction:n}){super({type:new KI(e.dictionary,e.indices,e.id,e.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=oM({type:this.type.indices,nullValues:t}),this.dictionary=oM({type:this.type.dictionary,nullValues:null}),"function"==typeof n&&(this.valueToKey=n)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(e){return this.indices.isValid(e)}setValid(e,t){const n=this.indices;return t=n.setValid(e,t),this.length=n.length,t}setValue(e,t){const n=this._keysToIndices,i=this.valueToKey(t);let r=n[i];return void 0===r&&(n[i]=r=this._dictionaryOffset+this.dictionary.append(t).length-1),this.indices.setValue(e,r)}flush(){const e=this.type,t=this._dictionary,n=this.dictionary.toVector(),i=this.indices.flush().clone(e);return i.dictionary=t?t.concat(n):n,this.finished||(this._dictionaryOffset+=n.length),this._dictionary=i.dictionary,this.clear(),i}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(e){return"string"==typeof e?e:`${e}`}}class iP extends _R{}iP.prototype._setValue=fA;class rP extends gR{setValue(e,t){const[n]=this.children,i=e*this.stride;for(let r=-1,o=t.length;++r<o;)n.set(i+r,t[r])}addChild(e,t="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");const n=this.children.push(e);return this.type=new YI(this.type.listSize,new wR(t,e.type,!0)),n}}class oP extends _R{setValue(e,t){this._values.set(e,t)}}class sP extends oP{setValue(e,t){super.setValue(e,rA(t))}}class aP extends oP{}class lP extends oP{}class cP extends _R{}cP.prototype._setValue=LA;class uP extends cP{}uP.prototype._setValue=RA;class dP extends cP{}dP.prototype._setValue=PA;class hP extends _R{}hP.prototype._setValue=OA;class fP extends hP{}fP.prototype._setValue=MA;class pP extends hP{}pP.prototype._setValue=DA;class mP extends hP{}mP.prototype._setValue=NA;class gP extends hP{}gP.prototype._setValue=FA;class _P extends _R{setValue(e,t){this._values.set(e,t)}}class yP extends _P{}class vP extends _P{}class bP extends _P{}class xP extends _P{}class wP extends _P{}class SP extends _P{}class EP extends _P{}class CP extends _P{}class TP extends yR{constructor(e){super(e),this._offsets=new mR(e.type)}addChild(e,t="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new WI(new wR(t,e.type,!0)),this.numChildren-1}_flushPending(e){const t=this._offsets,[n]=this.children;for(const[i,r]of e)if(void 0===r)t.set(i,0);else{const e=r,o=e.length,s=t.set(i,o).buffer[i];for(let t=-1;++t<o;)n.set(s+t,e[t])}}}class kP extends yR{set(e,t){return super.set(e,t)}setValue(e,t){const n=t instanceof Map?t:new Map(Object.entries(t)),i=this._pending||(this._pending=new Map),r=i.get(e);r&&(this._pendingLength-=r.size),this._pendingLength+=n.size,i.set(e,n)}addChild(e,t=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=e,this.type=new qI(new wR(t,e.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(e){const t=this._offsets,[n]=this.children;for(const[i,r]of e)if(void 0===r)t.set(i,0);else{let{[i]:e,[i+1]:o}=t.set(i,r.size).buffer;for(const t of r.entries())if(n.set(e,t),++e>=o)break}}}class IP extends gR{setValue(e,t){}setValid(e,t){return this.length=Math.max(e+1,this.length),t}}class AP extends gR{setValue(e,t){const{children:n,type:i}=this;switch(Array.isArray(t)||t.constructor){case!0:return i.children.forEach((i,r)=>n[r].set(e,t[r]));case Map:return i.children.forEach((i,r)=>n[r].set(e,t.get(i.name)));default:return i.children.forEach((i,r)=>n[r].set(e,t[i.name]))}}setValid(e,t){return super.setValid(e,t)||this.children.forEach(n=>n.setValid(e,t)),t}addChild(e,t=`${this.numChildren}`){const n=this.children.push(e);return this.type=new $I([...this.type.children,new wR(t,e.type,!0)]),n}}class LP extends _R{}LP.prototype._setValue=xA;class RP extends LP{}RP.prototype._setValue=_A;class PP extends LP{}PP.prototype._setValue=yA;class MP extends LP{}MP.prototype._setValue=vA;class DP extends LP{}DP.prototype._setValue=bA;class NP extends _R{}NP.prototype._setValue=TA;class FP extends NP{}FP.prototype._setValue=wA;class OP extends NP{}OP.prototype._setValue=SA;class BP extends NP{}BP.prototype._setValue=EA;class zP extends NP{}zP.prototype._setValue=CA;class UP extends gR{constructor(e){super(e),this._typeIds=new fR(Int8Array,0,1),"function"==typeof e.valueToChildTypeId&&(this._valueToChildTypeId=e.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(e,t){return this.set(this.length,e,t)}set(e,t,n){return void 0===n&&(n=this._valueToChildTypeId(this,t,e)),this.setValue(e,t,n),this}setValue(e,t,n){this._typeIds.set(e,n);const i=this.type.typeIdToChildIndex[n],r=this.children[i];null==r||r.set(e,t)}addChild(e,t=`${this.children.length}`){const n=this.children.push(e),{type:{children:i,mode:r,typeIds:o}}=this,s=[...i,new wR(t,e.type)];return this.type=new GI(r,[...o,n],s),n}_valueToChildTypeId(e,t,n){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}}class VP extends UP{}class HP extends UP{constructor(e){super(e),this._offsets=new fR(Int32Array)}setValue(e,t,n){const i=this._typeIds.set(e,n).buffer[e],r=this.getChildAt(this.type.typeIdToChildIndex[i]),o=this._offsets.set(e,r.length).buffer[e];null==r||r.set(o,t)}}class WP extends yR{constructor(e){super(e),this._values=new hR(Uint8Array)}get byteLength(){let e=this._pendingLength+4*this.length;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,t){return super.setValue(e,KC(t))}_flushPending(e,t){}}WP.prototype._flushPending=XR.prototype._flushPending;class $P extends yR{constructor(e){super(e),this._values=new hR(Uint8Array)}get byteLength(){let e=this._pendingLength+4*this.length;return this._offsets&&(e+=this._offsets.byteLength),this._values&&(e+=this._values.byteLength),this._nulls&&(e+=this._nulls.byteLength),e}setValue(e,t){return super.setValue(e,KC(t))}_flushPending(e,t){}}$P.prototype._flushPending=KR.prototype._flushPending;const GP=new class extends QI{visitNull(){return IP}visitBool(){return ZR}visitInt(){return _P}visitInt8(){return yP}visitInt16(){return vP}visitInt32(){return bP}visitInt64(){return xP}visitUint8(){return wP}visitUint16(){return SP}visitUint32(){return EP}visitUint64(){return CP}visitFloat(){return oP}visitFloat16(){return sP}visitFloat32(){return aP}visitFloat64(){return lP}visitUtf8(){return WP}visitLargeUtf8(){return $P}visitBinary(){return XR}visitLargeBinary(){return KR}visitFixedSizeBinary(){return iP}visitDate(){return QR}visitDateDay(){return JR}visitDateMillisecond(){return eP}visitTimestamp(){return LP}visitTimestampSecond(){return RP}visitTimestampMillisecond(){return PP}visitTimestampMicrosecond(){return MP}visitTimestampNanosecond(){return DP}visitTime(){return NP}visitTimeSecond(){return FP}visitTimeMillisecond(){return OP}visitTimeMicrosecond(){return BP}visitTimeNanosecond(){return zP}visitDecimal(){return tP}visitList(){return TP}visitStruct(){return AP}visitUnion(){return UP}visitDenseUnion(){return HP}visitSparseUnion(){return VP}visitDictionary(){return nP}visitInterval(){return cP}visitIntervalDayTime(){return uP}visitIntervalYearMonth(){return dP}visitDuration(){return hP}visitDurationSecond(){return fP}visitDurationMillisecond(){return pP}visitDurationMicrosecond(){return mP}visitDurationNanosecond(){return gP}visitFixedSizeList(){return rP}visitMap(){return kP}};class jP extends QI{compareSchemas(e,t){return e===t||t instanceof e.constructor&&this.compareManyFields(e.fields,t.fields)}compareManyFields(e,t){return e===t||Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((e,n)=>this.compareFields(e,t[n]))}compareFields(e,t){return e===t||t instanceof e.constructor&&e.name===t.name&&e.nullable===t.nullable&&this.visit(e.type,t.type)}}function YP(e,t){return t instanceof e.constructor}function qP(e,t){return e===t||YP(e,t)}function XP(e,t){return e===t||YP(e,t)&&e.bitWidth===t.bitWidth&&e.isSigned===t.isSigned}function KP(e,t){return e===t||YP(e,t)&&e.precision===t.precision}function ZP(e,t){return e===t||YP(e,t)&&e.unit===t.unit}function QP(e,t){return e===t||YP(e,t)&&e.unit===t.unit&&e.timezone===t.timezone}function JP(e,t){return e===t||YP(e,t)&&e.unit===t.unit&&e.bitWidth===t.bitWidth}function eM(e,t){return e===t||YP(e,t)&&e.mode===t.mode&&e.typeIds.every((e,n)=>e===t.typeIds[n])&&iM.compareManyFields(e.children,t.children)}function tM(e,t){return e===t||YP(e,t)&&e.unit===t.unit}function nM(e,t){return e===t||YP(e,t)&&e.unit===t.unit}jP.prototype.visitNull=qP,jP.prototype.visitBool=qP,jP.prototype.visitInt=XP,jP.prototype.visitInt8=XP,jP.prototype.visitInt16=XP,jP.prototype.visitInt32=XP,jP.prototype.visitInt64=XP,jP.prototype.visitUint8=XP,jP.prototype.visitUint16=XP,jP.prototype.visitUint32=XP,jP.prototype.visitUint64=XP,jP.prototype.visitFloat=KP,jP.prototype.visitFloat16=KP,jP.prototype.visitFloat32=KP,jP.prototype.visitFloat64=KP,jP.prototype.visitUtf8=qP,jP.prototype.visitLargeUtf8=qP,jP.prototype.visitBinary=qP,jP.prototype.visitLargeBinary=qP,jP.prototype.visitFixedSizeBinary=function(e,t){return e===t||YP(e,t)&&e.byteWidth===t.byteWidth},jP.prototype.visitDate=ZP,jP.prototype.visitDateDay=ZP,jP.prototype.visitDateMillisecond=ZP,jP.prototype.visitTimestamp=QP,jP.prototype.visitTimestampSecond=QP,jP.prototype.visitTimestampMillisecond=QP,jP.prototype.visitTimestampMicrosecond=QP,jP.prototype.visitTimestampNanosecond=QP,jP.prototype.visitTime=JP,jP.prototype.visitTimeSecond=JP,jP.prototype.visitTimeMillisecond=JP,jP.prototype.visitTimeMicrosecond=JP,jP.prototype.visitTimeNanosecond=JP,jP.prototype.visitDecimal=qP,jP.prototype.visitList=function(e,t){return e===t||YP(e,t)&&e.children.length===t.children.length&&iM.compareManyFields(e.children,t.children)},jP.prototype.visitStruct=function(e,t){return e===t||YP(e,t)&&e.children.length===t.children.length&&iM.compareManyFields(e.children,t.children)},jP.prototype.visitUnion=eM,jP.prototype.visitDenseUnion=eM,jP.prototype.visitSparseUnion=eM,jP.prototype.visitDictionary=function(e,t){return e===t||YP(e,t)&&e.id===t.id&&e.isOrdered===t.isOrdered&&iM.visit(e.indices,t.indices)&&iM.visit(e.dictionary,t.dictionary)},jP.prototype.visitInterval=tM,jP.prototype.visitIntervalDayTime=tM,jP.prototype.visitIntervalYearMonth=tM,jP.prototype.visitDuration=nM,jP.prototype.visitDurationSecond=nM,jP.prototype.visitDurationMillisecond=nM,jP.prototype.visitDurationMicrosecond=nM,jP.prototype.visitDurationNanosecond=nM,jP.prototype.visitFixedSizeList=function(e,t){return e===t||YP(e,t)&&e.listSize===t.listSize&&e.children.length===t.children.length&&iM.compareManyFields(e.children,t.children)},jP.prototype.visitMap=function(e,t){return e===t||YP(e,t)&&e.keysSorted===t.keysSorted&&e.children.length===t.children.length&&iM.compareManyFields(e.children,t.children)};const iM=new jP;function rM(e,t){return iM.compareSchemas(e,t)}function oM(e){const t=e.type,n=new(GP.getVisitFn(t)())(e);if(t.children&&t.children.length>0){const i=e.children||[],r={nullValues:e.nullValues},o=Array.isArray(i)?(e,t)=>i[t]||r:({name:e})=>i[e]||r;for(const[e,s]of t.children.entries()){const{type:t}=s,i=o(s,e);n.children.push(oM(Object.assign(Object.assign({},i),{type:t})))}}return n}function sM(e,t){if(e instanceof OL||e instanceof aR||e.type instanceof _I||ArrayBuffer.isView(e))return cR(e);const n=[...lM({type:aM(e),nullValues:[null]})(e)],i=1===n.length?n[0]:n.reduce((e,t)=>e.concat(t));return _I.isDictionary(i.type)?i.memoize():i}function aM(e){if(0===e.length)return new yI;let t=0,n=0,i=0,r=0,o=0,s=0,a=0,l=0;for(const c of e){if(null!=c){switch(typeof c){case"bigint":++s;continue;case"boolean":++a;continue;case"number":++r;continue;case"string":++o;continue;case"object":Array.isArray(c)?++n:"[object Date]"===Object.prototype.toString.call(c)?++l:++i;continue}throw new TypeError("Unable to infer Vector type from input values, explicit type declaration expected.")}++t}if(r+t===e.length)return new LI;if(o+t===e.length)return new KI(new MI,new wI);if(s+t===e.length)return new SI;if(a+t===e.length)return new NI;if(l+t===e.length)return new UI;if(n+t===e.length){const t=e,n=aM(t[t.findIndex(e=>null!=e)]);if(t.every(e=>{return null==e||(t=n,i=aM(e),iM.visit(t,i));var t,i}))return new WI(new wR("",n,!0))}else if(i+t===e.length){const t=new Map;for(const n of e)for(const e of Object.keys(n))t.has(e)||null==n[e]||t.set(e,new wR(e,aM([n[e]]),!0));return new $I([...t.values()])}throw new TypeError("Unable to infer Vector type from input values, explicit type declaration expected.")}function lM(e){const{queueingStrategy:t="count"}=e,{highWaterMark:n=("bytes"!==t?Number.POSITIVE_INFINITY:Math.pow(2,14))}=e,i="bytes"!==t?"length":"byteLength";return function*(t){let r=0;const o=oM(e);for(const e of t)o.append(e)[i]>=n&&++r&&(yield o.toVector());(o.finish().length>0||0===r)&&(yield o.toVector())}}function cM(e,t){return function(e,t){const n=[...e.fields],i=[],r={numBatches:t.reduce((e,t)=>Math.max(e,t.length),0)};let o=0,s=0,a=-1;const l=t.length;let c,u=[];for(;r.numBatches-- >0;){for(s=Number.POSITIVE_INFINITY,a=-1;++a<l;)u[a]=c=t[a].shift(),s=Math.min(s,c?c.length:s);Number.isFinite(s)&&(u=uM(n,s,u,t,r),s>0&&(i[o++]=UL({type:new $I(n),length:s,nullCount:0,children:u.slice()})))}return[e=e.assign(n),i.map(t=>new mM(e,t))]}(e,t.map(e=>e.data.concat()))}function uM(e,t,n,i,r){var o;const s=(t+63&-64)>>3;for(let a=-1,l=i.length;++a<l;){const l=n[a],c=null==l?void 0:l.length;if(c>=t)c===t?n[a]=l:(n[a]=l.slice(0,t),r.numBatches=Math.max(r.numBatches,i[a].unshift(l.slice(t,c-t))));else{const i=e[a];e[a]=i.clone({nullable:!0}),n[a]=null!==(o=null==l?void 0:l._changeLengthAndBackfillNullBitmap(t))&&void 0!==o?o:UL({type:i.type,length:t,nullCount:t,nullBitmap:new Uint8Array(s)})}}return n}var dM,hM;class fM{constructor(...e){var t,n;if(0===e.length)return this.batches=[],this.schema=new xR([]),this._offsets=[0],this;let i,r;e[0]instanceof xR&&(i=e.shift()),e.at(-1)instanceof Uint32Array&&(r=e.pop());const o=e=>{if(e){if(e instanceof mM)return[e];if(e instanceof fM)return e.batches;if(e instanceof OL){if(e.type instanceof $I)return[new mM(new xR(e.type.children),e)]}else{if(Array.isArray(e))return e.flatMap(e=>o(e));if("function"==typeof e[Symbol.iterator])return[...e].flatMap(e=>o(e));if("object"==typeof e){const t=Object.keys(e),n=t.map(t=>new aR([e[t]])),r=null!=i?i:new xR(t.map((e,t)=>new wR(String(e),n[t].type,n[t].nullable))),[,o]=cM(r,n);return 0===o.length?[new mM(e)]:o}}}return[]},s=e.flatMap(e=>o(e));if(i=null!==(n=null!=i?i:null===(t=s[0])||void 0===t?void 0:t.schema)&&void 0!==n?n:new xR([]),!(i instanceof xR))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const a of s){if(!(a instanceof mM))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!rM(i,a.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=i,this.batches=s,this._offsets=null!=r?r:WL(this.data)}get data(){return this.batches.map(({data:e})=>e)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((e,t)=>e+t.length,0)}get nullCount(){return-1===this._nullCount&&(this._nullCount=HL(this.data)),this._nullCount}isValid(e){return!1}get(e){return null}at(e){return this.get(CL(e,this.numRows))}set(e,t){}indexOf(e,t){return-1}[Symbol.iterator](){return this.batches.length>0?iR.visit(new aR(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[\n  ${this.toArray().join(",\n  ")}\n]`}concat(...e){const t=this.schema,n=this.data.concat(e.flatMap(({data:e})=>e));return new fM(t,n.map(e=>new mM(t,e)))}slice(e,t){const n=this.schema;[e,t]=EL({length:this.numRows},e,t);const i=$L(this.data,this._offsets,e,t);return new fM(n,i.map(e=>new mM(n,e)))}getChild(e){return this.getChildAt(this.schema.fields.findIndex(t=>t.name===e))}getChildAt(e){if(e>-1&&e<this.schema.fields.length){const t=this.data.map(t=>t.children[e]);if(0===t.length){const{type:n}=this.schema.fields[e],i=UL({type:n,length:0,nullCount:0});t.push(i._changeLengthAndBackfillNullBitmap(this.numRows))}return new aR(t)}return null}setChild(e,t){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex(t=>t.name===e),t)}setChildAt(e,t){let n=this.schema,i=[...this.batches];if(e>-1&&e<this.numCols){t||(t=new aR([UL({type:new yI,length:this.numRows})]));const r=n.fields.slice(),o=r[e].clone({type:t.type}),s=this.schema.fields.map((e,t)=>this.getChildAt(t));[r[e],s[e]]=[o,t],[n,i]=cM(n,s)}return new fM(n,i)}select(e){const t=this.schema.fields.reduce((e,t,n)=>e.set(t.name,n),new Map);return this.selectAt(e.map(e=>t.get(e)).filter(e=>e>-1))}selectAt(e){const t=this.schema.selectAt(e),n=this.batches.map(t=>t.selectAt(e));return new fM(t,n)}assign(e){const t=this.schema.fields,[n,i]=e.schema.fields.reduce((e,n,i)=>{const[r,o]=e,s=t.findIndex(e=>e.name===n.name);return~s?o[s]=i:r.push(i),e},[[],[]]),r=this.schema.assign(e.schema),o=[...t.map((e,t)=>[t,i[t]]).map(([t,n])=>void 0===n?this.getChildAt(t):e.getChildAt(n)),...n.map(t=>e.getChildAt(t))].filter(Boolean);return new fM(...cM(r,o))}}function pM(e){const t={},n=Object.entries(e);for(const[i,r]of n)t[i]=sM(r);return new fM(t)}dM=Symbol.toStringTag,fM[dM]=(e=>(e.schema=null,e.batches=[],e._offsets=new Uint32Array([0]),e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,e.isValid=YL(jL),e.get=YL(mL.getVisitFn(Pk.Struct)),e.set=qL(BA.getVisitFn(Pk.Struct)),e.indexOf=XL(JL.getVisitFn(Pk.Struct)),"Table"))(fM.prototype);let mM=class e{constructor(...e){switch(e.length){case 2:if([this.schema]=e,!(this.schema instanceof xR))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=UL({nullCount:0,type:new $I(this.schema.fields),children:this.schema.fields.map(e=>UL({type:e.type,nullCount:0}))})]=e,!(this.data instanceof OL))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=gM(this.schema,this.data.children);break;case 1:{const[t]=e,{fields:n,children:i,length:r}=Object.keys(t).reduce((e,n,i)=>(e.children[i]=t[n],e.length=Math.max(e.length,t[n].length),e.fields[i]=wR.new({name:n,type:t[n].type,nullable:!0}),e),{length:0,fields:new Array,children:new Array}),o=new xR(n),s=UL({type:new $I(n),length:r,children:i,nullCount:0});[this.schema,this.data]=gM(o,s.children,r);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=_M(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(e){return this.data.getValid(e)}get(e){return mL.visit(this.data,e)}at(e){return this.get(CL(e,this.numRows))}set(e,t){return BA.visit(this.data,e,t)}indexOf(e,t){return JL.visit(this.data,e,t)}[Symbol.iterator](){return iR.visit(new aR([this.data]))}toArray(){return[...this]}concat(...e){return new fM(this.schema,[this,...e])}slice(t,n){const[i]=new aR([this.data]).slice(t,n).data;return new e(this.schema,i)}getChild(e){var t;return this.getChildAt(null===(t=this.schema.fields)||void 0===t?void 0:t.findIndex(t=>t.name===e))}getChildAt(e){return e>-1&&e<this.schema.fields.length?new aR([this.data.children[e]]):null}setChild(e,t){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex(t=>t.name===e),t)}setChildAt(t,n){let i=this.schema,r=this.data;if(t>-1&&t<this.numCols){n||(n=new aR([UL({type:new yI,length:this.numRows})]));const e=i.fields.slice(),o=r.children.slice(),s=e[t].clone({type:n.type});[e[t],o[t]]=[s,n.data[0]],i=new xR(e,new Map(this.schema.metadata)),r=UL({type:new $I(e),children:o})}return new e(i,r)}select(t){const n=this.schema.select(t),i=new $I(n.fields),r=[];for(const e of t){const t=this.schema.fields.findIndex(t=>t.name===e);~t&&(r[t]=this.data.children[t])}return new e(n,UL({type:i,length:this.numRows,children:r}))}selectAt(t){const n=this.schema.selectAt(t),i=t.map(e=>this.data.children[e]).filter(Boolean),r=UL({type:new $I(n.fields),length:this.numRows,children:i});return new e(n,r)}};function gM(e,t,n=t.reduce((e,t)=>Math.max(e,t.length),0)){var i;const r=[...e.fields],o=[...t],s=(n+63&-64)>>3;for(const[a,l]of e.fields.entries()){const e=t[a];e&&e.length===n||(r[a]=l.clone({nullable:!0}),o[a]=null!==(i=null==e?void 0:e._changeLengthAndBackfillNullBitmap(n))&&void 0!==i?i:UL({type:l.type,length:n,nullCount:n,nullBitmap:new Uint8Array(s)}))}return[e.assign(r),UL({type:new $I(r),length:n,children:o})]}function _M(e,t,n=new Map){var i,r;if((null!==(i=null==e?void 0:e.length)&&void 0!==i?i:0)>0&&(null==e?void 0:e.length)===(null==t?void 0:t.length))for(let o=-1,s=e.length;++o<s;){const{type:i}=e[o],s=t[o];for(const e of[s,...(null===(r=null==s?void 0:s.dictionary)||void 0===r?void 0:r.data)||[]])_M(i.children,null==e?void 0:e.children,n);if(_I.isDictionary(i)){const{id:e}=i;if(n.has(e)){if(n.get(e)!==s.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else(null==s?void 0:s.dictionary)&&n.set(e,s.dictionary)}}return n}hM=Symbol.toStringTag,mM[hM]=(e=>(e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(mM.prototype);class yM extends mM{constructor(e){const t=e.fields.map(e=>UL({type:e.type}));super(e,UL({type:new $I(e.fields),nullCount:0,children:t}))}}let vM=class e{constructor(){this.bb=null,this.bb_pos=0}__init(e,t){return this.bb_pos=e,this.bb=t,this}static getRootAsMessage(t,n){return(n||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,n){return t.setPosition(t.position()+4),(n||new e).__init(t.readInt32(t.position())+t.position(),t)}version(){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.readInt16(this.bb_pos+e):CT.V1}headerType(){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readUint8(this.bb_pos+e):Lk.NONE}header(e){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__union(e,this.bb_pos+t):null}bodyLength(){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb_pos+e):BigInt("0")}customMetadata(e,t){const n=this.bb.__offset(this.bb_pos,12);return n?(t||new sk).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*e),this.bb):null}customMetadataLength(){const e=this.bb.__offset(this.bb_pos,12);return e?this.bb.__vector_len(this.bb_pos+e):0}static startMessage(e){e.startObject(5)}static addVersion(e,t){e.addFieldInt16(0,t,CT.V1)}static addHeaderType(e,t){e.addFieldInt8(1,t,Lk.NONE)}static addHeader(e,t){e.addFieldOffset(2,t,0)}static addBodyLength(e,t){e.addFieldInt64(3,t,BigInt("0"))}static addCustomMetadata(e,t){e.addFieldOffset(4,t,0)}static createCustomMetadataVector(e,t){e.startVector(4,t.length,4);for(let n=t.length-1;n>=0;n--)e.addOffset(t[n]);return e.endVector()}static startCustomMetadataVector(e,t){e.startVector(4,t,4)}static endMessage(e){return e.endObject()}static finishMessageBuffer(e,t){e.finish(t)}static finishSizePrefixedMessageBuffer(e,t){e.finish(t,void 0,!0)}static createMessage(t,n,i,r,o,s){return e.startMessage(t),e.addVersion(t,n),e.addHeaderType(t,i),e.addHeader(t,r),e.addBodyLength(t,o),e.addCustomMetadata(t,s),e.endMessage(t)}};const bM=new class extends QI{visit(e,t){return null==e||null==t?void 0:super.visit(e,t)}visitNull(e,t){return bk.startNull(t),bk.endNull(t)}visitInt(e,t){return rk.startInt(t),rk.addBitWidth(t,e.bitWidth),rk.addIsSigned(t,e.isSigned),rk.endInt(t)}visitFloat(e,t){return pk.startFloatingPoint(t),pk.addPrecision(t,e.precision),pk.endFloatingPoint(t)}visitBinary(e,t){return ak.startBinary(t),ak.endBinary(t)}visitLargeBinary(e,t){return gk.startLargeBinary(t),gk.endLargeBinary(t)}visitBool(e,t){return lk.startBool(t),lk.endBool(t)}visitUtf8(e,t){return Ck.startUtf8(t),Ck.endUtf8(t)}visitLargeUtf8(e,t){return _k.startLargeUtf8(t),_k.endLargeUtf8(t)}visitDecimal(e,t){return uk.startDecimal(t),uk.addScale(t,e.scale),uk.addPrecision(t,e.precision),uk.addBitWidth(t,e.bitWidth),uk.endDecimal(t)}visitDate(e,t){return ck.startDate(t),ck.addUnit(t,e.unit),ck.endDate(t)}visitTime(e,t){return wk.startTime(t),wk.addUnit(t,e.unit),wk.addBitWidth(t,e.bitWidth),wk.endTime(t)}visitTimestamp(e,t){const n=e.timezone&&t.createString(e.timezone)||void 0;return Sk.startTimestamp(t),Sk.addUnit(t,e.unit),void 0!==n&&Sk.addTimezone(t,n),Sk.endTimestamp(t)}visitInterval(e,t){return mk.startInterval(t),mk.addUnit(t,e.unit),mk.endInterval(t)}visitDuration(e,t){return dk.startDuration(t),dk.addUnit(t,e.unit),dk.endDuration(t)}visitList(e,t){return yk.startList(t),yk.endList(t)}visitStruct(e,t){return xk.startStruct_(t),xk.endStruct_(t)}visitUnion(e,t){Ek.startTypeIdsVector(t,e.typeIds.length);const n=Ek.createTypeIdsVector(t,e.typeIds);return Ek.startUnion(t),Ek.addMode(t,e.mode),Ek.addTypeIds(t,n),Ek.endUnion(t)}visitDictionary(e,t){const n=this.visit(e.indices,t);return ok.startDictionaryEncoding(t),ok.addId(t,BigInt(e.id)),ok.addIsOrdered(t,e.isOrdered),void 0!==n&&ok.addIndexType(t,n),ok.endDictionaryEncoding(t)}visitFixedSizeBinary(e,t){return hk.startFixedSizeBinary(t),hk.addByteWidth(t,e.byteWidth),hk.endFixedSizeBinary(t)}visitFixedSizeList(e,t){return fk.startFixedSizeList(t),fk.addListSize(t,e.listSize),fk.endFixedSizeList(t)}visitMap(e,t){return vk.startMap(t),vk.addKeysSorted(t,e.keysSorted),vk.endMap(t)}};function xM(e){return new RM(e.count,SM(e.columns),EM(e.columns))}function wM(e,t){return(e.children||[]).filter(Boolean).map(e=>wR.fromJSON(e,t))}function SM(e){return(e||[]).reduce((e,t)=>{return[...e,new DM(t.count,(n=t.VALIDITY,(n||[]).reduce((e,t)=>e+ +(0===t),0))),...SM(t.children)];var n},[])}function EM(e,t=[]){for(let n=-1,i=(e||[]).length;++n<i;){const i=e[n];i.VALIDITY&&t.push(new MM(t.length,i.VALIDITY.length)),i.TYPE_ID&&t.push(new MM(t.length,i.TYPE_ID.length)),i.OFFSET&&t.push(new MM(t.length,i.OFFSET.length)),i.DATA&&t.push(new MM(t.length,i.DATA.length)),t=EM(i.children,t)}return t}function CM(e=[]){return new Map(e.map(({key:e,value:t})=>[e,t]))}function TM(e){return new vI(e.isSigned,e.bitWidth)}function kM(e,t){const n=e.type.name;switch(n){case"NONE":case"null":return new yI;case"binary":return new RI;case"largebinary":return new PI;case"utf8":return new MI;case"largeutf8":return new DI;case"bool":return new NI;case"list":return new WI((t||[])[0]);case"struct":case"struct_":return new $I(t||[])}switch(n){case"int":{const t=e.type;return new vI(t.isSigned,t.bitWidth)}case"floatingpoint":{const t=e.type;return new II(AT[t.precision])}case"decimal":{const t=e.type;return new FI(t.scale,t.precision,t.bitWidth)}case"date":{const t=e.type;return new OI(RT[t.unit])}case"time":{const t=e.type;return new BI(MT[t.unit],t.bitWidth)}case"timestamp":{const t=e.type;return new zI(MT[t.unit],t.timezone)}case"interval":{const t=e.type;return new VI(NT[t.unit])}case"duration":{const t=e.type;return new HI(MT[t.unit])}case"union":{const n=e.type,[i,...r]=(n.mode+"").toLowerCase(),o=i.toUpperCase()+r.join("");return new GI(kT[o],n.typeIds||[],t||[])}case"fixedsizebinary":{const t=e.type;return new jI(t.byteWidth)}case"fixedsizelist":{const n=e.type;return new YI(n.listSize,(t||[])[0])}case"map":{const n=e.type;return new qI((t||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${n}"`)}var IM=$T,AM=WT;class LM{static fromJSON(e,t){const n=new LM(0,CT.V5,t);return n._createHeader=function(e,t){return()=>{switch(t){case Lk.Schema:return xR.fromJSON(e);case Lk.RecordBatch:return RM.fromJSON(e);case Lk.DictionaryBatch:return PM.fromJSON(e)}throw new Error(`Unrecognized Message type: { name: ${Lk[t]}, type: ${t} }`)}}(e,t),n}static decode(e){e=new AM(gT(e));const t=vM.getRootAsMessage(e),n=t.bodyLength(),i=t.version(),r=t.headerType(),o=new LM(n,i,r);return o._createHeader=function(e,t){return()=>{switch(t){case Lk.Schema:return xR.decode(e.header(new Ak),new Map,e.version());case Lk.RecordBatch:return RM.decode(e.header(new QT),e.version());case Lk.DictionaryBatch:return PM.decode(e.header(new JT),e.version())}throw new Error(`Unrecognized Message type: { name: ${Lk[t]}, type: ${t} }`)}}(t,r),o}static encode(e){const t=new IM;let n=-1;return e.isSchema()?n=xR.encode(t,e.header()):e.isRecordBatch()?n=RM.encode(t,e.header()):e.isDictionaryBatch()&&(n=PM.encode(t,e.header())),vM.startMessage(t),vM.addVersion(t,CT.V5),vM.addHeader(t,n),vM.addHeaderType(t,e.headerType),vM.addBodyLength(t,BigInt(e.bodyLength)),vM.finishMessageBuffer(t,vM.endMessage(t)),t.asUint8Array()}static from(e,t=0){if(e instanceof xR)return new LM(0,CT.V5,Lk.Schema,e);if(e instanceof RM)return new LM(t,CT.V5,Lk.RecordBatch,e);if(e instanceof PM)return new LM(t,CT.V5,Lk.DictionaryBatch,e);throw new Error(`Unrecognized Message header: ${e}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===Lk.Schema}isRecordBatch(){return this.headerType===Lk.RecordBatch}isDictionaryBatch(){return this.headerType===Lk.DictionaryBatch}constructor(e,t,n,i){this._version=t,this._headerType=n,this.body=new Uint8Array(0),i&&(this._createHeader=()=>i),this._bodyLength=Fk(e)}}class RM{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor(e,t,n){this._nodes=t,this._buffers=n,this._length=Fk(e)}}class PM{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(e,t,n=!1){this._data=e,this._isDelta=n,this._id=Fk(t)}}class MM{constructor(e,t){this.offset=Fk(e),this.length=Fk(t)}}class DM{constructor(e,t){this.length=Fk(e),this.nullCount=Fk(t)}}function NM(e,t){const n=[];for(let i,r=-1,o=-1,s=e.childrenLength();++r<s;)(i=e.children(r))&&(n[++o]=wR.decode(i,t));return n}function FM(e){const t=new Map;if(e)for(let n,i,r=-1,o=Math.trunc(e.customMetadataLength());++r<o;)(n=e.customMetadata(r))&&null!=(i=n.key())&&t.set(i,n.value());return t}function OM(e){return new vI(e.isSigned(),e.bitWidth())}function BM(e,t){const n=e.typeType();switch(n){case Tk.NONE:case Tk.Null:return new yI;case Tk.Binary:return new RI;case Tk.LargeBinary:return new PI;case Tk.Utf8:return new MI;case Tk.LargeUtf8:return new DI;case Tk.Bool:return new NI;case Tk.List:return new WI((t||[])[0]);case Tk.Struct_:return new $I(t||[])}switch(n){case Tk.Int:{const t=e.type(new rk);return new vI(t.isSigned(),t.bitWidth())}case Tk.FloatingPoint:{const t=e.type(new pk);return new II(t.precision())}case Tk.Decimal:{const t=e.type(new uk);return new FI(t.scale(),t.precision(),t.bitWidth())}case Tk.Date:{const t=e.type(new ck);return new OI(t.unit())}case Tk.Time:{const t=e.type(new wk);return new BI(t.unit(),t.bitWidth())}case Tk.Timestamp:{const t=e.type(new Sk);return new zI(t.unit(),t.timezone())}case Tk.Interval:{const t=e.type(new mk);return new VI(t.unit())}case Tk.Duration:{const t=e.type(new dk);return new HI(t.unit())}case Tk.Union:{const n=e.type(new Ek);return new GI(n.mode(),n.typeIdsArray()||[],t||[])}case Tk.FixedSizeBinary:{const t=e.type(new hk);return new jI(t.byteWidth())}case Tk.FixedSizeList:{const n=e.type(new fk);return new YI(n.listSize(),(t||[])[0])}case Tk.Map:{const n=e.type(new vk);return new qI((t||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${Tk[n]}" (${n})`)}wR.encode=function(e,t){let n=-1,i=-1,r=-1;const o=t.type;let s=t.typeId;_I.isDictionary(o)?(s=o.dictionary.typeId,r=bM.visit(o,e),i=bM.visit(o.dictionary,e)):i=bM.visit(o,e);const a=(o.children||[]).map(t=>wR.encode(e,t)),l=Ik.createChildrenVector(e,a),c=t.metadata&&t.metadata.size>0?Ik.createCustomMetadataVector(e,[...t.metadata].map(([t,n])=>{const i=e.createString(`${t}`),r=e.createString(`${n}`);return sk.startKeyValue(e),sk.addKey(e,i),sk.addValue(e,r),sk.endKeyValue(e)})):-1;return t.name&&(n=e.createString(t.name)),Ik.startField(e),Ik.addType(e,i),Ik.addTypeType(e,s),Ik.addChildren(e,l),Ik.addNullable(e,!!t.nullable),-1!==n&&Ik.addName(e,n),-1!==r&&Ik.addDictionary(e,r),-1!==c&&Ik.addCustomMetadata(e,c),Ik.endField(e)},wR.decode=function(e,t){let n,i,r,o,s,a;return t&&(a=e.dictionary())?t.has(n=Fk(a.id()))?(o=(o=a.indexType())?OM(o):new wI,s=new KI(t.get(n),o,n,a.isOrdered()),i=new wR(e.name(),s,e.nullable(),FM(e))):(o=(o=a.indexType())?OM(o):new wI,t.set(n,r=BM(e,NM(e,t))),s=new KI(r,o,n,a.isOrdered()),i=new wR(e.name(),s,e.nullable(),FM(e))):(r=BM(e,NM(e,t)),i=new wR(e.name(),r,e.nullable(),FM(e))),i||null},wR.fromJSON=function(e,t){let n,i,r,o,s,a;return t&&(o=e.dictionary)?t.has(n=o.id)?(i=(i=o.indexType)?TM(i):new wI,a=new KI(t.get(n),i,n,o.isOrdered),r=new wR(e.name,a,e.nullable,CM(e.metadata))):(i=(i=o.indexType)?TM(i):new wI,t.set(n,s=kM(e,wM(e,t))),a=new KI(s,i,n,o.isOrdered),r=new wR(e.name,a,e.nullable,CM(e.metadata))):(s=kM(e,wM(e,t)),r=new wR(e.name,s,e.nullable,CM(e.metadata))),r||null},xR.encode=function(e,t){const n=t.fields.map(t=>wR.encode(e,t));Ak.startFieldsVector(e,n.length);const i=Ak.createFieldsVector(e,n),r=t.metadata&&t.metadata.size>0?Ak.createCustomMetadataVector(e,[...t.metadata].map(([t,n])=>{const i=e.createString(`${t}`),r=e.createString(`${n}`);return sk.startKeyValue(e),sk.addKey(e,i),sk.addValue(e,r),sk.endKeyValue(e)})):-1;return Ak.startSchema(e),Ak.addFields(e,i),Ak.addEndianness(e,zM?ek.Little:ek.Big),-1!==r&&Ak.addCustomMetadata(e,r),Ak.endSchema(e)},xR.decode=function(e,t=new Map,n=CT.V5){const i=function(e,t){const n=[];for(let i,r=-1,o=-1,s=e.fieldsLength();++r<s;)(i=e.fields(r))&&(n[++o]=wR.decode(i,t));return n}(e,t);return new xR(i,FM(e),t,n)},xR.fromJSON=function(e,t=new Map){return new xR(function(e,t){return(e.fields||[]).filter(Boolean).map(e=>wR.fromJSON(e,t))}(e,t),CM(e.metadata),t)},RM.encode=function(e,t){const n=t.nodes||[],i=t.buffers||[];QT.startNodesVector(e,n.length);for(const s of n.slice().reverse())DM.encode(e,s);const r=e.endVector();QT.startBuffersVector(e,i.length);for(const s of i.slice().reverse())MM.encode(e,s);const o=e.endVector();return QT.startRecordBatch(e),QT.addLength(e,BigInt(t.length)),QT.addNodes(e,r),QT.addBuffers(e,o),QT.endRecordBatch(e)},RM.decode=function(e,t=CT.V5){if(null!==e.compression())throw new Error("Record batch compression not implemented");return new RM(e.length(),function(e){const t=[];for(let n,i=-1,r=-1,o=e.nodesLength();++i<o;)(n=e.nodes(i))&&(t[++r]=DM.decode(n));return t}(e),function(e,t){const n=[];for(let i,r=-1,o=-1,s=e.buffersLength();++r<s;)(i=e.buffers(r))&&(t<CT.V4&&(i.bb_pos+=8*(r+1)),n[++o]=MM.decode(i));return n}(e,t))},RM.fromJSON=xM,PM.encode=function(e,t){const n=RM.encode(e,t.data);return JT.startDictionaryBatch(e),JT.addId(e,BigInt(t.id)),JT.addIsDelta(e,t.isDelta),JT.addData(e,n),JT.endDictionaryBatch(e)},PM.decode=function(e,t=CT.V5){return new PM(RM.decode(e.data(),t),e.id(),e.isDelta())},PM.fromJSON=function(e){return new PM(xM(e.data),e.id,e.isDelta)},DM.encode=function(e,t){return ZT.createFieldNode(e,BigInt(t.length),BigInt(t.nullCount))},DM.decode=function(e){return new DM(e.length(),e.nullCount())},MM.encode=function(e,t){return KT.createBuffer(e,BigInt(t.offset),BigInt(t.length))},MM.decode=function(e){return new MM(e.offset(),e.length())};const zM=(()=>{const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]})(),UM=e=>`Expected ${Lk[e]} Message in stream, but was null or length 0.`,VM=e=>`Header pointer of flatbuffer-encoded ${Lk[e]} Message is null or length 0.`,HM=(e,t)=>`Expected to read ${e} metadata bytes, but only read ${t}.`,WM=(e,t)=>`Expected to read ${e} bytes for message body, but only read ${t}.`;class $M{constructor(e){this.source=e instanceof NR?e:new NR(e)}[Symbol.iterator](){return this}next(){let e;return(e=this.readMetadataLength()).done||-1===e.value&&(e=this.readMetadataLength()).done||(e=this.readMetadata(e.value)).done?LR:e}throw(e){return this.source.throw(e)}return(e){return this.source.return(e)}readMessage(e){let t;if((t=this.next()).done)return null;if(null!=e&&t.value.headerType!==e)throw new Error(UM(e));return t.value}readMessageBody(e){if(e<=0)return new Uint8Array(0);const t=gT(this.source.read(e));if(t.byteLength<e)throw new Error(WM(e,t.byteLength));return t.byteOffset%8==0&&t.byteOffset+t.byteLength<=t.buffer.byteLength?t:t.slice()}readSchema(e=!1){const t=Lk.Schema,n=this.readMessage(t),i=null==n?void 0:n.header();if(e&&!i)throw new Error(VM(t));return i}readMetadataLength(){const e=this.source.read(YM),t=e&&new WT(e),n=(null==t?void 0:t.readInt32(0))||0;return{done:0===n,value:n}}readMetadata(e){const t=this.source.read(e);if(!t)return LR;if(t.byteLength<e)throw new Error(HM(e,t.byteLength));return{done:!1,value:LM.decode(t)}}}class GM{constructor(e,t){this.source=e instanceof FR?e:oT(e)?new UR(e,t):new FR(e)}[Symbol.asyncIterator](){return this}next(){return HC(this,void 0,void 0,function*(){let e;return(e=yield this.readMetadataLength()).done||-1===e.value&&(e=yield this.readMetadataLength()).done||(e=yield this.readMetadata(e.value)).done?LR:e})}throw(e){return HC(this,void 0,void 0,function*(){return yield this.source.throw(e)})}return(e){return HC(this,void 0,void 0,function*(){return yield this.source.return(e)})}readMessage(e){return HC(this,void 0,void 0,function*(){let t;if((t=yield this.next()).done)return null;if(null!=e&&t.value.headerType!==e)throw new Error(UM(e));return t.value})}readMessageBody(e){return HC(this,void 0,void 0,function*(){if(e<=0)return new Uint8Array(0);const t=gT(yield this.source.read(e));if(t.byteLength<e)throw new Error(WM(e,t.byteLength));return t.byteOffset%8==0&&t.byteOffset+t.byteLength<=t.buffer.byteLength?t:t.slice()})}readSchema(){return HC(this,arguments,void 0,function*(e=!1){const t=Lk.Schema,n=yield this.readMessage(t),i=null==n?void 0:n.header();if(e&&!i)throw new Error(VM(t));return i})}readMetadataLength(){return HC(this,void 0,void 0,function*(){const e=yield this.source.read(YM),t=e&&new WT(e),n=(null==t?void 0:t.readInt32(0))||0;return{done:0===n,value:n}})}readMetadata(e){return HC(this,void 0,void 0,function*(){const t=yield this.source.read(e);if(!t)return LR;if(t.byteLength<e)throw new Error(HM(e,t.byteLength));return{done:!1,value:LM.decode(t)}})}}class jM extends $M{constructor(e){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=e instanceof RR?e:new RR(e)}next(){const{_json:e}=this;if(!this._schema)return this._schema=!0,{done:!1,value:LM.fromJSON(e.schema,Lk.Schema)};if(this._dictionaryIndex<e.dictionaries.length){const t=e.dictionaries[this._dictionaryIndex++];return this._body=t.data.columns,{done:!1,value:LM.fromJSON(t,Lk.DictionaryBatch)}}if(this._batchIndex<e.batches.length){const t=e.batches[this._batchIndex++];return this._body=t.columns,{done:!1,value:LM.fromJSON(t,Lk.RecordBatch)}}return this._body=[],LR}readMessageBody(e){return function e(t){return(t||[]).reduce((t,n)=>[...t,...n.VALIDITY&&[n.VALIDITY]||[],...n.TYPE_ID&&[n.TYPE_ID]||[],...n.OFFSET&&[n.OFFSET]||[],...n.DATA&&[n.DATA]||[],...e(n.children)],[])}(this._body)}readMessage(e){let t;if((t=this.next()).done)return null;if(null!=e&&t.value.headerType!==e)throw new Error(UM(e));return t.value}readSchema(){const e=Lk.Schema,t=this.readMessage(e),n=null==t?void 0:t.header();if(!t||!n)throw new Error(VM(e));return n}}const YM=4,qM=new Uint8Array(6);for(let dK=0;dK<6;dK+=1)qM[dK]="ARROW1".codePointAt(dK);function XM(e,t=0){for(let n=-1,i=qM.length;++n<i;)if(qM[n]!==e[t+n])return!1;return!0}const KM=qM.length,ZM=KM+YM,QM=2*KM+YM;class JM extends PR{constructor(e){super(),this._impl=e}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(e){return this._impl.throw(e)}return(e){return this._impl.return(e)}cancel(){return this._impl.cancel()}reset(e){return this._impl.reset(e),this._DOMStream=void 0,this._nodeStream=void 0,this}open(e){const t=this._impl.open(e);return eT(t)?t.then(()=>this):this}readRecordBatch(e){return this._impl.isFile()?this._impl.readRecordBatch(e):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return xT.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return xT.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,t){throw new Error('"throughDOM" not available in this environment')}static from(e){return e instanceof JM?e:iT(e)?function(e){return new eD(new cD(e))}(e):oT(e)?function(e){return HC(this,void 0,void 0,function*(){const{size:t}=yield e.stat(),n=new UR(e,t);return t>=QM&&XM(yield n.readAt(0,KM+7&-8))?new iD(new lD(n)):new tD(new sD(n))})}(e):eT(e)?(()=>HC(this,void 0,void 0,function*(){return yield JM.from(yield e)}))():sT(e)||lT(e)||cT(e)||nT(e)?function(e){return HC(this,void 0,void 0,function*(){const t=yield e.peek(KM+7&-8);return t&&t.byteLength>=4?XM(t)?new nD(new aD(yield e.read())):new tD(new sD(e)):new tD(new sD(function(){return $C(this,arguments,function*(){})}()))})}(new FR(e)):function(e){const t=e.peek(KM+7&-8);return t&&t.byteLength>=4?XM(t)?new nD(new aD(e.read())):new eD(new oD(e)):new eD(new oD(function*(){}()))}(new NR(e))}static readAll(e){return e instanceof JM?e.isSync()?dD(e):hD(e):iT(e)||ArrayBuffer.isView(e)||tT(e)||rT(e)?dD(e):hD(e)}}class eD extends JM{constructor(e){super(e),this._impl=e}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return $C(this,arguments,function*(){yield WC(yield*GC(jC(this[Symbol.iterator]())))})}}class tD extends JM{constructor(e){super(e),this._impl=e}readAll(){return HC(this,void 0,void 0,function*(){var e,t,n,i;const r=new Array;try{for(var o,s=!0,a=jC(this);!(e=(o=yield a.next()).done);s=!0){i=o.value,s=!1;const e=i;r.push(e)}}catch(l){t={error:l}}finally{try{s||e||!(n=a.return)||(yield n.call(a))}finally{if(t)throw t.error}}return r})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class nD extends eD{constructor(e){super(e),this._impl=e}}class iD extends tD{constructor(e){super(e),this._impl=e}}class rD{get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}constructor(e=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=e}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(e){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=e,this.dictionaries=new Map,this}_loadRecordBatch(e,t){const n=this._loadVectors(e,t,this.schema.fields),i=UL({type:new $I(this.schema.fields),length:e.length,children:n});return new mM(this.schema,i)}_loadDictionaryBatch(e,t){const{id:n,isDelta:i}=e,{dictionaries:r,schema:o}=this,s=r.get(n),a=o.dictionaries.get(n),l=this._loadVectors(e.data,t,[a]);return(s&&i?s.concat(new aR(l)):new aR(l)).memoize()}_loadVectors(e,t,n){return new YR(t,e.nodes,e.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(n)}}class oD extends rD{constructor(e,t){super(t),this._reader=iT(e)?new jM(this._handle=e):new $M(this._handle=e)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(e){return this.closed||(this.autoDestroy=uD(this,e),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(e):LR}return(e){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(e):LR}next(){if(this.closed)return LR;let e;const{_reader:t}=this;for(;e=this._readNextMessageAndValidate();)if(e.isSchema())this.reset(e.header());else{if(e.isRecordBatch()){this._recordBatchIndex++;const n=e.header(),i=t.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(n,i)}}if(e.isDictionaryBatch()){this._dictionaryIndex++;const n=e.header(),i=t.readMessageBody(e.bodyLength),r=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,r)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new yM(this.schema)}):this.return()}_readNextMessageAndValidate(e){return this._reader.readMessage(e)}}class sD extends rD{constructor(e,t){super(t),this._reader=new GM(this._handle=e)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return HC(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(e){return HC(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=uD(this,e),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(e){return HC(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(e):LR})}return(e){return HC(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(e):LR})}next(){return HC(this,void 0,void 0,function*(){if(this.closed)return LR;let e;const{_reader:t}=this;for(;e=yield this._readNextMessageAndValidate();)if(e.isSchema())yield this.reset(e.header());else{if(e.isRecordBatch()){this._recordBatchIndex++;const n=e.header(),i=yield t.readMessageBody(e.bodyLength);return{done:!1,value:this._loadRecordBatch(n,i)}}if(e.isDictionaryBatch()){this._dictionaryIndex++;const n=e.header(),i=yield t.readMessageBody(e.bodyLength),r=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,r)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new yM(this.schema)}):yield this.return()})}_readNextMessageAndValidate(e){return HC(this,void 0,void 0,function*(){return yield this._reader.readMessage(e)})}}class aD extends oD{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(e,t){super(e instanceof zR?e:new zR(e),t)}isSync(){return!0}isFile(){return!0}open(e){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const e of this._footer.dictionaryBatches())e&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(e)}readRecordBatch(e){var t;if(this.closed)return null;this._footer||this.open();const n=null===(t=this._footer)||void 0===t?void 0:t.getRecordBatch(e);if(n&&this._handle.seek(n.offset)){const e=this._reader.readMessage(Lk.RecordBatch);if(null==e?void 0:e.isRecordBatch()){const t=e.header(),n=this._reader.readMessageBody(e.bodyLength);return this._loadRecordBatch(t,n)}}return null}_readDictionaryBatch(e){var t;const n=null===(t=this._footer)||void 0===t?void 0:t.getDictionaryBatch(e);if(n&&this._handle.seek(n.offset)){const e=this._reader.readMessage(Lk.DictionaryBatch);if(null==e?void 0:e.isDictionaryBatch()){const t=e.header(),n=this._reader.readMessageBody(e.bodyLength),i=this._loadDictionaryBatch(t,n);this.dictionaries.set(t.id,i)}}}_readFooter(){const{_handle:e}=this,t=e.size-ZM,n=e.readInt32(t),i=e.readAt(t-n,n);return kR.decode(i)}_readNextMessageAndValidate(e){var t;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const n=null===(t=this._footer)||void 0===t?void 0:t.getRecordBatch(this._recordBatchIndex);if(n&&this._handle.seek(n.offset))return this._reader.readMessage(e)}return null}}class lD extends sD{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(e,...t){const n="number"!=typeof t[0]?t.shift():void 0,i=t[0]instanceof Map?t.shift():void 0;super(e instanceof UR?e:new UR(e,n),i)}isFile(){return!0}isAsync(){return!0}open(e){const t=Object.create(null,{open:{get:()=>super.open}});return HC(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const e of this._footer.dictionaryBatches())e&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield t.open.call(this,e)})}readRecordBatch(e){return HC(this,void 0,void 0,function*(){var t;if(this.closed)return null;this._footer||(yield this.open());const n=null===(t=this._footer)||void 0===t?void 0:t.getRecordBatch(e);if(n&&(yield this._handle.seek(n.offset))){const e=yield this._reader.readMessage(Lk.RecordBatch);if(null==e?void 0:e.isRecordBatch()){const t=e.header(),n=yield this._reader.readMessageBody(e.bodyLength);return this._loadRecordBatch(t,n)}}return null})}_readDictionaryBatch(e){return HC(this,void 0,void 0,function*(){var t;const n=null===(t=this._footer)||void 0===t?void 0:t.getDictionaryBatch(e);if(n&&(yield this._handle.seek(n.offset))){const e=yield this._reader.readMessage(Lk.DictionaryBatch);if(null==e?void 0:e.isDictionaryBatch()){const t=e.header(),n=yield this._reader.readMessageBody(e.bodyLength),i=this._loadDictionaryBatch(t,n);this.dictionaries.set(t.id,i)}}})}_readFooter(){return HC(this,void 0,void 0,function*(){const{_handle:e}=this;e._pending&&(yield e._pending);const t=e.size-ZM,n=yield e.readInt32(t),i=yield e.readAt(t-n,n);return kR.decode(i)})}_readNextMessageAndValidate(e){return HC(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const t=this._footer.getRecordBatch(this._recordBatchIndex);if(t&&(yield this._handle.seek(t.offset)))return yield this._reader.readMessage(e)}return null})}}class cD extends oD{constructor(e,t){super(e,t)}_loadVectors(e,t,n){return new qR(t,e.nodes,e.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(n)}}function uD(e,t){return t&&"boolean"==typeof t.autoDestroy?t.autoDestroy:e.autoDestroy}function*dD(e){const t=JM.from(e);try{if(!t.open({autoDestroy:!1}).closed)do{yield t}while(!t.reset().open().closed)}finally{t.cancel()}}function hD(e){return $C(this,arguments,function*(){const t=yield WC(JM.from(e));try{if(!(yield WC(t.open({autoDestroy:!1}))).closed)do{yield yield WC(t)}while(!(yield WC(t.reset().open())).closed)}finally{yield WC(t.cancel())}})}class fD extends QI{static assemble(...e){const t=e=>e.flatMap(e=>Array.isArray(e)?t(e):e instanceof mM?e.data.children:e.data),n=new fD;return n.visitMany(t(e)),n}constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}visit(e){if(e instanceof aR)return this.visitMany(e.data),this;const{type:t}=e;if(!_I.isDictionary(t)){const{length:n}=e;if(n>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");if(_I.isUnion(t))this.nodes.push(new DM(n,0));else{const{nullCount:i}=e;_I.isNull(t)||pD.call(this,i<=0?new Uint8Array(0):PL(e.offset,n,e.nullBitmap)),this.nodes.push(new DM(n,i))}}return super.visit(e)}visitNull(e){return this}visitDictionary(e){return this.visit(e.clone(e.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function pD(e){const t=e.byteLength+7&-8;return this.buffers.push(e),this.bufferRegions.push(new MM(this._byteLength,t)),this._byteLength+=t,this}function mD(e){return pD.call(this,e.values.subarray(0,e.length*e.stride))}function gD(e){const{length:t,values:n,valueOffsets:i}=e,r=Fk(i[0]),o=Fk(i[t]),s=Math.min(o-r,n.byteLength-r);return pD.call(this,bT(-r,t+1,i)),pD.call(this,n.subarray(r,r+s)),this}function _D(e){const{length:t,valueOffsets:n}=e;if(n){const{0:i,[t]:r}=n;return pD.call(this,bT(-i,t+1,n)),this.visit(e.children[0].slice(i,r-i))}return this.visit(e.children[0])}function yD(e){return this.visitMany(e.type.children.map((t,n)=>e.children[n]).filter(Boolean))[0]}fD.prototype.visitBool=function(e){let t;return e.nullCount>=e.length?pD.call(this,new Uint8Array(0)):(t=e.values)instanceof Uint8Array?pD.call(this,PL(e.offset,e.length,t)):pD.call(this,ML(e.values))},fD.prototype.visitInt=mD,fD.prototype.visitFloat=mD,fD.prototype.visitUtf8=gD,fD.prototype.visitLargeUtf8=gD,fD.prototype.visitBinary=gD,fD.prototype.visitLargeBinary=gD,fD.prototype.visitFixedSizeBinary=mD,fD.prototype.visitDate=mD,fD.prototype.visitTimestamp=mD,fD.prototype.visitTime=mD,fD.prototype.visitDecimal=mD,fD.prototype.visitList=_D,fD.prototype.visitStruct=yD,fD.prototype.visitUnion=function(e){var t;const{type:n,length:i,typeIds:r,valueOffsets:o}=e;if(pD.call(this,r),n.mode===kT.Sparse)return yD.call(this,e);if(n.mode===kT.Dense){if(e.offset<=0)return pD.call(this,o),yD.call(this,e);{const s=new Int32Array(i),a=Object.create(null),l=Object.create(null);for(let e,n,c=-1;++c<i;)void 0!==(e=r[c])&&(void 0===(n=a[e])&&(n=a[e]=o[c]),s[c]=o[c]-n,l[e]=(null!==(t=l[e])&&void 0!==t?t:0)+1);pD.call(this,s),this.visitMany(e.children.map((e,t)=>{const r=n.typeIds[t],o=a[r],s=l[r];return e.slice(o,Math.min(i,s))}))}}return this},fD.prototype.visitInterval=mD,fD.prototype.visitDuration=mD,fD.prototype.visitFixedSizeList=_D,fD.prototype.visitMap=_D;class vD extends PR{static throughNode(e){throw new Error('"throughNode" not available in this environment')}static throughDOM(e,t){throw new Error('"throughDOM" not available in this environment')}constructor(e){super(),this._position=0,this._started=!1,this._sink=new DR,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._seenDictionaries=new Map,this._dictionaryDeltaOffsets=new Map,JC(e)||(e={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy="boolean"!=typeof e.autoDestroy||e.autoDestroy,this._writeLegacyIpcFormat="boolean"==typeof e.writeLegacyIpcFormat&&e.writeLegacyIpcFormat}toString(e=!1){return this._sink.toString(e)}toUint8Array(e=!1){return this._sink.toUint8Array(e)}writeAll(e){return eT(e)?e.then(e=>this.writeAll(e)):nT(e)?SD(this,e):wD(this,e)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(e){return this._sink.toDOMStream(e)}toNodeStream(e){return this._sink.toNodeStream(e)}close(){return this.reset()._sink.close()}abort(e){return this.reset()._sink.abort(e)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(e=this._sink,t=null){var n;return e===this._sink||e instanceof DR?this._sink=e:(this._sink=new DR,e&&JC(n=e)&&QC(n.abort)&&QC(n.getWriter)&&!aT(n)?this.toDOMStream({type:"bytes"}).pipeTo(e):e&&(e=>JC(e)&&QC(e.end)&&QC(e.write)&&ZC(e.writable)&&!aT(e))(e)&&this.toNodeStream({objectMode:!1}).pipe(e)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._seenDictionaries=new Map,this._dictionaryDeltaOffsets=new Map,t&&rM(t,this._schema)||(null==t?(this._position=0,this._schema=null):(this._started=!0,this._schema=t,this._writeSchema(t))),this}write(e){let t=null;if(!this._sink)throw new Error("RecordBatchWriter is closed");if(null==e)return this.finish()&&void 0;if(e instanceof fM&&!(t=e.schema))return this.finish()&&void 0;if(e instanceof mM&&!(t=e.schema))return this.finish()&&void 0;if(t&&!rM(t,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,t)}e instanceof mM?e instanceof yM||this._writeRecordBatch(e):e instanceof fM?this.writeAll(e.batches):tT(e)&&this.writeAll(e)}_writeMessage(e,t=8){const n=t-1,i=LM.encode(e),r=i.byteLength,o=this._writeLegacyIpcFormat?4:8,s=r+o+n&~n,a=s-r-o;return e.headerType===Lk.RecordBatch?this._recordBatchBlocks.push(new AR(s,e.bodyLength,this._position)):e.headerType===Lk.DictionaryBatch&&this._dictionaryBlocks.push(new AR(s,e.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(s-o)),r>0&&this._write(i),this._writePadding(a)}_write(e){if(this._started){const t=gT(e);t&&t.byteLength>0&&(this._sink.write(t),this._position+=t.byteLength)}return this}_writeSchema(e){return this._writeMessage(LM.from(e))}_writeFooter(e){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(qM)}_writePadding(e){return e>0?this._write(new Uint8Array(e)):this}_writeRecordBatch(e){const{byteLength:t,nodes:n,bufferRegions:i,buffers:r}=fD.assemble(e),o=new RM(e.numRows,n,i),s=LM.from(o,t);return this._writeDictionaries(e)._writeMessage(s)._writeBodyBuffers(r)}_writeDictionaryBatch(e,t,n=!1){const{byteLength:i,nodes:r,bufferRegions:o,buffers:s}=fD.assemble(new aR([e])),a=new RM(e.length,r,o),l=new PM(a,t,n),c=LM.from(l,i);return this._writeMessage(c)._writeBodyBuffers(s)}_writeBodyBuffers(e){let t,n,i;for(let r=-1,o=e.length;++r<o;)(t=e[r])&&(n=t.byteLength)>0&&(this._write(t),(i=(n+7&-8)-n)>0&&this._writePadding(i));return this}_writeDictionaries(e){var t,n;for(const[i,r]of e.dictionaries){const e=null!==(t=null==r?void 0:r.data)&&void 0!==t?t:[],o=this._seenDictionaries.get(i),s=null!==(n=this._dictionaryDeltaOffsets.get(i))&&void 0!==n?n:0;if(o&&o.data[0]===e[0]){if(s<e.length)for(const t of e.slice(s))this._writeDictionaryBatch(t,i,!0)}else for(const[t,n]of e.entries())this._writeDictionaryBatch(n,i,t>0);this._seenDictionaries.set(i,r),this._dictionaryDeltaOffsets.set(i,e.length)}return this}}class bD extends vD{static writeAll(e,t){const n=new bD(t);return eT(e)?e.then(e=>n.writeAll(e)):nT(e)?SD(n,e):wD(n,e)}}class xD extends vD{static writeAll(e){const t=new xD;return eT(e)?e.then(e=>t.writeAll(e)):nT(e)?SD(t,e):wD(t,e)}constructor(){super(),this._autoDestroy=!0}_writeSchema(e){return this._writeMagic()._writePadding(2)}_writeDictionaryBatch(e,t,n=!1){if(!n&&this._seenDictionaries.has(t))throw new Error("The Arrow File format does not support replacement dictionaries. ");return super._writeDictionaryBatch(e,t,n)}_writeFooter(e){const t=kR.encode(new kR(e,CT.V5,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(e)._write(t)._write(Int32Array.of(t.byteLength))._writeMagic()}}function wD(e,t){let n=t;t instanceof fM&&(n=t.batches,e.reset(void 0,t.schema));for(const i of n)e.write(i);return e.finish()}function SD(e,t){return HC(this,void 0,void 0,function*(){var n,i,r,o,s,a,l;try{for(n=!0,i=jC(t);!(o=(r=yield i.next()).done);n=!0){l=r.value,n=!1;const t=l;e.write(t)}}catch(c){s={error:c}}finally{try{n||o||!(a=i.return)||(yield a.call(i))}finally{if(s)throw s.error}}return e.finish()})}function ED(e){const t=JM.from(e);return eT(t)?t.then(e=>ED(e)):t.isAsync()?t.readAll().then(e=>new fM(e)):new fM(t.readAll())}function CD(e,t="stream"){return("stream"===t?bD:xD).writeAll(e).toUint8Array(!0)}var TD,kD=Object.create,ID=Object.defineProperty,AD=Object.getOwnPropertyDescriptor,LD=Object.getOwnPropertyNames,RD=Object.getPrototypeOf,PD=Object.prototype.hasOwnProperty,MD=((e,t)=>()=>(t||((t={exports:{}}).exports=Worker),t.exports))(),DD=(e=>(e[e.UNDEFINED=0]="UNDEFINED",e[e.AUTOMATIC=1]="AUTOMATIC",e[e.READ_ONLY=2]="READ_ONLY",e[e.READ_WRITE=3]="READ_WRITE",e))(DD||{}),ND=(e=>(e[e.IDENTIFIER=0]="IDENTIFIER",e[e.NUMERIC_CONSTANT=1]="NUMERIC_CONSTANT",e[e.STRING_CONSTANT=2]="STRING_CONSTANT",e[e.OPERATOR=3]="OPERATOR",e[e.KEYWORD=4]="KEYWORD",e[e.COMMENT=5]="COMMENT",e))(ND||{}),FD=(e=>(e[e.NONE=0]="NONE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARNING=3]="WARNING",e[e.ERROR=4]="ERROR",e))(FD||{}),OD=(e=>(e[e.NONE=0]="NONE",e[e.CONNECT=1]="CONNECT",e[e.DISCONNECT=2]="DISCONNECT",e[e.OPEN=3]="OPEN",e[e.QUERY=4]="QUERY",e[e.INSTANTIATE=5]="INSTANTIATE",e))(OD||{}),BD=(e=>(e[e.NONE=0]="NONE",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR",e[e.START=3]="START",e[e.RUN=4]="RUN",e[e.CAPTURE=5]="CAPTURE",e))(BD||{}),zD=(e=>(e[e.NONE=0]="NONE",e[e.WEB_WORKER=1]="WEB_WORKER",e[e.NODE_WORKER=2]="NODE_WORKER",e[e.BINDINGS=3]="BINDINGS",e[e.ASYNC_DUCKDB=4]="ASYNC_DUCKDB",e))(zD||{}),UD=class{log(e){}},VD=class{constructor(e=2){this.level=e}log(e){e.level,this.level}},HD=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.MAX_ARROW_ERROR=255]="MAX_ARROW_ERROR",e[e.DUCKDB_WASM_RETRY=256]="DUCKDB_WASM_RETRY",e))(HD||{}),WD=class{constructor(e,t){this._bindings=e,this._conn=t}get bindings(){return this._bindings}async close(){return this._bindings.disconnect(this._conn)}useUnsafe(e){return e(this._bindings,this._conn)}async query(e){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:e});let t=await this._bindings.runQuery(this._conn,e),n=JM.from(t);return new fM(n)}async send(e,t=!1){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:e});let n=await this._bindings.startPendingQuery(this._conn,e,t);for(;null==n;)n=await this._bindings.pollPendingQuery(this._conn);let i=new $D(this._bindings,this._conn,n);return await JM.from(i)}async cancelSent(){return await this._bindings.cancelPendingQuery(this._conn)}async getTableNames(e){return await this._bindings.getTableNames(this._conn,e)}async prepare(e){let t=await this._bindings.createPrepared(this._conn,e);return new GD(this._bindings,this._conn,t)}async insertArrowTable(e,t){let n=CD(e,"stream");await this.insertArrowFromIPCStream(n,t)}async insertArrowFromIPCStream(e,t){await this._bindings.insertArrowFromIPCStream(this._conn,e,t)}async insertCSVFromPath(e,t){await this._bindings.insertCSVFromPath(this._conn,e,t)}async insertJSONFromPath(e,t){await this._bindings.insertJSONFromPath(this._conn,e,t)}},$D=class{constructor(e,t,n){this.db=e,this.conn=t,this.header=n,this._first=!0,this._depleted=!1,this._inFlight=null}async next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let e=null;for(null!=this._inFlight&&(e=await this._inFlight,this._inFlight=null);null==e;)e=await this.db.fetchQueryResults(this.conn);return this._depleted=0==e.length,this._depleted||(this._inFlight=this.db.fetchQueryResults(this.conn)),{done:this._depleted,value:e}}[Symbol.asyncIterator](){return this}},GD=class{constructor(e,t,n){this.bindings=e,this.connectionId=t,this.statementId=n}async close(){await this.bindings.closePrepared(this.connectionId,this.statementId)}async query(...e){let t=await this.bindings.runPrepared(this.connectionId,this.statementId,e),n=JM.from(t);return new fM(n)}async send(...e){let t=await this.bindings.sendPrepared(this.connectionId,this.statementId,e),n=new $D(this.bindings,this.connectionId,t);return await JM.from(n)}},jD=((TD=jD||{}).CANCEL_PENDING_QUERY="CANCEL_PENDING_QUERY",TD.CLOSE_PREPARED="CLOSE_PREPARED",TD.COLLECT_FILE_STATISTICS="COLLECT_FILE_STATISTICS",TD.REGISTER_OPFS_FILE_NAME="REGISTER_OPFS_FILE_NAME",TD.CONNECT="CONNECT",TD.COPY_FILE_TO_BUFFER="COPY_FILE_TO_BUFFER",TD.COPY_FILE_TO_PATH="COPY_FILE_TO_PATH",TD.CREATE_PREPARED="CREATE_PREPARED",TD.DISCONNECT="DISCONNECT",TD.DROP_FILE="DROP_FILE",TD.DROP_FILES="DROP_FILES",TD.EXPORT_FILE_STATISTICS="EXPORT_FILE_STATISTICS",TD.FETCH_QUERY_RESULTS="FETCH_QUERY_RESULTS",TD.FLUSH_FILES="FLUSH_FILES",TD.GET_FEATURE_FLAGS="GET_FEATURE_FLAGS",TD.GET_TABLE_NAMES="GET_TABLE_NAMES",TD.GET_VERSION="GET_VERSION",TD.GLOB_FILE_INFOS="GLOB_FILE_INFOS",TD.INSERT_ARROW_FROM_IPC_STREAM="INSERT_ARROW_FROM_IPC_STREAM",TD.INSERT_CSV_FROM_PATH="IMPORT_CSV_FROM_PATH",TD.INSERT_JSON_FROM_PATH="IMPORT_JSON_FROM_PATH",TD.INSTANTIATE="INSTANTIATE",TD.OPEN="OPEN",TD.PING="PING",TD.POLL_PENDING_QUERY="POLL_PENDING_QUERY",TD.REGISTER_FILE_BUFFER="REGISTER_FILE_BUFFER",TD.REGISTER_FILE_HANDLE="REGISTER_FILE_HANDLE",TD.REGISTER_FILE_URL="REGISTER_FILE_URL",TD.RESET="RESET",TD.RUN_PREPARED="RUN_PREPARED",TD.RUN_QUERY="RUN_QUERY",TD.SEND_PREPARED="SEND_PREPARED",TD.START_PENDING_QUERY="START_PENDING_QUERY",TD.TOKENIZE="TOKENIZE",TD),YD=(e=>(e.CONNECTION_INFO="CONNECTION_INFO",e.ERROR="ERROR",e.FEATURE_FLAGS="FEATURE_FLAGS",e.FILE_BUFFER="FILE_BUFFER",e.FILE_INFOS="FILE_INFOS",e.FILE_SIZE="FILE_SIZE",e.FILE_STATISTICS="FILE_STATISTICS",e.INSTANTIATE_PROGRESS="INSTANTIATE_PROGRESS",e.LOG="LOG",e.PROGRESS_UPDATE="PROGRESS_UPDATE",e.OK="OK",e.PREPARED_STATEMENT_ID="PREPARED_STATEMENT_ID",e.QUERY_PLAN="QUERY_PLAN",e.QUERY_RESULT="QUERY_RESULT",e.QUERY_RESULT_CHUNK="QUERY_RESULT_CHUNK",e.QUERY_RESULT_HEADER="QUERY_RESULT_HEADER",e.QUERY_RESULT_HEADER_OR_NULL="QUERY_RESULT_HEADER_OR_NULL",e.REGISTERED_FILE="REGISTERED_FILE",e.SCRIPT_TOKENS="SCRIPT_TOKENS",e.SUCCESS="SUCCESS",e.TABLE_NAMES="TABLE_NAMES",e.VERSION_STRING="VERSION_STRING",e))(YD||{}),qD=class{constructor(e,t){this.promiseResolver=()=>{},this.promiseRejecter=()=>{},this.type=e,this.data=t,this.promise=new Promise((e,t)=>{this.promiseResolver=e,this.promiseRejecter=t})}};function XD(e){switch(e.typeId){case Pk.Binary:return{sqlType:"binary"};case Pk.Bool:return{sqlType:"bool"};case Pk.Date:return{sqlType:"date"};case Pk.DateDay:return{sqlType:"date32[d]"};case Pk.DateMillisecond:return{sqlType:"date64[ms]"};case Pk.Decimal:{let t=e;return{sqlType:"decimal",precision:t.precision,scale:t.scale}}case Pk.Float:return{sqlType:"float"};case Pk.Float16:return{sqlType:"float16"};case Pk.Float32:return{sqlType:"float32"};case Pk.Float64:return{sqlType:"float64"};case Pk.Int:return{sqlType:"int32"};case Pk.Int16:return{sqlType:"int16"};case Pk.Int32:return{sqlType:"int32"};case Pk.Int64:return{sqlType:"int64"};case Pk.Uint16:return{sqlType:"uint16"};case Pk.Uint32:return{sqlType:"uint32"};case Pk.Uint64:return{sqlType:"uint64"};case Pk.Uint8:return{sqlType:"uint8"};case Pk.IntervalDayTime:return{sqlType:"interval[dt]"};case Pk.IntervalYearMonth:return{sqlType:"interval[m]"};case Pk.List:return{sqlType:"list",valueType:XD(e.valueType)};case Pk.FixedSizeBinary:return{sqlType:"fixedsizebinary",byteWidth:e.byteWidth};case Pk.Null:return{sqlType:"null"};case Pk.Utf8:return{sqlType:"utf8"};case Pk.Struct:return{sqlType:"struct",fields:e.children.map(e=>KD(e.name,e.type))};case Pk.Map:{let t=e;return{sqlType:"map",keyType:XD(t.keyType),valueType:XD(t.valueType)}}case Pk.Time:return{sqlType:"time[s]"};case Pk.TimeMicrosecond:return{sqlType:"time[us]"};case Pk.TimeMillisecond:return{sqlType:"time[ms]"};case Pk.TimeNanosecond:return{sqlType:"time[ns]"};case Pk.TimeSecond:return{sqlType:"time[s]"};case Pk.Timestamp:return{sqlType:"timestamp",timezone:e.timezone||void 0};case Pk.TimestampSecond:return{sqlType:"timestamp[s]",timezone:e.timezone||void 0};case Pk.TimestampMicrosecond:return{sqlType:"timestamp[us]",timezone:e.timezone||void 0};case Pk.TimestampNanosecond:return{sqlType:"timestamp[ns]",timezone:e.timezone||void 0};case Pk.TimestampMillisecond:return{sqlType:"timestamp[ms]",timezone:e.timezone||void 0}}throw new Error("unsupported arrow type: ".concat(e.toString()))}function KD(e,t){let n=XD(t);return n.name=e,n}var ZD=new TextEncoder,QD=class{constructor(e,t=null){this._onInstantiationProgress=[],this._onExecutionProgress=[],this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{},this._nextMessageId=0,this._pendingRequests=new Map,this._logger=e,this._onMessageHandler=this.onMessage.bind(this),this._onErrorHandler=this.onError.bind(this),this._onCloseHandler=this.onClose.bind(this),null!=t&&this.attach(t)}get logger(){return this._logger}attach(e){this._worker=e,this._worker.addEventListener("message",this._onMessageHandler),this._worker.addEventListener("error",this._onErrorHandler),this._worker.addEventListener("close",this._onCloseHandler),this._workerShutdownPromise=new Promise((e,t)=>{this._workerShutdownResolver=e})}detach(){this._worker&&(this._worker.removeEventListener("message",this._onMessageHandler),this._worker.removeEventListener("error",this._onErrorHandler),this._worker.removeEventListener("close",this._onCloseHandler),this._worker=null,this._workerShutdownResolver(null),this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async terminate(){this._worker&&(this._worker.terminate(),this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async postTask(e,t=[]){if(!this._worker)return;let n=this._nextMessageId++;return this._pendingRequests.set(n,e),this._worker.postMessage({messageId:n,type:e.type,data:e.data},t),await e.promise}onMessage(e){var t;let n=e.data;switch(n.type){case"PROGRESS_UPDATE":for(let e of this._onExecutionProgress)e(n.data);return;case"LOG":return void this._logger.log(n.data);case"INSTANTIATE_PROGRESS":for(let e of this._onInstantiationProgress)e(n.data);return}let i=this._pendingRequests.get(n.requestId);if(i){if(this._pendingRequests.delete(n.requestId),"ERROR"==n.type){let e=new Error(n.data.message);return e.name=n.data.name,null!=(t=Object.getOwnPropertyDescriptor(e,"stack"))&&t.writable&&(e.stack=n.data.stack),void i.promiseRejecter(e)}switch(i.type){case"CLOSE_PREPARED":case"COLLECT_FILE_STATISTICS":case"REGISTER_OPFS_FILE_NAME":case"COPY_FILE_TO_PATH":case"DISCONNECT":case"DROP_FILE":case"DROP_FILES":case"FLUSH_FILES":case"INSERT_ARROW_FROM_IPC_STREAM":case"IMPORT_CSV_FROM_PATH":case"IMPORT_JSON_FROM_PATH":case"OPEN":case"PING":case"REGISTER_FILE_BUFFER":case"REGISTER_FILE_HANDLE":case"REGISTER_FILE_URL":case"RESET":if("OK"==n.type)return void i.promiseResolver(n.data);break;case"INSTANTIATE":if(this._onInstantiationProgress=[],"OK"==n.type)return void i.promiseResolver(n.data);break;case"GLOB_FILE_INFOS":if("FILE_INFOS"==n.type)return void i.promiseResolver(n.data);break;case"GET_VERSION":if("VERSION_STRING"==n.type)return void i.promiseResolver(n.data);break;case"GET_FEATURE_FLAGS":if("FEATURE_FLAGS"==n.type)return void i.promiseResolver(n.data);break;case"GET_TABLE_NAMES":if("TABLE_NAMES"==n.type)return void i.promiseResolver(n.data);break;case"TOKENIZE":if("SCRIPT_TOKENS"==n.type)return void i.promiseResolver(n.data);break;case"COPY_FILE_TO_BUFFER":if("FILE_BUFFER"==n.type)return void i.promiseResolver(n.data);break;case"EXPORT_FILE_STATISTICS":if("FILE_STATISTICS"==n.type)return void i.promiseResolver(n.data);break;case"CONNECT":if("CONNECTION_INFO"==n.type)return void i.promiseResolver(n.data);break;case"RUN_PREPARED":case"RUN_QUERY":if("QUERY_RESULT"==n.type)return void i.promiseResolver(n.data);break;case"SEND_PREPARED":if("QUERY_RESULT_HEADER"==n.type)return void i.promiseResolver(n.data);break;case"START_PENDING_QUERY":case"POLL_PENDING_QUERY":if("QUERY_RESULT_HEADER_OR_NULL"==n.type)return void i.promiseResolver(n.data);break;case"CANCEL_PENDING_QUERY":if(this._onInstantiationProgress=[],"SUCCESS"==n.type)return void i.promiseResolver(n.data);break;case"FETCH_QUERY_RESULTS":if("QUERY_RESULT_CHUNK"==n.type)return void i.promiseResolver(n.data);break;case"CREATE_PREPARED":if("PREPARED_STATEMENT_ID"==n.type)return void i.promiseResolver(n.data)}i.promiseRejecter(new Error("unexpected response type: ".concat(n.type.toString())))}}onError(e){this._pendingRequests.clear()}onClose(){this._workerShutdownResolver(null),0==this._pendingRequests.size&&this._pendingRequests.clear()}async reset(){let e=new qD("RESET",null);return await this.postTask(e)}async ping(){let e=new qD("PING",null);await this.postTask(e)}async dropFile(e){let t=new qD("DROP_FILE",e);return await this.postTask(t)}async dropFiles(){let e=new qD("DROP_FILES",null);return await this.postTask(e)}async flushFiles(){let e=new qD("FLUSH_FILES",null);return await this.postTask(e)}async instantiate(e,t=null,n=e=>{}){this._onInstantiationProgress.push(n);let i=new qD("INSTANTIATE",[e,t]);return await this.postTask(i)}async getVersion(){let e=new qD("GET_VERSION",null);return await this.postTask(e)}async getFeatureFlags(){let e=new qD("GET_FEATURE_FLAGS",null);return await this.postTask(e)}async open(e){let t=new qD("OPEN",e);await this.postTask(t)}async tokenize(e){let t=new qD("TOKENIZE",e);return await this.postTask(t)}async connectInternal(){let e=new qD("CONNECT",null);return await this.postTask(e)}async connect(){let e=await this.connectInternal();return new WD(this,e)}async disconnect(e){let t=new qD("DISCONNECT",e);await this.postTask(t)}async runQuery(e,t){let n=new qD("RUN_QUERY",[e,t]);return await this.postTask(n)}async startPendingQuery(e,t,n=!1){let i=new qD("START_PENDING_QUERY",[e,t,n]);return await this.postTask(i)}async pollPendingQuery(e){let t=new qD("POLL_PENDING_QUERY",e);return await this.postTask(t)}async cancelPendingQuery(e){let t=new qD("CANCEL_PENDING_QUERY",e);return await this.postTask(t)}async fetchQueryResults(e){let t=new qD("FETCH_QUERY_RESULTS",e);return await this.postTask(t)}async getTableNames(e,t){let n=new qD("GET_TABLE_NAMES",[e,t]);return await this.postTask(n)}async createPrepared(e,t){let n=new qD("CREATE_PREPARED",[e,t]);return await this.postTask(n)}async closePrepared(e,t){let n=new qD("CLOSE_PREPARED",[e,t]);await this.postTask(n)}async runPrepared(e,t,n){let i=new qD("RUN_PREPARED",[e,t,n]);return await this.postTask(i)}async sendPrepared(e,t,n){let i=new qD("SEND_PREPARED",[e,t,n]);return await this.postTask(i)}async globFiles(e){let t=new qD("GLOB_FILE_INFOS",e);return await this.postTask(t)}async registerFileText(e,t){let n=ZD.encode(t);await this.registerFileBuffer(e,n)}async registerFileURL(e,t,n,i){void 0===t&&(t=e);let r=new qD("REGISTER_FILE_URL",[e,t,n,i]);await this.postTask(r)}async registerEmptyFileBuffer(e){}async registerFileBuffer(e,t){let n=new qD("REGISTER_FILE_BUFFER",[e,t]);await this.postTask(n,[t.buffer])}async registerFileHandle(e,t,n,i){let r=new qD("REGISTER_FILE_HANDLE",[e,t,n,i]);await this.postTask(r,[])}async registerOPFSFileName(e){let t=new qD("REGISTER_OPFS_FILE_NAME",[e]);await this.postTask(t,[])}async collectFileStatistics(e,t){let n=new qD("COLLECT_FILE_STATISTICS",[e,t]);await this.postTask(n,[])}async exportFileStatistics(e){let t=new qD("EXPORT_FILE_STATISTICS",e);return await this.postTask(t,[])}async copyFileToBuffer(e){let t=new qD("COPY_FILE_TO_BUFFER",e);return await this.postTask(t)}async copyFileToPath(e,t){let n=new qD("COPY_FILE_TO_PATH",[e,t]);await this.postTask(n)}async insertArrowFromIPCStream(e,t,n){if(0==t.length)return;let i=new qD("INSERT_ARROW_FROM_IPC_STREAM",[e,t,n]);await this.postTask(i,[t.buffer])}async insertCSVFromPath(e,t,n){if(void 0!==n.columns){let e=[];for(let t in n.columns){let i=n.columns[t];e.push(KD(t,i))}n.columnsFlat=e,delete n.columns}let i=new qD("IMPORT_CSV_FROM_PATH",[e,t,n]);await this.postTask(i)}async insertJSONFromPath(e,t,n){if(void 0!==n.columns){let e=[];for(let t in n.columns){let i=n.columns[t];e.push(KD(t,i))}n.columnsFlat=e,delete n.columns}let i=new qD("IMPORT_JSON_FROM_PATH",[e,t,n]);await this.postTask(i)}};new TextDecoder;var JD=(e=>(e[e.BUFFER=0]="BUFFER",e[e.NODE_FS=1]="NODE_FS",e[e.BROWSER_FILEREADER=2]="BROWSER_FILEREADER",e[e.BROWSER_FSACCESS=3]="BROWSER_FSACCESS",e[e.HTTP=4]="HTTP",e[e.S3=5]="S3",e))(JD||{}),eN={name:"@duckdb/duckdb-wasm",version:"1.30.0"},tN=eN.name,nN=eN.version,iN=eN.version.split(".");iN[0],iN[1],iN[2];var rN=null,oN=null,sN=null,aN=null,lN=null;((e,t,n)=>{n=null!=e?kD(RD(e)):{},((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of LD(t))!PD.call(e,r)&&undefined!==r&&ID(e,r,{get:()=>t[r],enumerable:!(i=AD(t,r))||i.enumerable})})(e&&e.__esModule?n:ID(n,"default",{value:e,enumerable:!0}),e)})(MD());class cN{constructor(e={}){s(this,"_ipc"),s(this,"_options"),s(this,"_db"),s(this,"_con"),s(this,"_config"),s(this,"_loadPromise");const{ipc:t,duckdb:n,connection:i,config:r,...o}=e;this._ipc=t,this._options=o,this._db=n,this._con=i,this._config=r}async getDuckDB(){return this._db||await uN(this),this._db}async getConnection(){return this._con||await uN(this),this._con}async query(e){const{type:t,sql:n}=e,i=await this.getConnection(),r=await function(e,t){return new Promise((n,i)=>{e.useUnsafe(async(e,r)=>{try{const i=await e.runQuery(r,t);n(i)}catch(o){i(o)}})})}(i,n);return"exec"===t?void 0:"arrow"===t?hw(r,this._ipc):hw(r).toArray()}}function uN(e){return e._loadPromise||(e._loadPromise=(e._db?Promise.resolve(e._db):async function({log:e=!1}={}){const t=function(){let e="https://cdn.jsdelivr.net/npm/".concat(tN,"@").concat(nN,"/dist/");return{mvp:{mainModule:"".concat(e,"duckdb-mvp.wasm"),mainWorker:"".concat(e,"duckdb-browser-mvp.worker.js")},eh:{mainModule:"".concat(e,"duckdb-eh.wasm"),mainWorker:"".concat(e,"duckdb-browser-eh.worker.js")}}}(),n=await async function(e){let t=await async function(){return null==rN&&(rN=typeof BigInt64Array<"u"),null==oN&&(oN=await(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11])))()),null==sN&&(sN=await(async e=>{try{return typeof MessageChannel<"u"&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch(t){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))),null==aN&&(aN=await(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])))()),null==lN&&(lN=await(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])))()),{bigInt64Array:rN,crossOriginIsolated:typeof navigator>"u"||globalThis.crossOriginIsolated||!1,wasmExceptions:oN,wasmSIMD:aN,wasmThreads:sN,wasmBulkMemory:lN}}();if(t.wasmExceptions){if(t.wasmSIMD&&t.wasmThreads&&t.crossOriginIsolated&&e.coi)return{mainModule:e.coi.mainModule,mainWorker:e.coi.mainWorker,pthreadWorker:e.coi.pthreadWorker};if(e.eh)return{mainModule:e.eh.mainModule,mainWorker:e.eh.mainWorker,pthreadWorker:null}}return{mainModule:e.mvp.mainModule,mainWorker:e.mvp.mainWorker,pthreadWorker:null}}(t),i=URL.createObjectURL(new Blob([`importScripts("${n.mainWorker}");`],{type:"text/javascript"})),r=new Worker(i),o=e?new VD:new UD,s=new QD(o,r);return await s.instantiate(n.mainModule,n.pthreadWorker),URL.revokeObjectURL(i),s}(e._options).then(t=>e._db=t)).then(t=>null!=e._config?t.open(e._config).then(()=>t):t).then(e=>e.connect()).then(t=>e._con=t)),e._loadPromise}const dN=(e,t,n="info")=>{if(window.cosmographDisableLogging)return;let i,r;switch(n){case"ok":i="#54AE47",r=" ";break;case"info":i="#4196f8",r=" ";break;case"warn":i="#FFA500",r=" ";break;case"util":i="#666666",r=" ";break;case"error":i="#FF0000",r=" "}};var hN={};const fN=(e,t,n=new Set)=>{if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;if(n.has(e))return!0;n.add(e);for(let i=0;i<e.length;i++)if(!fN(e[i],t[i],n))return!1;return!0}if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if("object"==typeof e&&null!==e&&null!==t){if("object"!=typeof t)return!1;if(e===t)return!0;if(Object.keys(e).length!==Object.keys(t).length)return!1;if(n.has(e))return!0;n.add(e);for(const i in e)if(!fN(e[i],t[i],n))return!1;return!0}return e===t},pN=e=>{if(!e)return[];const t=e.numRows,n=e.schema.fields,i=new Array(t);for(let r=0;r<t;r++){const t={};for(let i=0;i<n.length;i++){const o=e.getChildAt(i);o&&(t[n[i].name]=o.get(r))}i[r]=t}return i},mN=()=>{let e;try{e=!!hN.DEBUG}catch(t){e=!1}return e},gN=(e,t)=>[Math.round(e),Math.round(t)],_N=e=>`'${String(e).replace(/'/g,"''")}'`,yN=e=>2===(null==e?void 0:e.typeId)||3===(null==e?void 0:e.typeId)||7===(null==e?void 0:e.typeId),vN=e=>5===(null==e?void 0:e.typeId),bN=e=>6===(null==e?void 0:e.typeId)||20===(null==e?void 0:e.typeId),xN=e=>12===(null==e?void 0:e.typeId)||13===(null==e?void 0:e.typeId),wN=e=>"string"==typeof e?/(\[\]|list)/i.test(e):xN(e??void 0),SN=()=>Math.random().toString(36).substring(2,9);var EN=Object.create,CN=Object.defineProperty,TN=Object.getOwnPropertyDescriptor,kN=Object.getOwnPropertyNames,IN=Object.getPrototypeOf,AN=Object.prototype.hasOwnProperty,LN=((e,t)=>()=>(t||((t={exports:{}}).exports=Worker),t.exports))(),RN=(e=>(e[e.UNDEFINED=0]="UNDEFINED",e[e.AUTOMATIC=1]="AUTOMATIC",e[e.READ_ONLY=2]="READ_ONLY",e[e.READ_WRITE=3]="READ_WRITE",e))(RN||{}),PN=(e=>(e[e.IDENTIFIER=0]="IDENTIFIER",e[e.NUMERIC_CONSTANT=1]="NUMERIC_CONSTANT",e[e.STRING_CONSTANT=2]="STRING_CONSTANT",e[e.OPERATOR=3]="OPERATOR",e[e.KEYWORD=4]="KEYWORD",e[e.COMMENT=5]="COMMENT",e))(PN||{}),MN=(e=>(e[e.NONE=0]="NONE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARNING=3]="WARNING",e[e.ERROR=4]="ERROR",e))(MN||{}),DN=(e=>(e[e.NONE=0]="NONE",e[e.CONNECT=1]="CONNECT",e[e.DISCONNECT=2]="DISCONNECT",e[e.OPEN=3]="OPEN",e[e.QUERY=4]="QUERY",e[e.INSTANTIATE=5]="INSTANTIATE",e))(DN||{}),NN=(e=>(e[e.NONE=0]="NONE",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR",e[e.START=3]="START",e[e.RUN=4]="RUN",e[e.CAPTURE=5]="CAPTURE",e))(NN||{}),FN=(e=>(e[e.NONE=0]="NONE",e[e.WEB_WORKER=1]="WEB_WORKER",e[e.NODE_WORKER=2]="NODE_WORKER",e[e.BINDINGS=3]="BINDINGS",e[e.ASYNC_DUCKDB=4]="ASYNC_DUCKDB",e))(FN||{}),ON=class{log(e){}},BN=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.MAX_ARROW_ERROR=255]="MAX_ARROW_ERROR",e[e.DUCKDB_WASM_RETRY=256]="DUCKDB_WASM_RETRY",e))(BN||{}),zN=class{constructor(e,t){this._bindings=e,this._conn=t}get bindings(){return this._bindings}async close(){return this._bindings.disconnect(this._conn)}useUnsafe(e){return e(this._bindings,this._conn)}async query(e){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:e});let t=await this._bindings.runQuery(this._conn,e),n=JM.from(t);return new fM(n)}async send(e,t=!1){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:e});let n=await this._bindings.startPendingQuery(this._conn,e,t);for(;null==n;)n=await this._bindings.pollPendingQuery(this._conn);let i=new UN(this._bindings,this._conn,n);return await JM.from(i)}async cancelSent(){return await this._bindings.cancelPendingQuery(this._conn)}async getTableNames(e){return await this._bindings.getTableNames(this._conn,e)}async prepare(e){let t=await this._bindings.createPrepared(this._conn,e);return new VN(this._bindings,this._conn,t)}async insertArrowTable(e,t){let n=CD(e,"stream");await this.insertArrowFromIPCStream(n,t)}async insertArrowFromIPCStream(e,t){await this._bindings.insertArrowFromIPCStream(this._conn,e,t)}async insertCSVFromPath(e,t){await this._bindings.insertCSVFromPath(this._conn,e,t)}async insertJSONFromPath(e,t){await this._bindings.insertJSONFromPath(this._conn,e,t)}},UN=class{constructor(e,t,n){this.db=e,this.conn=t,this.header=n,this._first=!0,this._depleted=!1,this._inFlight=null}async next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let e=null;for(null!=this._inFlight&&(e=await this._inFlight,this._inFlight=null);null==e;)e=await this.db.fetchQueryResults(this.conn);return this._depleted=0==e.length,this._depleted||(this._inFlight=this.db.fetchQueryResults(this.conn)),{done:this._depleted,value:e}}[Symbol.asyncIterator](){return this}},VN=class{constructor(e,t,n){this.bindings=e,this.connectionId=t,this.statementId=n}async close(){await this.bindings.closePrepared(this.connectionId,this.statementId)}async query(...e){let t=await this.bindings.runPrepared(this.connectionId,this.statementId,e),n=JM.from(t);return new fM(n)}async send(...e){let t=await this.bindings.sendPrepared(this.connectionId,this.statementId,e),n=new UN(this.bindings,this.connectionId,t);return await JM.from(n)}},HN=(e=>(e.CANCEL_PENDING_QUERY="CANCEL_PENDING_QUERY",e.CLOSE_PREPARED="CLOSE_PREPARED",e.COLLECT_FILE_STATISTICS="COLLECT_FILE_STATISTICS",e.REGISTER_OPFS_FILE_NAME="REGISTER_OPFS_FILE_NAME",e.CONNECT="CONNECT",e.COPY_FILE_TO_BUFFER="COPY_FILE_TO_BUFFER",e.COPY_FILE_TO_PATH="COPY_FILE_TO_PATH",e.CREATE_PREPARED="CREATE_PREPARED",e.DISCONNECT="DISCONNECT",e.DROP_FILE="DROP_FILE",e.DROP_FILES="DROP_FILES",e.EXPORT_FILE_STATISTICS="EXPORT_FILE_STATISTICS",e.FETCH_QUERY_RESULTS="FETCH_QUERY_RESULTS",e.FLUSH_FILES="FLUSH_FILES",e.GET_FEATURE_FLAGS="GET_FEATURE_FLAGS",e.GET_TABLE_NAMES="GET_TABLE_NAMES",e.GET_VERSION="GET_VERSION",e.GLOB_FILE_INFOS="GLOB_FILE_INFOS",e.INSERT_ARROW_FROM_IPC_STREAM="INSERT_ARROW_FROM_IPC_STREAM",e.INSERT_CSV_FROM_PATH="IMPORT_CSV_FROM_PATH",e.INSERT_JSON_FROM_PATH="IMPORT_JSON_FROM_PATH",e.INSTANTIATE="INSTANTIATE",e.OPEN="OPEN",e.PING="PING",e.POLL_PENDING_QUERY="POLL_PENDING_QUERY",e.REGISTER_FILE_BUFFER="REGISTER_FILE_BUFFER",e.REGISTER_FILE_HANDLE="REGISTER_FILE_HANDLE",e.REGISTER_FILE_URL="REGISTER_FILE_URL",e.RESET="RESET",e.RUN_PREPARED="RUN_PREPARED",e.RUN_QUERY="RUN_QUERY",e.SEND_PREPARED="SEND_PREPARED",e.START_PENDING_QUERY="START_PENDING_QUERY",e.TOKENIZE="TOKENIZE",e))(HN||{}),WN=(e=>(e.CONNECTION_INFO="CONNECTION_INFO",e.ERROR="ERROR",e.FEATURE_FLAGS="FEATURE_FLAGS",e.FILE_BUFFER="FILE_BUFFER",e.FILE_INFOS="FILE_INFOS",e.FILE_SIZE="FILE_SIZE",e.FILE_STATISTICS="FILE_STATISTICS",e.INSTANTIATE_PROGRESS="INSTANTIATE_PROGRESS",e.LOG="LOG",e.PROGRESS_UPDATE="PROGRESS_UPDATE",e.OK="OK",e.PREPARED_STATEMENT_ID="PREPARED_STATEMENT_ID",e.QUERY_PLAN="QUERY_PLAN",e.QUERY_RESULT="QUERY_RESULT",e.QUERY_RESULT_CHUNK="QUERY_RESULT_CHUNK",e.QUERY_RESULT_HEADER="QUERY_RESULT_HEADER",e.QUERY_RESULT_HEADER_OR_NULL="QUERY_RESULT_HEADER_OR_NULL",e.REGISTERED_FILE="REGISTERED_FILE",e.SCRIPT_TOKENS="SCRIPT_TOKENS",e.SUCCESS="SUCCESS",e.TABLE_NAMES="TABLE_NAMES",e.VERSION_STRING="VERSION_STRING",e))(WN||{}),$N=class{constructor(e,t){this.promiseResolver=()=>{},this.promiseRejecter=()=>{},this.type=e,this.data=t,this.promise=new Promise((e,t)=>{this.promiseResolver=e,this.promiseRejecter=t})}};function GN(e){switch(e.typeId){case Pk.Binary:return{sqlType:"binary"};case Pk.Bool:return{sqlType:"bool"};case Pk.Date:return{sqlType:"date"};case Pk.DateDay:return{sqlType:"date32[d]"};case Pk.DateMillisecond:return{sqlType:"date64[ms]"};case Pk.Decimal:{let t=e;return{sqlType:"decimal",precision:t.precision,scale:t.scale}}case Pk.Float:return{sqlType:"float"};case Pk.Float16:return{sqlType:"float16"};case Pk.Float32:return{sqlType:"float32"};case Pk.Float64:return{sqlType:"float64"};case Pk.Int:return{sqlType:"int32"};case Pk.Int16:return{sqlType:"int16"};case Pk.Int32:return{sqlType:"int32"};case Pk.Int64:return{sqlType:"int64"};case Pk.Uint16:return{sqlType:"uint16"};case Pk.Uint32:return{sqlType:"uint32"};case Pk.Uint64:return{sqlType:"uint64"};case Pk.Uint8:return{sqlType:"uint8"};case Pk.IntervalDayTime:return{sqlType:"interval[dt]"};case Pk.IntervalYearMonth:return{sqlType:"interval[m]"};case Pk.List:return{sqlType:"list",valueType:GN(e.valueType)};case Pk.FixedSizeBinary:return{sqlType:"fixedsizebinary",byteWidth:e.byteWidth};case Pk.Null:return{sqlType:"null"};case Pk.Utf8:return{sqlType:"utf8"};case Pk.Struct:return{sqlType:"struct",fields:e.children.map(e=>jN(e.name,e.type))};case Pk.Map:{let t=e;return{sqlType:"map",keyType:GN(t.keyType),valueType:GN(t.valueType)}}case Pk.Time:return{sqlType:"time[s]"};case Pk.TimeMicrosecond:return{sqlType:"time[us]"};case Pk.TimeMillisecond:return{sqlType:"time[ms]"};case Pk.TimeNanosecond:return{sqlType:"time[ns]"};case Pk.TimeSecond:return{sqlType:"time[s]"};case Pk.Timestamp:return{sqlType:"timestamp",timezone:e.timezone||void 0};case Pk.TimestampSecond:return{sqlType:"timestamp[s]",timezone:e.timezone||void 0};case Pk.TimestampMicrosecond:return{sqlType:"timestamp[us]",timezone:e.timezone||void 0};case Pk.TimestampNanosecond:return{sqlType:"timestamp[ns]",timezone:e.timezone||void 0};case Pk.TimestampMillisecond:return{sqlType:"timestamp[ms]",timezone:e.timezone||void 0}}throw new Error("unsupported arrow type: ".concat(e.toString()))}function jN(e,t){let n=GN(t);return n.name=e,n}var YN=new TextEncoder,qN=class{constructor(e,t=null){this._onInstantiationProgress=[],this._onExecutionProgress=[],this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{},this._nextMessageId=0,this._pendingRequests=new Map,this._logger=e,this._onMessageHandler=this.onMessage.bind(this),this._onErrorHandler=this.onError.bind(this),this._onCloseHandler=this.onClose.bind(this),null!=t&&this.attach(t)}get logger(){return this._logger}attach(e){this._worker=e,this._worker.addEventListener("message",this._onMessageHandler),this._worker.addEventListener("error",this._onErrorHandler),this._worker.addEventListener("close",this._onCloseHandler),this._workerShutdownPromise=new Promise((e,t)=>{this._workerShutdownResolver=e})}detach(){this._worker&&(this._worker.removeEventListener("message",this._onMessageHandler),this._worker.removeEventListener("error",this._onErrorHandler),this._worker.removeEventListener("close",this._onCloseHandler),this._worker=null,this._workerShutdownResolver(null),this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async terminate(){this._worker&&(this._worker.terminate(),this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async postTask(e,t=[]){if(!this._worker)return;let n=this._nextMessageId++;return this._pendingRequests.set(n,e),this._worker.postMessage({messageId:n,type:e.type,data:e.data},t),await e.promise}onMessage(e){var t;let n=e.data;switch(n.type){case"PROGRESS_UPDATE":for(let e of this._onExecutionProgress)e(n.data);return;case"LOG":return void this._logger.log(n.data);case"INSTANTIATE_PROGRESS":for(let e of this._onInstantiationProgress)e(n.data);return}let i=this._pendingRequests.get(n.requestId);if(i){if(this._pendingRequests.delete(n.requestId),"ERROR"==n.type){let e=new Error(n.data.message);return e.name=n.data.name,null!=(t=Object.getOwnPropertyDescriptor(e,"stack"))&&t.writable&&(e.stack=n.data.stack),void i.promiseRejecter(e)}switch(i.type){case"CLOSE_PREPARED":case"COLLECT_FILE_STATISTICS":case"REGISTER_OPFS_FILE_NAME":case"COPY_FILE_TO_PATH":case"DISCONNECT":case"DROP_FILE":case"DROP_FILES":case"FLUSH_FILES":case"INSERT_ARROW_FROM_IPC_STREAM":case"IMPORT_CSV_FROM_PATH":case"IMPORT_JSON_FROM_PATH":case"OPEN":case"PING":case"REGISTER_FILE_BUFFER":case"REGISTER_FILE_HANDLE":case"REGISTER_FILE_URL":case"RESET":if("OK"==n.type)return void i.promiseResolver(n.data);break;case"INSTANTIATE":if(this._onInstantiationProgress=[],"OK"==n.type)return void i.promiseResolver(n.data);break;case"GLOB_FILE_INFOS":if("FILE_INFOS"==n.type)return void i.promiseResolver(n.data);break;case"GET_VERSION":if("VERSION_STRING"==n.type)return void i.promiseResolver(n.data);break;case"GET_FEATURE_FLAGS":if("FEATURE_FLAGS"==n.type)return void i.promiseResolver(n.data);break;case"GET_TABLE_NAMES":if("TABLE_NAMES"==n.type)return void i.promiseResolver(n.data);break;case"TOKENIZE":if("SCRIPT_TOKENS"==n.type)return void i.promiseResolver(n.data);break;case"COPY_FILE_TO_BUFFER":if("FILE_BUFFER"==n.type)return void i.promiseResolver(n.data);break;case"EXPORT_FILE_STATISTICS":if("FILE_STATISTICS"==n.type)return void i.promiseResolver(n.data);break;case"CONNECT":if("CONNECTION_INFO"==n.type)return void i.promiseResolver(n.data);break;case"RUN_PREPARED":case"RUN_QUERY":if("QUERY_RESULT"==n.type)return void i.promiseResolver(n.data);break;case"SEND_PREPARED":if("QUERY_RESULT_HEADER"==n.type)return void i.promiseResolver(n.data);break;case"START_PENDING_QUERY":case"POLL_PENDING_QUERY":if("QUERY_RESULT_HEADER_OR_NULL"==n.type)return void i.promiseResolver(n.data);break;case"CANCEL_PENDING_QUERY":if(this._onInstantiationProgress=[],"SUCCESS"==n.type)return void i.promiseResolver(n.data);break;case"FETCH_QUERY_RESULTS":if("QUERY_RESULT_CHUNK"==n.type)return void i.promiseResolver(n.data);break;case"CREATE_PREPARED":if("PREPARED_STATEMENT_ID"==n.type)return void i.promiseResolver(n.data)}i.promiseRejecter(new Error("unexpected response type: ".concat(n.type.toString())))}}onError(e){this._pendingRequests.clear()}onClose(){this._workerShutdownResolver(null),0==this._pendingRequests.size&&this._pendingRequests.clear()}async reset(){let e=new $N("RESET",null);return await this.postTask(e)}async ping(){let e=new $N("PING",null);await this.postTask(e)}async dropFile(e){let t=new $N("DROP_FILE",e);return await this.postTask(t)}async dropFiles(){let e=new $N("DROP_FILES",null);return await this.postTask(e)}async flushFiles(){let e=new $N("FLUSH_FILES",null);return await this.postTask(e)}async instantiate(e,t=null,n=e=>{}){this._onInstantiationProgress.push(n);let i=new $N("INSTANTIATE",[e,t]);return await this.postTask(i)}async getVersion(){let e=new $N("GET_VERSION",null);return await this.postTask(e)}async getFeatureFlags(){let e=new $N("GET_FEATURE_FLAGS",null);return await this.postTask(e)}async open(e){let t=new $N("OPEN",e);await this.postTask(t)}async tokenize(e){let t=new $N("TOKENIZE",e);return await this.postTask(t)}async connectInternal(){let e=new $N("CONNECT",null);return await this.postTask(e)}async connect(){let e=await this.connectInternal();return new zN(this,e)}async disconnect(e){let t=new $N("DISCONNECT",e);await this.postTask(t)}async runQuery(e,t){let n=new $N("RUN_QUERY",[e,t]);return await this.postTask(n)}async startPendingQuery(e,t,n=!1){let i=new $N("START_PENDING_QUERY",[e,t,n]);return await this.postTask(i)}async pollPendingQuery(e){let t=new $N("POLL_PENDING_QUERY",e);return await this.postTask(t)}async cancelPendingQuery(e){let t=new $N("CANCEL_PENDING_QUERY",e);return await this.postTask(t)}async fetchQueryResults(e){let t=new $N("FETCH_QUERY_RESULTS",e);return await this.postTask(t)}async getTableNames(e,t){let n=new $N("GET_TABLE_NAMES",[e,t]);return await this.postTask(n)}async createPrepared(e,t){let n=new $N("CREATE_PREPARED",[e,t]);return await this.postTask(n)}async closePrepared(e,t){let n=new $N("CLOSE_PREPARED",[e,t]);await this.postTask(n)}async runPrepared(e,t,n){let i=new $N("RUN_PREPARED",[e,t,n]);return await this.postTask(i)}async sendPrepared(e,t,n){let i=new $N("SEND_PREPARED",[e,t,n]);return await this.postTask(i)}async globFiles(e){let t=new $N("GLOB_FILE_INFOS",e);return await this.postTask(t)}async registerFileText(e,t){let n=YN.encode(t);await this.registerFileBuffer(e,n)}async registerFileURL(e,t,n,i){void 0===t&&(t=e);let r=new $N("REGISTER_FILE_URL",[e,t,n,i]);await this.postTask(r)}async registerEmptyFileBuffer(e){}async registerFileBuffer(e,t){let n=new $N("REGISTER_FILE_BUFFER",[e,t]);await this.postTask(n,[t.buffer])}async registerFileHandle(e,t,n,i){let r=new $N("REGISTER_FILE_HANDLE",[e,t,n,i]);await this.postTask(r,[])}async registerOPFSFileName(e){let t=new $N("REGISTER_OPFS_FILE_NAME",[e]);await this.postTask(t,[])}async collectFileStatistics(e,t){let n=new $N("COLLECT_FILE_STATISTICS",[e,t]);await this.postTask(n,[])}async exportFileStatistics(e){let t=new $N("EXPORT_FILE_STATISTICS",e);return await this.postTask(t,[])}async copyFileToBuffer(e){let t=new $N("COPY_FILE_TO_BUFFER",e);return await this.postTask(t)}async copyFileToPath(e,t){let n=new $N("COPY_FILE_TO_PATH",[e,t]);await this.postTask(n)}async insertArrowFromIPCStream(e,t,n){if(0==t.length)return;let i=new $N("INSERT_ARROW_FROM_IPC_STREAM",[e,t,n]);await this.postTask(i,[t.buffer])}async insertCSVFromPath(e,t,n){if(void 0!==n.columns){let e=[];for(let t in n.columns){let i=n.columns[t];e.push(jN(t,i))}n.columnsFlat=e,delete n.columns}let i=new $N("IMPORT_CSV_FROM_PATH",[e,t,n]);await this.postTask(i)}async insertJSONFromPath(e,t,n){if(void 0!==n.columns){let e=[];for(let t in n.columns){let i=n.columns[t];e.push(jN(t,i))}n.columnsFlat=e,delete n.columns}let i=new $N("IMPORT_JSON_FROM_PATH",[e,t,n]);await this.postTask(i)}};new TextDecoder;var XN=(e=>(e[e.BUFFER=0]="BUFFER",e[e.NODE_FS=1]="NODE_FS",e[e.BROWSER_FILEREADER=2]="BROWSER_FILEREADER",e[e.BROWSER_FSACCESS=3]="BROWSER_FSACCESS",e[e.HTTP=4]="HTTP",e[e.S3=5]="S3",e))(XN||{}),KN={name:"@duckdb/duckdb-wasm",version:"1.29.1-dev260.0"},ZN=KN.name,QN=KN.version,JN=KN.version.split(".");JN[0],JN[1],JN[2];var eF,tF,nF,iF=null,rF=null,oF=null,sF=null,aF=null;((e,t,n)=>{n=null!=e?EN(IN(e)):{},((e,t,n,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of kN(t))!AN.call(e,r)&&undefined!==r&&CN(e,r,{get:()=>t[r],enumerable:!(i=TN(t,r))||i.enumerable})})(e&&e.__esModule?n:CN(n,"default",{value:e,enumerable:!0}),e)})(LN()),function(e){e.RawPoints="temp_cosmograph_raw_points",e.RawLinks="temp_cosmograph_raw_links",e.PreparedPoints="temp_cosmograph_prepared_points",e.PreparedLinks="temp_cosmograph_prepared_links",e.Points="cosmograph_points",e.Links="cosmograph_links"}(eF||(eF={})),function(e){e.Id="id",e.Idx="idx",e.Sequence="points_idx_seq",e.Source="source",e.SourceIdx="sourceidx",e.Target="target",e.TargetIdx="targetidx"}(tF||(tF={})),function(e){e.Parquet="parquet",e.Arrow="arrow",e.CSV="csv",e.JSON="json"}(nF||(nF={}));const lF=mN(),cF=function(){let e="https://cdn.jsdelivr.net/npm/".concat(ZN,"@").concat(QN,"/dist/");return{mvp:{mainModule:"".concat(e,"duckdb-mvp.wasm"),mainWorker:"".concat(e,"duckdb-browser-mvp.worker.js")},eh:{mainModule:"".concat(e,"duckdb-eh.wasm"),mainWorker:"".concat(e,"duckdb-browser-eh.worker.js")}}}();let uF=(e=class{constructor(){s(this,"_db"),s(this,"_connection"),s(this,"logTable",async(e,t=!1)=>{var n;if(!lF)return;const i=`SELECT COUNT(*) as count FROM ${e}`,r=await this.query(i);if(!r)return;null==(n=r.getChild("count"))||n.get(0);const o=`SELECT * FROM ${e} ${t?"":"LIMIT 10"}`,s=await this.query(o);s&&pN(s)})}static async getInstance(){return e._initPromise=(async()=>{const t=new e;return await t._init(),t})(),e._instance=await e._initPromise,e._instance}async _init(){const e=await async function(e){let t=await async function(){return null==iF&&(iF=typeof BigInt64Array<"u"),null==rF&&(rF=await(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11])))()),null==oF&&(oF=await(async e=>{try{return typeof MessageChannel<"u"&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch(t){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))),null==sF&&(sF=await(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])))()),null==aF&&(aF=await(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])))()),{bigInt64Array:iF,crossOriginIsolated:typeof navigator>"u"||globalThis.crossOriginIsolated||!1,wasmExceptions:rF,wasmSIMD:sF,wasmThreads:oF,wasmBulkMemory:aF}}();if(t.wasmExceptions){if(t.wasmSIMD&&t.wasmThreads&&t.crossOriginIsolated&&e.coi)return{mainModule:e.coi.mainModule,mainWorker:e.coi.mainWorker,pthreadWorker:e.coi.pthreadWorker};if(e.eh)return{mainModule:e.eh.mainModule,mainWorker:e.eh.mainWorker,pthreadWorker:null}}return{mainModule:e.mvp.mainModule,mainWorker:e.mvp.mainWorker,pthreadWorker:null}}(cF),t=URL.createObjectURL(new Blob([`importScripts("${e.mainWorker}");`],{type:"text/javascript"})),n=new Worker(t),i=new ON;this._db=new qN(i,n),await this._db.instantiate(e.mainModule,e.pthreadWorker),this._connection=await this._db.connect(),await this._connection.query("\n      SET max_expression_depth TO 20000000;\n      SET memory_limit = '10GB';\n    ".trim()),URL.revokeObjectURL(t)}get connection(){if(!this._connection)throw new Error("Cosmograph: DuckDB-Wasm connection is not initialized");return this._connection}get db(){if(!this._db)throw new Error("Cosmograph: DuckDB-Wasm is not initialized");return this._db}async destroy(){await this.connection.close(),await this.db.terminate(),e._instance=void 0,e._initPromise=void 0}async dropTable(e){await this.query(`DROP TABLE IF EXISTS "${e}"`)}async query(e){let t;lF&&(t=performance.now());try{return await this.connection.query(e)}catch(n){globalThis.__lastDuckdbError=String(n)}finally{lF&&void 0!==t&&performance.now()}}async exec(e){await this.query(e)}async send(e,t){try{const n=await this.connection.send(e);let i;for(;!(i=await n.next()).done;){const e=i.value;for(let n=0;n<e.numRows;n++){const i=e.getChildAt(n);t&&t(i)}}}catch(n){}}async uploadData(e,t,n=!1,i,r){if(Array.isArray(e)&&e.length>0&&e[0]&&"object"==typeof e[0])return await this.uploadObject(e,t,n);if(e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof fM)return await this._uploadArrow(e,t,n);if("string"==typeof e||e instanceof File){const s=(o=e instanceof File?e.name:e).endsWith(".arrow")?nF.Arrow:o.endsWith(".parquet")||o.endsWith(".pq")?nF.Parquet:o.endsWith(".csv")||o.endsWith(".tsv")?nF.CSV:o.endsWith(".json")?nF.JSON:"unknown";try{switch(s){case nF.Arrow:return await this._uploadArrow(e,t,n);case nF.Parquet:return await this._uploadParquet(e,t,n);case nF.CSV:return await this._uploadCSV(e,t,n,i,r);case nF.JSON:return await this._uploadJSON(e,t,n);default:throw new Error("Unsupported file type")}}catch(o){return{error:o}}}var o;return{error:"Could not upload data"}}async uploadArrow(e,t){return await this._uploadArrow(e,t)}async exportTableToArrow(e){try{const t=[],n=await this.connection.send(`SELECT * FROM ${e}`);let i;for(;!(i=await n.next()).done;){const e=i.value;e&&e.numRows&&t.push(e)}return t.length?new fM(t):void 0}catch(qe){throw qe}}async exportTableToArrowBuffer(e){const t=await this.exportTableToArrow(e);return t?CD(t):void 0}async exportTableToPq(e){var t,n;const i=`${e}.${nF.Parquet}`;try{return await this.connection.query(`COPY ${e} TO '${i}' (FORMAT PARQUET)`),await(null==(t=this._db)?void 0:t.copyFileToBuffer(i))}catch(Xe){}finally{await(null==(n=this._db)?void 0:n.registerEmptyFileBuffer(i))}}async exportTableToCSV(e){var t,n;const i=`${e}.${nF.CSV}`;try{return await this.connection.query(`COPY ${e} TO '${i}' (HEADER, DELIMITER ',')`),await(null==(t=this._db)?void 0:t.copyFileToBuffer(i))}catch(Xe){}finally{await(null==(n=this._db)?void 0:n.registerEmptyFileBuffer(i))}}async uploadObject(e,t,n=!1){if(0===e.length)return{};try{const i=`t_${t}`;await this.query(`DROP TABLE IF EXISTS "${i}"`);const r=function(e){const t=sM(e),n=new mM(new xR(t.type.children),t.data[0]);return new fM(n)}(e);return await this.connection.insertArrowTable(r,{name:i}),await this._handleTableInsertion(i,t,n),await this.logTable(t),{}}catch(i){throw new Error(`Failed to upload Object: ${i}`)}}async _uploadCSV(e,t,n=!1,i,r){const o=`t_${t}`;let s=null;try{let a;if(e instanceof File){const t=await e.text();s=e.name,await this.db.registerFileText(s,t),a=s}else a=e;const l=`\n        CREATE TABLE ${o} AS SELECT * FROM read_csv_auto(\n          '${a}',\n          SAMPLE_SIZE=-1,\n          allow_quoted_nulls=true,\n          ignore_errors=true\n          ${i?`, timestampformat='${i}'`:""}\n          ${r?`, types=${JSON.stringify(r)}`:""}\n        )`.trim();return await this.query(l),await this._handleTableInsertion(o,t,n),await this.logTable(t),{}}catch(a){throw new Error(`Failed to upload CSV: ${a}`)}finally{s&&await this.db.dropFile(s)}}async _uploadParquet(e,t,n=!1){const i=`t_${t}`;let r=null;try{let o;e instanceof File?(r=e.name,await this.db.registerFileHandle(r,e,XN.BROWSER_FILEREADER,!0),o=r):o=e;const s=`CREATE TABLE ${i} AS SELECT * FROM read_parquet('${o}')`;return await this.query(s),await this._handleTableInsertion(i,t,n),await this.logTable(t),{}}catch(o){const e=o instanceof Error?o.message:String(o);throw new Error(`Failed to upload Parquet: ${e}`)}finally{r&&await this.db.dropFile(r)}}async _uploadArrow(e,t,n=!1){try{let i;const r=`t_${t}`;if(await this.query(`DROP TABLE IF EXISTS "${r}"`),e instanceof File)i=await e.arrayBuffer(),i=new Uint8Array(i);else if("string"==typeof e){const t=await fetch(e);t.ok,i=await t.arrayBuffer(),i=new Uint8Array(i)}else i=e;const o=e instanceof fM?e:ED(i);return await this.connection.insertArrowTable(o,{name:r}),await this._handleTableInsertion(r,t,n),await this.logTable(t),{}}catch(i){const e=i instanceof Error?i.message:String(i);throw new Error(`Failed to upload Arrow: ${e}`)}}async _uploadJSON(e,t,n=!1){const i=`t_${t}`;await this.query(`DROP TABLE IF EXISTS "${i}"`);try{if(e instanceof File){const t=await e.text();await this.db.registerFileText("json",t)}else{const t=await fetch(e);t.ok;const n=await t.text();await this.db.registerFileText("json",n)}return await this.connection.insertJSONFromPath("json",{name:i}),await this._handleTableInsertion(i,t,n),await this.logTable(t),{}}catch(r){const e=r instanceof Error?r.message:String(r);throw new Error(`Failed to upload JSON: ${e}`)}finally{await this.db.dropFile("json")}}async _handleTableInsertion(e,t,n){n?(await this.query(`INSERT INTO "${t}" SELECT * FROM "${e}"`),await this.query(`DROP TABLE IF EXISTS "${e}"`)):(await this.query(`DROP TABLE IF EXISTS "${t}"`),await this.query(`ALTER TABLE "${e}" RENAME TO "${t}"`))}},s(e,"_instance"),s(e,"_initPromise"),e);const dF=mN();let hF=class e{constructor(e,t){if(s(this,"_coordinator"),s(this,"_internalDB"),!e)return;const n=new PC;n.databaseConnector(e),dF?n.manager.logQueries(!0):n.logger(null),this._coordinator=n,this._internalDB=t}static async create(t){let n,i;try{if(t)"string"==typeof t?(n=new VC({uri:t}),dN(0,0,"ok")):(n=new cN(t),dN(0,0,"ok"));else{const e=Date.now();i=await uF.getInstance(),n=new cN({duckdb:i.db,connection:i.connection});const t=Date.now();dN((t-e).toFixed(),0,"ok")}}catch(r){return void dN(0,0,"error")}return new e(n,i)}get internalDB(){return this._internalDB}connect(e){var t,n;(null==(t=this._coordinator)?void 0:t.clients.has(e))||null==(n=this._coordinator)||n.connect(e)}disconnect(e){var t,n;(null==(t=this._coordinator)?void 0:t.clients.has(e))&&(null==(n=this._coordinator)||n.disconnect(e))}clearCache(){var e;null==(e=this._coordinator)||e.clear({cache:!0,clients:!1})}async destroy(){var e;null==(e=this._coordinator)||e.clear(),this._coordinator=void 0}query(e,t={}){const{cache:n=!1,...i}=t;return this._coordinator.query(e,{cache:n,...i})}};var fF="http://www.w3.org/1999/xhtml";const pF={svg:"http://www.w3.org/2000/svg",xhtml:fF,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function mF(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),pF.hasOwnProperty(t)?{space:pF[t],local:e}:e}function gF(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===fF&&t.documentElement.namespaceURI===fF?t.createElement(e):t.createElementNS(n,e)}}function _F(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function yF(e){var t=mF(e);return(t.local?_F:gF)(t)}function vF(){}function bF(e){return null==e?vF:function(){return this.querySelector(e)}}function xF(){return[]}function wF(e){return null==e?xF:function(){return this.querySelectorAll(e)}}function SF(e){return function(){return this.matches(e)}}function EF(e){return function(t){return t.matches(e)}}var CF=Array.prototype.find;function TF(){return this.firstElementChild}var kF=Array.prototype.filter;function IF(){return Array.from(this.children)}function AF(e){return new Array(e.length)}function LF(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function RF(e,t,n,i,r,o){for(var s,a=0,l=t.length,c=o.length;a<c;++a)(s=t[a])?(s.__data__=o[a],i[a]=s):n[a]=new LF(e,o[a]);for(;a<l;++a)(s=t[a])&&(r[a]=s)}function PF(e,t,n,i,r,o,s){var a,l,c,u=new Map,d=t.length,h=o.length,f=new Array(d);for(a=0;a<d;++a)(l=t[a])&&(f[a]=c=s.call(l,l.__data__,a,t)+"",u.has(c)?r[a]=l:u.set(c,l));for(a=0;a<h;++a)c=s.call(e,o[a],a,o)+"",(l=u.get(c))?(i[a]=l,l.__data__=o[a],u.delete(c)):n[a]=new LF(e,o[a]);for(a=0;a<d;++a)(l=t[a])&&u.get(f[a])===l&&(r[a]=l)}function MF(e){return e.__data__}function DF(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function NF(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function FF(e){return function(){this.removeAttribute(e)}}function OF(e){return function(){this.removeAttributeNS(e.space,e.local)}}function BF(e,t){return function(){this.setAttribute(e,t)}}function zF(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function UF(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function VF(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function HF(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function WF(e){return function(){this.style.removeProperty(e)}}function $F(e,t,n){return function(){this.style.setProperty(e,t,n)}}function GF(e,t,n){return function(){var i=t.apply(this,arguments);null==i?this.style.removeProperty(e):this.style.setProperty(e,i,n)}}function jF(e,t){return e.style.getPropertyValue(t)||HF(e).getComputedStyle(e,null).getPropertyValue(t)}function YF(e){return function(){delete this[e]}}function qF(e,t){return function(){this[e]=t}}function XF(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function KF(e){return e.trim().split(/^|\s+/)}function ZF(e){return e.classList||new QF(e)}function QF(e){this._node=e,this._names=KF(e.getAttribute("class")||"")}function JF(e,t){for(var n=ZF(e),i=-1,r=t.length;++i<r;)n.add(t[i])}function eO(e,t){for(var n=ZF(e),i=-1,r=t.length;++i<r;)n.remove(t[i])}function tO(e){return function(){JF(this,e)}}function nO(e){return function(){eO(this,e)}}function iO(e,t){return function(){(t.apply(this,arguments)?JF:eO)(this,e)}}function rO(){this.textContent=""}function oO(e){return function(){this.textContent=e}}function sO(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function aO(){this.innerHTML=""}function lO(e){return function(){this.innerHTML=e}}function cO(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function uO(){this.nextSibling&&this.parentNode.appendChild(this)}function dO(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function hO(){return null}function fO(){var e=this.parentNode;e&&e.removeChild(this)}function pO(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function mO(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function gO(e){return function(){var t=this.__on;if(t){for(var n,i=0,r=-1,o=t.length;i<o;++i)n=t[i],e.type&&n.type!==e.type||n.name!==e.name?t[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?t.length=r:delete this.__on}}}function _O(e,t,n){return function(){var i,r=this.__on,o=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(r)for(var s=0,a=r.length;s<a;++s)if((i=r[s]).type===e.type&&i.name===e.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),void(i.value=t);this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}function yO(e,t,n){var i=HF(e),r=i.CustomEvent;"function"==typeof r?r=new r(t,n):(r=i.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function vO(e,t){return function(){return yO(this,e,t)}}function bO(e,t){return function(){return yO(this,e,t.apply(this,arguments))}}LF.prototype={constructor:LF,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}},QF.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var xO=[null];function wO(e,t){this._groups=e,this._parents=t}function SO(){return new wO([[document.documentElement]],xO)}function EO(e){return"string"==typeof e?new wO([[document.querySelector(e)]],[document.documentElement]):new wO([[e]],xO)}function CO(e,t){if(e=function(e){let t;for(;t=e.sourceEvent;)e=t;return e}(e),void 0===t&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}wO.prototype=SO.prototype={constructor:wO,select:function(e){"function"!=typeof e&&(e=bF(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o,s,a=t[r],l=a.length,c=i[r]=new Array(l),u=0;u<l;++u)(o=a[u])&&(s=e.call(o,o.__data__,u,a))&&("__data__"in o&&(s.__data__=o.__data__),c[u]=s);return new wO(i,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){return null==(t=e.apply(this,arguments))?[]:Array.isArray(t)?t:Array.from(t);var t}}(e):wF(e);for(var t=this._groups,n=t.length,i=[],r=[],o=0;o<n;++o)for(var s,a=t[o],l=a.length,c=0;c<l;++c)(s=a[c])&&(i.push(e.call(s,s.__data__,c,a)),r.push(s));return new wO(i,r)},selectChild:function(e){return this.select(null==e?TF:function(e){return function(){return CF.call(this.children,e)}}("function"==typeof e?e:EF(e)))},selectChildren:function(e){return this.selectAll(null==e?IF:function(e){return function(){return kF.call(this.children,e)}}("function"==typeof e?e:EF(e)))},filter:function(e){"function"!=typeof e&&(e=SF(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o,s=t[r],a=s.length,l=i[r]=[],c=0;c<a;++c)(o=s[c])&&e.call(o,o.__data__,c,s)&&l.push(o);return new wO(i,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,MF);var n,i=t?PF:RF,r=this._parents,o=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var s=o.length,a=new Array(s),l=new Array(s),c=new Array(s),u=0;u<s;++u){var d=r[u],h=o[u],f=h.length,p=DF(e.call(d,d&&d.__data__,u,r)),m=p.length,g=l[u]=new Array(m),_=a[u]=new Array(m);i(d,h,g,_,c[u]=new Array(f),p,t);for(var y,v,b=0,x=0;b<m;++b)if(y=g[b]){for(b>=x&&(x=b+1);!(v=_[x])&&++x<m;);y._next=v||null}}return(a=new wO(a,r))._enter=l,a._exit=c,a},enter:function(){return new wO(this._enter||this._groups.map(AF),this._parents)},exit:function(){return new wO(this._exit||this._groups.map(AF),this._parents)},join:function(e,t,n){var i=this.enter(),r=this,o=this.exit();return"function"==typeof e?(i=e(i))&&(i=i.selection()):i=i.append(e+""),null!=t&&(r=t(r))&&(r=r.selection()),null==n?o.remove():n(o),i&&r?i.merge(r).order():r},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,i=t._groups,r=n.length,o=i.length,s=Math.min(r,o),a=new Array(r),l=0;l<s;++l)for(var c,u=n[l],d=i[l],h=u.length,f=a[l]=new Array(h),p=0;p<h;++p)(c=u[p]||d[p])&&(f[p]=c);for(;l<r;++l)a[l]=n[l];return new wO(a,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var i,r=e[t],o=r.length-1,s=r[o];--o>=0;)(i=r[o])&&(s&&4^i.compareDocumentPosition(s)&&s.parentNode.insertBefore(i,s),s=i);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=NF);for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var s,a=n[o],l=a.length,c=r[o]=new Array(l),u=0;u<l;++u)(s=a[u])&&(c[u]=s);c.sort(t)}return new wO(r,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],r=0,o=i.length;r<o;++r){var s=i[r];if(s)return s}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,i=t.length;n<i;++n)for(var r,o=t[n],s=0,a=o.length;s<a;++s)(r=o[s])&&e.call(r,r.__data__,s,o);return this},attr:function(e,t){var n=mF(e);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==t?n.local?OF:FF:"function"==typeof t?n.local?VF:UF:n.local?zF:BF)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?WF:"function"==typeof t?GF:$F)(e,t,null==n?"":n)):jF(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?YF:"function"==typeof t?XF:qF)(e,t)):this.node()[e]},classed:function(e,t){var n=KF(e+"");if(arguments.length<2){for(var i=ZF(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof t?iO:t?tO:nO)(n,t))},text:function(e){return arguments.length?this.each(null==e?rO:("function"==typeof e?sO:oO)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?aO:("function"==typeof e?cO:lO)(e)):this.node().innerHTML},raise:function(){return this.each(uO)},lower:function(){return this.each(dO)},append:function(e){var t="function"==typeof e?e:yF(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:yF(e),i=null==t?hO:"function"==typeof t?t:bF(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function(){return this.each(fO)},clone:function(e){return this.select(e?mO:pO)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var i,r,o=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),s=o.length;if(!(arguments.length<2)){for(a=t?_O:gO,i=0;i<s;++i)this.each(a(o[i],t,n));return this}var a=this.node().__on;if(a)for(var l,c=0,u=a.length;c<u;++c)for(i=0,l=a[c];i<s;++i)if((r=o[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?bO:vO)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i,r=e[t],o=0,s=r.length;o<s;++o)(i=r[o])&&(yield i)}};var TO={value:()=>{}};function kO(){for(var e,t=0,n=arguments.length,i={};t<n;++t){if(!(e=arguments[t]+"")||e in i||/[\s.]/.test(e))throw new Error("illegal type: "+e);i[e]=[]}return new IO(i)}function IO(e){this._=e}function AO(e,t){for(var n,i=0,r=e.length;i<r;++i)if((n=e[i]).name===t)return n.value}function LO(e,t,n){for(var i=0,r=e.length;i<r;++i)if(e[i].name===t){e[i]=TO,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=n&&e.push({name:t,value:n}),e}IO.prototype=kO.prototype={constructor:IO,on:function(e,t){var n,i,r=this._,o=(i=r,(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!i.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}})),s=-1,a=o.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++s<a;)if(n=(e=o[s]).type)r[n]=LO(r[n],e.name,t);else if(null==t)for(n in r)r[n]=LO(r[n],e.name,null);return this}for(;++s<a;)if((n=(e=o[s]).type)&&(n=AO(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new IO(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=0,n=(i=this._[e]).length;o<n;++o)i[o].value.apply(t,r)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,o=i.length;r<o;++r)i[r].value.apply(t,n)}};var RO,PO,MO=0,DO=0,NO=0,FO=0,OO=0,BO=0,zO="object"==typeof performance&&performance.now?performance:Date,UO="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function VO(){return OO||(UO(HO),OO=zO.now()+BO)}function HO(){OO=0}function WO(){this._call=this._time=this._next=null}function $O(e,t,n){var i=new WO;return i.restart(e,t,n),i}function GO(){OO=(FO=zO.now())+BO,MO=DO=0;try{!function(){VO(),++MO;for(var e,t=RO;t;)(e=OO-t._time)>=0&&t._call.call(void 0,e),t=t._next;--MO}()}finally{MO=0,function(){for(var e,t,n=RO,i=1/0;n;)n._call?(i>n._time&&(i=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:RO=t);PO=e,YO(i)}(),OO=0}}function jO(){var e=zO.now(),t=e-FO;t>1e3&&(BO-=t,FO=e)}function YO(e){MO||(DO&&(DO=clearTimeout(DO)),e-OO>24?(e<1/0&&(DO=setTimeout(GO,e-zO.now()-BO)),NO&&(NO=clearInterval(NO))):(NO||(FO=zO.now(),NO=setInterval(jO,1e3)),MO=1,UO(GO)))}function qO(e,t,n){var i=new WO;return t=null==t?0:+t,i.restart(n=>{i.stop(),e(n+t)},t,n),i}WO.prototype=$O.prototype={constructor:WO,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?VO():+n)+(null==t?0:+t),this._next||PO===this||(PO?PO._next=this:RO=this,PO=this),this._call=e,this._time=n,YO()},stop:function(){this._call&&(this._call=null,this._time=1/0,YO())}};var XO=kO("start","end","cancel","interrupt"),KO=[];function ZO(e,t,n,i,r,o){var s=e.__transition;if(s){if(n in s)return}else e.__transition={};!function(e,t,n){var i,r=e.__transition;function o(l){var c,u,d,h;if(1!==n.state)return a();for(c in r)if((h=r[c]).name===n.name){if(3===h.state)return qO(o);4===h.state?(h.state=6,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[c]):+c<t&&(h.state=6,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[c])}if(qO(function(){3===n.state&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(d=n.tween.length),c=0,u=-1;c<d;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(i[++u]=h);i.length=u+1}}function s(t){for(var r=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(a),n.state=5,1),o=-1,s=i.length;++o<s;)i[o].call(e,r);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),a())}function a(){for(var i in n.state=6,n.timer.stop(),delete r[t],r)return;delete e.__transition}r[t]=n,n.timer=$O(function(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)},0,n.time)}(e,n,{name:t,index:i,group:r,on:XO,tween:KO,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function QO(e,t){var n=eB(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function JO(e,t){var n=eB(e,t);if(n.state>3)throw new Error("too late; already running");return n}function eB(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function tB(e,t){var n,i,r,o=e.__transition,s=!0;if(o){for(r in t=null==t?null:t+"",o)(n=o[r]).name===t?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete o[r]):s=!1;s&&delete e.__transition}}function nB(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function iB(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function rB(){}var oB=.7,sB=1/oB,aB="\\s*([+-]?\\d+)\\s*",lB="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",cB="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",uB=/^#([0-9a-f]{3,8})$/,dB=new RegExp(`^rgb\\(${aB},${aB},${aB}\\)$`),hB=new RegExp(`^rgb\\(${cB},${cB},${cB}\\)$`),fB=new RegExp(`^rgba\\(${aB},${aB},${aB},${lB}\\)$`),pB=new RegExp(`^rgba\\(${cB},${cB},${cB},${lB}\\)$`),mB=new RegExp(`^hsl\\(${lB},${cB},${cB}\\)$`),gB=new RegExp(`^hsla\\(${lB},${cB},${cB},${lB}\\)$`),_B={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function yB(){return this.rgb().formatHex()}function vB(){return this.rgb().formatRgb()}function bB(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=uB.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?xB(t):3===n?new CB(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?wB(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?wB(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=dB.exec(e))?new CB(t[1],t[2],t[3],1):(t=hB.exec(e))?new CB(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=fB.exec(e))?wB(t[1],t[2],t[3],t[4]):(t=pB.exec(e))?wB(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=mB.exec(e))?RB(t[1],t[2]/100,t[3]/100,1):(t=gB.exec(e))?RB(t[1],t[2]/100,t[3]/100,t[4]):_B.hasOwnProperty(e)?xB(_B[e]):"transparent"===e?new CB(NaN,NaN,NaN,0):null}function xB(e){return new CB(e>>16&255,e>>8&255,255&e,1)}function wB(e,t,n,i){return i<=0&&(e=t=n=NaN),new CB(e,t,n,i)}function SB(e){return e instanceof rB||(e=bB(e)),e?new CB((e=e.rgb()).r,e.g,e.b,e.opacity):new CB}function EB(e,t,n,i){return 1===arguments.length?SB(e):new CB(e,t,n,null==i?1:i)}function CB(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function TB(){return`#${LB(this.r)}${LB(this.g)}${LB(this.b)}`}function kB(){const e=IB(this.opacity);return`${1===e?"rgb(":"rgba("}${AB(this.r)}, ${AB(this.g)}, ${AB(this.b)}${1===e?")":`, ${e})`}`}function IB(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function AB(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function LB(e){return((e=AB(e))<16?"0":"")+e.toString(16)}function RB(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new MB(e,t,n,i)}function PB(e){if(e instanceof MB)return new MB(e.h,e.s,e.l,e.opacity);if(e instanceof rB||(e=bB(e)),!e)return new MB;if(e instanceof MB)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,r=Math.min(t,n,i),o=Math.max(t,n,i),s=NaN,a=o-r,l=(o+r)/2;return a?(s=t===o?(n-i)/a+6*(n<i):n===o?(i-t)/a+2:(t-n)/a+4,a/=l<.5?o+r:2-o-r,s*=60):a=l>0&&l<1?0:s,new MB(s,a,l,e.opacity)}function MB(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function DB(e){return(e=(e||0)%360)<0?e+360:e}function NB(e){return Math.max(0,Math.min(1,e||0))}function FB(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}nB(rB,bB,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:yB,formatHex:yB,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return PB(this).formatHsl()},formatRgb:vB,toString:vB}),nB(CB,EB,iB(rB,{brighter(e){return e=null==e?sB:Math.pow(sB,e),new CB(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?oB:Math.pow(oB,e),new CB(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new CB(AB(this.r),AB(this.g),AB(this.b),IB(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:TB,formatHex:TB,formatHex8:function(){return`#${LB(this.r)}${LB(this.g)}${LB(this.b)}${LB(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:kB,toString:kB})),nB(MB,function(e,t,n,i){return 1===arguments.length?PB(e):new MB(e,t,n,null==i?1:i)},iB(rB,{brighter(e){return e=null==e?sB:Math.pow(sB,e),new MB(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?oB:Math.pow(oB,e),new MB(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,r=2*n-i;return new CB(FB(e>=240?e-240:e+120,r,i),FB(e,r,i),FB(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new MB(DB(this.h),NB(this.s),NB(this.l),IB(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=IB(this.opacity);return`${1===e?"hsl(":"hsla("}${DB(this.h)}, ${100*NB(this.s)}%, ${100*NB(this.l)}%${1===e?")":`, ${e})`}`}}));const OB=Math.PI/180,BB=180/Math.PI;var zB=-.14861,UB=1.78277,VB=-.29227,HB=-.90649,WB=1.97294,$B=WB*HB,GB=WB*UB,jB=UB*VB-HB*zB;function YB(e,t,n,i){return 1===arguments.length?function(e){if(e instanceof qB)return new qB(e.h,e.s,e.l,e.opacity);e instanceof CB||(e=SB(e));var t=e.r/255,n=e.g/255,i=e.b/255,r=(jB*i+$B*t-GB*n)/(jB+$B-GB),o=i-r,s=(WB*(n-r)-VB*o)/HB,a=Math.sqrt(s*s+o*o)/(WB*r*(1-r)),l=a?Math.atan2(s,o)*BB-120:NaN;return new qB(l<0?l+360:l,a,r,e.opacity)}(e):new qB(e,t,n,null==i?1:i)}function qB(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}nB(qB,YB,iB(rB,{brighter(e){return e=null==e?sB:Math.pow(sB,e),new qB(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?oB:Math.pow(oB,e),new qB(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*OB,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),r=Math.sin(e);return new CB(255*(t+n*(zB*i+UB*r)),255*(t+n*(VB*i+HB*r)),255*(t+n*(WB*i)),this.opacity)}}));const XB=e=>()=>e;function KB(e,t){return function(n){return e+n*t}}function ZB(e,t){var n=t-e;return n?KB(e,n):XB(isNaN(e)?t:e)}const QB=function e(t){var n=function(e){return 1===(e=+e)?ZB:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}(t,n,e):XB(isNaN(t)?n:t)}}(t);function i(e,t){var i=n((e=EB(e)).r,(t=EB(t)).r),r=n(e.g,t.g),o=n(e.b,t.b),s=ZB(e.opacity,t.opacity);return function(t){return e.r=i(t),e.g=r(t),e.b=o(t),e.opacity=s(t),e+""}}return i.gamma=e,i}(1);function JB(e,t){t||(t=[]);var n,i=e?Math.min(t.length,e.length):0,r=t.slice();return function(o){for(n=0;n<i;++n)r[n]=e[n]*(1-o)+t[n]*o;return r}}function ez(e,t){var n,i=t?t.length:0,r=e?Math.min(i,e.length):0,o=new Array(r),s=new Array(i);for(n=0;n<r;++n)o[n]=az(e[n],t[n]);for(;n<i;++n)s[n]=t[n];return function(e){for(n=0;n<r;++n)s[n]=o[n](e);return s}}function tz(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function nz(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function iz(e,t){var n,i={},r={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?i[n]=az(e[n],t[n]):r[n]=t[n];return function(e){for(n in i)r[n]=i[n](e);return r}}var rz=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,oz=new RegExp(rz.source,"g");function sz(e,t){var n,i,r,o=rz.lastIndex=oz.lastIndex=0,s=-1,a=[],l=[];for(e+="",t+="";(n=rz.exec(e))&&(i=oz.exec(t));)(r=i.index)>o&&(r=t.slice(o,r),a[s]?a[s]+=r:a[++s]=r),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,l.push({i:s,x:nz(n,i)})),o=oz.lastIndex;return o<t.length&&(r=t.slice(o),a[s]?a[s]+=r:a[++s]=r),a.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,i=0;i<t;++i)a[(n=l[i]).i]=n.x(e);return a.join("")})}function az(e,t){var n,i,r=typeof t;return null==t||"boolean"===r?XB(t):("number"===r?nz:"string"===r?(n=bB(t))?(t=n,QB):sz:t instanceof bB?QB:t instanceof Date?tz:(i=t,!ArrayBuffer.isView(i)||i instanceof DataView?Array.isArray(t)?ez:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?iz:nz:JB))(e,t)}function lz(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var cz,uz=180/Math.PI,dz={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function hz(e,t,n,i,r,o){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*i)&&(n-=e*l,i-=t*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),e*i<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(t,e)*uz,skewX:Math.atan(l)*uz,scaleX:s,scaleY:a}}function fz(e,t,n,i){function r(e){return e.length?e.pop()+" ":""}return function(o,s){var a=[],l=[];return o=e(o),s=e(s),function(e,i,r,o,s,a){if(e!==r||i!==o){var l=s.push("translate(",null,t,null,n);a.push({i:l-4,x:nz(e,r)},{i:l-2,x:nz(i,o)})}else(r||o)&&s.push("translate("+r+t+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(r(n)+"rotate(",null,i)-2,x:nz(e,t)})):t&&n.push(r(n)+"rotate("+t+i)}(o.rotate,s.rotate,a,l),function(e,t,n,o){e!==t?o.push({i:n.push(r(n)+"skewX(",null,i)-2,x:nz(e,t)}):t&&n.push(r(n)+"skewX("+t+i)}(o.skewX,s.skewX,a,l),function(e,t,n,i,o,s){if(e!==n||t!==i){var a=o.push(r(o)+"scale(",null,",",null,")");s.push({i:a-4,x:nz(e,n)},{i:a-2,x:nz(t,i)})}else 1===n&&1===i||o.push(r(o)+"scale("+n+","+i+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(e){for(var t,n=-1,i=l.length;++n<i;)a[(t=l[n]).i]=t.x(e);return a.join("")}}}var pz=fz(function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?dz:hz(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),mz=fz(function(e){return null==e?dz:(cz||(cz=document.createElementNS("http://www.w3.org/2000/svg","g")),cz.setAttribute("transform",e),(e=cz.transform.baseVal.consolidate())?hz((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):dz)},", ",")",")");function gz(e){return function t(n){function i(t,i){var r=e((t=YB(t)).h,(i=YB(i)).h),o=ZB(t.s,i.s),s=ZB(t.l,i.l),a=ZB(t.opacity,i.opacity);return function(e){return t.h=r(e),t.s=o(e),t.l=s(Math.pow(e,n)),t.opacity=a(e),t+""}}return n=+n,i.gamma=t,i}(1)}const _z=gz(function(e,t){var n=t-e;return n?KB(e,n>180||n<-180?n-360*Math.round(n/360):n):XB(isNaN(e)?t:e)});function yz(e,t){void 0===t&&(t=e,e=az);for(var n=0,i=t.length-1,r=t[0],o=new Array(i<0?0:i);n<i;)o[n]=e(r,r=t[++n]);return function(e){var t=Math.max(0,Math.min(i-1,Math.floor(e*=i)));return o[t](e-t)}}function vz(e,t){var n,i;return function(){var r=JO(this,e),o=r.tween;if(o!==n)for(var s=0,a=(i=n=o).length;s<a;++s)if(i[s].name===t){(i=i.slice()).splice(s,1);break}r.tween=i}}function bz(e,t,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var o=JO(this,e),s=o.tween;if(s!==i){r=(i=s).slice();for(var a={name:t,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===t){r[l]=a;break}l===c&&r.push(a)}o.tween=r}}function xz(e,t,n){var i=e._id;return e.each(function(){var e=JO(this,i);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return eB(e,i).value[t]}}function wz(e,t){var n;return("number"==typeof t?nz:t instanceof bB?QB:(n=bB(t))?(t=n,QB):sz)(e,t)}function Sz(e){return function(){this.removeAttribute(e)}}function Ez(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Cz(e,t,n){var i,r,o=n+"";return function(){var s=this.getAttribute(e);return s===o?null:s===i?r:r=t(i=s,n)}}function Tz(e,t,n){var i,r,o=n+"";return function(){var s=this.getAttributeNS(e.space,e.local);return s===o?null:s===i?r:r=t(i=s,n)}}function kz(e,t,n){var i,r,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(e))===(a=l+"")?null:s===i&&a===r?o:(r=a,o=t(i=s,l));this.removeAttribute(e)}}function Iz(e,t,n){var i,r,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(e.space,e.local))===(a=l+"")?null:s===i&&a===r?o:(r=a,o=t(i=s,l));this.removeAttributeNS(e.space,e.local)}}function Az(e,t){var n,i;function r(){var r=t.apply(this,arguments);return r!==i&&(n=(i=r)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,r)),n}return r._value=t,r}function Lz(e,t){var n,i;function r(){var r=t.apply(this,arguments);return r!==i&&(n=(i=r)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,r)),n}return r._value=t,r}function Rz(e,t){return function(){QO(this,e).delay=+t.apply(this,arguments)}}function Pz(e,t){return t=+t,function(){QO(this,e).delay=t}}function Mz(e,t){return function(){JO(this,e).duration=+t.apply(this,arguments)}}function Dz(e,t){return t=+t,function(){JO(this,e).duration=t}}gz(ZB);var Nz=SO.prototype.constructor;function Fz(e){return function(){this.style.removeProperty(e)}}var Oz=0;function Bz(e,t,n,i){this._groups=e,this._parents=t,this._name=n,this._id=i}function zz(){return++Oz}var Uz=SO.prototype;Bz.prototype={constructor:Bz,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=bF(e));for(var i=this._groups,r=i.length,o=new Array(r),s=0;s<r;++s)for(var a,l,c=i[s],u=c.length,d=o[s]=new Array(u),h=0;h<u;++h)(a=c[h])&&(l=e.call(a,a.__data__,h,c))&&("__data__"in a&&(l.__data__=a.__data__),d[h]=l,ZO(d[h],t,n,h,d,eB(a,n)));return new Bz(o,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=wF(e));for(var i=this._groups,r=i.length,o=[],s=[],a=0;a<r;++a)for(var l,c=i[a],u=c.length,d=0;d<u;++d)if(l=c[d]){for(var h,f=e.call(l,l.__data__,d,c),p=eB(l,n),m=0,g=f.length;m<g;++m)(h=f[m])&&ZO(h,t,n,m,f,p);o.push(f),s.push(l)}return new Bz(o,s,t,n)},selectChild:Uz.selectChild,selectChildren:Uz.selectChildren,filter:function(e){"function"!=typeof e&&(e=SF(e));for(var t=this._groups,n=t.length,i=new Array(n),r=0;r<n;++r)for(var o,s=t[r],a=s.length,l=i[r]=[],c=0;c<a;++c)(o=s[c])&&e.call(o,o.__data__,c,s)&&l.push(o);return new Bz(i,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,i=t.length,r=n.length,o=Math.min(i,r),s=new Array(i),a=0;a<o;++a)for(var l,c=t[a],u=n[a],d=c.length,h=s[a]=new Array(d),f=0;f<d;++f)(l=c[f]||u[f])&&(h[f]=l);for(;a<i;++a)s[a]=t[a];return new Bz(s,this._parents,this._name,this._id)},selection:function(){return new Nz(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=zz(),i=this._groups,r=i.length,o=0;o<r;++o)for(var s,a=i[o],l=a.length,c=0;c<l;++c)if(s=a[c]){var u=eB(s,t);ZO(s,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Bz(i,this._parents,e,n)},call:Uz.call,nodes:Uz.nodes,node:Uz.node,size:Uz.size,empty:Uz.empty,each:Uz.each,on:function(e,t){var n=this._id;return arguments.length<2?eB(this.node(),n).on.on(e):this.each(function(e,t,n){var i,r,o=function(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(t)?QO:JO;return function(){var s=o(this,e),a=s.on;a!==i&&(r=(i=a).copy()).on(t,n),s.on=r}}(n,e,t))},attr:function(e,t){var n=mF(e),i="transform"===n?mz:wz;return this.attrTween(e,"function"==typeof t?(n.local?Iz:kz)(n,i,xz(this,"attr."+e,t)):null==t?(n.local?Ez:Sz)(n):(n.local?Tz:Cz)(n,i,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var i=mF(e);return this.tween(n,(i.local?Az:Lz)(i,t))},style:function(e,t,n){var i="transform"==(e+="")?pz:wz;return null==t?this.styleTween(e,function(e,t){var n,i,r;return function(){var o=jF(this,e),s=(this.style.removeProperty(e),jF(this,e));return o===s?null:o===n&&s===i?r:r=t(n=o,i=s)}}(e,i)).on("end.style."+e,Fz(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var i,r,o;return function(){var s=jF(this,e),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(e),l=a=jF(this,e)),s===l?null:s===i&&l===r?o:(r=l,o=t(i=s,a))}}(e,i,xz(this,"style."+e,t))).each(function(e,t){var n,i,r,o,s="style."+t,a="end."+s;return function(){var l=JO(this,e),c=l.on,u=null==l.value[s]?o||(o=Fz(t)):void 0;c===n&&r===u||(i=(n=c).copy()).on(a,r=u),l.on=i}}(this._id,e)):this.styleTween(e,function(e,t,n){var i,r,o=n+"";return function(){var s=jF(this,e);return s===o?null:s===i?r:r=t(i=s,n)}}(e,i,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==t)return this.tween(i,null);if("function"!=typeof t)throw new Error;return this.tween(i,function(e,t,n){var i,r;function o(){var o=t.apply(this,arguments);return o!==r&&(i=(r=o)&&function(e,t,n){return function(i){this.style.setProperty(e,t.call(this,i),n)}}(e,o,n)),i}return o._value=t,o}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(xz(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,function(e){var t,n;function i(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&function(e){return function(t){this.textContent=e.call(this,t)}}(i)),t}return i._value=e,i}(e))},remove:function(){return this.on("end.remove",(e=this._id,function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}));var e},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var i,r=eB(this.node(),n).tween,o=0,s=r.length;o<s;++o)if((i=r[o]).name===e)return i.value;return null}return this.each((null==t?vz:bz)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Rz:Pz)(t,e)):eB(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Mz:Dz)(t,e)):eB(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!=typeof t)throw new Error;return function(){JO(this,e).ease=t}}(t,e)):eB(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;JO(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,i=n._id,r=n.size();return new Promise(function(o,s){var a={value:s},l={value:function(){0===--r&&o()}};n.each(function(){var n=JO(this,i),r=n.on;r!==e&&((t=(e=r).copy())._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),n.on=t}),0===r&&o()})},[Symbol.iterator]:Uz[Symbol.iterator]};var Vz={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function Hz(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}SO.prototype.interrupt=function(e){return this.each(function(){tB(this,e)})},SO.prototype.transition=function(e){var t,n;e instanceof Bz?(t=e._id,e=e._name):(t=zz(),(n=Vz).time=VO(),e=null==e?null:e+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var s,a=i[o],l=a.length,c=0;c<l;++c)(s=a[c])&&ZO(s,e,t,c,a,n||Hz(s,t));return new Bz(i,this._parents,e,t)};var Wz,$z,Gz=[],jz=function(){return Gz.some(function(e){return e.activeTargets.length>0})},Yz="ResizeObserver loop completed with undelivered notifications.";($z=Wz||(Wz={})).BORDER_BOX="border-box",$z.CONTENT_BOX="content-box",$z.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box";var qz,Xz=function(e){return Object.freeze(e)},Kz=function(){return function(e,t){this.inlineSize=e,this.blockSize=t,Xz(this)}}(),Zz=function(){function e(e,t,n,i){return this.x=e,this.y=t,this.width=n,this.height=i,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Xz(this)}return e.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),Qz=function(e){return e instanceof SVGElement&&"getBBox"in e},Jz=function(e){if(Qz(e)){var t=e.getBBox(),n=t.width,i=t.height;return!n&&!i}var r=e,o=r.offsetWidth,s=r.offsetHeight;return!(o||s||e.getClientRects().length)},eU=function(e){var t;if(e instanceof Element)return!0;var n=null===(t=null==e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView;return!!(n&&e instanceof n.Element)},tU="undefined"!=typeof window?window:{},nU=new WeakMap,iU=/auto|scroll/,rU=/^tb|vertical/,oU=/msie|trident/i.test(tU.navigator&&tU.navigator.userAgent),sU=function(e){return parseFloat(e||"0")},aU=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=!1),new Kz((n?t:e)||0,(n?e:t)||0)},lU=Xz({devicePixelContentBoxSize:aU(),borderBoxSize:aU(),contentBoxSize:aU(),contentRect:new Zz(0,0,0,0)}),cU=function(e,t){if(void 0===t&&(t=!1),nU.has(e)&&!t)return nU.get(e);if(Jz(e))return nU.set(e,lU),lU;var n=getComputedStyle(e),i=Qz(e)&&e.ownerSVGElement&&e.getBBox(),r=!oU&&"border-box"===n.boxSizing,o=rU.test(n.writingMode||""),s=!i&&iU.test(n.overflowY||""),a=!i&&iU.test(n.overflowX||""),l=i?0:sU(n.paddingTop),c=i?0:sU(n.paddingRight),u=i?0:sU(n.paddingBottom),d=i?0:sU(n.paddingLeft),h=i?0:sU(n.borderTopWidth),f=i?0:sU(n.borderRightWidth),p=i?0:sU(n.borderBottomWidth),m=d+c,g=l+u,_=(i?0:sU(n.borderLeftWidth))+f,y=h+p,v=a?e.offsetHeight-y-e.clientHeight:0,b=s?e.offsetWidth-_-e.clientWidth:0,x=r?m+_:0,w=r?g+y:0,S=i?i.width:sU(n.width)-x-b,E=i?i.height:sU(n.height)-w-v,C=S+m+b+_,T=E+g+v+y,k=Xz({devicePixelContentBoxSize:aU(Math.round(S*devicePixelRatio),Math.round(E*devicePixelRatio),o),borderBoxSize:aU(C,T,o),contentBoxSize:aU(S,E,o),contentRect:new Zz(d,l,S,E)});return nU.set(e,k),k},uU=function(e,t,n){var i=cU(e,n),r=i.borderBoxSize,o=i.contentBoxSize,s=i.devicePixelContentBoxSize;switch(t){case Wz.DEVICE_PIXEL_CONTENT_BOX:return s;case Wz.BORDER_BOX:return r;default:return o}},dU=function(){return function(e){var t=cU(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=Xz([t.borderBoxSize]),this.contentBoxSize=Xz([t.contentBoxSize]),this.devicePixelContentBoxSize=Xz([t.devicePixelContentBoxSize])}}(),hU=function(e){if(Jz(e))return 1/0;for(var t=0,n=e.parentNode;n;)t+=1,n=n.parentNode;return t},fU=function(){var e=1/0,t=[];Gz.forEach(function(n){if(0!==n.activeTargets.length){var i=[];n.activeTargets.forEach(function(t){var n=new dU(t.target),r=hU(t.target);i.push(n),t.lastReportedSize=uU(t.target,t.observedBox),r<e&&(e=r)}),t.push(function(){n.callback.call(n.observer,i,n.observer)}),n.activeTargets.splice(0,n.activeTargets.length)}});for(var n=0,i=t;n<i.length;n++)(0,i[n])();return e},pU=function(e){Gz.forEach(function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach(function(n){n.isActive()&&(hU(n.target)>e?t.activeTargets.push(n):t.skippedTargets.push(n))})})},mU=[],gU=0,_U={attributes:!0,characterData:!0,childList:!0,subtree:!0},yU=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],vU=function(e){return void 0===e&&(e=0),Date.now()+e},bU=!1,xU=new(function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t=this;if(void 0===e&&(e=250),!bU){bU=!0;var n,i=vU(e);n=function(){var n=!1;try{n=function(){var e,t=0;for(pU(t);jz();)t=fU(),pU(t);return Gz.some(function(e){return e.skippedTargets.length>0})&&("function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:Yz}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=Yz),window.dispatchEvent(e)),t>0}()}finally{if(bU=!1,e=i-vU(),!gU)return;n?t.run(1e3):e>0?t.run(e):t.start()}},function(e){if(!qz){var t=0,n=document.createTextNode("");new MutationObserver(function(){return mU.splice(0).forEach(function(e){return e()})}).observe(n,{characterData:!0}),qz=function(){n.textContent="".concat(t?t--:t++)}}mU.push(e),qz()}(function(){requestAnimationFrame(n)})}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,_U)};document.body?t():tU.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),yU.forEach(function(t){return tU.addEventListener(t,e.listener,!0)}))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),yU.forEach(function(t){return tU.removeEventListener(t,e.listener,!0)}),this.stopped=!0)},e}()),wU=function(e){!gU&&e>0&&xU.start(),!(gU+=e)&&xU.stop()},SU=function(){function e(e,t){this.target=e,this.observedBox=t||Wz.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=uU(this.target,this.observedBox,!0);return e=this.target,Qz(e)||function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)||"inline"!==getComputedStyle(e).display||(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),EU=function(){return function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t}}(),CU=new WeakMap,TU=function(e,t){for(var n=0;n<e.length;n+=1)if(e[n].target===t)return n;return-1},kU=function(){function e(){}return e.connect=function(e,t){var n=new EU(e,t);CU.set(e,n)},e.observe=function(e,t,n){var i=CU.get(e),r=0===i.observationTargets.length;TU(i.observationTargets,t)<0&&(r&&Gz.push(i),i.observationTargets.push(new SU(t,n&&n.box)),wU(1),xU.schedule())},e.unobserve=function(e,t){var n=CU.get(e),i=TU(n.observationTargets,t),r=1===n.observationTargets.length;i>=0&&(r&&Gz.splice(Gz.indexOf(n),1),n.observationTargets.splice(i,1),wU(-1))},e.disconnect=function(e){var t=this,n=CU.get(e);n.observationTargets.slice().forEach(function(n){return t.unobserve(e,n.target)}),n.activeTargets.splice(0,n.activeTargets.length)},e}(),IU=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");kU.connect(this,e)}return e.prototype.observe=function(e,t){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!eU(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");kU.observe(this,e,t)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!eU(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");kU.unobserve(this,e)},e.prototype.disconnect=function(){kU.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}();function AU(e){return e}var LU=1e-6;function RU(e){return"translate("+e+",0)"}function PU(e){return t=>+e(t)}function MU(e,t){return t=Math.max(0,e.bandwidth()-2*t)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function DU(){return!this.__axis}function NU(e,t){var n=[],i=null,r=null,o=6,s=6,a=3,l="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,c=RU;function u(e){var u=null==i?t.ticks?t.ticks.apply(t,n):t.domain():i,d=null==r?t.tickFormat?t.tickFormat.apply(t,n):AU:r,h=Math.max(o,0)+a,f=t.range(),p=+f[0]+l,m=+f[f.length-1]+l,g=(t.bandwidth?MU:PU)(t.copy(),l),_=e.selection?e.selection():e,y=_.selectAll(".domain").data([null]),v=_.selectAll(".tick").data(u,t).order(),b=v.exit(),x=v.enter().append("g").attr("class","tick"),w=v.select("line"),S=v.select("text");y=y.merge(y.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),v=v.merge(x),w=w.merge(x.append("line").attr("stroke","currentColor").attr("y2",1*o)),S=S.merge(x.append("text").attr("fill","currentColor").attr("y",1*h).attr("dy","0.71em")),e!==_&&(y=y.transition(e),v=v.transition(e),w=w.transition(e),S=S.transition(e),b=b.transition(e).attr("opacity",LU).attr("transform",function(e){return isFinite(e=g(e))?c(e+l):this.getAttribute("transform")}),x.attr("opacity",LU).attr("transform",function(e){var t=this.parentNode.__axis;return c((t&&isFinite(t=t(e))?t:g(e))+l)})),b.remove(),y.attr("d",s?"M"+p+","+1*s+"V"+l+"H"+m+"V"+1*s:"M"+p+","+l+"H"+m),v.attr("opacity",1).attr("transform",function(e){return c(g(e)+l)}),w.attr("y2",1*o),S.attr("y",1*h).text(d),_.filter(DU).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),_.each(function(){this.__axis=g})}return u.scale=function(e){return arguments.length?(t=e,u):t},u.ticks=function(){return n=Array.from(arguments),u},u.tickArguments=function(e){return arguments.length?(n=null==e?[]:Array.from(e),u):n.slice()},u.tickValues=function(e){return arguments.length?(i=null==e?null:Array.from(e),u):i&&i.slice()},u.tickFormat=function(e){return arguments.length?(r=e,u):r},u.tickSize=function(e){return arguments.length?(o=s=+e,u):o},u.tickSizeInner=function(e){return arguments.length?(o=+e,u):o},u.tickSizeOuter=function(e){return arguments.length?(s=+e,u):s},u.tickPadding=function(e){return arguments.length?(a=+e,u):a},u.offset=function(e){return arguments.length?(l=+e,u):l},u}function FU(e){return NU(0,e)}const OU={capture:!0,passive:!1};function BU(e){e.preventDefault(),e.stopImmediatePropagation()}const zU=e=>()=>e;function UU(e,{sourceEvent:t,target:n,selection:i,mode:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:i,enumerable:!0,configurable:!0},mode:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function VU(e){e.preventDefault(),e.stopImmediatePropagation()}var HU={name:"drag"},WU={name:"space"},$U={name:"handle"},GU={name:"center"};const{abs:jU,max:YU,min:qU}=Math;function XU(e){return[+e[0],+e[1]]}function KU(e){return[XU(e[0]),XU(e[1])]}var ZU={name:"x",handles:["w","e"].map(oV),input:function(e,t){return null==e?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},QU={},JU={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(oV),input:function(e){return null==e?null:KU(e)},output:function(e){return e}},eV={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},tV={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},nV={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},iV={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},rV={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function oV(e){return{type:e}}function sV(e){return!e.ctrlKey&&!e.button}function aV(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function lV(){return navigator.maxTouchPoints||"ontouchstart"in this}function cV(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function uV(){return dV(ZU)}function dV(e){var t,n=aV,i=sV,r=lV,o=!0,s=kO("start","brush","end"),a=6;function l(t){var n=t.property("__brush",m).selectAll(".overlay").data([oV("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",eV.overlay).merge(n).each(function(){var e=cV(this).extent;EO(this).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1])}),t.selectAll(".selection").data([oV("selection")]).enter().append("rect").attr("class","selection").attr("cursor",eV.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var i=t.selectAll(".handle").data(e.handles,function(e){return e.type});i.exit().remove(),i.enter().append("rect").attr("class",function(e){return"handle handle--"+e.type}).attr("cursor",function(e){return eV[e.type]}),t.each(c).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",h).filter(r).on("touchstart.brush",h).on("touchmove.brush",f).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function c(){var e=EO(this),t=cV(this).selection;t?(e.selectAll(".selection").style("display",null).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1]),e.selectAll(".handle").style("display",null).attr("x",function(e){return"e"===e.type[e.type.length-1]?t[1][0]-a/2:t[0][0]-a/2}).attr("y",function(e){return"s"===e.type[0]?t[1][1]-a/2:t[0][1]-a/2}).attr("width",function(e){return"n"===e.type||"s"===e.type?t[1][0]-t[0][0]+a:a}).attr("height",function(e){return"e"===e.type||"w"===e.type?t[1][1]-t[0][1]+a:a})):e.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function u(e,t,n){var i=e.__brush.emitter;return!i||n&&i.clean?new d(e,t,n):i}function d(e,t,n){this.that=e,this.args=t,this.state=e.__brush,this.active=0,this.clean=n}function h(n){if((!t||n.touches)&&i.apply(this,arguments)){var r,s,a,l,d,h,f,p,m,g,_,y=this,v=n.target.__data__.type,b="selection"===(o&&n.metaKey?v="overlay":v)?HU:o&&n.altKey?GU:$U,x=e===QU?null:iV[v],w=e===ZU?null:rV[v],S=cV(y),E=S.extent,C=S.selection,T=E[0][0],k=E[0][1],I=E[1][0],A=E[1][1],L=0,R=0,P=x&&w&&o&&n.shiftKey,M=Array.from(n.touches||[n],e=>{const t=e.identifier;return(e=CO(e,y)).point0=e.slice(),e.identifier=t,e});tB(y);var D=u(y,arguments,!0).beforestart();if("overlay"===v){C&&(m=!0);const t=[M[0],M[1]||M[0]];S.selection=C=[[r=e===QU?T:qU(t[0][0],t[1][0]),a=e===ZU?k:qU(t[0][1],t[1][1])],[d=e===QU?I:YU(t[0][0],t[1][0]),f=e===ZU?A:YU(t[0][1],t[1][1])]],M.length>1&&z(n)}else r=C[0][0],a=C[0][1],d=C[1][0],f=C[1][1];s=r,l=a,h=d,p=f;var N=EO(y).attr("pointer-events","none"),F=N.selectAll(".overlay").attr("cursor",eV[v]);if(n.touches)D.moved=B,D.ended=U;else{var O=EO(n.view).on("mousemove.brush",B,!0).on("mouseup.brush",U,!0);o&&O.on("keydown.brush",function(e){switch(e.keyCode){case 16:P=x&&w;break;case 18:b===$U&&(x&&(d=h-L*x,r=s+L*x),w&&(f=p-R*w,a=l+R*w),b=GU,z(e));break;case 32:b!==$U&&b!==GU||(x<0?d=h-L:x>0&&(r=s-L),w<0?f=p-R:w>0&&(a=l-R),b=WU,F.attr("cursor",eV.selection),z(e));break;default:return}VU(e)},!0).on("keyup.brush",function(e){switch(e.keyCode){case 16:P&&(g=_=P=!1,z(e));break;case 18:b===GU&&(x<0?d=h:x>0&&(r=s),w<0?f=p:w>0&&(a=l),b=$U,z(e));break;case 32:b===WU&&(e.altKey?(x&&(d=h-L*x,r=s+L*x),w&&(f=p-R*w,a=l+R*w),b=GU):(x<0?d=h:x>0&&(r=s),w<0?f=p:w>0&&(a=l),b=$U),F.attr("cursor",eV[v]),z(e));break;default:return}VU(e)},!0),function(e){var t=e.document.documentElement,n=EO(e).on("dragstart.drag",BU,OU);"onselectstart"in t?n.on("selectstart.drag",BU,OU):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}(n.view)}c.call(y),D.start(n,b.name)}function B(e){for(const t of e.changedTouches||[e])for(const e of M)e.identifier===t.identifier&&(e.cur=CO(t,y));if(P&&!g&&!_&&1===M.length){const e=M[0];jU(e.cur[0]-e[0])>jU(e.cur[1]-e[1])?_=!0:g=!0}for(const t of M)t.cur&&(t[0]=t.cur[0],t[1]=t.cur[1]);m=!0,VU(e),z(e)}function z(e){const t=M[0],n=t.point0;var i;switch(L=t[0]-n[0],R=t[1]-n[1],b){case WU:case HU:x&&(L=YU(T-r,qU(I-d,L)),s=r+L,h=d+L),w&&(R=YU(k-a,qU(A-f,R)),l=a+R,p=f+R);break;case $U:M[1]?(x&&(s=YU(T,qU(I,M[0][0])),h=YU(T,qU(I,M[1][0])),x=1),w&&(l=YU(k,qU(A,M[0][1])),p=YU(k,qU(A,M[1][1])),w=1)):(x<0?(L=YU(T-r,qU(I-r,L)),s=r+L,h=d):x>0&&(L=YU(T-d,qU(I-d,L)),s=r,h=d+L),w<0?(R=YU(k-a,qU(A-a,R)),l=a+R,p=f):w>0&&(R=YU(k-f,qU(A-f,R)),l=a,p=f+R));break;case GU:x&&(s=YU(T,qU(I,r-L*x)),h=YU(T,qU(I,d+L*x))),w&&(l=YU(k,qU(A,a-R*w)),p=YU(k,qU(A,f+R*w)))}h<s&&(x*=-1,i=r,r=d,d=i,i=s,s=h,h=i,v in tV&&F.attr("cursor",eV[v=tV[v]])),p<l&&(w*=-1,i=a,a=f,f=i,i=l,l=p,p=i,v in nV&&F.attr("cursor",eV[v=nV[v]])),S.selection&&(C=S.selection),g&&(s=C[0][0],h=C[1][0]),_&&(l=C[0][1],p=C[1][1]),C[0][0]===s&&C[0][1]===l&&C[1][0]===h&&C[1][1]===p||(S.selection=[[s,l],[h,p]],c.call(y),D.brush(e,b.name))}function U(e){if(function(e){e.stopImmediatePropagation()}(e),e.touches){if(e.touches.length)return;t&&clearTimeout(t),t=setTimeout(function(){t=null},500)}else!function(e,t){var n=e.document.documentElement,i=EO(e).on("dragstart.drag",null);t&&(i.on("click.drag",BU,OU),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(e.view,m),O.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);N.attr("pointer-events","all"),F.attr("cursor",eV.overlay),S.selection&&(C=S.selection),function(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}(C)&&(S.selection=null,c.call(y)),D.end(e,b.name)}}function f(e){u(this,arguments).moved(e)}function p(e){u(this,arguments).ended(e)}function m(){var t=this.__brush||{selection:null};return t.extent=KU(n.apply(this,arguments)),t.dim=e,t}return l.move=function(t,n,i){t.tween?t.on("start.brush",function(e){u(this,arguments).beforestart().start(e)}).on("interrupt.brush end.brush",function(e){u(this,arguments).end(e)}).tween("brush",function(){var t=this,i=t.__brush,r=u(t,arguments),o=i.selection,s=e.input("function"==typeof n?n.apply(this,arguments):n,i.extent),a=az(o,s);function l(e){i.selection=1===e&&null===s?null:a(e),c.call(t),r.brush()}return null!==o&&null!==s?l:l(1)}):t.each(function(){var t=this,r=arguments,o=t.__brush,s=e.input("function"==typeof n?n.apply(t,r):n,o.extent),a=u(t,r).beforestart();tB(t),o.selection=null===s?null:s,c.call(t),a.start(i).brush(i).end(i)})},l.clear=function(e,t){l.move(e,null,t)},d.prototype={beforestart:function(){return 1===++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(e,t){return this.starting?(this.starting=!1,this.emit("start",e,t)):this.emit("brush",e),this},brush:function(e,t){return this.emit("brush",e,t),this},end:function(e,t){return 0===--this.active&&(delete this.state.emitter,this.emit("end",e,t)),this},emit:function(t,n,i){var r=EO(this.that).datum();s.call(t,this.that,new UU(t,{sourceEvent:n,target:l,selection:e.output(this.state.selection),mode:i,dispatch:s}),r)}},l.extent=function(e){return arguments.length?(n="function"==typeof e?e:zU(KU(e)),l):n},l.filter=function(e){return arguments.length?(i="function"==typeof e?e:zU(!!e),l):i},l.touchable=function(e){return arguments.length?(r="function"==typeof e?e:zU(!!e),l):r},l.handleSize=function(e){return arguments.length?(a=+e,l):a},l.keyModifiers=function(e){return arguments.length?(o=!!e,l):o},l.on=function(){var e=s.on.apply(s,arguments);return e===s?l:e},l}function hV(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function fV(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function pV(e){let t,n,i;function r(e,i,r=0,o=e.length){if(r<o){if(0!==t(i,i))return o;do{const t=r+o>>>1;n(e[t],i)<0?r=t+1:o=t}while(r<o)}return r}return 2!==e.length?(t=hV,n=(t,n)=>hV(e(t),n),i=(t,n)=>e(t)-n):(t=e===hV||e===fV?e:mV,n=e,i=e),{left:r,center:function(e,t,n=0,o=e.length){const s=r(e,t,n,o-1);return s>n&&i(e[s-1],t)>-i(e[s],t)?s-1:s},right:function(e,i,r=0,o=e.length){if(r<o){if(0!==t(i,i))return o;do{const t=r+o>>>1;n(e[t],i)<=0?r=t+1:o=t}while(r<o)}return r}}}function mV(){return 0}const gV=pV(hV).right;pV(function(e){return null===e?NaN:+e}).center;const _V=(yV=function(e){const t=Math.floor(e);if(t===e)return function(e){const t=2*e+1;return(n,i,r,o,s)=>{if(!((o-=s)>=r))return;let a=e*i[r];const l=s*e;for(let e=r,t=r+l;e<t;e+=s)a+=i[Math.min(o,e)];for(let e=r,c=o;e<=c;e+=s)a+=i[Math.min(o,e+l)],n[e]=a/t,a-=i[Math.max(r,e-l)]}}(e);const n=e-t,i=2*e+1;return(e,r,o,s,a)=>{if(!((s-=a)>=o))return;let l=t*r[o];const c=a*t,u=c+a;for(let t=o,n=o+c;t<n;t+=a)l+=r[Math.min(s,t)];for(let t=o,d=s;t<=d;t+=a)l+=r[Math.min(s,t+c)],e[t]=(l+n*(r[Math.max(o,t-u)]+r[Math.min(s,t+u)]))/i,l-=r[Math.max(o,t-c)]}},function(e,t,n=t){if(!((t=+t)>=0))throw new RangeError("invalid rx");if(!((n=+n)>=0))throw new RangeError("invalid ry");let{data:i,width:r,height:o}=e;if(!((r=Math.floor(r))>=0))throw new RangeError("invalid width");if(!((o=Math.floor(void 0!==o?o:i.length/r))>=0))throw new RangeError("invalid height");if(!r||!o||!t&&!n)return e;const s=t&&yV(t),a=n&&yV(n),l=i.slice();return s&&a?(vV(s,l,i,r,o),vV(s,i,l,r,o),vV(s,l,i,r,o),bV(a,i,l,r,o),bV(a,l,i,r,o),bV(a,i,l,r,o)):s?(vV(s,i,l,r,o),vV(s,l,i,r,o),vV(s,i,l,r,o)):a&&(bV(a,i,l,r,o),bV(a,l,i,r,o),bV(a,i,l,r,o)),e});var yV;function vV(e,t,n,i,r){for(let o=0,s=i*r;o<s;)e(t,n,o,o+=i,1)}function bV(e,t,n,i,r){for(let o=0,s=i*r;o<i;++o)e(t,n,o,o+s,i)}function xV(e,t){let n,i;if(void 0===t)for(const r of e)null!=r&&(void 0===n?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)));else{let r=-1;for(let o of e)null!=(o=t(o,++r,e))&&(void 0===n?o>=o&&(n=i=o):(n>o&&(n=o),i<o&&(i=o)))}return[n,i]}class wV extends Map{constructor(e,t=EV){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(SV(this,e))}has(e){return super.has(SV(this,e))}set(e,t){return super.set(function({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}(this,e),t)}delete(e){return super.delete(function({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}(this,e))}}function SV({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function EV(e){return null!==e&&"object"==typeof e?e.valueOf():e}function CV(e,t){return(null==e||!(e>=e))-(null==t||!(t>=t))||(e<t?-1:e>t?1:0)}const TV=Math.sqrt(50),kV=Math.sqrt(10),IV=Math.sqrt(2);function AV(e,t,n){const i=(t-e)/Math.max(0,n),r=Math.floor(Math.log10(i)),o=i/Math.pow(10,r),s=o>=TV?10:o>=kV?5:o>=IV?2:1;let a,l,c;return r<0?(c=Math.pow(10,-r)/s,a=Math.round(e*c),l=Math.round(t*c),a/c<e&&++a,l/c>t&&--l,c=-c):(c=Math.pow(10,r)*s,a=Math.round(e/c),l=Math.round(t/c),a*c<e&&++a,l*c>t&&--l),l<a&&.5<=n&&n<2?AV(e,t,2*n):[a,l,c]}function LV(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const i=t<e,[r,o,s]=i?AV(t,e,n):AV(e,t,n);if(!(o>=r))return[];const a=o-r+1,l=new Array(a);if(i)if(s<0)for(let c=0;c<a;++c)l[c]=(o-c)/-s;else for(let c=0;c<a;++c)l[c]=(o-c)*s;else if(s<0)for(let c=0;c<a;++c)l[c]=(r+c)/-s;else for(let c=0;c<a;++c)l[c]=(r+c)*s;return l}function RV(e,t,n){return AV(e=+e,t=+t,n=+n)[2]}function PV(e,t,n){n=+n;const i=(t=+t)<(e=+e),r=i?RV(t,e,n):RV(e,t,n);return(i?-1:1)*(r<0?1/-r:r)}function MV(e){return Math.max(1,Math.ceil(Math.log(function(e){let t=0;for(let n of e)null!=n&&(n=+n)>=n&&++t;return t}(e))/Math.LN2)+1)}function DV(e,t){let n;for(const i of e)null!=i&&(n<i||void 0===n&&i>=i)&&(n=i);return n}function NV(e,t){let n;for(const i of e)null!=i&&(n>i||void 0===n&&i>=i)&&(n=i);return n}function FV(e,t,n=0,i=1/0,r){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(e.length-1,i)),!(n<=t&&t<=i))return e;for(r=void 0===r?CV:function(e=hV){if(e===hV)return CV;if("function"!=typeof e)throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||0===i?i:(0===e(n,n))-(0===e(t,t))}}(r);i>n;){if(i-n>600){const o=i-n+1,s=t-n+1,a=Math.log(o),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(o-l)/o)*(s-o/2<0?-1:1);FV(e,t,Math.max(n,Math.floor(t-s*l/o+c)),Math.min(i,Math.floor(t+(o-s)*l/o+c)),r)}const o=e[t];let s=n,a=i;for(OV(e,n,t),r(e[i],o)>0&&OV(e,n,i);s<a;){for(OV(e,s,a),++s,--a;r(e[s],o)<0;)++s;for(;r(e[a],o)>0;)--a}0===r(e[n],o)?OV(e,n,a):(++a,OV(e,a,i)),a<=t&&(n=a+1),t<=a&&(i=a-1)}return e}function OV(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function BV(e,t,n){if((i=(e=Float64Array.from(function*(e){for(let t of e)null!=t&&(t=+t)>=t&&(yield t)}(e))).length)&&!isNaN(t=+t)){if(t<=0||i<2)return NV(e);if(t>=1)return DV(e);var i,r=(i-1)*t,o=Math.floor(r),s=DV(FV(e,o).subarray(0,o+1));return s+(NV(e.subarray(o+1))-s)*(r-o)}}function zV(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function UV(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}const VV=Symbol("implicit");function HV(){var e=new wV,t=[],n=[],i=VV;function r(r){let o=e.get(r);if(void 0===o){if(i!==VV)return i;e.set(r,o=t.push(r)-1)}return n[o%n.length]}return r.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new wV;for(const i of n)e.has(i)||e.set(i,t.push(i)-1);return r},r.range=function(e){return arguments.length?(n=Array.from(e),r):n.slice()},r.unknown=function(e){return arguments.length?(i=e,r):i},r.copy=function(){return HV(t,n).unknown(i)},zV.apply(r,arguments),r}function WV(e){return+e}var $V=[0,1];function GV(e){return e}function jV(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function YV(e,t,n){var i=e[0],r=e[1],o=t[0],s=t[1];return r<i?(i=jV(r,i),o=n(s,o)):(i=jV(i,r),o=n(o,s)),function(e){return o(i(e))}}function qV(e,t,n){var i=Math.min(e.length,t.length)-1,r=new Array(i),o=new Array(i),s=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<i;)r[s]=jV(e[s],e[s+1]),o[s]=n(t[s],t[s+1]);return function(t){var n=gV(e,t,1,i)-1;return o[n](r[n](t))}}function XV(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function KV(){var e,t,n,i,r,o,s=$V,a=$V,l=az,c=GV;function u(){var e=Math.min(s.length,a.length);return c!==GV&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(s[0],s[e-1])),i=e>2?qV:YV,r=o=null,d}function d(t){return null==t||isNaN(t=+t)?n:(r||(r=i(s.map(e),a,l)))(e(c(t)))}return d.invert=function(n){return c(t((o||(o=i(a,s.map(e),nz)))(n)))},d.domain=function(e){return arguments.length?(s=Array.from(e,WV),u()):s.slice()},d.range=function(e){return arguments.length?(a=Array.from(e),u()):a.slice()},d.rangeRound=function(e){return a=Array.from(e),l=lz,u()},d.clamp=function(e){return arguments.length?(c=!!e||GV,u()):c!==GV},d.interpolate=function(e){return arguments.length?(l=e,u()):l},d.unknown=function(e){return arguments.length?(n=e,d):n},function(n,i){return e=n,t=i,u()}}function ZV(){return KV()(GV,GV)}function QV(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function JV(e){return(e=QV(Math.abs(e)))?e[1]:NaN}var eH,tH=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function nH(e){if(!(t=tH.exec(e)))throw new Error("invalid format: "+e);var t;return new iH({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function iH(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function rH(e,t){var n=QV(e,t);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}nH.prototype=iH.prototype,iH.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const oH={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>rH(100*e,t),r:rH,s:function(e,t){var n=QV(e,t);if(!n)return e+"";var i=n[0],r=n[1],o=r-(eH=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,s=i.length;return o===s?i:o>s?i+new Array(o-s+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+QV(e,Math.max(0,t+o-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function sH(e){return e}var aH,lH,cH,uH=Array.prototype.map,dH=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function hH(e){var t=e.domain;return e.ticks=function(e){var n=t();return LV(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var i=t();return function(e,t,n,i){var r,o=PV(e,t,n);switch((i=nH(null==i?",f":i)).type){case"s":var s=Math.max(Math.abs(e),Math.abs(t));return null!=i.precision||isNaN(r=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(JV(t)/3)))-JV(Math.abs(e)))}(o,s))||(i.precision=r),cH(i,s);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,JV(t)-JV(e))+1}(o,Math.max(Math.abs(e),Math.abs(t))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(e){return Math.max(0,-JV(Math.abs(e)))}(o))||(i.precision=r-2*("%"===i.type))}return lH(i)}(i[0],i[i.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var i,r,o=t(),s=0,a=o.length-1,l=o[s],c=o[a],u=10;for(c<l&&(r=l,l=c,c=r,r=s,s=a,a=r);u-- >0;){if((r=RV(l,c,n))===i)return o[s]=l,o[a]=c,t(o);if(r>0)l=Math.floor(l/r)*r,c=Math.ceil(c/r)*r;else{if(!(r<0))break;l=Math.ceil(l*r)/r,c=Math.floor(c*r)/r}i=r}return e},e}function fH(){var e=ZV();return e.copy=function(){return XV(e,fH())},zV.apply(e,arguments),hH(e)}function pH(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function mH(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function gH(){var e=function(e){var t=1,n=e(pH(t),mH(t));return n.constant=function(n){return arguments.length?e(pH(t=+n),mH(t)):t},hH(n)}(KV());return e.copy=function(){return XV(e,gH()).constant(e.constant())},zV.apply(e,arguments)}function _H(){var e,t=0,n=1,i=1,r=[.5],o=[0,1];function s(t){return null!=t&&t<=t?o[gV(r,t,0,i)]:e}function a(){var e=-1;for(r=new Array(i);++e<i;)r[e]=((e+1)*n-(e-i)*t)/(i+1);return s}return s.domain=function(e){return arguments.length?([t,n]=e,t=+t,n=+n,a()):[t,n]},s.range=function(e){return arguments.length?(i=(o=Array.from(e)).length-1,a()):o.slice()},s.invertExtent=function(e){var s=o.indexOf(e);return s<0?[NaN,NaN]:s<1?[t,r[0]]:s>=i?[r[i-1],n]:[r[s-1],r[s]]},s.unknown=function(t){return arguments.length?(e=t,s):s},s.thresholds=function(){return r.slice()},s.copy=function(){return _H().domain([t,n]).range(o).unknown(e)},zV.apply(hH(s),arguments)}aH=function(e){var t,n,i=void 0===e.grouping||void 0===e.thousands?sH:(t=uH.call(e.grouping,Number),n=e.thousands+"",function(e,i){for(var r=e.length,o=[],s=0,a=t[0],l=0;r>0&&a>0&&(l+a+1>i&&(a=Math.max(1,i-l)),o.push(e.substring(r-=a,r+a)),!((l+=a+1)>i));)a=t[s=(s+1)%t.length];return o.reverse().join(n)}),r=void 0===e.currency?"":e.currency[0]+"",o=void 0===e.currency?"":e.currency[1]+"",s=void 0===e.decimal?".":e.decimal+"",a=void 0===e.numerals?sH:function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(uH.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function d(e){var t=(e=nH(e)).fill,n=e.align,d=e.sign,h=e.symbol,f=e.zero,p=e.width,m=e.comma,g=e.precision,_=e.trim,y=e.type;"n"===y?(m=!0,y="g"):oH[y]||(void 0===g&&(g=12),_=!0,y="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var v="$"===h?r:"#"===h&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",b="$"===h?o:/[%p]/.test(y)?l:"",x=oH[y],w=/[defgprs%]/.test(y);function S(e){var r,o,l,h=v,S=b;if("c"===y)S=x(e)+S,e="";else{var E=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:x(Math.abs(e),g),_&&(e=function(e){e:for(var t,n=e.length,i=1,r=-1;i<n;++i)switch(e[i]){case".":r=t=i;break;case"0":0===r&&(r=i),t=i;break;default:if(!+e[i])break e;r>0&&(r=0)}return r>0?e.slice(0,r)+e.slice(t+1):e}(e)),E&&0===+e&&"+"!==d&&(E=!1),h=(E?"("===d?d:c:"-"===d||"("===d?"":d)+h,S=("s"===y?dH[8+eH/3]:"")+S+(E&&"("===d?")":""),w)for(r=-1,o=e.length;++r<o;)if(48>(l=e.charCodeAt(r))||l>57){S=(46===l?s+e.slice(r+1):e.slice(r))+S,e=e.slice(0,r);break}}m&&!f&&(e=i(e,1/0));var C=h.length+e.length+S.length,T=C<p?new Array(p-C+1).join(t):"";switch(m&&f&&(e=i(T+e,T.length?p-S.length:1/0),T=""),n){case"<":e=h+e+S+T;break;case"=":e=h+T+e+S;break;case"^":e=T.slice(0,C=T.length>>1)+h+e+S+T.slice(C);break;default:e=T+h+e+S}return a(e)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),S.toString=function(){return e+""},S}return{format:d,formatPrefix:function(e,t){var n=d(((e=nH(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor(JV(t)/3))),r=Math.pow(10,-i),o=dH[8+i/3];return function(e){return n(r*e)+o}}}}({thousands:",",grouping:[3],currency:["$",""]}),lH=aH.format,cH=aH.formatPrefix;const yH=new Date,vH=new Date;function bH(e,t,n,i){function r(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return r.floor=t=>(e(t=new Date(+t)),t),r.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),r.round=e=>{const t=r(e),n=r.ceil(e);return e-t<n-e?t:n},r.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),r.range=(n,i,o)=>{const s=[];if(n=r.ceil(n),o=null==o?1:Math.floor(o),!(n<i&&o>0))return s;let a;do{s.push(a=new Date(+n)),t(n,o),e(n)}while(a<n&&n<i);return s},r.filter=n=>bH(t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},(e,i)=>{if(e>=e)if(i<0)for(;++i<=0;)for(;t(e,-1),!n(e););else for(;--i>=0;)for(;t(e,1),!n(e););}),n&&(r.count=(t,i)=>(yH.setTime(+t),vH.setTime(+i),e(yH),e(vH),Math.floor(n(yH,vH))),r.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?r.filter(i?t=>i(t)%e===0:t=>r.count(0,t)%e===0):r:null)),r}const xH=bH(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);xH.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?bH(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):xH:null),xH.range;const wH=1e3,SH=6e4,EH=36e5,CH=864e5,TH=6048e5,kH=31536e6,IH=bH(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*wH)},(e,t)=>(t-e)/wH,e=>e.getUTCSeconds());IH.range;const AH=bH(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*wH)},(e,t)=>{e.setTime(+e+t*SH)},(e,t)=>(t-e)/SH,e=>e.getMinutes());AH.range,bH(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*SH)},(e,t)=>(t-e)/SH,e=>e.getUTCMinutes()).range;const LH=bH(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*wH-e.getMinutes()*SH)},(e,t)=>{e.setTime(+e+t*EH)},(e,t)=>(t-e)/EH,e=>e.getHours());LH.range,bH(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*EH)},(e,t)=>(t-e)/EH,e=>e.getUTCHours()).range;const RH=bH(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*SH)/CH,e=>e.getDate()-1);RH.range;const PH=bH(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/CH,e=>e.getUTCDate()-1);function MH(e){return bH(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*SH)/TH)}PH.range,bH(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/CH,e=>Math.floor(e/CH)).range;const DH=MH(0),NH=MH(1),FH=MH(2),OH=MH(3),BH=MH(4),zH=MH(5),UH=MH(6);function VH(e){return bH(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/TH)}DH.range,NH.range,FH.range,OH.range,BH.range,zH.range,UH.range;const HH=VH(0),WH=VH(1),$H=VH(2),GH=VH(3),jH=VH(4),YH=VH(5),qH=VH(6);HH.range,WH.range,$H.range,GH.range,jH.range,YH.range,qH.range;const XH=bH(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()),e=>e.getMonth());XH.range,bH(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear()),e=>e.getUTCMonth()).range;const KH=bH(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());KH.every=e=>isFinite(e=Math.floor(e))&&e>0?bH(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}):null,KH.range;const ZH=bH(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ZH.every=e=>isFinite(e=Math.floor(e))&&e>0?bH(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null,ZH.range;const[QH,JH]=function(e){const t=[[IH,1,wH],[IH,5,5e3],[IH,15,15e3],[IH,30,3e4],[AH,1,SH],[AH,5,3e5],[AH,15,9e5],[AH,30,18e5],[LH,1,EH],[LH,3,108e5],[LH,6,216e5],[LH,12,432e5],[RH,1,CH],[RH,2,1728e5],[DH,1,TH],[XH,1,2592e6],[XH,3,7776e6],[e,1,kH]];function n(n,i,r){const o=Math.abs(i-n)/r,s=pV(([,,e])=>e).right(t,o);if(s===t.length)return e.every(PV(n/kH,i/kH,r));if(0===s)return xH.every(Math.max(PV(n,i,r),1));const[a,l]=t[o/t[s-1][2]<t[s][2]/o?s-1:s];return a.every(l)}return[function(e,t,i){const r=t<e;r&&([e,t]=[t,e]);const o=i&&"function"==typeof i.range?i:n(e,t,i),s=o?o.range(e,+t+1):[];return r?s.reverse():s},n]}(KH);function eW(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function tW(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function nW(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var iW,rW,oW={"-":"",_:" ",0:"0"},sW=/^\s*\d+/,aW=/^%/,lW=/[\\^$*+?|[\]().{}]/g;function cW(e,t,n){var i=e<0?"-":"",r=(i?-e:e)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(t)+r:r)}function uW(e){return e.replace(lW,"\\$&")}function dW(e){return new RegExp("^(?:"+e.map(uW).join("|")+")","i")}function hW(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function fW(e,t,n){var i=sW.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function pW(e,t,n){var i=sW.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function mW(e,t,n){var i=sW.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function gW(e,t,n){var i=sW.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function _W(e,t,n){var i=sW.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function yW(e,t,n){var i=sW.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function vW(e,t,n){var i=sW.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function bW(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function xW(e,t,n){var i=sW.exec(t.slice(n,n+1));return i?(e.q=3*i[0]-3,n+i[0].length):-1}function wW(e,t,n){var i=sW.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function SW(e,t,n){var i=sW.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function EW(e,t,n){var i=sW.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function CW(e,t,n){var i=sW.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function TW(e,t,n){var i=sW.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function kW(e,t,n){var i=sW.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function IW(e,t,n){var i=sW.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function AW(e,t,n){var i=sW.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function LW(e,t,n){var i=aW.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function RW(e,t,n){var i=sW.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function PW(e,t,n){var i=sW.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function MW(e,t){return cW(e.getDate(),t,2)}function DW(e,t){return cW(e.getHours(),t,2)}function NW(e,t){return cW(e.getHours()%12||12,t,2)}function FW(e,t){return cW(1+RH.count(KH(e),e),t,3)}function OW(e,t){return cW(e.getMilliseconds(),t,3)}function BW(e,t){return OW(e,t)+"000"}function zW(e,t){return cW(e.getMonth()+1,t,2)}function UW(e,t){return cW(e.getMinutes(),t,2)}function VW(e,t){return cW(e.getSeconds(),t,2)}function HW(e){var t=e.getDay();return 0===t?7:t}function WW(e,t){return cW(DH.count(KH(e)-1,e),t,2)}function $W(e){var t=e.getDay();return t>=4||0===t?BH(e):BH.ceil(e)}function GW(e,t){return e=$W(e),cW(BH.count(KH(e),e)+(4===KH(e).getDay()),t,2)}function jW(e){return e.getDay()}function YW(e,t){return cW(NH.count(KH(e)-1,e),t,2)}function qW(e,t){return cW(e.getFullYear()%100,t,2)}function XW(e,t){return cW((e=$W(e)).getFullYear()%100,t,2)}function KW(e,t){return cW(e.getFullYear()%1e4,t,4)}function ZW(e,t){var n=e.getDay();return cW((e=n>=4||0===n?BH(e):BH.ceil(e)).getFullYear()%1e4,t,4)}function QW(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+cW(t/60|0,"0",2)+cW(t%60,"0",2)}function JW(e,t){return cW(e.getUTCDate(),t,2)}function e$(e,t){return cW(e.getUTCHours(),t,2)}function t$(e,t){return cW(e.getUTCHours()%12||12,t,2)}function n$(e,t){return cW(1+PH.count(ZH(e),e),t,3)}function i$(e,t){return cW(e.getUTCMilliseconds(),t,3)}function r$(e,t){return i$(e,t)+"000"}function o$(e,t){return cW(e.getUTCMonth()+1,t,2)}function s$(e,t){return cW(e.getUTCMinutes(),t,2)}function a$(e,t){return cW(e.getUTCSeconds(),t,2)}function l$(e){var t=e.getUTCDay();return 0===t?7:t}function c$(e,t){return cW(HH.count(ZH(e)-1,e),t,2)}function u$(e){var t=e.getUTCDay();return t>=4||0===t?jH(e):jH.ceil(e)}function d$(e,t){return e=u$(e),cW(jH.count(ZH(e),e)+(4===ZH(e).getUTCDay()),t,2)}function h$(e){return e.getUTCDay()}function f$(e,t){return cW(WH.count(ZH(e)-1,e),t,2)}function p$(e,t){return cW(e.getUTCFullYear()%100,t,2)}function m$(e,t){return cW((e=u$(e)).getUTCFullYear()%100,t,2)}function g$(e,t){return cW(e.getUTCFullYear()%1e4,t,4)}function _$(e,t){var n=e.getUTCDay();return cW((e=n>=4||0===n?jH(e):jH.ceil(e)).getUTCFullYear()%1e4,t,4)}function y$(){return"+0000"}function v$(){return"%"}function b$(e){return+e}function x$(e){return Math.floor(+e/1e3)}function w$(e){return new Date(e)}function S$(e){return e instanceof Date?+e:+new Date(+e)}function E$(e,t,n,i,r,o,s,a,l,c){var u=ZV(),d=u.invert,h=u.domain,f=c(".%L"),p=c(":%S"),m=c("%I:%M"),g=c("%I %p"),_=c("%a %d"),y=c("%b %d"),v=c("%B"),b=c("%Y");function x(e){return(l(e)<e?f:a(e)<e?p:s(e)<e?m:o(e)<e?g:i(e)<e?r(e)<e?_:y:n(e)<e?v:b)(e)}return u.invert=function(e){return new Date(d(e))},u.domain=function(e){return arguments.length?h(Array.from(e,S$)):h().map(w$)},u.ticks=function(t){var n=h();return e(n[0],n[n.length-1],null==t?10:t)},u.tickFormat=function(e,t){return null==t?x:c(t)},u.nice=function(e){var n=h();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?h(function(e,t){var n,i=0,r=(e=e.slice()).length-1,o=e[i],s=e[r];return s<o&&(n=i,i=r,r=n,n=o,o=s,s=n),e[i]=t.floor(o),e[r]=t.ceil(s),e}(n,e)):u},u.copy=function(){return XV(u,E$(e,t,n,i,r,o,s,a,l,c))},u}function C$(){return zV.apply(E$(QH,JH,KH,XH,DH,RH,LH,AH,IH,rW).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function T$(){var e=hH(function(){var e,t,n,i,r,o=0,s=1,a=GV,l=!1;function c(t){return null==t||isNaN(t=+t)?r:a(0===n?.5:(t=(i(t)-e)*n,l?Math.max(0,Math.min(1,t)):t))}function u(e){return function(t){var n,i;return arguments.length?([n,i]=t,a=e(n,i),c):[a(0),a(1)]}}return c.domain=function(r){return arguments.length?([o,s]=r,e=i(o=+o),t=i(s=+s),n=e===t?0:1/(t-e),c):[o,s]},c.clamp=function(e){return arguments.length?(l=!!e,c):l},c.interpolator=function(e){return arguments.length?(a=e,c):a},c.range=u(az),c.rangeRound=u(lz),c.unknown=function(e){return arguments.length?(r=e,c):r},function(r){return i=r,e=r(o),t=r(s),n=e===t?0:1/(t-e),c}}()(GV));return e.copy=function(){return t=e,T$().domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown());var t},UV.apply(e,arguments)}iW=function(e){var t=e.dateTime,n=e.date,i=e.time,r=e.periods,o=e.days,s=e.shortDays,a=e.months,l=e.shortMonths,c=dW(r),u=hW(r),d=dW(o),h=hW(o),f=dW(s),p=hW(s),m=dW(a),g=hW(a),_=dW(l),y=hW(l),v={a:function(e){return s[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return a[e.getMonth()]},c:null,d:MW,e:MW,f:BW,g:XW,G:ZW,H:DW,I:NW,j:FW,L:OW,m:zW,M:UW,p:function(e){return r[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:b$,s:x$,S:VW,u:HW,U:WW,V:GW,w:jW,W:YW,x:null,X:null,y:qW,Y:KW,Z:QW,"%":v$},b={a:function(e){return s[e.getUTCDay()]},A:function(e){return o[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return a[e.getUTCMonth()]},c:null,d:JW,e:JW,f:r$,g:m$,G:_$,H:e$,I:t$,j:n$,L:i$,m:o$,M:s$,p:function(e){return r[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:b$,s:x$,S:a$,u:l$,U:c$,V:d$,w:h$,W:f$,x:null,X:null,y:p$,Y:g$,Z:y$,"%":v$},x={a:function(e,t,n){var i=f.exec(t.slice(n));return i?(e.w=p.get(i[0].toLowerCase()),n+i[0].length):-1},A:function(e,t,n){var i=d.exec(t.slice(n));return i?(e.w=h.get(i[0].toLowerCase()),n+i[0].length):-1},b:function(e,t,n){var i=_.exec(t.slice(n));return i?(e.m=y.get(i[0].toLowerCase()),n+i[0].length):-1},B:function(e,t,n){var i=m.exec(t.slice(n));return i?(e.m=g.get(i[0].toLowerCase()),n+i[0].length):-1},c:function(e,n,i){return E(e,t,n,i)},d:SW,e:SW,f:AW,g:vW,G:yW,H:CW,I:CW,j:EW,L:IW,m:wW,M:TW,p:function(e,t,n){var i=c.exec(t.slice(n));return i?(e.p=u.get(i[0].toLowerCase()),n+i[0].length):-1},q:xW,Q:RW,s:PW,S:kW,u:pW,U:mW,V:gW,w:fW,W:_W,x:function(e,t,i){return E(e,n,t,i)},X:function(e,t,n){return E(e,i,t,n)},y:vW,Y:yW,Z:bW,"%":LW};function w(e,t){return function(n){var i,r,o,s=[],a=-1,l=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++a<c;)37===e.charCodeAt(a)&&(s.push(e.slice(l,a)),null!=(r=oW[i=e.charAt(++a)])?i=e.charAt(++a):r="e"===i?" ":"0",(o=t[i])&&(i=o(n,r)),s.push(i),l=a+1);return s.push(e.slice(l,a)),s.join("")}}function S(e,t){return function(n){var i,r,o=nW(1900,void 0,1);if(E(o,e,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(t&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(r=(i=tW(nW(o.y,0,1))).getUTCDay(),i=r>4||0===r?WH.ceil(i):WH(i),i=PH.offset(i,7*(o.V-1)),o.y=i.getUTCFullYear(),o.m=i.getUTCMonth(),o.d=i.getUTCDate()+(o.w+6)%7):(r=(i=eW(nW(o.y,0,1))).getDay(),i=r>4||0===r?NH.ceil(i):NH(i),i=RH.offset(i,7*(o.V-1)),o.y=i.getFullYear(),o.m=i.getMonth(),o.d=i.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),r="Z"in o?tW(nW(o.y,0,1)).getUTCDay():eW(nW(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(r+5)%7:o.w+7*o.U-(r+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,tW(o)):eW(o)}}function E(e,t,n,i){for(var r,o,s=0,a=t.length,l=n.length;s<a;){if(i>=l)return-1;if(37===(r=t.charCodeAt(s++))){if(r=t.charAt(s++),!(o=x[r in oW?t.charAt(s++):r])||(i=o(e,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}return v.x=w(n,v),v.X=w(i,v),v.c=w(t,v),b.x=w(n,b),b.X=w(i,b),b.c=w(t,b),{format:function(e){var t=w(e+="",v);return t.toString=function(){return e},t},parse:function(e){var t=S(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",b);return t.toString=function(){return e},t},utcParse:function(e){var t=S(e+="",!0);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),rW=iW.format,iW.parse,iW.utcFormat,iW.utcParse;const k$={allowSelection:!0,showAnimationControls:!1,animationSpeed:50,padding:{top:1,left:5,bottom:1,right:5},axisTickHeight:16,selectionRadius:3,selectionPadding:8,barCount:250,barRadius:1,barPadding:.1,barTopMargin:20,minBarHeight:1,dataStep:void 0,tickStep:void 0,stickySelection:!0,formatter:void 0,onBrush:void 0,onBarHover:void 0,onAnimationPlay:void 0,onAnimationPause:void 0,onAnimationTick:void 0,noDataMessage:"No timeline data",loadingMessage:"Data loading..."},I$=e=>"Function"!==e.constructor.name&&"Object"!==e.constructor.name,A$=e=>(e=>e instanceof Object)(e)&&!(e=>Array.isArray(e))(e)&&!(e=>"function"==typeof e)(e)&&!I$(e),L$=(e,t=new Map)=>{if("object"!=typeof e||null===e)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof Array){const n=[];t.set(e,n);for(const i of e)n.push(t.has(i)?t.get(i):L$(i,t));return e}if(I$(e))return e;if(e instanceof Object){const n={};t.set(e,n);const i=e;return Object.keys(e).reduce((e,n)=>(e[n]=t.has(i[n])?t.get(i[n]):L$(i[n],t),e),n),n}return e},R$=(e,t,n=new Map)=>{const i=I$(e)?e:L$(e);return e===t?e:n.has(t)?n.get(t):(n.set(t,i),Object.keys(t).forEach(r=>{A$(e[r])&&A$(t[r])?i[r]=R$(e[r],t[r],n):I$(t)?i[r]=t:i[r]=L$(t[r])}),i)},P$=(e,t="",n,i)=>{if(!e)return"0";let r,o;n?(r=e,o=n):Math.abs(e)>=7e11?(r=e/1e12,o="T"):Math.abs(e)>=2e8?(r=e/1e9,o="B"):Math.abs(e)>=1e6?(r=e/1e6,o="M"):Math.abs(e)>=1e3?(r=e/1e3,o="K"):(r=e,o="");const s=Math.abs(r);void 0===i&&(i=Number.isInteger(s)?0:s<.1?3:s<1?2:s<10?1:0);let a=s>0&&s<.5/Math.pow(10,i);if(a){let e=i;for(;a&&e<8;)e++,a=s<.5/Math.pow(10,e);if(a)return`~${t??""}0`;i=e}let l=e<0?"-":"";return t&&(l+=t),`${l}${lH(`.${i}~f`)(s)}${o}`};function M$(e,t,n){if(!e)return[];const[i,r]=e,o=Math.abs(+r-+i),s=Number.isFinite(o)&&t>1?o/(t-1):1,a=n??s;if(0===a)return[];const l=Array.from({length:t},(e,t)=>+i+t*a);return l[t-1]=+r,l}function D$(e,t,n,i=!1,r=!0){const o=Array.from({length:t.length-1},(e,n)=>[t[n],t[n+1]]),s=n&&i?o.filter(([e,t])=>{const[i,r]=n;return!(e<+i||t>=+r&&!(t>+i&&e<+r))}):o,a=function(e,t,n=t,i=[]){if(!e.length||!t.length||!n.length)return new Array(t.length).fill(0);const r=new Array(t.length).fill(0),o=new Map;for(const[l,c]of n){o.has(l)||o.set(l,new Map);for(let e=0;e<t.length;e++){const[n,i]=t[e];if(l===n&&c===i){o.get(l).set(c,e);break}}}const s=i.length>0?i[i.length-1]:t[t.length-1][1],a=[...n].sort((e,t)=>e[0]-t[0]);for(const l of e){let e=0,t=a.length-1;for(;e<=t;){const n=Math.floor((e+t)/2),[i,c]=a[n];if(l>=i&&(c===s?l<=c:l<c)){const e=o.get(i);if(e){const t=e.get(c);void 0!==t&&r[t]++}break}l<i?t=n-1:e=n+1}}return r}(e,o,s,t);return o.map(([e,t],n)=>({rangeStart:r?e:new Date(e),rangeEnd:r?t:new Date(t),count:a[n]??0}))}const N$=rW(".%L"),F$=rW(":%S"),O$=rW("%I:%M"),B$=rW("%I %p"),z$=rW("%a %d"),U$=rW("%d %b"),V$=rW("%b %Y"),H$=rW("%Y"),W$=36e5,$$=24*W$,G$=7*$$,j$=30*$$,Y$=365*$$,q$=(e,t=null,n=!1)=>{if(n)return P$(e);const i=new Date(e),r=null!==t?t:Date.now()-i.getTime();return(r<1e3?N$:r<6e4?F$:r<W$?O$:r<$$?B$:r<j$?r<G$?z$:U$:r>20*Y$?H$:V$)(i)};!function(){try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('@keyframes style_module_fadeIn__ffac87fd{0%{opacity:0}to{opacity:.2}}.style_module_displayState__6ae19b84{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:var(--cosmograph-ui-text);display:flex;justify-content:center;align-items:center;min-width:100px;opacity:.2;font-size:calc(var(--cosmograph-ui-font-size) + 1px);letter-spacing:-.02em;font-weight:200;user-select:none;-webkit-user-select:none;animation:style_module_fadeIn__ffac87fd .3s ease-in-out}:root{--cosmograph-timeline-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-timeline-selection-opacity: .5;--cosmograph-timeline-bar-color: var(--cosmograph-ui-element-color);--cosmograph-timeline-highlighted-bar-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-timeline-font-family: var(--cosmograph-ui-font-family);--cosmograph-timeline-font-size: var(--cosmograph-ui-tick-font-size);--cosmograph-timeline-background: var(--cosmograph-ui-background);--cosmograph-timeline-text-color: var(--cosmograph-ui-text);--cosmograph-timeline-axis-color: var(--cosmograph-ui-text)}.style_module_timeline__736434f7{position:relative;display:flex;background:var(--cosmograph-timeline-background);width:100%;min-height:25px;overflow:hidden}.style_module_timelineSvg__b916ad04{position:relative;width:100%;height:100%}.style_module_selection__ebee57f8{fill:var(--cosmograph-timeline-selection-color);fill-opacity:var(--cosmograph-timeline-selection-opacity);stroke:none}.style_module_axisTick__5865631d{color:var(--cosmograph-timeline-axis-color);font:var(--cosmograph-timeline-font-family);font-size:var(--cosmograph-timeline-font-size);user-select:none;-webkit-user-select:none;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum";alignment-baseline:text-before-edge}.style_module_axisLine__992b502d{opacity:.2;color:var(--cosmograph-timeline-axis-color)}.style_module_bar__114fa79f{fill:var(--cosmograph-timeline-bar-color);transform:scaleY(-1);opacity:0}.style_module_animationControl__ee52cd66{color:var(--cosmograph-timeline-axis-color);width:6%;max-width:30px;min-width:20px;cursor:pointer;display:none;align-items:center;user-select:none;-webkit-user-select:none;opacity:.5;position:relative;justify-content:center}.style_module_animationControl__ee52cd66>svg{width:50%;max-height:20px;padding-right:2px}.style_module_hidden__a73fe81a{display:none}.style_module_disabled__eb988570{opacity:.2;pointer-events:none}.style_module_highlightedBar__c2fc9bdc{fill:var(--cosmograph-timeline-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-search-font-family: var(--cosmograph-ui-font-family);--cosmograph-search-font-size: 14px;--cosmograph-search-list-font-size: 13.5px;--cosmograph-search-text-color: var(--cosmograph-ui-text);--cosmograph-search-background: transparent;--cosmograph-search-list-background: rgba(0, 0, 0, .2);--cosmograph-search-list-match-background: rgba(255, 255, 255, .2);--cosmograph-search-list-match-color: var(--cosmograph-ui-text)}.style_module_searchInput__d7830601:hover{filter:brightness(1.2) contrast(1)}.style_module_searchInput__d7830601{width:100%;background:transparent;color:var(--cosmograph-search-text-color);border:none;border-bottom:.5px solid var(--cosmograph-search-text-color);padding:4px 20px 5px 2px;font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:opacity .2s ease-out}.style_module_searchInput__d7830601::selection{background:var(--cosmograph-search-list-match-background)}.style_module_searchInput__d7830601:focus{outline:none}.style_module_searchSuggestions__b0d3f71e{color:#fff;width:100%;padding:0;margin:0;background:transparent;overflow-y:auto;flex:1;min-height:0}.style_module_searchSuggestions__b0d3f71e li{padding:5px 10px;cursor:pointer;-webkit-user-select:none;user-select:none;display:block;font-weight:500;font-size:var(--cosmograph-search-list-font-size);max-width:100%;overflow:hidden}.style_module_searchSuggestions__b0d3f71e li>div{white-space:nowrap;font-weight:200;overflow:hidden;text-overflow:ellipsis;width:100%}.style_module_searchSuggestions__b0d3f71e li:hover{background:#ffffff1a}.style_module_searchSuggestions__b0d3f71e mark{background:var(--cosmograph-search-list-match-background);color:var(--cosmograph-search-list-match-color);border-radius:2px}.style_module_clearButton__5ebb41de{position:absolute;right:0;top:0;height:100%;background:none;border:none;color:var(--cosmograph-search-text-color);font-weight:300;cursor:pointer;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d{opacity:.7}.style_module_placeholderWrapper__72d5eb0e{z-index:1;color:var(--cosmograph-search-text-color);font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);position:absolute;top:0;left:0;width:100%;bottom:0;display:flex;line-height:1.25;align-items:center;transition:transform .3s ease-out,opacity .3s ease-out}.style_module_placeholderWrapper__72d5eb0e.style_module_hidden__acfb8431{transform:translate(-30px);pointer-events:none;opacity:0}.style_module_searchInput__d7830601:disabled,.style_module_searchInput__d7830601.style_module_disabled__62c35dc5{opacity:.2;cursor:not-allowed;pointer-events:none}.style_module_disabled__62c35dc5 .style_module_clearButton__5ebb41de{display:none}.style_module_disabled__62c35dc5 .style_module_placeholderWrapper__72d5eb0e{opacity:.3;cursor:not-allowed}.style_module_searchInputWrapper__1edbcb22{position:relative;display:flex;width:100%}.style_module_noResults__363397c3{opacity:.3!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none}.style_module_noResults__363397c3:hover{background:none}.style_module_loading__296e0212{opacity:.7!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none;-webkit-user-select:none;user-select:none}.style_module_dropdownContainer__d98287da{position:absolute;top:100%;left:0;width:100%;background:var(--cosmograph-search-list-background);border-radius:4px;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);opacity:0;transform:translateY(-10px);transition:opacity .2s ease-out,transform .2s ease-out;pointer-events:none;overflow:hidden;z-index:10;display:flex;flex-direction:column;padding-bottom:2px}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b{top:auto;bottom:100%;transform:translateY(10px)}.style_module_dropdownContainer__d98287da.style_module_visible__5be7493d{opacity:1;transform:translateY(0);pointer-events:auto}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b.style_module_visible__5be7493d{opacity:1;transform:translateY(-2px);pointer-events:auto}.style_module_footerContainer__73e7a066{flex-shrink:0}:root{--cosmograph-scrollbar-background: rgba(255, 255, 255, .1);--cosmograph-ui-background: rgb(45, 49, 58);--cosmograph-ui-text: #ffffffc7;--cosmograph-ui-tick-font-size: 11px;--cosmograph-ui-font-size: 12px;--cosmograph-ui-font-family: inherit;--cosmograph-ui-element-color: #5C616A;--cosmograph-ui-highlighted-element-color: white;--cosmograph-ui-selection-control-color: #8d949ea8;-webkit-font-smoothing:antialiased!important;text-rendering:optimizeLegibility!important}.style_module_cosmograph-ui__5acb97f1{background:var(--cosmograph-ui-background);color:var(--cosmograph-ui-text)}.style_module_scrollbar__f1516254 *::-webkit-scrollbar{width:5px;height:5px;border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-track{border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-corner{background:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-button{display:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-thumb{background-color:var(--cosmograph-scrollbar-background);transition:background-color .5s;border-radius:20px;border:3px solid var(--cosmograph-scrollbar-background)}@-moz-document url-prefix(){.style_module_scrollbar__f1516254 *{scrollbar-width:thin;scrollbar-color:var(--cosmograph-scrollbar-background) transparent;scrollbar-track-color:transparent;scrollbar-face-color:var(--cosmograph-scrollbar-background)}}:root{--cosmograph-histogram-background: var(--cosmograph-ui-background);--cosmograph-histogram-text-color: var(--cosmograph-ui-text);--cosmograph-histogram-axis-color: var(--cosmograph-ui-text);--cosmograph-histogram-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-histogram-selection-opacity: .5;--cosmograph-histogram-bar-color: var(--cosmograph-ui-element-color);--cosmograph-histogram-highlighted-bar-color: var( --cosmograph-ui-highlighted-element-color);--cosmograph-histogram-font-family: var(--cosmograph-ui-font-family);--cosmograph-histogram-font-size: var(--cosmograph-ui-tick-font-size)}.style_module_histogram__9d8a77ea{position:relative;display:flex;min-height:25px;background:var(--cosmograph-histogram-background);width:100%}.style_module_histogramSvg__ccccb628{position:relative;width:100%;height:100%}.style_module_selection__7db96137{fill:var(--cosmograph-histogram-selection-color);fill-opacity:var(--cosmograph-histogram-selection-opacity);stroke:none}.style_module_axisTick__898e1f39{color:var(--cosmograph-histogram-axis-color);font-family:var(--cosmograph-histogram-font-family);font-size:var(--cosmograph-histogram-font-size);user-select:none;-webkit-user-select:none;alignment-baseline:text-before-edge;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum"}.style_module_bar__3c9ab488{fill:var(--cosmograph-histogram-bar-color);transform:scaleY(-1)}.style_module_highlightedBar__b193a8de{fill:var(--cosmograph-histogram-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-bars-font-color: var(--cosmograph-ui-text);--cosmograph-bars-font-family: var(--cosmograph-ui-font-family);--cosmograph-bars-font-size: var(--cosmograph-ui-font-size);--cosmograph-bars-ui-font-size: 11.5px;--cosmograph-bars-background: var(--cosmograph-ui-element-color);--cosmograph-bars-bar-height: 20px;--cosmograph-bars-bar-bottom-margin: 2px;--cosmograph-bars-highlighted-color: var( --cosmograph-ui-highlighted-element-color)}.style_module_bars__25497ded{position:relative;width:100%;min-height:100px;user-select:none;flex-direction:column;-webkit-user-select:none}.style_module_bars__25497ded .scroll-container{position:relative;width:100%;overflow-y:hidden;overflow-x:hidden}.style_module_bars__25497ded .bars-container{position:relative;width:calc(100% - 1px);font-family:var(--cosmograph-bars-font-family)}.style_module_bars__25497ded .highlighted-bars-container{position:absolute;top:0;left:0;pointer-events:none}.style_module_bars__25497ded .row{height:var(--cosmograph-bars-bar-height);display:flex;align-items:center;margin-bottom:var(--cosmograph-bars-bar-bottom-margin);width:100%;transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row:hover{filter:brightness(1.15) contrast(1.05);transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row.unselected:hover{filter:brightness(.95) contrast(1.15);transition:filter .05s linear}.style_module_bars__25497ded .unselected{opacity:.85;filter:brightness(.8) contrast(1.1)}.style_module_bars__25497ded .selected{filter:brightness(1.05) contrast(1.05)}.style_module_bars__25497ded .selected>.info>.label{font-weight:600;filter:brightness(1.1) contrast(1.05)}.style_module_bars__25497ded .unselected>.info>.label{font-weight:300}.style_module_bars__25497ded .bar{height:100%;background-color:var(--cosmograph-bars-background);opacity:.8;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .bar-highlighted{height:100%;background-color:var(--cosmograph-bars-highlighted-color);opacity:.2;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .info{display:flex;justify-content:space-between;width:100%;padding:0 4px;position:absolute;font-size:var(--cosmograph-bars-font-size);font-feature-settings:"tnum";color:var(--cosmograph-bars-font-color);gap:2px}.style_module_bars__25497ded .label{min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;transition:opacity .05s linear}.style_module_bars__25497ded .count{flex-shrink:0;font-weight:300;opacity:.8;transition:opacity .05s linear}.style_module_bars__25497ded .show-more{cursor:pointer;padding-top:2px;display:flex;font-weight:300;color:var(--cosmograph-bars-font-color);font-size:11px;justify-content:space-between;opacity:.6;font-size:var(--cosmograph-bars-ui-font-size);pointer-events:none;transition:opacity .1s linear}.style_module_bars__25497ded .show-more:hover{opacity:1;text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .show-more>span{pointer-events:all}.style_module_bars__25497ded .show-more-count{padding-right:5px;pointer-events:all;font-feature-settings:"tnum"}.style_module_bars__25497ded .unselected>.info>.label,.style_module_bars__25497ded .unselected>.info>.count{opacity:.5}.style_module_bars__25497ded .unselected:hover>.info>.label,.style_module_bars__25497ded .unselected:hover>.info>.count{opacity:1}.style_module_bars__25497ded .search-input{background:transparent;border:none;border-bottom:1px solid rgba(255,255,255,.3);font-size:13px!important;color:var(--cosmograph-bars-font-color);line-height:1.5;padding:2px;width:100%;position:relative;transition:border-bottom-color .2s}.style_module_bars__25497ded .search-input::placeholder{color:var(--cosmograph-bars-font-color)!important;opacity:.4;font-weight:300;font-family:inherit}.style_module_bars__25497ded .search-container{position:relative;width:100%;margin-bottom:4px;display:none;z-index:1}.style_module_bars__25497ded .clear-button{position:absolute;right:0;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--cosmograph-bars-font-color);font-weight:300;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_bars__25497ded .clear-button.visible:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_bars__25497ded .clear-button.visible{opacity:.7}.style_module_bars__25497ded .clear-button svg{width:10px;height:10px;fill:currentColor}.style_module_bars__25497ded .sorting-block{visibility:hidden;margin-top:1px;display:flex;justify-content:space-between}.style_module_bars__25497ded .buttons-container{margin-top:4px;font-size:var(--cosmograph-bars-ui-font-size);display:flex;gap:4px;line-height:1.25}.style_module_bars__25497ded .buttons-container>div{transition:opacity .05s linear,filter .05s linear;padding:1px 5px;background:var(--cosmograph-bars-background);border-radius:4px;opacity:.9;display:flex;cursor:pointer;align-items:center}.style_module_bars__25497ded .buttons-container>div:hover{filter:brightness(1.2)}.style_module_bars__25497ded .reset-text{transition:opacity .05s linear,filter .05s linear;display:flex;font-size:var(--cosmograph-bars-ui-font-size);align-items:end;padding-right:4px;cursor:pointer;font-weight:300}.style_module_bars__25497ded .reset-text:hover{text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .reset-text.unselected{pointer-events:none;cursor:default;opacity:.7}.style_module_bars__25497ded :scope.reset-text:hover:not(.unselected){filter:brightness(1.5);opacity:1}:root{--cosmograph-size-legend-form-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-family: inherit;--cosmograph-size-legend-font-size: var(--cosmograph-ui-font-size);--cosmograph-size-legend-sublabel-font-size: 10px;--cosmograph-size-legend-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-size-legend-line-radius: 2px;--cosmograph-size-legend-line-width: 30px;--cosmograph-size-legend-hide-transform: translateY(100%);--cosmograph-size-legend-show-transform: translateX(0)}.style_module_container__d2889234{display:flex;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;overflow:hidden;min-height:25px}.style_module_legend__75c167f2{width:auto;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-size-legend-font-size);font-family:var(--cosmograph-size-legend-font-family);user-select:none;-webkit-user-select:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.04em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__91eae57a{opacity:1;transform:var(--cosmograph-size-legend-show-transform)}.style_module_disabled__d51f7a10{opacity:0;transform:var(--cosmograph-size-legend-hide-transform);pointer-events:none;display:none!important;min-height:0}@starting-style{.style_module_container__d2889234.style_module_enabled__91eae57a,.style_module_legend__75c167f2.style_module_enabled__91eae57a{opacity:0;transform:var(--cosmograph-size-legend-hide-transform)}}.style_module_legend__75c167f2 .circle{background-color:var(--cosmograph-size-legend-form-color);border-radius:50%;transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2 .line{background-color:var(--cosmograph-size-legend-form-color);border-radius:var(--cosmograph-size-legend-line-radius);width:var(--cosmograph-size-legend-line-width);transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2.style_module_events__894316a8{pointer-events:auto;cursor:pointer}.style_module_legend__75c167f2 .legend-content{display:flex;align-items:end;justify-content:center;gap:.75rem}.style_module_legend__75c167f2 .legend-content>div{transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__75c167f2 .labels-wrapper{white-space:nowrap}.style_module_legend__75c167f2 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-size-legend-items-margin)}.style_module_legend__75c167f2 .name{align-items:center;text-align:center;justify-content:center;display:flex;color:var(--cosmograph-size-legend-font-color);overflow:hidden;width:100%;margin-top:3px;word-break:break-all;white-space:pre-line;transition:color .15s ease-in-out;letter-spacing:-.02em}.style_module_legend__75c167f2 .label{color:var(--cosmograph-size-legend-font-color);overflow:hidden;transition:color .15s ease-in-out;text-overflow:ellipsis;font-feature-settings:"tnum"}.style_module_legend__75c167f2 .sublabel{padding-top:1px;font-size:var(--cosmograph-size-legend-sublabel-font-size);opacity:.5;line-height:1;min-width:10px;transition:color .15s ease-in-out}.style_module_hovered__1206707f .label,.style_module_hovered__1206707f .sublabel{color:var(--cosmograph-size-legend-hover-color);cursor:pointer}.style_module_hovered__1206707f .circle,.style_module_hovered__1206707f .line{background-color:var(--cosmograph-size-legend-hover-color);cursor:pointer}:root{--cosmograph-color-legend-range-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-range-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-range-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-label-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-sublabel-font-size: 10px;--cosmograph-color-legend-range-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-range-gradient-height: 6px;--cosmograph-color-legend-range-gradient-radius: 8px;--cosmograph-color-legend-range-gradient-top-margin: 6px;--cosmograph-color-legend-hide-transform: translateY(100%);--cosmograph-color-legend-show-transform: translateX(0)}.style_module_container__05cc807d{display:flex;min-width:150px;min-height:25px;width:100%;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_legend__a3e235e4{width:100%;font-weight:300;letter-spacing:-.04em;display:flex;flex-direction:column;font-size:var(--cosmograph-color-legend-range-font-size);font-family:var(--cosmograph-color-legend-range-font-family);user-select:none;-webkit-user-select:none;pointer-events:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__b3120e27{opacity:1;transform:var(--cosmograph-color-legend-show-transform);pointer-events:auto}.style_module_disabled__c2dc158c{opacity:0;transform:var(--cosmograph-color-legend-hide-transform);pointer-events:none;display:none;min-height:0}@starting-style{.style_module_container__05cc807d.style_module_enabled__b3120e27,.style_module_legend__a3e235e4.style_module_enabled__b3120e27{opacity:0;transform:var(--cosmograph-color-legend-hide-transform)}}.style_module_legend__a3e235e4 .legend-content{display:flex;align-items:end;justify-content:space-between}.style_module_hovered__dfd7bb2c .label,.style_module_hovered__dfd7bb2c .sublabel{color:var(--cosmograph-size-legend-hover-color)!important;cursor:pointer}.style_module_legend__a3e235e4 .extent{white-space:nowrap;transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__a3e235e4 .gradient{width:100%;margin-top:var(--cosmograph-color-legend-range-gradient-top-margin);height:var(--cosmograph-color-legend-range-gradient-height);border-radius:var(--cosmograph-color-legend-range-gradient-radius)}.style_module_legend__a3e235e4 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-color-legend-range-items-margin)}.style_module_legend__a3e235e4 .name{align-items:center;text-align:center;justify-content:space-around;display:flex;color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;width:100%;word-break:break-word;text-wrap:balance;white-space:pre-line;transition:color .15s ease-in-out;margin:0 4px;letter-spacing:-.02em;line-height:1.25}.style_module_legend__a3e235e4 .label{color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;max-width:150px;text-overflow:ellipsis;font-size:var(--cosmograph-color-legend-range-label-font-size);transition:color .15s ease-in-out;line-height:1;font-feature-settings:"tnum"}.style_module_legend__a3e235e4 .sublabel{padding-top:1px;color:var(--cosmograph-color-legend-range-font-color);opacity:.55;font-size:var(--cosmograph-color-legend-range-sublabel-font-size);line-height:1;transition:color .15s ease-in-out}:root{--cosmograph-color-legend-type-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-type-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-type-font-size: 11px;--cosmograph-color-legend-type-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-type-others-color: #bab0ab;--cosmograph-color-legend-type-bullet-size: 8px;--cosmograph-color-legend-type-bullet-radius: 1rem;--cosmograph-color-legend-type-items-margin: 4px;--cosmograph-color-legend-type-hide-transform: translateY(125%);--cosmograph-color-legend-type-show-transform: translateX(0)}.style_module_enabled__277b2403{opacity:1;transform:var(--cosmograph-color-legend-type-show-transform)}.style_module_disabled__7a587f96{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform);display:none!important;min-height:0}.style_module_wrapper__ea8ca7f4{position:relative;max-width:100%;width:fit-content;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_typeLegend__15bf4b2f{position:relative;width:fit-content;max-width:100%;min-height:25px;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.015em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_typeLegend__15bf4b2f .reverted{flex-direction:row-reverse}.style_module_typeLegend__15bf4b2f .scroll-container{width:100%;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-color-legend-type-font-size);font-family:var(--cosmograph-color-legend-type-font-family);user-select:none;-webkit-user-select:none;line-height:normal;overflow-x:hidden;overflow-y:auto;will-change:transform}@starting-style{.style_module_typeLegend__15bf4b2f.style_module_enabled__277b2403,.style_module_wrapper__ea8ca7f4.style_module_enabled__277b2403{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform)}}.style_module_typeLegend__15bf4b2f .legend-item{display:flex;align-items:center;position:absolute;margin-bottom:var(--cosmograph-color-legend-type-items-margin);pointer-events:none;width:100%;padding-left:1px;font-weight:300;transition:filter .1s ease-in-out,opacity .1s ease-in-out;min-height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px + var(--cosmograph-color-legend-type-items-margin));height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px);box-sizing:border-box}.style_module_typeLegend__15bf4b2f .unknown{background-color:var(--cosmograph-color-legend-type-unknown-color)}.style_module_typeLegend__15bf4b2f .others{background-color:var(--cosmograph-color-legend-type-others-color)}.style_module_typeLegend__15bf4b2f .bullet{height:var(--cosmograph-color-legend-type-bullet-size);width:var(--cosmograph-color-legend-type-bullet-size);min-height:var(--cosmograph-color-legend-type-bullet-size);min-width:var(--cosmograph-color-legend-type-bullet-size);border-radius:var(--cosmograph-color-legend-type-bullet-radius);pointer-events:all;margin-right:5px}.style_module_typeLegend__15bf4b2f .label{color:var(--cosmograph-color-legend-type-font-color);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - var(--cosmograph-color-legend-type-bullet-size) - 5px);pointer-events:all;transition:.05s linear color}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.bullet{margin-right:0}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.label{margin-right:5px}.style_module_typeLegend__15bf4b2f .show-more{cursor:pointer;padding-top:4px;display:none;font-weight:300;color:var(--cosmograph-color-legend-type-font-color);font-size:11px;opacity:.6;pointer-events:all;justify-content:space-between;transition:opacity .1s linear;font-feature-settings:"tnum"}.style_module_typeLegend__15bf4b2f .show-more:hover{opacity:1}.style_module_hovered__c0993502 .label,.style_module_hovered__c0993502 .sublabel{color:var(--cosmograph-color-legend-type-hover-color)!important;cursor:pointer}.style_module_selected__36e1dd81{filter:brightness(1)}.style_module_selected__36e1dd81>.style_module_label__afecc7a3{filter:brightness(1.2)}.style_module_unselected__4826cfb7{filter:brightness(.5)}.style_module_typeLegend__15bf4b2f .name{font-size:calc(var(--cosmograph-color-legend-type-font-size) + 1px);font-family:var(--cosmograph-color-legend-type-font-family);color:var(--cosmograph-color-legend-type-font-color);transition:color .15s ease-in-out,opacity .3s ease-in-out,max-height .3s ease-in-out,transform .3s ease-in-out;margin-bottom:4px;margin-top:2px;margin-left:1px;letter-spacing:-.02em;line-height:1.25;overflow:hidden;width:100%;white-space:nowrap;text-overflow:ellipsis;pointer-events:all;-webkit-user-select:none!important;user-select:none!important;max-height:100px;opacity:1;transform:translateY(0)}.style_module_typeLegend__15bf4b2f .name.hidden{opacity:0;max-height:0;margin-bottom:0;margin-top:0;transform:translateY(-10px)}:root{--cosmograph-button-color: var(--cosmograph-ui-text);--cosmograph-button-background: var(--cosmograph-ui-element-color);--cosmograph-button-border-radius: 2px}.style_module_button__e95a1138{background:var(--cosmograph-button-background);color:var(--cosmograph-button-color);border-radius:var(--cosmograph-button-border-radius);display:none;align-items:center;justify-content:center;width:25px;height:25px;margin:3px;padding:5px;cursor:pointer;filter:brightness(.95) contrast(.9);transition:filter .1s}.style_module_button__e95a1138:hover{filter:brightness(1.2) contrast(1)}')),document.head.appendChild(e)}}catch(Xn){}}();var X$=Object.defineProperty,K$=(e,t,n)=>((e,t,n)=>t in e?X$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);const Z$={noDataMessage:"No data",loadingMessage:"Data loading...",disableStateMessages:!1,allowPointerEvents:!1};let Q$=class{constructor(e,t){K$(this,"_displayStateDiv"),K$(this,"_displayStateTimeout",null),K$(this,"_displayStateConfig"),K$(this,"_displayStateContainerNode"),this._displayStateContainerNode=e,this._displayStateConfig={...Z$,...t},"static"===getComputedStyle(e).position&&(e.style.position="relative"),this._displayStateDiv=this._createDisplayStateElement(),this._displayStateContainerNode.appendChild(this._displayStateDiv)}static extractConfig(e,t){return{noDataMessage:e.noDataMessage??t.noDataMessage,loadingMessage:e.loadingMessage??t.loadingMessage,disableStateMessages:e.disableStateMessages??t.disableStateMessages,allowPointerEvents:e.allowPointerEvents??t.allowPointerEvents}}_createDisplayStateElement(){const e=document.createElement("div");return e.classList.add("style_module_displayState__6ae19b84"),!1===this._displayStateConfig.allowPointerEvents&&(!1===this._displayStateConfig.noDataMessage?this._displayStateContainerNode.style.pointerEvents="none":this._displayStateContainerNode.style.pointerEvents=""),!this._displayStateConfig.disableStateMessages&&!1!==this._displayStateConfig.noDataMessage&&(e.textContent="string"==typeof this._displayStateConfig.noDataMessage?this._displayStateConfig.noDataMessage:Z$.noDataMessage),e}setLoadingState(){this._displayStateConfig.disableStateMessages||!1===this._displayStateConfig.loadingMessage?this._displayStateDiv.textContent="":this._displayStateDiv.textContent="string"==typeof this._displayStateConfig.loadingMessage?this._displayStateConfig.loadingMessage:Z$.loadingMessage}showState(e){this._resetDisplayStateTimeout(),this._displayStateConfig.disableStateMessages?this._displayStateDiv.textContent="":e?this._displayStateDiv.textContent=e:!1!==this._displayStateConfig.noDataMessage?this._displayStateDiv.textContent="string"==typeof this._displayStateConfig.noDataMessage?this._displayStateConfig.noDataMessage:Z$.noDataMessage:this._displayStateDiv.textContent="",!1===this._displayStateConfig.allowPointerEvents&&(this._displayStateContainerNode.style.pointerEvents="none"),"flex"!==this._displayStateDiv.style.display&&(this._displayStateTimeout=setTimeout(()=>{this._displayStateDiv.style.display="flex"},150))}hideState(){this._resetDisplayStateTimeout(),this._displayStateDiv.style.display="none",this._displayStateContainerNode.style.pointerEvents=""}setDisplayStateConfig(e){this._displayStateConfig={...this._displayStateConfig,...e}}_resetDisplayStateTimeout(){this._displayStateTimeout&&(clearTimeout(this._displayStateTimeout),this._displayStateTimeout=null)}destroy(){var e,t;this._resetDisplayStateTimeout(),null==(t=null==(e=this._displayStateDiv)?void 0:e.parentNode)||t.removeChild(this._displayStateDiv)}};const J$="style_module_bar__114fa79f",eG="style_module_bars__097b45e0",tG="style_module_hidden__a73fe81a",nG="style_module_disabled__eb988570",iG="style_module_highlightedBar__c2fc9bdc",rG="style_module_playAnimation__c1180703",oG="style_module_pauseAnimation__d6cfd97b";!function(){try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('@keyframes style_module_fadeIn__ffac87fd{0%{opacity:0}to{opacity:.2}}.style_module_displayState__6ae19b84{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:var(--cosmograph-ui-text);display:flex;justify-content:center;align-items:center;min-width:100px;opacity:.2;font-size:calc(var(--cosmograph-ui-font-size) + 1px);letter-spacing:-.02em;font-weight:200;user-select:none;-webkit-user-select:none;animation:style_module_fadeIn__ffac87fd .3s ease-in-out}:root{--cosmograph-timeline-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-timeline-selection-opacity: .5;--cosmograph-timeline-bar-color: var(--cosmograph-ui-element-color);--cosmograph-timeline-highlighted-bar-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-timeline-font-family: var(--cosmograph-ui-font-family);--cosmograph-timeline-font-size: var(--cosmograph-ui-tick-font-size);--cosmograph-timeline-background: var(--cosmograph-ui-background);--cosmograph-timeline-text-color: var(--cosmograph-ui-text);--cosmograph-timeline-axis-color: var(--cosmograph-ui-text)}.style_module_timeline__736434f7{position:relative;display:flex;background:var(--cosmograph-timeline-background);width:100%;min-height:25px;overflow:hidden}.style_module_timelineSvg__b916ad04{position:relative;width:100%;height:100%}.style_module_selection__ebee57f8{fill:var(--cosmograph-timeline-selection-color);fill-opacity:var(--cosmograph-timeline-selection-opacity);stroke:none}.style_module_axisTick__5865631d{color:var(--cosmograph-timeline-axis-color);font:var(--cosmograph-timeline-font-family);font-size:var(--cosmograph-timeline-font-size);user-select:none;-webkit-user-select:none;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum";alignment-baseline:text-before-edge}.style_module_axisLine__992b502d{opacity:.2;color:var(--cosmograph-timeline-axis-color)}.style_module_bar__114fa79f{fill:var(--cosmograph-timeline-bar-color);transform:scaleY(-1);opacity:0}.style_module_animationControl__ee52cd66{color:var(--cosmograph-timeline-axis-color);width:6%;max-width:30px;min-width:20px;cursor:pointer;display:none;align-items:center;user-select:none;-webkit-user-select:none;opacity:.5;position:relative;justify-content:center}.style_module_animationControl__ee52cd66>svg{width:50%;max-height:20px;padding-right:2px}.style_module_hidden__a73fe81a{display:none}.style_module_disabled__eb988570{opacity:.2;pointer-events:none}.style_module_highlightedBar__c2fc9bdc{fill:var(--cosmograph-timeline-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-search-font-family: var(--cosmograph-ui-font-family);--cosmograph-search-font-size: 14px;--cosmograph-search-list-font-size: 13.5px;--cosmograph-search-text-color: var(--cosmograph-ui-text);--cosmograph-search-background: transparent;--cosmograph-search-list-background: rgba(0, 0, 0, .2);--cosmograph-search-list-match-background: rgba(255, 255, 255, .2);--cosmograph-search-list-match-color: var(--cosmograph-ui-text)}.style_module_searchInput__d7830601:hover{filter:brightness(1.2) contrast(1)}.style_module_searchInput__d7830601{width:100%;background:transparent;color:var(--cosmograph-search-text-color);border:none;border-bottom:.5px solid var(--cosmograph-search-text-color);padding:4px 20px 5px 2px;font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:opacity .2s ease-out}.style_module_searchInput__d7830601::selection{background:var(--cosmograph-search-list-match-background)}.style_module_searchInput__d7830601:focus{outline:none}.style_module_searchSuggestions__b0d3f71e{color:#fff;width:100%;padding:0;margin:0;background:transparent;overflow-y:auto;flex:1;min-height:0}.style_module_searchSuggestions__b0d3f71e li{padding:5px 10px;cursor:pointer;-webkit-user-select:none;user-select:none;display:block;font-weight:500;font-size:var(--cosmograph-search-list-font-size);max-width:100%;overflow:hidden}.style_module_searchSuggestions__b0d3f71e li>div{white-space:nowrap;font-weight:200;overflow:hidden;text-overflow:ellipsis;width:100%}.style_module_searchSuggestions__b0d3f71e li:hover{background:#ffffff1a}.style_module_searchSuggestions__b0d3f71e mark{background:var(--cosmograph-search-list-match-background);color:var(--cosmograph-search-list-match-color);border-radius:2px}.style_module_clearButton__5ebb41de{position:absolute;right:0;top:0;height:100%;background:none;border:none;color:var(--cosmograph-search-text-color);font-weight:300;cursor:pointer;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d{opacity:.7}.style_module_placeholderWrapper__72d5eb0e{z-index:1;color:var(--cosmograph-search-text-color);font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);position:absolute;top:0;left:0;width:100%;bottom:0;display:flex;line-height:1.25;align-items:center;transition:transform .3s ease-out,opacity .3s ease-out}.style_module_placeholderWrapper__72d5eb0e.style_module_hidden__acfb8431{transform:translate(-30px);pointer-events:none;opacity:0}.style_module_searchInput__d7830601:disabled,.style_module_searchInput__d7830601.style_module_disabled__62c35dc5{opacity:.2;cursor:not-allowed;pointer-events:none}.style_module_disabled__62c35dc5 .style_module_clearButton__5ebb41de{display:none}.style_module_disabled__62c35dc5 .style_module_placeholderWrapper__72d5eb0e{opacity:.3;cursor:not-allowed}.style_module_searchInputWrapper__1edbcb22{position:relative;display:flex;width:100%}.style_module_noResults__363397c3{opacity:.3!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none}.style_module_noResults__363397c3:hover{background:none}.style_module_loading__296e0212{opacity:.7!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none;-webkit-user-select:none;user-select:none}.style_module_dropdownContainer__d98287da{position:absolute;top:100%;left:0;width:100%;background:var(--cosmograph-search-list-background);border-radius:4px;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);opacity:0;transform:translateY(-10px);transition:opacity .2s ease-out,transform .2s ease-out;pointer-events:none;overflow:hidden;z-index:10;display:flex;flex-direction:column;padding-bottom:2px}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b{top:auto;bottom:100%;transform:translateY(10px)}.style_module_dropdownContainer__d98287da.style_module_visible__5be7493d{opacity:1;transform:translateY(0);pointer-events:auto}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b.style_module_visible__5be7493d{opacity:1;transform:translateY(-2px);pointer-events:auto}.style_module_footerContainer__73e7a066{flex-shrink:0}:root{--cosmograph-scrollbar-background: rgba(255, 255, 255, .1);--cosmograph-ui-background: rgb(45, 49, 58);--cosmograph-ui-text: #ffffffc7;--cosmograph-ui-tick-font-size: 11px;--cosmograph-ui-font-size: 12px;--cosmograph-ui-font-family: inherit;--cosmograph-ui-element-color: #5C616A;--cosmograph-ui-highlighted-element-color: white;--cosmograph-ui-selection-control-color: #8d949ea8;-webkit-font-smoothing:antialiased!important;text-rendering:optimizeLegibility!important}.style_module_cosmograph-ui__5acb97f1{background:var(--cosmograph-ui-background);color:var(--cosmograph-ui-text)}.style_module_scrollbar__f1516254 *::-webkit-scrollbar{width:5px;height:5px;border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-track{border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-corner{background:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-button{display:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-thumb{background-color:var(--cosmograph-scrollbar-background);transition:background-color .5s;border-radius:20px;border:3px solid var(--cosmograph-scrollbar-background)}@-moz-document url-prefix(){.style_module_scrollbar__f1516254 *{scrollbar-width:thin;scrollbar-color:var(--cosmograph-scrollbar-background) transparent;scrollbar-track-color:transparent;scrollbar-face-color:var(--cosmograph-scrollbar-background)}}:root{--cosmograph-histogram-background: var(--cosmograph-ui-background);--cosmograph-histogram-text-color: var(--cosmograph-ui-text);--cosmograph-histogram-axis-color: var(--cosmograph-ui-text);--cosmograph-histogram-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-histogram-selection-opacity: .5;--cosmograph-histogram-bar-color: var(--cosmograph-ui-element-color);--cosmograph-histogram-highlighted-bar-color: var( --cosmograph-ui-highlighted-element-color);--cosmograph-histogram-font-family: var(--cosmograph-ui-font-family);--cosmograph-histogram-font-size: var(--cosmograph-ui-tick-font-size)}.style_module_histogram__9d8a77ea{position:relative;display:flex;min-height:25px;background:var(--cosmograph-histogram-background);width:100%}.style_module_histogramSvg__ccccb628{position:relative;width:100%;height:100%}.style_module_selection__7db96137{fill:var(--cosmograph-histogram-selection-color);fill-opacity:var(--cosmograph-histogram-selection-opacity);stroke:none}.style_module_axisTick__898e1f39{color:var(--cosmograph-histogram-axis-color);font-family:var(--cosmograph-histogram-font-family);font-size:var(--cosmograph-histogram-font-size);user-select:none;-webkit-user-select:none;alignment-baseline:text-before-edge;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum"}.style_module_bar__3c9ab488{fill:var(--cosmograph-histogram-bar-color);transform:scaleY(-1)}.style_module_highlightedBar__b193a8de{fill:var(--cosmograph-histogram-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-bars-font-color: var(--cosmograph-ui-text);--cosmograph-bars-font-family: var(--cosmograph-ui-font-family);--cosmograph-bars-font-size: var(--cosmograph-ui-font-size);--cosmograph-bars-ui-font-size: 11.5px;--cosmograph-bars-background: var(--cosmograph-ui-element-color);--cosmograph-bars-bar-height: 20px;--cosmograph-bars-bar-bottom-margin: 2px;--cosmograph-bars-highlighted-color: var( --cosmograph-ui-highlighted-element-color)}.style_module_bars__25497ded{position:relative;width:100%;min-height:100px;user-select:none;flex-direction:column;-webkit-user-select:none}.style_module_bars__25497ded .scroll-container{position:relative;width:100%;overflow-y:hidden;overflow-x:hidden}.style_module_bars__25497ded .bars-container{position:relative;width:calc(100% - 1px);font-family:var(--cosmograph-bars-font-family)}.style_module_bars__25497ded .highlighted-bars-container{position:absolute;top:0;left:0;pointer-events:none}.style_module_bars__25497ded .row{height:var(--cosmograph-bars-bar-height);display:flex;align-items:center;margin-bottom:var(--cosmograph-bars-bar-bottom-margin);width:100%;transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row:hover{filter:brightness(1.15) contrast(1.05);transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row.unselected:hover{filter:brightness(.95) contrast(1.15);transition:filter .05s linear}.style_module_bars__25497ded .unselected{opacity:.85;filter:brightness(.8) contrast(1.1)}.style_module_bars__25497ded .selected{filter:brightness(1.05) contrast(1.05)}.style_module_bars__25497ded .selected>.info>.label{font-weight:600;filter:brightness(1.1) contrast(1.05)}.style_module_bars__25497ded .unselected>.info>.label{font-weight:300}.style_module_bars__25497ded .bar{height:100%;background-color:var(--cosmograph-bars-background);opacity:.8;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .bar-highlighted{height:100%;background-color:var(--cosmograph-bars-highlighted-color);opacity:.2;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .info{display:flex;justify-content:space-between;width:100%;padding:0 4px;position:absolute;font-size:var(--cosmograph-bars-font-size);font-feature-settings:"tnum";color:var(--cosmograph-bars-font-color);gap:2px}.style_module_bars__25497ded .label{min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;transition:opacity .05s linear}.style_module_bars__25497ded .count{flex-shrink:0;font-weight:300;opacity:.8;transition:opacity .05s linear}.style_module_bars__25497ded .show-more{cursor:pointer;padding-top:2px;display:flex;font-weight:300;color:var(--cosmograph-bars-font-color);font-size:11px;justify-content:space-between;opacity:.6;font-size:var(--cosmograph-bars-ui-font-size);pointer-events:none;transition:opacity .1s linear}.style_module_bars__25497ded .show-more:hover{opacity:1;text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .show-more>span{pointer-events:all}.style_module_bars__25497ded .show-more-count{padding-right:5px;pointer-events:all;font-feature-settings:"tnum"}.style_module_bars__25497ded .unselected>.info>.label,.style_module_bars__25497ded .unselected>.info>.count{opacity:.5}.style_module_bars__25497ded .unselected:hover>.info>.label,.style_module_bars__25497ded .unselected:hover>.info>.count{opacity:1}.style_module_bars__25497ded .search-input{background:transparent;border:none;border-bottom:1px solid rgba(255,255,255,.3);font-size:13px!important;color:var(--cosmograph-bars-font-color);line-height:1.5;padding:2px;width:100%;position:relative;transition:border-bottom-color .2s}.style_module_bars__25497ded .search-input::placeholder{color:var(--cosmograph-bars-font-color)!important;opacity:.4;font-weight:300;font-family:inherit}.style_module_bars__25497ded .search-container{position:relative;width:100%;margin-bottom:4px;display:none;z-index:1}.style_module_bars__25497ded .clear-button{position:absolute;right:0;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--cosmograph-bars-font-color);font-weight:300;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_bars__25497ded .clear-button.visible:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_bars__25497ded .clear-button.visible{opacity:.7}.style_module_bars__25497ded .clear-button svg{width:10px;height:10px;fill:currentColor}.style_module_bars__25497ded .sorting-block{visibility:hidden;margin-top:1px;display:flex;justify-content:space-between}.style_module_bars__25497ded .buttons-container{margin-top:4px;font-size:var(--cosmograph-bars-ui-font-size);display:flex;gap:4px;line-height:1.25}.style_module_bars__25497ded .buttons-container>div{transition:opacity .05s linear,filter .05s linear;padding:1px 5px;background:var(--cosmograph-bars-background);border-radius:4px;opacity:.9;display:flex;cursor:pointer;align-items:center}.style_module_bars__25497ded .buttons-container>div:hover{filter:brightness(1.2)}.style_module_bars__25497ded .reset-text{transition:opacity .05s linear,filter .05s linear;display:flex;font-size:var(--cosmograph-bars-ui-font-size);align-items:end;padding-right:4px;cursor:pointer;font-weight:300}.style_module_bars__25497ded .reset-text:hover{text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .reset-text.unselected{pointer-events:none;cursor:default;opacity:.7}.style_module_bars__25497ded :scope.reset-text:hover:not(.unselected){filter:brightness(1.5);opacity:1}:root{--cosmograph-size-legend-form-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-family: inherit;--cosmograph-size-legend-font-size: var(--cosmograph-ui-font-size);--cosmograph-size-legend-sublabel-font-size: 10px;--cosmograph-size-legend-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-size-legend-line-radius: 2px;--cosmograph-size-legend-line-width: 30px;--cosmograph-size-legend-hide-transform: translateY(100%);--cosmograph-size-legend-show-transform: translateX(0)}.style_module_container__d2889234{display:flex;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;overflow:hidden;min-height:25px}.style_module_legend__75c167f2{width:auto;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-size-legend-font-size);font-family:var(--cosmograph-size-legend-font-family);user-select:none;-webkit-user-select:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.04em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__91eae57a{opacity:1;transform:var(--cosmograph-size-legend-show-transform)}.style_module_disabled__d51f7a10{opacity:0;transform:var(--cosmograph-size-legend-hide-transform);pointer-events:none;display:none!important;min-height:0}@starting-style{.style_module_container__d2889234.style_module_enabled__91eae57a,.style_module_legend__75c167f2.style_module_enabled__91eae57a{opacity:0;transform:var(--cosmograph-size-legend-hide-transform)}}.style_module_legend__75c167f2 .circle{background-color:var(--cosmograph-size-legend-form-color);border-radius:50%;transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2 .line{background-color:var(--cosmograph-size-legend-form-color);border-radius:var(--cosmograph-size-legend-line-radius);width:var(--cosmograph-size-legend-line-width);transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2.style_module_events__894316a8{pointer-events:auto;cursor:pointer}.style_module_legend__75c167f2 .legend-content{display:flex;align-items:end;justify-content:center;gap:.75rem}.style_module_legend__75c167f2 .legend-content>div{transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__75c167f2 .labels-wrapper{white-space:nowrap}.style_module_legend__75c167f2 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-size-legend-items-margin)}.style_module_legend__75c167f2 .name{align-items:center;text-align:center;justify-content:center;display:flex;color:var(--cosmograph-size-legend-font-color);overflow:hidden;width:100%;margin-top:3px;word-break:break-all;white-space:pre-line;transition:color .15s ease-in-out;letter-spacing:-.02em}.style_module_legend__75c167f2 .label{color:var(--cosmograph-size-legend-font-color);overflow:hidden;transition:color .15s ease-in-out;text-overflow:ellipsis;font-feature-settings:"tnum"}.style_module_legend__75c167f2 .sublabel{padding-top:1px;font-size:var(--cosmograph-size-legend-sublabel-font-size);opacity:.5;line-height:1;min-width:10px;transition:color .15s ease-in-out}.style_module_hovered__1206707f .label,.style_module_hovered__1206707f .sublabel{color:var(--cosmograph-size-legend-hover-color);cursor:pointer}.style_module_hovered__1206707f .circle,.style_module_hovered__1206707f .line{background-color:var(--cosmograph-size-legend-hover-color);cursor:pointer}:root{--cosmograph-color-legend-range-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-range-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-range-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-label-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-sublabel-font-size: 10px;--cosmograph-color-legend-range-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-range-gradient-height: 6px;--cosmograph-color-legend-range-gradient-radius: 8px;--cosmograph-color-legend-range-gradient-top-margin: 6px;--cosmograph-color-legend-hide-transform: translateY(100%);--cosmograph-color-legend-show-transform: translateX(0)}.style_module_container__05cc807d{display:flex;min-width:150px;min-height:25px;width:100%;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_legend__a3e235e4{width:100%;font-weight:300;letter-spacing:-.04em;display:flex;flex-direction:column;font-size:var(--cosmograph-color-legend-range-font-size);font-family:var(--cosmograph-color-legend-range-font-family);user-select:none;-webkit-user-select:none;pointer-events:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__b3120e27{opacity:1;transform:var(--cosmograph-color-legend-show-transform);pointer-events:auto}.style_module_disabled__c2dc158c{opacity:0;transform:var(--cosmograph-color-legend-hide-transform);pointer-events:none;display:none;min-height:0}@starting-style{.style_module_container__05cc807d.style_module_enabled__b3120e27,.style_module_legend__a3e235e4.style_module_enabled__b3120e27{opacity:0;transform:var(--cosmograph-color-legend-hide-transform)}}.style_module_legend__a3e235e4 .legend-content{display:flex;align-items:end;justify-content:space-between}.style_module_hovered__dfd7bb2c .label,.style_module_hovered__dfd7bb2c .sublabel{color:var(--cosmograph-size-legend-hover-color)!important;cursor:pointer}.style_module_legend__a3e235e4 .extent{white-space:nowrap;transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__a3e235e4 .gradient{width:100%;margin-top:var(--cosmograph-color-legend-range-gradient-top-margin);height:var(--cosmograph-color-legend-range-gradient-height);border-radius:var(--cosmograph-color-legend-range-gradient-radius)}.style_module_legend__a3e235e4 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-color-legend-range-items-margin)}.style_module_legend__a3e235e4 .name{align-items:center;text-align:center;justify-content:space-around;display:flex;color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;width:100%;word-break:break-word;text-wrap:balance;white-space:pre-line;transition:color .15s ease-in-out;margin:0 4px;letter-spacing:-.02em;line-height:1.25}.style_module_legend__a3e235e4 .label{color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;max-width:150px;text-overflow:ellipsis;font-size:var(--cosmograph-color-legend-range-label-font-size);transition:color .15s ease-in-out;line-height:1;font-feature-settings:"tnum"}.style_module_legend__a3e235e4 .sublabel{padding-top:1px;color:var(--cosmograph-color-legend-range-font-color);opacity:.55;font-size:var(--cosmograph-color-legend-range-sublabel-font-size);line-height:1;transition:color .15s ease-in-out}:root{--cosmograph-color-legend-type-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-type-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-type-font-size: 11px;--cosmograph-color-legend-type-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-type-others-color: #bab0ab;--cosmograph-color-legend-type-bullet-size: 8px;--cosmograph-color-legend-type-bullet-radius: 1rem;--cosmograph-color-legend-type-items-margin: 4px;--cosmograph-color-legend-type-hide-transform: translateY(125%);--cosmograph-color-legend-type-show-transform: translateX(0)}.style_module_enabled__277b2403{opacity:1;transform:var(--cosmograph-color-legend-type-show-transform)}.style_module_disabled__7a587f96{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform);display:none!important;min-height:0}.style_module_wrapper__ea8ca7f4{position:relative;max-width:100%;width:fit-content;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_typeLegend__15bf4b2f{position:relative;width:fit-content;max-width:100%;min-height:25px;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.015em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_typeLegend__15bf4b2f .reverted{flex-direction:row-reverse}.style_module_typeLegend__15bf4b2f .scroll-container{width:100%;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-color-legend-type-font-size);font-family:var(--cosmograph-color-legend-type-font-family);user-select:none;-webkit-user-select:none;line-height:normal;overflow-x:hidden;overflow-y:auto;will-change:transform}@starting-style{.style_module_typeLegend__15bf4b2f.style_module_enabled__277b2403,.style_module_wrapper__ea8ca7f4.style_module_enabled__277b2403{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform)}}.style_module_typeLegend__15bf4b2f .legend-item{display:flex;align-items:center;position:absolute;margin-bottom:var(--cosmograph-color-legend-type-items-margin);pointer-events:none;width:100%;padding-left:1px;font-weight:300;transition:filter .1s ease-in-out,opacity .1s ease-in-out;min-height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px + var(--cosmograph-color-legend-type-items-margin));height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px);box-sizing:border-box}.style_module_typeLegend__15bf4b2f .unknown{background-color:var(--cosmograph-color-legend-type-unknown-color)}.style_module_typeLegend__15bf4b2f .others{background-color:var(--cosmograph-color-legend-type-others-color)}.style_module_typeLegend__15bf4b2f .bullet{height:var(--cosmograph-color-legend-type-bullet-size);width:var(--cosmograph-color-legend-type-bullet-size);min-height:var(--cosmograph-color-legend-type-bullet-size);min-width:var(--cosmograph-color-legend-type-bullet-size);border-radius:var(--cosmograph-color-legend-type-bullet-radius);pointer-events:all;margin-right:5px}.style_module_typeLegend__15bf4b2f .label{color:var(--cosmograph-color-legend-type-font-color);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - var(--cosmograph-color-legend-type-bullet-size) - 5px);pointer-events:all;transition:.05s linear color}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.bullet{margin-right:0}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.label{margin-right:5px}.style_module_typeLegend__15bf4b2f .show-more{cursor:pointer;padding-top:4px;display:none;font-weight:300;color:var(--cosmograph-color-legend-type-font-color);font-size:11px;opacity:.6;pointer-events:all;justify-content:space-between;transition:opacity .1s linear;font-feature-settings:"tnum"}.style_module_typeLegend__15bf4b2f .show-more:hover{opacity:1}.style_module_hovered__c0993502 .label,.style_module_hovered__c0993502 .sublabel{color:var(--cosmograph-color-legend-type-hover-color)!important;cursor:pointer}.style_module_selected__36e1dd81{filter:brightness(1)}.style_module_selected__36e1dd81>.style_module_label__afecc7a3{filter:brightness(1.2)}.style_module_unselected__4826cfb7{filter:brightness(.5)}.style_module_typeLegend__15bf4b2f .name{font-size:calc(var(--cosmograph-color-legend-type-font-size) + 1px);font-family:var(--cosmograph-color-legend-type-font-family);color:var(--cosmograph-color-legend-type-font-color);transition:color .15s ease-in-out,opacity .3s ease-in-out,max-height .3s ease-in-out,transform .3s ease-in-out;margin-bottom:4px;margin-top:2px;margin-left:1px;letter-spacing:-.02em;line-height:1.25;overflow:hidden;width:100%;white-space:nowrap;text-overflow:ellipsis;pointer-events:all;-webkit-user-select:none!important;user-select:none!important;max-height:100px;opacity:1;transform:translateY(0)}.style_module_typeLegend__15bf4b2f .name.hidden{opacity:0;max-height:0;margin-bottom:0;margin-top:0;transform:translateY(-10px)}:root{--cosmograph-button-color: var(--cosmograph-ui-text);--cosmograph-button-background: var(--cosmograph-ui-element-color);--cosmograph-button-border-radius: 2px}.style_module_button__e95a1138{background:var(--cosmograph-button-background);color:var(--cosmograph-button-color);border-radius:var(--cosmograph-button-border-radius);display:none;align-items:center;justify-content:center;width:25px;height:25px;margin:3px;padding:5px;cursor:pointer;filter:brightness(.95) contrast(.9);transition:filter .1s}.style_module_button__e95a1138:hover{filter:brightness(1.2) contrast(1)}')),document.head.appendChild(e)}}catch(Xn){}}();var sG=Object.defineProperty,aG=(e,t,n)=>((e,t,n)=>t in e?sG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class lG extends Q${constructor(e,t){const n=R$(k$,t??{});super(e,Q$.extractConfig(n,k$)),aG(this,"_config"),aG(this,"_animationInterval"),aG(this,"_isAnimationRunning",!1),aG(this,"_svgParser",new DOMParser),aG(this,"_svg"),aG(this,"_animationControlDiv"),aG(this,"_playButtonSvg"),aG(this,"_pauseButtonSvg"),aG(this,"_containerNode"),aG(this,"_axisGroup"),aG(this,"_barsGroup"),aG(this,"_brushGroup"),aG(this,"_highlightedBarsGroup"),aG(this,"_resizeObserver"),aG(this,"_height",0),aG(this,"_width",0),aG(this,"_timelineWidth",0),aG(this,"_timelineHeight",0),aG(this,"_barWidth",0),aG(this,"_maxCount",0),aG(this,"_barsData",[]),aG(this,"_highlightedBarsData",[]),aG(this,"_highlightedData"),aG(this,"_timeData"),aG(this,"_extent"),aG(this,"_bandIntervals",[]),aG(this,"_currentSelection"),aG(this,"_currentSelectionInPixels"),aG(this,"_isNumericTimeline",!1),aG(this,"_firstRender",!0),aG(this,"_yScale",gH()),aG(this,"_timeScale",C$()),aG(this,"_numScale",fH()),aG(this,"_activeAxisScale",this._timeScale),aG(this,"_timeAxis",FU(this._timeScale)),aG(this,"_numAxis",FU(this._numScale)),aG(this,"_brushInstance"),aG(this,"_toggleAnimation",e=>{e.preventDefault(),this._isAnimationRunning?this.pauseAnimation():this.playAnimation()}),aG(this,"_disableAnimation",()=>{var e,t;this.pauseAnimation(),null==(e=this._animationControlDiv)||e.removeEventListener("click",this._toggleAnimation),null==(t=this._animationControlDiv)||t.remove()}),aG(this,"playAnimation",()=>{var e,t,n,i;clearInterval(this._animationInterval),this._currentSelectionInPixels&&(this._animationInterval=setInterval(this._animateSelection,this._config.animationSpeed??0),this._isAnimationRunning=!0,null==(t=(e=this._config).onAnimationPlay)||t.call(e,this._isAnimationRunning,this._currentSelection),null==(n=this._pauseButtonSvg)||n.classList.remove(tG),null==(i=this._playButtonSvg)||i.classList.add(tG))}),aG(this,"pauseAnimation",()=>{var e,t,n,i;clearInterval(this._animationInterval),this._isAnimationRunning=!1,null==(t=(e=this._config).onAnimationPause)||t.call(e,this._isAnimationRunning,this._currentSelection),null==(n=this._pauseButtonSvg)||n.classList.add(tG),null==(i=this._playButtonSvg)||i.classList.remove(tG)}),aG(this,"stopAnimation",()=>{var e,t;this.pauseAnimation(),this.setSelection(void 0),null==(t=(e=this._config).onBrush)||t.call(e,void 0)}),aG(this,"_animateSelection",()=>{var e,t,n,i;const r=this._currentSelectionInPixels;r&&void 0!==r[0]&&void 0!==r[1]&&(this._setSelectionInPixels([r[0]+this._barWidth,r[1]+this._barWidth]),null==(t=(e=this._config).onAnimationTick)||t.call(e,this._currentSelection),(r[1]===(null==(n=this._currentSelectionInPixels)?void 0:n[1])||void 0===(null==(i=this._currentSelectionInPixels)?void 0:i[1]))&&this.stopAnimation())}),aG(this,"destroy",()=>{super.destroy(),this._resizeObserver.disconnect(),this._containerNode.innerHTML="",clearInterval(this._animationInterval)}),this._config=n,this._containerNode=e,this._containerNode.classList.add("style_module_timeline__736434f7"),this._animationControlDiv=document.createElement("div"),this._animationControlDiv.classList.add("style_module_animationControl__ee52cd66"),this._containerNode.appendChild(this._animationControlDiv),this._initializeSVG(),this._initializeGroups(),this._initAnimationControls(),this._resizeObserver=new IU(()=>{this.resize()}),this._resizeObserver.observe(this._containerNode)}_initializeSVG(){this._svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._svg.classList.add("style_module_timelineSvg__b916ad04"),this._containerNode.appendChild(this._svg)}async _initAnimationControls(){await(async()=>{var e,t;if(!this._animationControlDiv.firstChild){const n=this._svgParser.parseFromString('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg>',"image/svg+xml").firstChild,i=this._svgParser.parseFromString('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112V400c0 26.5 21.5 48 48 48H80c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H48zm192 0c-26.5 0-48 21.5-48 48V400c0 26.5 21.5 48 48 48h32c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H240z"/></svg>',"image/svg+xml").firstChild;this._pauseButtonSvg=null==(e=this._animationControlDiv)?void 0:e.appendChild(i),this._playButtonSvg=null==(t=this._animationControlDiv)?void 0:t.appendChild(n)}})().then(()=>{var e,t,n,i,r;this._isAnimationRunning?(null==(n=this._playButtonSvg)||n.classList.add(rG,tG),null==(i=this._pauseButtonSvg)||i.classList.add(oG)):(null==(e=this._playButtonSvg)||e.classList.add(rG),null==(t=this._pauseButtonSvg)||t.classList.add(oG,tG)),this._currentSelection||null==(r=this._animationControlDiv)||r.classList.add(nG),this._animationControlDiv.addEventListener("click",this._toggleAnimation)})}setLoadingState(){super.setLoadingState()}_initializeGroups(){this._axisGroup=EO(this._svg).append("g").attr("class","style_module_axis__5ff3086c"),this._barsGroup=EO(this._svg).append("g").attr("class",eG),this._highlightedBarsGroup=EO(this._svg).append("g").attr("class",eG),this._brushGroup=EO(this._svg).append("g").attr("class","style_module_brush__39277182")}get _barPadding(){return this._barWidth*(this._config.barPadding??0)}getCurrentSelection(){return this._currentSelection}getCurrentSelectionInPixels(){return this._currentSelectionInPixels}getBarWidth(){return this._barWidth-this._barPadding}getConfig(){return this._config}getIsAnimationRunning(){return this._isAnimationRunning}setConfig(e){var t,n,i,r;const o=JSON.parse(JSON.stringify(this._config));this._config=R$(k$,e??{}),this.setDisplayStateConfig(Q$.extractConfig(this._config,k$)),o.formatter!==this._config.formatter&&this._checkFormatter(),null!=(t=this._config)&&t.showAnimationControls?null!=(n=this._animationControlDiv)&&n.isConnected||this._initAnimationControls():this._animationControlDiv&&this._disableAnimation(),this._config.allowSelection||this._disableBrush(),((null==(i=this._config)?void 0:i.dataStep)!==o.dataStep||(null==(r=this._config)?void 0:r.barCount)!==o.barCount)&&(this._updateTimelineData(this._timeData),this._updateTimelineData(this._highlightedData,!0)),this.resize()}_checkFormatter(){this._config.formatter?(this._timeAxis.tickFormat(e=>this._config.formatter(e)),this._numAxis.tickFormat(e=>this._config.formatter(e))):this._extent&&(this._timeAxis.tickFormat(e=>q$(e,+this._extent[1]-+this._extent[0],this._isNumericTimeline)),this._numAxis.tickFormat(e=>q$(e,+this._extent[1]-+this._extent[0],this._isNumericTimeline)))}_parseData(e){if(null==e||!e.length)return[];const t=new Float64Array(e.length);let n=0;for(let i=0;i<e.length;i++){const r=e[i];let o;o=r instanceof Date?r.getTime():r,o&&!isNaN(o)&&(t[n++]=this._normalizeTimeToMilliseconds(o))}return Array.from(t.subarray(0,n))}setTimeData(e,t){if(this._highlightedBarsData=[],this._timeData=[],this._currentSelection=void 0,t&&t[1]<=t[0])return;if(this._brushCurrentSelection(),e&&e.length>1){const t=e[0],n=t instanceof Date&&!isNaN(t.getTime()),i="number"==typeof t&&new Date(t).getFullYear()>1970;this._isNumericTimeline=!n&&!i}const n=this._parseData(e),i=t||xV(n),r=i[0]<i[1]&&n.length>1;EO(this._animationControlDiv).style("display",r?"flex":"none"),r?(this.hideState(),this._timeData=n,this._extent=i,this._firstRender=!0):(this.showState("Empty or invalid timeline data"),this.render()),this._updateTimelineData(this._timeData),this._updateScales(),this.render()}setHighlightedData(e){this._highlightedBarsData=[],this._timeData&&(this._highlightedData=this._parseData(e),this._updateTimelineData(this._highlightedData,!0),this._updateBars(!0))}_updateTimelineData(e=[],t=!1){const n=t?"_highlightedBarsData":"_barsData";if(!this._extent)return void(this[n]=[]);if(!e.length)return void(this[n]=D$([],this._bandIntervals,this._currentSelection,t));t||this._generateBandIntervals();const i=D$(e,this._bandIntervals,this._currentSelection,t);this[n]=i,t||(this._maxCount=Math.max(...i.map(e=>e.count)))}_generateBandIntervals(){if(!this._extent)return;const{barCount:e=30,dataStep:t}=this._config;this._bandIntervals=M$(this._extent,e,t)}setSelection(e,t=!1){var n,i,r,o,s,a,l;const c=this._currentSelection;if(e&&this._extent){const t=[Math.max(+this._extent[0],Math.min(+e[0],+this._extent[1])),Math.min(+this._extent[1],Math.max(+e[1],+this._extent[0]))];if(t[0]<t[1]){if(this._config.stickySelection){const e=t.map(this._activeAxisScale);this._mapSelection(e)}else this._currentSelection=t;null==(n=this._animationControlDiv)||n.classList.remove(nG)}else this._currentSelection=void 0,null==(i=this._animationControlDiv)||i.classList.add(nG)}else this._currentSelection=void 0,null==(r=this._animationControlDiv)||r.classList.add(nG);!t&&((null==c?void 0:c[0])!==(null==(o=this._currentSelection)?void 0:o[0])||(null==c?void 0:c[1])!==(null==(s=this._currentSelection)?void 0:s[1]))&&(null==(l=(a=this._config).onBrush)||l.call(a,this._currentSelection,!0)),this._brushCurrentSelection()}_setSelectionInPixels(e){var t,n,i,r,o;if(e){const i=[Math.max(0,Math.min(e[0],this._timelineWidth)),Math.min(this._timelineWidth,Math.max(e[1],0))];i[0]<i[1]?(this._currentSelection=i.map(e=>this._activeAxisScale.invert(e)),null==(t=this._animationControlDiv)||t.classList.remove(nG)):(this._currentSelection=void 0,null==(n=this._animationControlDiv)||n.classList.add(nG))}else this._currentSelection=void 0,null==(i=this._animationControlDiv)||i.classList.add(nG);null==(o=(r=this._config).onBrush)||o.call(r,this._currentSelection),this._brushCurrentSelection()}updateDimensions(){var e,t,n,i;const{height:r,width:o}=(e=>{const t=getComputedStyle(e);let n=e.clientWidth,i=e.clientHeight;return i-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),n-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),{height:i,width:n}})(this._containerNode),{offsetWidth:s}=this._animationControlDiv;this._width=o,this._height=r,this._timelineWidth=this._width-((null==(e=this._config.padding)?void 0:e.left)??0)-((null==(t=this._config.padding)?void 0:t.right)??0)-s,this._timelineHeight=this._height-((null==(n=this._config.padding)?void 0:n.top)??0)-((null==(i=this._config.padding)?void 0:i.bottom)??0)}resize(){var e,t;this.updateDimensions();const n=(null==(e=this._config.padding)?void 0:e.top)??0,i=(null==(t=this._config.padding)?void 0:t.bottom)??0;this._timelineHeight>n+i&&(this._updateScales(),this._checkLastTickPosition(),this._currentSelection&&this.setSelection(this._currentSelection,!0),this.render())}render(){this._timelineHeight<=0||this._timelineWidth<=0?this._axisGroup.style("display","none"):(this._firstRender&&(this.updateDimensions(),this._updateScales(),this._checkLastTickPosition()),this._updateBrush(),this._updateBars(),this._updateBars(!0),this._updateAxis(),this._firstRender&&(this._firstRender=!1))}_updateAxis(){if(!this._timeData||!this._timeData.length)return void this._axisGroup.style("display","none");const{padding:e,axisTickHeight:t,selectionPadding:n}=this._config;this._axisGroup.style("transform",`translate(${((null==e?void 0:e.left)??0)+1}px, ${((null==e?void 0:e.top)??0)+(t??0)+1+(n??0)/2}px)`).call(this._isNumericTimeline?this._numAxis:this._timeAxis).call(e=>e.select(".domain").remove()),this._axisGroup.selectAll(".tick").select("text").attr("class","style_module_axisTick__5865631d").attr("y",0).attr("dy",-(t??0)).attr("dx","5px"),this._axisGroup.selectAll("line").attr("class","style_module_axisLine__992b502d").attr("y2",-(t??0))}_updateBrush(){if(!this._config.allowSelection||this._timelineHeight<0||this._timelineWidth<0)return void this._brushGroup.selectAll("*").remove();const{selectionPadding:e,padding:t,selectionRadius:n}=this._config,i=this._timelineHeight-(e??0),r=[[0,(e??0)/2],[this._timelineWidth,i+(e??0)/2]];this._brushInstance=uV().extent(r),this._brushInstance.on("end",({selection:e,sourceEvent:t})=>{var n,i,r,o,s,a;t&&(e?(this._config.stickySelection?this._mapSelection(e):this._currentSelection=e.map(e=>this._activeAxisScale.invert(e)),null==(n=this._animationControlDiv)||n.classList.remove(nG),null==(r=(i=this._config).onBrush)||r.call(i,this._currentSelection)):(this._currentSelection=void 0,null==(s=(o=this._config).onBrush)||s.call(o,void 0),null==(a=this._animationControlDiv)||a.classList.add(nG)),this._brushCurrentSelection())}),this._brushGroup.style("transform",`translate(${(null==t?void 0:t.left)??0}px, ${(null==t?void 0:t.top)??0}px)`).call(this._brushInstance).call(this._brushInstance.move,this._currentSelectionInPixels||null),this._brushGroup.select("rect.selection").classed("style_module_selection__ebee57f8",!0).attr("rx",n??0).attr("ry",n??0)}_updateBars(e=!1){const{padding:t,selectionPadding:n}=this._config,i=e?this._highlightedBarsGroup:this._barsGroup;if(!this._timeData||!this._timeData.length)return void i.selectAll("rect").remove();i.style("transform",`translate(${(null==t?void 0:t.left)??0}px, ${((null==t?void 0:t.top)??0)-(n??0)/2}px)`);const r=e?.5:1,o=this._createBars(i,e);!e&&this._config.onBarHover&&o.on("mouseover",e=>{var t,n;return null==(n=(t=this._config).onBarHover)?void 0:n.call(t,e)}),this._animateBars(o,e,r)}_createBars(e,t){return this._activeAxisScale&&this._yScale&&this._barsData.length?e.selectAll(`.${t?iG:J$}`).data(t?this._highlightedBarsData:this._barsData).join("rect").attr("class",t?iG:J$).attr("x",e=>this._activeAxisScale(e.rangeStart)+this._barPadding/2).attr("width",this.getBarWidth()).attr("rx",this._config.barRadius??0).attr("ry",this._config.barRadius??0).attr("y",-this._timelineHeight):(e.selectAll("rect").remove(),e.selectAll("rect"))}_animateBars(e,t,n){e.transition().duration(this._isAnimationRunning?0:300).attr("height",e=>t&&0===e.count?0:this._yScale(e.count)).style("opacity",e=>this._yScale(e.count)===(this._config.minBarHeight??0)?.4:n)}_updateScales(){if(!this._extent||!this._barsData.length||this._timelineHeight<0||this._timelineWidth<0)return void this._axisGroup.style("display","none");this._checkFormatter(),this._axisGroup.style("display","inherit");const e=this._barsData[this._barsData.length-1],t=Math.floor(this._timelineWidth/100),n=this._barsData.map(e=>e.rangeStart);let i;if(n.length>t){const e=Math.ceil(n.length/t);i=n.filter((t,n)=>n%e===0)}else i=n;(this._isNumericTimeline?this._numAxis:this._timeAxis).tickValues(i);const r=Math.max(0,this._maxCount),o=Math.max(0,this._config.minBarHeight??0),s=Math.max(0,this._timelineHeight-(this._config.barTopMargin??0)-(this._config.selectionPadding??0));this._yScale.range([o,s]).domain([0,r]).clamp(!0);const a=[this._extent[0],e.rangeEnd],l=[0,this._timelineWidth],c=this._isNumericTimeline?this._numScale:this._timeScale;c.domain(a),c.range(l),c.clamp(!0),this._activeAxisScale=c;const u=this._barsData[0],d=this._activeAxisScale(u.rangeEnd)-this._activeAxisScale(u.rangeStart);this._barWidth=d}_disableBrush(){var e,t;null==(e=this._brushInstance)||e.clear(this._brushGroup),this._currentSelectionInPixels=void 0,this._currentSelection=void 0,this.pauseAnimation(),this._brushGroup.selectAll("*").remove(),this._config.showAnimationControls&&(null==(t=this._animationControlDiv)||t.classList.add(nG))}_mapSelection(e){if(!this._barsData.length)return;const t=this._activeAxisScale.invert(e[0]),n=this._activeAxisScale.invert(e[1]),i=this._getClosestRange(+t),r=this._getClosestRange(+n,!0);i&&r&&i.rangeStart<=r.rangeEnd&&e[1]-e[0]>this.getBarWidth()/2?this._currentSelection=[i.rangeStart,r.rangeEnd]:this._currentSelection=void 0}_getClosestRange(e,t){return this._barsData.reduce((n,i)=>{const r=t?n.rangeEnd:n.rangeStart,o=t?i.rangeEnd:i.rangeStart;return Math.abs(+o-+e)<Math.abs(+r-+e)?i:n})}_checkLastTickPosition(){var e;const t=this._axisGroup.selectAll(".tick:last-of-type").nodes();if(null!=t&&t.length){const n=t[0],i=null==n?void 0:n.getBoundingClientRect().right,r=null==(e=this._svg)?void 0:e.getBoundingClientRect().right;n.style.display=i>=r?"none":"inherit"}}_brushCurrentSelection(){var e;this._currentSelection?(this._currentSelectionInPixels=this._currentSelection.map(this._activeAxisScale),this._brushInstance&&!this._firstRender&&this._brushGroup.call(this._brushInstance.move,this._currentSelectionInPixels)):(this._currentSelectionInPixels=void 0,null==(e=this._brushInstance)||e.clear(this._brushGroup))}_normalizeTimeToMilliseconds(e){if(e<1e13)return e;const t=10**(Math.floor(Math.log10(e))-12);return Math.round(e/t*1e3)/1e3}}const cG={debounceTime:300,suggestionsLimit:50,maxVisibleItems:10,minSearchLength:2,highlightMatch:!0,disabled:!1,openListUpwards:!1,placeholderRenderer:"Search...",suggestionRenderer:e=>String(e),selectedSuggestionRenderer:e=>String(e),inputClassName:void 0,suggestionListClassName:void 0,searchFn:async()=>[],onEnter:()=>{},onInput:()=>{},onSelect:()=>{},onClear:()=>{},noResultsText:"No results found",footerComponent:void 0},uG="style_module_visible__5be7493d",dG="style_module_hidden__acfb8431",hG="style_module_disabled__62c35dc5",fG="style_module_upwards__e0b4831b";!function(){try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('@keyframes style_module_fadeIn__ffac87fd{0%{opacity:0}to{opacity:.2}}.style_module_displayState__6ae19b84{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:var(--cosmograph-ui-text);display:flex;justify-content:center;align-items:center;min-width:100px;opacity:.2;font-size:calc(var(--cosmograph-ui-font-size) + 1px);letter-spacing:-.02em;font-weight:200;user-select:none;-webkit-user-select:none;animation:style_module_fadeIn__ffac87fd .3s ease-in-out}:root{--cosmograph-timeline-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-timeline-selection-opacity: .5;--cosmograph-timeline-bar-color: var(--cosmograph-ui-element-color);--cosmograph-timeline-highlighted-bar-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-timeline-font-family: var(--cosmograph-ui-font-family);--cosmograph-timeline-font-size: var(--cosmograph-ui-tick-font-size);--cosmograph-timeline-background: var(--cosmograph-ui-background);--cosmograph-timeline-text-color: var(--cosmograph-ui-text);--cosmograph-timeline-axis-color: var(--cosmograph-ui-text)}.style_module_timeline__736434f7{position:relative;display:flex;background:var(--cosmograph-timeline-background);width:100%;min-height:25px;overflow:hidden}.style_module_timelineSvg__b916ad04{position:relative;width:100%;height:100%}.style_module_selection__ebee57f8{fill:var(--cosmograph-timeline-selection-color);fill-opacity:var(--cosmograph-timeline-selection-opacity);stroke:none}.style_module_axisTick__5865631d{color:var(--cosmograph-timeline-axis-color);font:var(--cosmograph-timeline-font-family);font-size:var(--cosmograph-timeline-font-size);user-select:none;-webkit-user-select:none;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum";alignment-baseline:text-before-edge}.style_module_axisLine__992b502d{opacity:.2;color:var(--cosmograph-timeline-axis-color)}.style_module_bar__114fa79f{fill:var(--cosmograph-timeline-bar-color);transform:scaleY(-1);opacity:0}.style_module_animationControl__ee52cd66{color:var(--cosmograph-timeline-axis-color);width:6%;max-width:30px;min-width:20px;cursor:pointer;display:none;align-items:center;user-select:none;-webkit-user-select:none;opacity:.5;position:relative;justify-content:center}.style_module_animationControl__ee52cd66>svg{width:50%;max-height:20px;padding-right:2px}.style_module_hidden__a73fe81a{display:none}.style_module_disabled__eb988570{opacity:.2;pointer-events:none}.style_module_highlightedBar__c2fc9bdc{fill:var(--cosmograph-timeline-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-search-font-family: var(--cosmograph-ui-font-family);--cosmograph-search-font-size: 14px;--cosmograph-search-list-font-size: 13.5px;--cosmograph-search-text-color: var(--cosmograph-ui-text);--cosmograph-search-background: transparent;--cosmograph-search-list-background: rgba(0, 0, 0, .2);--cosmograph-search-list-match-background: rgba(255, 255, 255, .2);--cosmograph-search-list-match-color: var(--cosmograph-ui-text)}.style_module_searchInput__d7830601:hover{filter:brightness(1.2) contrast(1)}.style_module_searchInput__d7830601{width:100%;background:transparent;color:var(--cosmograph-search-text-color);border:none;border-bottom:.5px solid var(--cosmograph-search-text-color);padding:4px 20px 5px 2px;font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:opacity .2s ease-out}.style_module_searchInput__d7830601::selection{background:var(--cosmograph-search-list-match-background)}.style_module_searchInput__d7830601:focus{outline:none}.style_module_searchSuggestions__b0d3f71e{color:#fff;width:100%;padding:0;margin:0;background:transparent;overflow-y:auto;flex:1;min-height:0}.style_module_searchSuggestions__b0d3f71e li{padding:5px 10px;cursor:pointer;-webkit-user-select:none;user-select:none;display:block;font-weight:500;font-size:var(--cosmograph-search-list-font-size);max-width:100%;overflow:hidden}.style_module_searchSuggestions__b0d3f71e li>div{white-space:nowrap;font-weight:200;overflow:hidden;text-overflow:ellipsis;width:100%}.style_module_searchSuggestions__b0d3f71e li:hover{background:#ffffff1a}.style_module_searchSuggestions__b0d3f71e mark{background:var(--cosmograph-search-list-match-background);color:var(--cosmograph-search-list-match-color);border-radius:2px}.style_module_clearButton__5ebb41de{position:absolute;right:0;top:0;height:100%;background:none;border:none;color:var(--cosmograph-search-text-color);font-weight:300;cursor:pointer;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d{opacity:.7}.style_module_placeholderWrapper__72d5eb0e{z-index:1;color:var(--cosmograph-search-text-color);font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);position:absolute;top:0;left:0;width:100%;bottom:0;display:flex;line-height:1.25;align-items:center;transition:transform .3s ease-out,opacity .3s ease-out}.style_module_placeholderWrapper__72d5eb0e.style_module_hidden__acfb8431{transform:translate(-30px);pointer-events:none;opacity:0}.style_module_searchInput__d7830601:disabled,.style_module_searchInput__d7830601.style_module_disabled__62c35dc5{opacity:.2;cursor:not-allowed;pointer-events:none}.style_module_disabled__62c35dc5 .style_module_clearButton__5ebb41de{display:none}.style_module_disabled__62c35dc5 .style_module_placeholderWrapper__72d5eb0e{opacity:.3;cursor:not-allowed}.style_module_searchInputWrapper__1edbcb22{position:relative;display:flex;width:100%}.style_module_noResults__363397c3{opacity:.3!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none}.style_module_noResults__363397c3:hover{background:none}.style_module_loading__296e0212{opacity:.7!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none;-webkit-user-select:none;user-select:none}.style_module_dropdownContainer__d98287da{position:absolute;top:100%;left:0;width:100%;background:var(--cosmograph-search-list-background);border-radius:4px;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);opacity:0;transform:translateY(-10px);transition:opacity .2s ease-out,transform .2s ease-out;pointer-events:none;overflow:hidden;z-index:10;display:flex;flex-direction:column;padding-bottom:2px}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b{top:auto;bottom:100%;transform:translateY(10px)}.style_module_dropdownContainer__d98287da.style_module_visible__5be7493d{opacity:1;transform:translateY(0);pointer-events:auto}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b.style_module_visible__5be7493d{opacity:1;transform:translateY(-2px);pointer-events:auto}.style_module_footerContainer__73e7a066{flex-shrink:0}:root{--cosmograph-scrollbar-background: rgba(255, 255, 255, .1);--cosmograph-ui-background: rgb(45, 49, 58);--cosmograph-ui-text: #ffffffc7;--cosmograph-ui-tick-font-size: 11px;--cosmograph-ui-font-size: 12px;--cosmograph-ui-font-family: inherit;--cosmograph-ui-element-color: #5C616A;--cosmograph-ui-highlighted-element-color: white;--cosmograph-ui-selection-control-color: #8d949ea8;-webkit-font-smoothing:antialiased!important;text-rendering:optimizeLegibility!important}.style_module_cosmograph-ui__5acb97f1{background:var(--cosmograph-ui-background);color:var(--cosmograph-ui-text)}.style_module_scrollbar__f1516254 *::-webkit-scrollbar{width:5px;height:5px;border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-track{border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-corner{background:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-button{display:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-thumb{background-color:var(--cosmograph-scrollbar-background);transition:background-color .5s;border-radius:20px;border:3px solid var(--cosmograph-scrollbar-background)}@-moz-document url-prefix(){.style_module_scrollbar__f1516254 *{scrollbar-width:thin;scrollbar-color:var(--cosmograph-scrollbar-background) transparent;scrollbar-track-color:transparent;scrollbar-face-color:var(--cosmograph-scrollbar-background)}}:root{--cosmograph-histogram-background: var(--cosmograph-ui-background);--cosmograph-histogram-text-color: var(--cosmograph-ui-text);--cosmograph-histogram-axis-color: var(--cosmograph-ui-text);--cosmograph-histogram-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-histogram-selection-opacity: .5;--cosmograph-histogram-bar-color: var(--cosmograph-ui-element-color);--cosmograph-histogram-highlighted-bar-color: var( --cosmograph-ui-highlighted-element-color);--cosmograph-histogram-font-family: var(--cosmograph-ui-font-family);--cosmograph-histogram-font-size: var(--cosmograph-ui-tick-font-size)}.style_module_histogram__9d8a77ea{position:relative;display:flex;min-height:25px;background:var(--cosmograph-histogram-background);width:100%}.style_module_histogramSvg__ccccb628{position:relative;width:100%;height:100%}.style_module_selection__7db96137{fill:var(--cosmograph-histogram-selection-color);fill-opacity:var(--cosmograph-histogram-selection-opacity);stroke:none}.style_module_axisTick__898e1f39{color:var(--cosmograph-histogram-axis-color);font-family:var(--cosmograph-histogram-font-family);font-size:var(--cosmograph-histogram-font-size);user-select:none;-webkit-user-select:none;alignment-baseline:text-before-edge;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum"}.style_module_bar__3c9ab488{fill:var(--cosmograph-histogram-bar-color);transform:scaleY(-1)}.style_module_highlightedBar__b193a8de{fill:var(--cosmograph-histogram-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-bars-font-color: var(--cosmograph-ui-text);--cosmograph-bars-font-family: var(--cosmograph-ui-font-family);--cosmograph-bars-font-size: var(--cosmograph-ui-font-size);--cosmograph-bars-ui-font-size: 11.5px;--cosmograph-bars-background: var(--cosmograph-ui-element-color);--cosmograph-bars-bar-height: 20px;--cosmograph-bars-bar-bottom-margin: 2px;--cosmograph-bars-highlighted-color: var( --cosmograph-ui-highlighted-element-color)}.style_module_bars__25497ded{position:relative;width:100%;min-height:100px;user-select:none;flex-direction:column;-webkit-user-select:none}.style_module_bars__25497ded .scroll-container{position:relative;width:100%;overflow-y:hidden;overflow-x:hidden}.style_module_bars__25497ded .bars-container{position:relative;width:calc(100% - 1px);font-family:var(--cosmograph-bars-font-family)}.style_module_bars__25497ded .highlighted-bars-container{position:absolute;top:0;left:0;pointer-events:none}.style_module_bars__25497ded .row{height:var(--cosmograph-bars-bar-height);display:flex;align-items:center;margin-bottom:var(--cosmograph-bars-bar-bottom-margin);width:100%;transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row:hover{filter:brightness(1.15) contrast(1.05);transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row.unselected:hover{filter:brightness(.95) contrast(1.15);transition:filter .05s linear}.style_module_bars__25497ded .unselected{opacity:.85;filter:brightness(.8) contrast(1.1)}.style_module_bars__25497ded .selected{filter:brightness(1.05) contrast(1.05)}.style_module_bars__25497ded .selected>.info>.label{font-weight:600;filter:brightness(1.1) contrast(1.05)}.style_module_bars__25497ded .unselected>.info>.label{font-weight:300}.style_module_bars__25497ded .bar{height:100%;background-color:var(--cosmograph-bars-background);opacity:.8;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .bar-highlighted{height:100%;background-color:var(--cosmograph-bars-highlighted-color);opacity:.2;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .info{display:flex;justify-content:space-between;width:100%;padding:0 4px;position:absolute;font-size:var(--cosmograph-bars-font-size);font-feature-settings:"tnum";color:var(--cosmograph-bars-font-color);gap:2px}.style_module_bars__25497ded .label{min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;transition:opacity .05s linear}.style_module_bars__25497ded .count{flex-shrink:0;font-weight:300;opacity:.8;transition:opacity .05s linear}.style_module_bars__25497ded .show-more{cursor:pointer;padding-top:2px;display:flex;font-weight:300;color:var(--cosmograph-bars-font-color);font-size:11px;justify-content:space-between;opacity:.6;font-size:var(--cosmograph-bars-ui-font-size);pointer-events:none;transition:opacity .1s linear}.style_module_bars__25497ded .show-more:hover{opacity:1;text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .show-more>span{pointer-events:all}.style_module_bars__25497ded .show-more-count{padding-right:5px;pointer-events:all;font-feature-settings:"tnum"}.style_module_bars__25497ded .unselected>.info>.label,.style_module_bars__25497ded .unselected>.info>.count{opacity:.5}.style_module_bars__25497ded .unselected:hover>.info>.label,.style_module_bars__25497ded .unselected:hover>.info>.count{opacity:1}.style_module_bars__25497ded .search-input{background:transparent;border:none;border-bottom:1px solid rgba(255,255,255,.3);font-size:13px!important;color:var(--cosmograph-bars-font-color);line-height:1.5;padding:2px;width:100%;position:relative;transition:border-bottom-color .2s}.style_module_bars__25497ded .search-input::placeholder{color:var(--cosmograph-bars-font-color)!important;opacity:.4;font-weight:300;font-family:inherit}.style_module_bars__25497ded .search-container{position:relative;width:100%;margin-bottom:4px;display:none;z-index:1}.style_module_bars__25497ded .clear-button{position:absolute;right:0;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--cosmograph-bars-font-color);font-weight:300;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_bars__25497ded .clear-button.visible:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_bars__25497ded .clear-button.visible{opacity:.7}.style_module_bars__25497ded .clear-button svg{width:10px;height:10px;fill:currentColor}.style_module_bars__25497ded .sorting-block{visibility:hidden;margin-top:1px;display:flex;justify-content:space-between}.style_module_bars__25497ded .buttons-container{margin-top:4px;font-size:var(--cosmograph-bars-ui-font-size);display:flex;gap:4px;line-height:1.25}.style_module_bars__25497ded .buttons-container>div{transition:opacity .05s linear,filter .05s linear;padding:1px 5px;background:var(--cosmograph-bars-background);border-radius:4px;opacity:.9;display:flex;cursor:pointer;align-items:center}.style_module_bars__25497ded .buttons-container>div:hover{filter:brightness(1.2)}.style_module_bars__25497ded .reset-text{transition:opacity .05s linear,filter .05s linear;display:flex;font-size:var(--cosmograph-bars-ui-font-size);align-items:end;padding-right:4px;cursor:pointer;font-weight:300}.style_module_bars__25497ded .reset-text:hover{text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .reset-text.unselected{pointer-events:none;cursor:default;opacity:.7}.style_module_bars__25497ded :scope.reset-text:hover:not(.unselected){filter:brightness(1.5);opacity:1}:root{--cosmograph-size-legend-form-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-family: inherit;--cosmograph-size-legend-font-size: var(--cosmograph-ui-font-size);--cosmograph-size-legend-sublabel-font-size: 10px;--cosmograph-size-legend-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-size-legend-line-radius: 2px;--cosmograph-size-legend-line-width: 30px;--cosmograph-size-legend-hide-transform: translateY(100%);--cosmograph-size-legend-show-transform: translateX(0)}.style_module_container__d2889234{display:flex;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;overflow:hidden;min-height:25px}.style_module_legend__75c167f2{width:auto;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-size-legend-font-size);font-family:var(--cosmograph-size-legend-font-family);user-select:none;-webkit-user-select:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.04em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__91eae57a{opacity:1;transform:var(--cosmograph-size-legend-show-transform)}.style_module_disabled__d51f7a10{opacity:0;transform:var(--cosmograph-size-legend-hide-transform);pointer-events:none;display:none!important;min-height:0}@starting-style{.style_module_container__d2889234.style_module_enabled__91eae57a,.style_module_legend__75c167f2.style_module_enabled__91eae57a{opacity:0;transform:var(--cosmograph-size-legend-hide-transform)}}.style_module_legend__75c167f2 .circle{background-color:var(--cosmograph-size-legend-form-color);border-radius:50%;transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2 .line{background-color:var(--cosmograph-size-legend-form-color);border-radius:var(--cosmograph-size-legend-line-radius);width:var(--cosmograph-size-legend-line-width);transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2.style_module_events__894316a8{pointer-events:auto;cursor:pointer}.style_module_legend__75c167f2 .legend-content{display:flex;align-items:end;justify-content:center;gap:.75rem}.style_module_legend__75c167f2 .legend-content>div{transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__75c167f2 .labels-wrapper{white-space:nowrap}.style_module_legend__75c167f2 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-size-legend-items-margin)}.style_module_legend__75c167f2 .name{align-items:center;text-align:center;justify-content:center;display:flex;color:var(--cosmograph-size-legend-font-color);overflow:hidden;width:100%;margin-top:3px;word-break:break-all;white-space:pre-line;transition:color .15s ease-in-out;letter-spacing:-.02em}.style_module_legend__75c167f2 .label{color:var(--cosmograph-size-legend-font-color);overflow:hidden;transition:color .15s ease-in-out;text-overflow:ellipsis;font-feature-settings:"tnum"}.style_module_legend__75c167f2 .sublabel{padding-top:1px;font-size:var(--cosmograph-size-legend-sublabel-font-size);opacity:.5;line-height:1;min-width:10px;transition:color .15s ease-in-out}.style_module_hovered__1206707f .label,.style_module_hovered__1206707f .sublabel{color:var(--cosmograph-size-legend-hover-color);cursor:pointer}.style_module_hovered__1206707f .circle,.style_module_hovered__1206707f .line{background-color:var(--cosmograph-size-legend-hover-color);cursor:pointer}:root{--cosmograph-color-legend-range-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-range-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-range-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-label-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-sublabel-font-size: 10px;--cosmograph-color-legend-range-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-range-gradient-height: 6px;--cosmograph-color-legend-range-gradient-radius: 8px;--cosmograph-color-legend-range-gradient-top-margin: 6px;--cosmograph-color-legend-hide-transform: translateY(100%);--cosmograph-color-legend-show-transform: translateX(0)}.style_module_container__05cc807d{display:flex;min-width:150px;min-height:25px;width:100%;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_legend__a3e235e4{width:100%;font-weight:300;letter-spacing:-.04em;display:flex;flex-direction:column;font-size:var(--cosmograph-color-legend-range-font-size);font-family:var(--cosmograph-color-legend-range-font-family);user-select:none;-webkit-user-select:none;pointer-events:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__b3120e27{opacity:1;transform:var(--cosmograph-color-legend-show-transform);pointer-events:auto}.style_module_disabled__c2dc158c{opacity:0;transform:var(--cosmograph-color-legend-hide-transform);pointer-events:none;display:none;min-height:0}@starting-style{.style_module_container__05cc807d.style_module_enabled__b3120e27,.style_module_legend__a3e235e4.style_module_enabled__b3120e27{opacity:0;transform:var(--cosmograph-color-legend-hide-transform)}}.style_module_legend__a3e235e4 .legend-content{display:flex;align-items:end;justify-content:space-between}.style_module_hovered__dfd7bb2c .label,.style_module_hovered__dfd7bb2c .sublabel{color:var(--cosmograph-size-legend-hover-color)!important;cursor:pointer}.style_module_legend__a3e235e4 .extent{white-space:nowrap;transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__a3e235e4 .gradient{width:100%;margin-top:var(--cosmograph-color-legend-range-gradient-top-margin);height:var(--cosmograph-color-legend-range-gradient-height);border-radius:var(--cosmograph-color-legend-range-gradient-radius)}.style_module_legend__a3e235e4 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-color-legend-range-items-margin)}.style_module_legend__a3e235e4 .name{align-items:center;text-align:center;justify-content:space-around;display:flex;color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;width:100%;word-break:break-word;text-wrap:balance;white-space:pre-line;transition:color .15s ease-in-out;margin:0 4px;letter-spacing:-.02em;line-height:1.25}.style_module_legend__a3e235e4 .label{color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;max-width:150px;text-overflow:ellipsis;font-size:var(--cosmograph-color-legend-range-label-font-size);transition:color .15s ease-in-out;line-height:1;font-feature-settings:"tnum"}.style_module_legend__a3e235e4 .sublabel{padding-top:1px;color:var(--cosmograph-color-legend-range-font-color);opacity:.55;font-size:var(--cosmograph-color-legend-range-sublabel-font-size);line-height:1;transition:color .15s ease-in-out}:root{--cosmograph-color-legend-type-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-type-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-type-font-size: 11px;--cosmograph-color-legend-type-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-type-others-color: #bab0ab;--cosmograph-color-legend-type-bullet-size: 8px;--cosmograph-color-legend-type-bullet-radius: 1rem;--cosmograph-color-legend-type-items-margin: 4px;--cosmograph-color-legend-type-hide-transform: translateY(125%);--cosmograph-color-legend-type-show-transform: translateX(0)}.style_module_enabled__277b2403{opacity:1;transform:var(--cosmograph-color-legend-type-show-transform)}.style_module_disabled__7a587f96{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform);display:none!important;min-height:0}.style_module_wrapper__ea8ca7f4{position:relative;max-width:100%;width:fit-content;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_typeLegend__15bf4b2f{position:relative;width:fit-content;max-width:100%;min-height:25px;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.015em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_typeLegend__15bf4b2f .reverted{flex-direction:row-reverse}.style_module_typeLegend__15bf4b2f .scroll-container{width:100%;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-color-legend-type-font-size);font-family:var(--cosmograph-color-legend-type-font-family);user-select:none;-webkit-user-select:none;line-height:normal;overflow-x:hidden;overflow-y:auto;will-change:transform}@starting-style{.style_module_typeLegend__15bf4b2f.style_module_enabled__277b2403,.style_module_wrapper__ea8ca7f4.style_module_enabled__277b2403{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform)}}.style_module_typeLegend__15bf4b2f .legend-item{display:flex;align-items:center;position:absolute;margin-bottom:var(--cosmograph-color-legend-type-items-margin);pointer-events:none;width:100%;padding-left:1px;font-weight:300;transition:filter .1s ease-in-out,opacity .1s ease-in-out;min-height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px + var(--cosmograph-color-legend-type-items-margin));height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px);box-sizing:border-box}.style_module_typeLegend__15bf4b2f .unknown{background-color:var(--cosmograph-color-legend-type-unknown-color)}.style_module_typeLegend__15bf4b2f .others{background-color:var(--cosmograph-color-legend-type-others-color)}.style_module_typeLegend__15bf4b2f .bullet{height:var(--cosmograph-color-legend-type-bullet-size);width:var(--cosmograph-color-legend-type-bullet-size);min-height:var(--cosmograph-color-legend-type-bullet-size);min-width:var(--cosmograph-color-legend-type-bullet-size);border-radius:var(--cosmograph-color-legend-type-bullet-radius);pointer-events:all;margin-right:5px}.style_module_typeLegend__15bf4b2f .label{color:var(--cosmograph-color-legend-type-font-color);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - var(--cosmograph-color-legend-type-bullet-size) - 5px);pointer-events:all;transition:.05s linear color}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.bullet{margin-right:0}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.label{margin-right:5px}.style_module_typeLegend__15bf4b2f .show-more{cursor:pointer;padding-top:4px;display:none;font-weight:300;color:var(--cosmograph-color-legend-type-font-color);font-size:11px;opacity:.6;pointer-events:all;justify-content:space-between;transition:opacity .1s linear;font-feature-settings:"tnum"}.style_module_typeLegend__15bf4b2f .show-more:hover{opacity:1}.style_module_hovered__c0993502 .label,.style_module_hovered__c0993502 .sublabel{color:var(--cosmograph-color-legend-type-hover-color)!important;cursor:pointer}.style_module_selected__36e1dd81{filter:brightness(1)}.style_module_selected__36e1dd81>.style_module_label__afecc7a3{filter:brightness(1.2)}.style_module_unselected__4826cfb7{filter:brightness(.5)}.style_module_typeLegend__15bf4b2f .name{font-size:calc(var(--cosmograph-color-legend-type-font-size) + 1px);font-family:var(--cosmograph-color-legend-type-font-family);color:var(--cosmograph-color-legend-type-font-color);transition:color .15s ease-in-out,opacity .3s ease-in-out,max-height .3s ease-in-out,transform .3s ease-in-out;margin-bottom:4px;margin-top:2px;margin-left:1px;letter-spacing:-.02em;line-height:1.25;overflow:hidden;width:100%;white-space:nowrap;text-overflow:ellipsis;pointer-events:all;-webkit-user-select:none!important;user-select:none!important;max-height:100px;opacity:1;transform:translateY(0)}.style_module_typeLegend__15bf4b2f .name.hidden{opacity:0;max-height:0;margin-bottom:0;margin-top:0;transform:translateY(-10px)}:root{--cosmograph-button-color: var(--cosmograph-ui-text);--cosmograph-button-background: var(--cosmograph-ui-element-color);--cosmograph-button-border-radius: 2px}.style_module_button__e95a1138{background:var(--cosmograph-button-background);color:var(--cosmograph-button-color);border-radius:var(--cosmograph-button-border-radius);display:none;align-items:center;justify-content:center;width:25px;height:25px;margin:3px;padding:5px;cursor:pointer;filter:brightness(.95) contrast(.9);transition:filter .1s}.style_module_button__e95a1138:hover{filter:brightness(1.2) contrast(1)}')),document.head.appendChild(e)}}catch(Xn){}}();const pG="style_module_scrollbar__f1516254";!function(){try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('@keyframes style_module_fadeIn__ffac87fd{0%{opacity:0}to{opacity:.2}}.style_module_displayState__6ae19b84{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:var(--cosmograph-ui-text);display:flex;justify-content:center;align-items:center;min-width:100px;opacity:.2;font-size:calc(var(--cosmograph-ui-font-size) + 1px);letter-spacing:-.02em;font-weight:200;user-select:none;-webkit-user-select:none;animation:style_module_fadeIn__ffac87fd .3s ease-in-out}:root{--cosmograph-timeline-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-timeline-selection-opacity: .5;--cosmograph-timeline-bar-color: var(--cosmograph-ui-element-color);--cosmograph-timeline-highlighted-bar-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-timeline-font-family: var(--cosmograph-ui-font-family);--cosmograph-timeline-font-size: var(--cosmograph-ui-tick-font-size);--cosmograph-timeline-background: var(--cosmograph-ui-background);--cosmograph-timeline-text-color: var(--cosmograph-ui-text);--cosmograph-timeline-axis-color: var(--cosmograph-ui-text)}.style_module_timeline__736434f7{position:relative;display:flex;background:var(--cosmograph-timeline-background);width:100%;min-height:25px;overflow:hidden}.style_module_timelineSvg__b916ad04{position:relative;width:100%;height:100%}.style_module_selection__ebee57f8{fill:var(--cosmograph-timeline-selection-color);fill-opacity:var(--cosmograph-timeline-selection-opacity);stroke:none}.style_module_axisTick__5865631d{color:var(--cosmograph-timeline-axis-color);font:var(--cosmograph-timeline-font-family);font-size:var(--cosmograph-timeline-font-size);user-select:none;-webkit-user-select:none;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum";alignment-baseline:text-before-edge}.style_module_axisLine__992b502d{opacity:.2;color:var(--cosmograph-timeline-axis-color)}.style_module_bar__114fa79f{fill:var(--cosmograph-timeline-bar-color);transform:scaleY(-1);opacity:0}.style_module_animationControl__ee52cd66{color:var(--cosmograph-timeline-axis-color);width:6%;max-width:30px;min-width:20px;cursor:pointer;display:none;align-items:center;user-select:none;-webkit-user-select:none;opacity:.5;position:relative;justify-content:center}.style_module_animationControl__ee52cd66>svg{width:50%;max-height:20px;padding-right:2px}.style_module_hidden__a73fe81a{display:none}.style_module_disabled__eb988570{opacity:.2;pointer-events:none}.style_module_highlightedBar__c2fc9bdc{fill:var(--cosmograph-timeline-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-search-font-family: var(--cosmograph-ui-font-family);--cosmograph-search-font-size: 14px;--cosmograph-search-list-font-size: 13.5px;--cosmograph-search-text-color: var(--cosmograph-ui-text);--cosmograph-search-background: transparent;--cosmograph-search-list-background: rgba(0, 0, 0, .2);--cosmograph-search-list-match-background: rgba(255, 255, 255, .2);--cosmograph-search-list-match-color: var(--cosmograph-ui-text)}.style_module_searchInput__d7830601:hover{filter:brightness(1.2) contrast(1)}.style_module_searchInput__d7830601{width:100%;background:transparent;color:var(--cosmograph-search-text-color);border:none;border-bottom:.5px solid var(--cosmograph-search-text-color);padding:4px 20px 5px 2px;font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:opacity .2s ease-out}.style_module_searchInput__d7830601::selection{background:var(--cosmograph-search-list-match-background)}.style_module_searchInput__d7830601:focus{outline:none}.style_module_searchSuggestions__b0d3f71e{color:#fff;width:100%;padding:0;margin:0;background:transparent;overflow-y:auto;flex:1;min-height:0}.style_module_searchSuggestions__b0d3f71e li{padding:5px 10px;cursor:pointer;-webkit-user-select:none;user-select:none;display:block;font-weight:500;font-size:var(--cosmograph-search-list-font-size);max-width:100%;overflow:hidden}.style_module_searchSuggestions__b0d3f71e li>div{white-space:nowrap;font-weight:200;overflow:hidden;text-overflow:ellipsis;width:100%}.style_module_searchSuggestions__b0d3f71e li:hover{background:#ffffff1a}.style_module_searchSuggestions__b0d3f71e mark{background:var(--cosmograph-search-list-match-background);color:var(--cosmograph-search-list-match-color);border-radius:2px}.style_module_clearButton__5ebb41de{position:absolute;right:0;top:0;height:100%;background:none;border:none;color:var(--cosmograph-search-text-color);font-weight:300;cursor:pointer;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d{opacity:.7}.style_module_placeholderWrapper__72d5eb0e{z-index:1;color:var(--cosmograph-search-text-color);font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);position:absolute;top:0;left:0;width:100%;bottom:0;display:flex;line-height:1.25;align-items:center;transition:transform .3s ease-out,opacity .3s ease-out}.style_module_placeholderWrapper__72d5eb0e.style_module_hidden__acfb8431{transform:translate(-30px);pointer-events:none;opacity:0}.style_module_searchInput__d7830601:disabled,.style_module_searchInput__d7830601.style_module_disabled__62c35dc5{opacity:.2;cursor:not-allowed;pointer-events:none}.style_module_disabled__62c35dc5 .style_module_clearButton__5ebb41de{display:none}.style_module_disabled__62c35dc5 .style_module_placeholderWrapper__72d5eb0e{opacity:.3;cursor:not-allowed}.style_module_searchInputWrapper__1edbcb22{position:relative;display:flex;width:100%}.style_module_noResults__363397c3{opacity:.3!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none}.style_module_noResults__363397c3:hover{background:none}.style_module_loading__296e0212{opacity:.7!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none;-webkit-user-select:none;user-select:none}.style_module_dropdownContainer__d98287da{position:absolute;top:100%;left:0;width:100%;background:var(--cosmograph-search-list-background);border-radius:4px;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);opacity:0;transform:translateY(-10px);transition:opacity .2s ease-out,transform .2s ease-out;pointer-events:none;overflow:hidden;z-index:10;display:flex;flex-direction:column;padding-bottom:2px}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b{top:auto;bottom:100%;transform:translateY(10px)}.style_module_dropdownContainer__d98287da.style_module_visible__5be7493d{opacity:1;transform:translateY(0);pointer-events:auto}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b.style_module_visible__5be7493d{opacity:1;transform:translateY(-2px);pointer-events:auto}.style_module_footerContainer__73e7a066{flex-shrink:0}:root{--cosmograph-scrollbar-background: rgba(255, 255, 255, .1);--cosmograph-ui-background: rgb(45, 49, 58);--cosmograph-ui-text: #ffffffc7;--cosmograph-ui-tick-font-size: 11px;--cosmograph-ui-font-size: 12px;--cosmograph-ui-font-family: inherit;--cosmograph-ui-element-color: #5C616A;--cosmograph-ui-highlighted-element-color: white;--cosmograph-ui-selection-control-color: #8d949ea8;-webkit-font-smoothing:antialiased!important;text-rendering:optimizeLegibility!important}.style_module_cosmograph-ui__5acb97f1{background:var(--cosmograph-ui-background);color:var(--cosmograph-ui-text)}.style_module_scrollbar__f1516254 *::-webkit-scrollbar{width:5px;height:5px;border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-track{border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-corner{background:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-button{display:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-thumb{background-color:var(--cosmograph-scrollbar-background);transition:background-color .5s;border-radius:20px;border:3px solid var(--cosmograph-scrollbar-background)}@-moz-document url-prefix(){.style_module_scrollbar__f1516254 *{scrollbar-width:thin;scrollbar-color:var(--cosmograph-scrollbar-background) transparent;scrollbar-track-color:transparent;scrollbar-face-color:var(--cosmograph-scrollbar-background)}}:root{--cosmograph-histogram-background: var(--cosmograph-ui-background);--cosmograph-histogram-text-color: var(--cosmograph-ui-text);--cosmograph-histogram-axis-color: var(--cosmograph-ui-text);--cosmograph-histogram-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-histogram-selection-opacity: .5;--cosmograph-histogram-bar-color: var(--cosmograph-ui-element-color);--cosmograph-histogram-highlighted-bar-color: var( --cosmograph-ui-highlighted-element-color);--cosmograph-histogram-font-family: var(--cosmograph-ui-font-family);--cosmograph-histogram-font-size: var(--cosmograph-ui-tick-font-size)}.style_module_histogram__9d8a77ea{position:relative;display:flex;min-height:25px;background:var(--cosmograph-histogram-background);width:100%}.style_module_histogramSvg__ccccb628{position:relative;width:100%;height:100%}.style_module_selection__7db96137{fill:var(--cosmograph-histogram-selection-color);fill-opacity:var(--cosmograph-histogram-selection-opacity);stroke:none}.style_module_axisTick__898e1f39{color:var(--cosmograph-histogram-axis-color);font-family:var(--cosmograph-histogram-font-family);font-size:var(--cosmograph-histogram-font-size);user-select:none;-webkit-user-select:none;alignment-baseline:text-before-edge;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum"}.style_module_bar__3c9ab488{fill:var(--cosmograph-histogram-bar-color);transform:scaleY(-1)}.style_module_highlightedBar__b193a8de{fill:var(--cosmograph-histogram-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-bars-font-color: var(--cosmograph-ui-text);--cosmograph-bars-font-family: var(--cosmograph-ui-font-family);--cosmograph-bars-font-size: var(--cosmograph-ui-font-size);--cosmograph-bars-ui-font-size: 11.5px;--cosmograph-bars-background: var(--cosmograph-ui-element-color);--cosmograph-bars-bar-height: 20px;--cosmograph-bars-bar-bottom-margin: 2px;--cosmograph-bars-highlighted-color: var( --cosmograph-ui-highlighted-element-color)}.style_module_bars__25497ded{position:relative;width:100%;min-height:100px;user-select:none;flex-direction:column;-webkit-user-select:none}.style_module_bars__25497ded .scroll-container{position:relative;width:100%;overflow-y:hidden;overflow-x:hidden}.style_module_bars__25497ded .bars-container{position:relative;width:calc(100% - 1px);font-family:var(--cosmograph-bars-font-family)}.style_module_bars__25497ded .highlighted-bars-container{position:absolute;top:0;left:0;pointer-events:none}.style_module_bars__25497ded .row{height:var(--cosmograph-bars-bar-height);display:flex;align-items:center;margin-bottom:var(--cosmograph-bars-bar-bottom-margin);width:100%;transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row:hover{filter:brightness(1.15) contrast(1.05);transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row.unselected:hover{filter:brightness(.95) contrast(1.15);transition:filter .05s linear}.style_module_bars__25497ded .unselected{opacity:.85;filter:brightness(.8) contrast(1.1)}.style_module_bars__25497ded .selected{filter:brightness(1.05) contrast(1.05)}.style_module_bars__25497ded .selected>.info>.label{font-weight:600;filter:brightness(1.1) contrast(1.05)}.style_module_bars__25497ded .unselected>.info>.label{font-weight:300}.style_module_bars__25497ded .bar{height:100%;background-color:var(--cosmograph-bars-background);opacity:.8;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .bar-highlighted{height:100%;background-color:var(--cosmograph-bars-highlighted-color);opacity:.2;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .info{display:flex;justify-content:space-between;width:100%;padding:0 4px;position:absolute;font-size:var(--cosmograph-bars-font-size);font-feature-settings:"tnum";color:var(--cosmograph-bars-font-color);gap:2px}.style_module_bars__25497ded .label{min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;transition:opacity .05s linear}.style_module_bars__25497ded .count{flex-shrink:0;font-weight:300;opacity:.8;transition:opacity .05s linear}.style_module_bars__25497ded .show-more{cursor:pointer;padding-top:2px;display:flex;font-weight:300;color:var(--cosmograph-bars-font-color);font-size:11px;justify-content:space-between;opacity:.6;font-size:var(--cosmograph-bars-ui-font-size);pointer-events:none;transition:opacity .1s linear}.style_module_bars__25497ded .show-more:hover{opacity:1;text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .show-more>span{pointer-events:all}.style_module_bars__25497ded .show-more-count{padding-right:5px;pointer-events:all;font-feature-settings:"tnum"}.style_module_bars__25497ded .unselected>.info>.label,.style_module_bars__25497ded .unselected>.info>.count{opacity:.5}.style_module_bars__25497ded .unselected:hover>.info>.label,.style_module_bars__25497ded .unselected:hover>.info>.count{opacity:1}.style_module_bars__25497ded .search-input{background:transparent;border:none;border-bottom:1px solid rgba(255,255,255,.3);font-size:13px!important;color:var(--cosmograph-bars-font-color);line-height:1.5;padding:2px;width:100%;position:relative;transition:border-bottom-color .2s}.style_module_bars__25497ded .search-input::placeholder{color:var(--cosmograph-bars-font-color)!important;opacity:.4;font-weight:300;font-family:inherit}.style_module_bars__25497ded .search-container{position:relative;width:100%;margin-bottom:4px;display:none;z-index:1}.style_module_bars__25497ded .clear-button{position:absolute;right:0;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--cosmograph-bars-font-color);font-weight:300;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_bars__25497ded .clear-button.visible:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_bars__25497ded .clear-button.visible{opacity:.7}.style_module_bars__25497ded .clear-button svg{width:10px;height:10px;fill:currentColor}.style_module_bars__25497ded .sorting-block{visibility:hidden;margin-top:1px;display:flex;justify-content:space-between}.style_module_bars__25497ded .buttons-container{margin-top:4px;font-size:var(--cosmograph-bars-ui-font-size);display:flex;gap:4px;line-height:1.25}.style_module_bars__25497ded .buttons-container>div{transition:opacity .05s linear,filter .05s linear;padding:1px 5px;background:var(--cosmograph-bars-background);border-radius:4px;opacity:.9;display:flex;cursor:pointer;align-items:center}.style_module_bars__25497ded .buttons-container>div:hover{filter:brightness(1.2)}.style_module_bars__25497ded .reset-text{transition:opacity .05s linear,filter .05s linear;display:flex;font-size:var(--cosmograph-bars-ui-font-size);align-items:end;padding-right:4px;cursor:pointer;font-weight:300}.style_module_bars__25497ded .reset-text:hover{text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .reset-text.unselected{pointer-events:none;cursor:default;opacity:.7}.style_module_bars__25497ded :scope.reset-text:hover:not(.unselected){filter:brightness(1.5);opacity:1}:root{--cosmograph-size-legend-form-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-family: inherit;--cosmograph-size-legend-font-size: var(--cosmograph-ui-font-size);--cosmograph-size-legend-sublabel-font-size: 10px;--cosmograph-size-legend-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-size-legend-line-radius: 2px;--cosmograph-size-legend-line-width: 30px;--cosmograph-size-legend-hide-transform: translateY(100%);--cosmograph-size-legend-show-transform: translateX(0)}.style_module_container__d2889234{display:flex;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;overflow:hidden;min-height:25px}.style_module_legend__75c167f2{width:auto;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-size-legend-font-size);font-family:var(--cosmograph-size-legend-font-family);user-select:none;-webkit-user-select:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.04em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__91eae57a{opacity:1;transform:var(--cosmograph-size-legend-show-transform)}.style_module_disabled__d51f7a10{opacity:0;transform:var(--cosmograph-size-legend-hide-transform);pointer-events:none;display:none!important;min-height:0}@starting-style{.style_module_container__d2889234.style_module_enabled__91eae57a,.style_module_legend__75c167f2.style_module_enabled__91eae57a{opacity:0;transform:var(--cosmograph-size-legend-hide-transform)}}.style_module_legend__75c167f2 .circle{background-color:var(--cosmograph-size-legend-form-color);border-radius:50%;transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2 .line{background-color:var(--cosmograph-size-legend-form-color);border-radius:var(--cosmograph-size-legend-line-radius);width:var(--cosmograph-size-legend-line-width);transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2.style_module_events__894316a8{pointer-events:auto;cursor:pointer}.style_module_legend__75c167f2 .legend-content{display:flex;align-items:end;justify-content:center;gap:.75rem}.style_module_legend__75c167f2 .legend-content>div{transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__75c167f2 .labels-wrapper{white-space:nowrap}.style_module_legend__75c167f2 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-size-legend-items-margin)}.style_module_legend__75c167f2 .name{align-items:center;text-align:center;justify-content:center;display:flex;color:var(--cosmograph-size-legend-font-color);overflow:hidden;width:100%;margin-top:3px;word-break:break-all;white-space:pre-line;transition:color .15s ease-in-out;letter-spacing:-.02em}.style_module_legend__75c167f2 .label{color:var(--cosmograph-size-legend-font-color);overflow:hidden;transition:color .15s ease-in-out;text-overflow:ellipsis;font-feature-settings:"tnum"}.style_module_legend__75c167f2 .sublabel{padding-top:1px;font-size:var(--cosmograph-size-legend-sublabel-font-size);opacity:.5;line-height:1;min-width:10px;transition:color .15s ease-in-out}.style_module_hovered__1206707f .label,.style_module_hovered__1206707f .sublabel{color:var(--cosmograph-size-legend-hover-color);cursor:pointer}.style_module_hovered__1206707f .circle,.style_module_hovered__1206707f .line{background-color:var(--cosmograph-size-legend-hover-color);cursor:pointer}:root{--cosmograph-color-legend-range-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-range-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-range-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-label-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-sublabel-font-size: 10px;--cosmograph-color-legend-range-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-range-gradient-height: 6px;--cosmograph-color-legend-range-gradient-radius: 8px;--cosmograph-color-legend-range-gradient-top-margin: 6px;--cosmograph-color-legend-hide-transform: translateY(100%);--cosmograph-color-legend-show-transform: translateX(0)}.style_module_container__05cc807d{display:flex;min-width:150px;min-height:25px;width:100%;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_legend__a3e235e4{width:100%;font-weight:300;letter-spacing:-.04em;display:flex;flex-direction:column;font-size:var(--cosmograph-color-legend-range-font-size);font-family:var(--cosmograph-color-legend-range-font-family);user-select:none;-webkit-user-select:none;pointer-events:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__b3120e27{opacity:1;transform:var(--cosmograph-color-legend-show-transform);pointer-events:auto}.style_module_disabled__c2dc158c{opacity:0;transform:var(--cosmograph-color-legend-hide-transform);pointer-events:none;display:none;min-height:0}@starting-style{.style_module_container__05cc807d.style_module_enabled__b3120e27,.style_module_legend__a3e235e4.style_module_enabled__b3120e27{opacity:0;transform:var(--cosmograph-color-legend-hide-transform)}}.style_module_legend__a3e235e4 .legend-content{display:flex;align-items:end;justify-content:space-between}.style_module_hovered__dfd7bb2c .label,.style_module_hovered__dfd7bb2c .sublabel{color:var(--cosmograph-size-legend-hover-color)!important;cursor:pointer}.style_module_legend__a3e235e4 .extent{white-space:nowrap;transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__a3e235e4 .gradient{width:100%;margin-top:var(--cosmograph-color-legend-range-gradient-top-margin);height:var(--cosmograph-color-legend-range-gradient-height);border-radius:var(--cosmograph-color-legend-range-gradient-radius)}.style_module_legend__a3e235e4 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-color-legend-range-items-margin)}.style_module_legend__a3e235e4 .name{align-items:center;text-align:center;justify-content:space-around;display:flex;color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;width:100%;word-break:break-word;text-wrap:balance;white-space:pre-line;transition:color .15s ease-in-out;margin:0 4px;letter-spacing:-.02em;line-height:1.25}.style_module_legend__a3e235e4 .label{color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;max-width:150px;text-overflow:ellipsis;font-size:var(--cosmograph-color-legend-range-label-font-size);transition:color .15s ease-in-out;line-height:1;font-feature-settings:"tnum"}.style_module_legend__a3e235e4 .sublabel{padding-top:1px;color:var(--cosmograph-color-legend-range-font-color);opacity:.55;font-size:var(--cosmograph-color-legend-range-sublabel-font-size);line-height:1;transition:color .15s ease-in-out}:root{--cosmograph-color-legend-type-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-type-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-type-font-size: 11px;--cosmograph-color-legend-type-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-type-others-color: #bab0ab;--cosmograph-color-legend-type-bullet-size: 8px;--cosmograph-color-legend-type-bullet-radius: 1rem;--cosmograph-color-legend-type-items-margin: 4px;--cosmograph-color-legend-type-hide-transform: translateY(125%);--cosmograph-color-legend-type-show-transform: translateX(0)}.style_module_enabled__277b2403{opacity:1;transform:var(--cosmograph-color-legend-type-show-transform)}.style_module_disabled__7a587f96{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform);display:none!important;min-height:0}.style_module_wrapper__ea8ca7f4{position:relative;max-width:100%;width:fit-content;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_typeLegend__15bf4b2f{position:relative;width:fit-content;max-width:100%;min-height:25px;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.015em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_typeLegend__15bf4b2f .reverted{flex-direction:row-reverse}.style_module_typeLegend__15bf4b2f .scroll-container{width:100%;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-color-legend-type-font-size);font-family:var(--cosmograph-color-legend-type-font-family);user-select:none;-webkit-user-select:none;line-height:normal;overflow-x:hidden;overflow-y:auto;will-change:transform}@starting-style{.style_module_typeLegend__15bf4b2f.style_module_enabled__277b2403,.style_module_wrapper__ea8ca7f4.style_module_enabled__277b2403{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform)}}.style_module_typeLegend__15bf4b2f .legend-item{display:flex;align-items:center;position:absolute;margin-bottom:var(--cosmograph-color-legend-type-items-margin);pointer-events:none;width:100%;padding-left:1px;font-weight:300;transition:filter .1s ease-in-out,opacity .1s ease-in-out;min-height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px + var(--cosmograph-color-legend-type-items-margin));height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px);box-sizing:border-box}.style_module_typeLegend__15bf4b2f .unknown{background-color:var(--cosmograph-color-legend-type-unknown-color)}.style_module_typeLegend__15bf4b2f .others{background-color:var(--cosmograph-color-legend-type-others-color)}.style_module_typeLegend__15bf4b2f .bullet{height:var(--cosmograph-color-legend-type-bullet-size);width:var(--cosmograph-color-legend-type-bullet-size);min-height:var(--cosmograph-color-legend-type-bullet-size);min-width:var(--cosmograph-color-legend-type-bullet-size);border-radius:var(--cosmograph-color-legend-type-bullet-radius);pointer-events:all;margin-right:5px}.style_module_typeLegend__15bf4b2f .label{color:var(--cosmograph-color-legend-type-font-color);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - var(--cosmograph-color-legend-type-bullet-size) - 5px);pointer-events:all;transition:.05s linear color}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.bullet{margin-right:0}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.label{margin-right:5px}.style_module_typeLegend__15bf4b2f .show-more{cursor:pointer;padding-top:4px;display:none;font-weight:300;color:var(--cosmograph-color-legend-type-font-color);font-size:11px;opacity:.6;pointer-events:all;justify-content:space-between;transition:opacity .1s linear;font-feature-settings:"tnum"}.style_module_typeLegend__15bf4b2f .show-more:hover{opacity:1}.style_module_hovered__c0993502 .label,.style_module_hovered__c0993502 .sublabel{color:var(--cosmograph-color-legend-type-hover-color)!important;cursor:pointer}.style_module_selected__36e1dd81{filter:brightness(1)}.style_module_selected__36e1dd81>.style_module_label__afecc7a3{filter:brightness(1.2)}.style_module_unselected__4826cfb7{filter:brightness(.5)}.style_module_typeLegend__15bf4b2f .name{font-size:calc(var(--cosmograph-color-legend-type-font-size) + 1px);font-family:var(--cosmograph-color-legend-type-font-family);color:var(--cosmograph-color-legend-type-font-color);transition:color .15s ease-in-out,opacity .3s ease-in-out,max-height .3s ease-in-out,transform .3s ease-in-out;margin-bottom:4px;margin-top:2px;margin-left:1px;letter-spacing:-.02em;line-height:1.25;overflow:hidden;width:100%;white-space:nowrap;text-overflow:ellipsis;pointer-events:all;-webkit-user-select:none!important;user-select:none!important;max-height:100px;opacity:1;transform:translateY(0)}.style_module_typeLegend__15bf4b2f .name.hidden{opacity:0;max-height:0;margin-bottom:0;margin-top:0;transform:translateY(-10px)}:root{--cosmograph-button-color: var(--cosmograph-ui-text);--cosmograph-button-background: var(--cosmograph-ui-element-color);--cosmograph-button-border-radius: 2px}.style_module_button__e95a1138{background:var(--cosmograph-button-background);color:var(--cosmograph-button-color);border-radius:var(--cosmograph-button-border-radius);display:none;align-items:center;justify-content:center;width:25px;height:25px;margin:3px;padding:5px;cursor:pointer;filter:brightness(.95) contrast(.9);transition:filter .1s}.style_module_button__e95a1138:hover{filter:brightness(1.2) contrast(1)}')),document.head.appendChild(e)}}catch(Xn){}}();var mG=Object.defineProperty,gG=(e,t,n)=>((e,t,n)=>t in e?mG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);let _G=class{constructor(e,t){gG(this,"_container"),gG(this,"_inputElement"),gG(this,"_suggestionList"),gG(this,"_dropdownContainer"),gG(this,"_footerContainer",null),gG(this,"_clearButton"),gG(this,"_config"),gG(this,"_debounceTimeout"),gG(this,"_placeholderElement",null),gG(this,"_handleFocus"),gG(this,"_handleBlur"),gG(this,"_handleClearClick"),gG(this,"_handleMouseDown"),this._container=e,this._container.classList.add(pG),this._config=R$(cG,t??{});const n=document.createElement("div");n.className="style_module_searchInputWrapper__1edbcb22",this._container.appendChild(n),this._inputElement=document.createElement("input"),this._inputElement.className=this._config.inputClassName??"style_module_searchInput__d7830601",n.appendChild(this._inputElement),this._createPlaceholderElement(),this._handleFocus=()=>this._updatePlaceholderVisibility(),this._handleBlur=()=>this._updatePlaceholderVisibility(),this._handleClearClick=()=>this.clearInput(),this._inputElement.addEventListener("focus",this._handleFocus),this._inputElement.addEventListener("blur",this._handleBlur),this._clearButton=document.createElement("button"),this._clearButton.className="style_module_clearButton__5ebb41de",this._clearButton.innerHTML="",this._clearButton.addEventListener("click",this._handleClearClick),n.appendChild(this._clearButton),this._dropdownContainer=document.createElement("div"),this._dropdownContainer.className="style_module_dropdownContainer__d98287da",this._config.openListUpwards&&this._dropdownContainer.classList.add(fG),n.appendChild(this._dropdownContainer),this._suggestionList=document.createElement("ul"),this._suggestionList.classList.add(this._config.suggestionListClassName??"style_module_searchSuggestions__b0d3f71e"),this._dropdownContainer.appendChild(this._suggestionList),this._footerContainer=document.createElement("div"),this._footerContainer.className="style_module_footerContainer__73e7a066",this._dropdownContainer.appendChild(this._footerContainer),this._handleKeyDown=this._handleKeyDown.bind(this),this._handleInput=this._handleInput.bind(this),this._inputElement.addEventListener("input",this._handleInput),this._inputElement.addEventListener("keydown",this._handleKeyDown),this._config.disabled&&this.setDisabled(!0)}get suggestionList(){return this._suggestionList}get dropdownContainer(){return this._dropdownContainer}_handleInput(e){if(this._config.disabled)return;const t=this._inputElement.value;t?this._clearButton.classList.add(uG):this._clearButton.classList.remove(uG),this._updatePlaceholderVisibility(),this._debounceTimeout&&window.clearTimeout(this._debounceTimeout),t.length>=(this._config.minSearchLength??0)&&this._renderLoading(),this._debounceTimeout=window.setTimeout(async()=>{const n=await this._performSearch(t);this._config.onInput&&this._config.onInput(t,n,e),this._renderSuggestions(n)},this._config.debounceTime??300)}async _handleKeyDown(e){if(!this._config.disabled&&"Enter"===e.key){const e=this._inputElement.value;this._renderLoading();const t=await this._performSearch(e);this._config.onEnter&&this._config.onEnter(e,t),this._renderSuggestions(t)}}_createPlaceholderElement(){var e;if(this._config.placeholderRenderer){const t=this._config.placeholderRenderer;t instanceof HTMLElement?(this._placeholderElement=document.createElement("div"),this._placeholderElement.className="style_module_placeholderWrapper__72d5eb0e",this._handleMouseDown=e=>{if(this._config.disabled)return void e.preventDefault();let t=e.target;for(;t&&t!==this._placeholderElement;){if("true"===t.dataset.ignoreFocus)return void e.preventDefault();t=t.parentElement}},this._placeholderElement.addEventListener("mousedown",this._handleMouseDown),this._placeholderElement.appendChild(t),null==(e=this._inputElement.parentNode)||e.insertBefore(this._placeholderElement,this._inputElement)):this._inputElement.placeholder=t}this._updatePlaceholderVisibility()}_updatePlaceholderVisibility(){this._placeholderElement&&(this._inputElement.value||document.activeElement===this._inputElement?this._placeholderElement.classList.add(dG):this._placeholderElement.classList.remove(dG))}_createSuggestionElement(e){var t,n;const i=document.createElement("li"),r=document.createElement("div"),o=(null==(n=(t=this._config).suggestionRenderer)?void 0:n.call(t,e,this._inputElement.value))??String(e);return"string"==typeof o?(r.title=o,r.innerHTML=this._config.highlightMatch?this.getHighlightedMatch(o):o):r.appendChild(o),i.appendChild(r),i}_renderSuggestions(e){this._suggestionList.innerHTML="";const t=this._config.maxVisibleItems&&e.length>this._config.maxVisibleItems;if(this._suggestionList.style.overflowY=t?"auto":"",e.length>0){const t=this._createSuggestionElement(e[0]);this._suggestionList.appendChild(t);const n=t.offsetHeight;if(this._suggestionList.removeChild(t),this._config.maxVisibleItems&&n>0){const e=n*this._config.maxVisibleItems,t=.6*window.innerHeight;this._suggestionList.style.maxHeight=`${Math.min(e,t)}px`}}const n=this._inputElement.value.length>=(this._config.minSearchLength??0);if(e.forEach(e=>{const t=this._createSuggestionElement(e);t.addEventListener("click",()=>this._handleSuggestionClick(e)),this._suggestionList.appendChild(t)}),0===e.length&&this._config.noResultsText&&n){const e=document.createElement("li");e.className="style_module_noResults__363397c3",e.textContent=this._config.noResultsText,this._suggestionList.appendChild(e)}this._footerContainer&&(this._footerContainer.innerHTML="",this._config.footerComponent&&n&&e.length>0&&this._footerContainer.appendChild(this._config.footerComponent)),e.length>0||this._config.noResultsText&&n?this._dropdownContainer.classList.add(uG):this._dropdownContainer.classList.remove(uG)}_renderLoading(){if(!(this._inputElement.value.length>=(this._config.minSearchLength??0)))return;this._suggestionList.innerHTML="";const e=document.createElement("li");e.className="style_module_loading__296e0212",e.textContent="Searching",this._suggestionList.appendChild(e),this._footerContainer&&(this._footerContainer.innerHTML=""),this._dropdownContainer.classList.add(uG)}_handleSuggestionClick(e){var t,n;this._config.disabled||(this._config.onSelect&&this._config.onSelect(e),this._inputElement.value=(null==(n=(t=this._config).selectedSuggestionRenderer)?void 0:n.call(t,e,this._inputElement.value))??String(e),this._updatePlaceholderVisibility(),this._clearButton.classList.add(uG),this._suggestionList.innerHTML="",this._footerContainer&&(this._footerContainer.innerHTML=""),this._dropdownContainer.classList.remove(uG))}async _performSearch(e){let t=[];return this._config.searchFn&&e.length>=(this._config.minSearchLength??0)&&(t=await this._config.searchFn(e,this._config.suggestionsLimit)),t}getHighlightedMatch(e){if(!this._config.highlightMatch||!this._inputElement.value)return e;const t=this._inputElement.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),n=new RegExp(`(${t})`,"gi");return e.replace(n,"<mark>$1</mark>")}setDisabled(e){var t;e?(this._inputElement.disabled=!0,this._inputElement.value="",null==(t=this._placeholderElement)||t.classList.remove(dG),this._clearButton.classList.remove(uG),this._container.classList.add(hG),this._dropdownContainer.classList.remove(uG)):(this._inputElement.disabled=!1,this._container.classList.remove(hG)),this._config.disabled=e}isDisabled(){return!!this._config.disabled}setConfig(e){const t=this._config.openListUpwards;this._config=R$(cG,e??{}),this.setDisabled(!!this._config.disabled),t!==this._config.openListUpwards&&(this._config.openListUpwards?this._dropdownContainer.classList.add(fG):this._dropdownContainer.classList.remove(fG))}destroy(){var e;this._inputElement.removeEventListener("input",this._handleInput),this._inputElement.removeEventListener("keydown",this._handleKeyDown),this._inputElement.removeEventListener("focus",this._handleFocus),this._inputElement.removeEventListener("blur",this._handleBlur),this._clearButton.removeEventListener("click",this._handleClearClick),this._placeholderElement&&this._handleMouseDown&&(null==(e=this._placeholderElement)||e.removeEventListener("mousedown",this._handleMouseDown)),this._container.innerHTML=""}clearInput(){if(this._config.disabled)return;const e=!!this._inputElement.value;this._inputElement.value="",this._suggestionList.innerHTML="",this._footerContainer&&(this._footerContainer.innerHTML=""),this._dropdownContainer.classList.remove(uG),this._clearButton.classList.remove(uG),this._updatePlaceholderVisibility(),e&&this._config.onClear&&this._config.onClear()}hideSuggestions(){this._suggestionList.innerHTML="",this._footerContainer&&(this._footerContainer.innerHTML=""),this._dropdownContainer.classList.remove(uG)}focus(){this._inputElement.focus()}blur(){this._inputElement.blur()}};const yG=30,vG={padding:{top:5,left:5,bottom:1,right:5},barPadding:.1,minBarHeight:2,selectionRadius:3,selectionPadding:8,barCount:yG,dataStep:void 0,barRadius:1,barTopMargin:7,labelSideMargin:3,formatter:P$,allowSelection:!0,stickySelection:!0,onBrush:void 0,onBarHover:void 0,noDataMessage:"No histogram data",loadingMessage:"Data loading..."},bG="style_module_bar__3c9ab488",xG="style_module_highlightedBar__b193a8de",wG="style_module_bars__cf3a511f";!function(){try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('@keyframes style_module_fadeIn__ffac87fd{0%{opacity:0}to{opacity:.2}}.style_module_displayState__6ae19b84{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:var(--cosmograph-ui-text);display:flex;justify-content:center;align-items:center;min-width:100px;opacity:.2;font-size:calc(var(--cosmograph-ui-font-size) + 1px);letter-spacing:-.02em;font-weight:200;user-select:none;-webkit-user-select:none;animation:style_module_fadeIn__ffac87fd .3s ease-in-out}:root{--cosmograph-timeline-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-timeline-selection-opacity: .5;--cosmograph-timeline-bar-color: var(--cosmograph-ui-element-color);--cosmograph-timeline-highlighted-bar-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-timeline-font-family: var(--cosmograph-ui-font-family);--cosmograph-timeline-font-size: var(--cosmograph-ui-tick-font-size);--cosmograph-timeline-background: var(--cosmograph-ui-background);--cosmograph-timeline-text-color: var(--cosmograph-ui-text);--cosmograph-timeline-axis-color: var(--cosmograph-ui-text)}.style_module_timeline__736434f7{position:relative;display:flex;background:var(--cosmograph-timeline-background);width:100%;min-height:25px;overflow:hidden}.style_module_timelineSvg__b916ad04{position:relative;width:100%;height:100%}.style_module_selection__ebee57f8{fill:var(--cosmograph-timeline-selection-color);fill-opacity:var(--cosmograph-timeline-selection-opacity);stroke:none}.style_module_axisTick__5865631d{color:var(--cosmograph-timeline-axis-color);font:var(--cosmograph-timeline-font-family);font-size:var(--cosmograph-timeline-font-size);user-select:none;-webkit-user-select:none;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum";alignment-baseline:text-before-edge}.style_module_axisLine__992b502d{opacity:.2;color:var(--cosmograph-timeline-axis-color)}.style_module_bar__114fa79f{fill:var(--cosmograph-timeline-bar-color);transform:scaleY(-1);opacity:0}.style_module_animationControl__ee52cd66{color:var(--cosmograph-timeline-axis-color);width:6%;max-width:30px;min-width:20px;cursor:pointer;display:none;align-items:center;user-select:none;-webkit-user-select:none;opacity:.5;position:relative;justify-content:center}.style_module_animationControl__ee52cd66>svg{width:50%;max-height:20px;padding-right:2px}.style_module_hidden__a73fe81a{display:none}.style_module_disabled__eb988570{opacity:.2;pointer-events:none}.style_module_highlightedBar__c2fc9bdc{fill:var(--cosmograph-timeline-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-search-font-family: var(--cosmograph-ui-font-family);--cosmograph-search-font-size: 14px;--cosmograph-search-list-font-size: 13.5px;--cosmograph-search-text-color: var(--cosmograph-ui-text);--cosmograph-search-background: transparent;--cosmograph-search-list-background: rgba(0, 0, 0, .2);--cosmograph-search-list-match-background: rgba(255, 255, 255, .2);--cosmograph-search-list-match-color: var(--cosmograph-ui-text)}.style_module_searchInput__d7830601:hover{filter:brightness(1.2) contrast(1)}.style_module_searchInput__d7830601{width:100%;background:transparent;color:var(--cosmograph-search-text-color);border:none;border-bottom:.5px solid var(--cosmograph-search-text-color);padding:4px 20px 5px 2px;font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:opacity .2s ease-out}.style_module_searchInput__d7830601::selection{background:var(--cosmograph-search-list-match-background)}.style_module_searchInput__d7830601:focus{outline:none}.style_module_searchSuggestions__b0d3f71e{color:#fff;width:100%;padding:0;margin:0;background:transparent;overflow-y:auto;flex:1;min-height:0}.style_module_searchSuggestions__b0d3f71e li{padding:5px 10px;cursor:pointer;-webkit-user-select:none;user-select:none;display:block;font-weight:500;font-size:var(--cosmograph-search-list-font-size);max-width:100%;overflow:hidden}.style_module_searchSuggestions__b0d3f71e li>div{white-space:nowrap;font-weight:200;overflow:hidden;text-overflow:ellipsis;width:100%}.style_module_searchSuggestions__b0d3f71e li:hover{background:#ffffff1a}.style_module_searchSuggestions__b0d3f71e mark{background:var(--cosmograph-search-list-match-background);color:var(--cosmograph-search-list-match-color);border-radius:2px}.style_module_clearButton__5ebb41de{position:absolute;right:0;top:0;height:100%;background:none;border:none;color:var(--cosmograph-search-text-color);font-weight:300;cursor:pointer;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d{opacity:.7}.style_module_placeholderWrapper__72d5eb0e{z-index:1;color:var(--cosmograph-search-text-color);font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);position:absolute;top:0;left:0;width:100%;bottom:0;display:flex;line-height:1.25;align-items:center;transition:transform .3s ease-out,opacity .3s ease-out}.style_module_placeholderWrapper__72d5eb0e.style_module_hidden__acfb8431{transform:translate(-30px);pointer-events:none;opacity:0}.style_module_searchInput__d7830601:disabled,.style_module_searchInput__d7830601.style_module_disabled__62c35dc5{opacity:.2;cursor:not-allowed;pointer-events:none}.style_module_disabled__62c35dc5 .style_module_clearButton__5ebb41de{display:none}.style_module_disabled__62c35dc5 .style_module_placeholderWrapper__72d5eb0e{opacity:.3;cursor:not-allowed}.style_module_searchInputWrapper__1edbcb22{position:relative;display:flex;width:100%}.style_module_noResults__363397c3{opacity:.3!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none}.style_module_noResults__363397c3:hover{background:none}.style_module_loading__296e0212{opacity:.7!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none;-webkit-user-select:none;user-select:none}.style_module_dropdownContainer__d98287da{position:absolute;top:100%;left:0;width:100%;background:var(--cosmograph-search-list-background);border-radius:4px;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);opacity:0;transform:translateY(-10px);transition:opacity .2s ease-out,transform .2s ease-out;pointer-events:none;overflow:hidden;z-index:10;display:flex;flex-direction:column;padding-bottom:2px}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b{top:auto;bottom:100%;transform:translateY(10px)}.style_module_dropdownContainer__d98287da.style_module_visible__5be7493d{opacity:1;transform:translateY(0);pointer-events:auto}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b.style_module_visible__5be7493d{opacity:1;transform:translateY(-2px);pointer-events:auto}.style_module_footerContainer__73e7a066{flex-shrink:0}:root{--cosmograph-scrollbar-background: rgba(255, 255, 255, .1);--cosmograph-ui-background: rgb(45, 49, 58);--cosmograph-ui-text: #ffffffc7;--cosmograph-ui-tick-font-size: 11px;--cosmograph-ui-font-size: 12px;--cosmograph-ui-font-family: inherit;--cosmograph-ui-element-color: #5C616A;--cosmograph-ui-highlighted-element-color: white;--cosmograph-ui-selection-control-color: #8d949ea8;-webkit-font-smoothing:antialiased!important;text-rendering:optimizeLegibility!important}.style_module_cosmograph-ui__5acb97f1{background:var(--cosmograph-ui-background);color:var(--cosmograph-ui-text)}.style_module_scrollbar__f1516254 *::-webkit-scrollbar{width:5px;height:5px;border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-track{border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-corner{background:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-button{display:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-thumb{background-color:var(--cosmograph-scrollbar-background);transition:background-color .5s;border-radius:20px;border:3px solid var(--cosmograph-scrollbar-background)}@-moz-document url-prefix(){.style_module_scrollbar__f1516254 *{scrollbar-width:thin;scrollbar-color:var(--cosmograph-scrollbar-background) transparent;scrollbar-track-color:transparent;scrollbar-face-color:var(--cosmograph-scrollbar-background)}}:root{--cosmograph-histogram-background: var(--cosmograph-ui-background);--cosmograph-histogram-text-color: var(--cosmograph-ui-text);--cosmograph-histogram-axis-color: var(--cosmograph-ui-text);--cosmograph-histogram-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-histogram-selection-opacity: .5;--cosmograph-histogram-bar-color: var(--cosmograph-ui-element-color);--cosmograph-histogram-highlighted-bar-color: var( --cosmograph-ui-highlighted-element-color);--cosmograph-histogram-font-family: var(--cosmograph-ui-font-family);--cosmograph-histogram-font-size: var(--cosmograph-ui-tick-font-size)}.style_module_histogram__9d8a77ea{position:relative;display:flex;min-height:25px;background:var(--cosmograph-histogram-background);width:100%}.style_module_histogramSvg__ccccb628{position:relative;width:100%;height:100%}.style_module_selection__7db96137{fill:var(--cosmograph-histogram-selection-color);fill-opacity:var(--cosmograph-histogram-selection-opacity);stroke:none}.style_module_axisTick__898e1f39{color:var(--cosmograph-histogram-axis-color);font-family:var(--cosmograph-histogram-font-family);font-size:var(--cosmograph-histogram-font-size);user-select:none;-webkit-user-select:none;alignment-baseline:text-before-edge;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum"}.style_module_bar__3c9ab488{fill:var(--cosmograph-histogram-bar-color);transform:scaleY(-1)}.style_module_highlightedBar__b193a8de{fill:var(--cosmograph-histogram-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-bars-font-color: var(--cosmograph-ui-text);--cosmograph-bars-font-family: var(--cosmograph-ui-font-family);--cosmograph-bars-font-size: var(--cosmograph-ui-font-size);--cosmograph-bars-ui-font-size: 11.5px;--cosmograph-bars-background: var(--cosmograph-ui-element-color);--cosmograph-bars-bar-height: 20px;--cosmograph-bars-bar-bottom-margin: 2px;--cosmograph-bars-highlighted-color: var( --cosmograph-ui-highlighted-element-color)}.style_module_bars__25497ded{position:relative;width:100%;min-height:100px;user-select:none;flex-direction:column;-webkit-user-select:none}.style_module_bars__25497ded .scroll-container{position:relative;width:100%;overflow-y:hidden;overflow-x:hidden}.style_module_bars__25497ded .bars-container{position:relative;width:calc(100% - 1px);font-family:var(--cosmograph-bars-font-family)}.style_module_bars__25497ded .highlighted-bars-container{position:absolute;top:0;left:0;pointer-events:none}.style_module_bars__25497ded .row{height:var(--cosmograph-bars-bar-height);display:flex;align-items:center;margin-bottom:var(--cosmograph-bars-bar-bottom-margin);width:100%;transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row:hover{filter:brightness(1.15) contrast(1.05);transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row.unselected:hover{filter:brightness(.95) contrast(1.15);transition:filter .05s linear}.style_module_bars__25497ded .unselected{opacity:.85;filter:brightness(.8) contrast(1.1)}.style_module_bars__25497ded .selected{filter:brightness(1.05) contrast(1.05)}.style_module_bars__25497ded .selected>.info>.label{font-weight:600;filter:brightness(1.1) contrast(1.05)}.style_module_bars__25497ded .unselected>.info>.label{font-weight:300}.style_module_bars__25497ded .bar{height:100%;background-color:var(--cosmograph-bars-background);opacity:.8;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .bar-highlighted{height:100%;background-color:var(--cosmograph-bars-highlighted-color);opacity:.2;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .info{display:flex;justify-content:space-between;width:100%;padding:0 4px;position:absolute;font-size:var(--cosmograph-bars-font-size);font-feature-settings:"tnum";color:var(--cosmograph-bars-font-color);gap:2px}.style_module_bars__25497ded .label{min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;transition:opacity .05s linear}.style_module_bars__25497ded .count{flex-shrink:0;font-weight:300;opacity:.8;transition:opacity .05s linear}.style_module_bars__25497ded .show-more{cursor:pointer;padding-top:2px;display:flex;font-weight:300;color:var(--cosmograph-bars-font-color);font-size:11px;justify-content:space-between;opacity:.6;font-size:var(--cosmograph-bars-ui-font-size);pointer-events:none;transition:opacity .1s linear}.style_module_bars__25497ded .show-more:hover{opacity:1;text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .show-more>span{pointer-events:all}.style_module_bars__25497ded .show-more-count{padding-right:5px;pointer-events:all;font-feature-settings:"tnum"}.style_module_bars__25497ded .unselected>.info>.label,.style_module_bars__25497ded .unselected>.info>.count{opacity:.5}.style_module_bars__25497ded .unselected:hover>.info>.label,.style_module_bars__25497ded .unselected:hover>.info>.count{opacity:1}.style_module_bars__25497ded .search-input{background:transparent;border:none;border-bottom:1px solid rgba(255,255,255,.3);font-size:13px!important;color:var(--cosmograph-bars-font-color);line-height:1.5;padding:2px;width:100%;position:relative;transition:border-bottom-color .2s}.style_module_bars__25497ded .search-input::placeholder{color:var(--cosmograph-bars-font-color)!important;opacity:.4;font-weight:300;font-family:inherit}.style_module_bars__25497ded .search-container{position:relative;width:100%;margin-bottom:4px;display:none;z-index:1}.style_module_bars__25497ded .clear-button{position:absolute;right:0;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--cosmograph-bars-font-color);font-weight:300;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_bars__25497ded .clear-button.visible:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_bars__25497ded .clear-button.visible{opacity:.7}.style_module_bars__25497ded .clear-button svg{width:10px;height:10px;fill:currentColor}.style_module_bars__25497ded .sorting-block{visibility:hidden;margin-top:1px;display:flex;justify-content:space-between}.style_module_bars__25497ded .buttons-container{margin-top:4px;font-size:var(--cosmograph-bars-ui-font-size);display:flex;gap:4px;line-height:1.25}.style_module_bars__25497ded .buttons-container>div{transition:opacity .05s linear,filter .05s linear;padding:1px 5px;background:var(--cosmograph-bars-background);border-radius:4px;opacity:.9;display:flex;cursor:pointer;align-items:center}.style_module_bars__25497ded .buttons-container>div:hover{filter:brightness(1.2)}.style_module_bars__25497ded .reset-text{transition:opacity .05s linear,filter .05s linear;display:flex;font-size:var(--cosmograph-bars-ui-font-size);align-items:end;padding-right:4px;cursor:pointer;font-weight:300}.style_module_bars__25497ded .reset-text:hover{text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .reset-text.unselected{pointer-events:none;cursor:default;opacity:.7}.style_module_bars__25497ded :scope.reset-text:hover:not(.unselected){filter:brightness(1.5);opacity:1}:root{--cosmograph-size-legend-form-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-family: inherit;--cosmograph-size-legend-font-size: var(--cosmograph-ui-font-size);--cosmograph-size-legend-sublabel-font-size: 10px;--cosmograph-size-legend-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-size-legend-line-radius: 2px;--cosmograph-size-legend-line-width: 30px;--cosmograph-size-legend-hide-transform: translateY(100%);--cosmograph-size-legend-show-transform: translateX(0)}.style_module_container__d2889234{display:flex;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;overflow:hidden;min-height:25px}.style_module_legend__75c167f2{width:auto;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-size-legend-font-size);font-family:var(--cosmograph-size-legend-font-family);user-select:none;-webkit-user-select:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.04em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__91eae57a{opacity:1;transform:var(--cosmograph-size-legend-show-transform)}.style_module_disabled__d51f7a10{opacity:0;transform:var(--cosmograph-size-legend-hide-transform);pointer-events:none;display:none!important;min-height:0}@starting-style{.style_module_container__d2889234.style_module_enabled__91eae57a,.style_module_legend__75c167f2.style_module_enabled__91eae57a{opacity:0;transform:var(--cosmograph-size-legend-hide-transform)}}.style_module_legend__75c167f2 .circle{background-color:var(--cosmograph-size-legend-form-color);border-radius:50%;transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2 .line{background-color:var(--cosmograph-size-legend-form-color);border-radius:var(--cosmograph-size-legend-line-radius);width:var(--cosmograph-size-legend-line-width);transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2.style_module_events__894316a8{pointer-events:auto;cursor:pointer}.style_module_legend__75c167f2 .legend-content{display:flex;align-items:end;justify-content:center;gap:.75rem}.style_module_legend__75c167f2 .legend-content>div{transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__75c167f2 .labels-wrapper{white-space:nowrap}.style_module_legend__75c167f2 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-size-legend-items-margin)}.style_module_legend__75c167f2 .name{align-items:center;text-align:center;justify-content:center;display:flex;color:var(--cosmograph-size-legend-font-color);overflow:hidden;width:100%;margin-top:3px;word-break:break-all;white-space:pre-line;transition:color .15s ease-in-out;letter-spacing:-.02em}.style_module_legend__75c167f2 .label{color:var(--cosmograph-size-legend-font-color);overflow:hidden;transition:color .15s ease-in-out;text-overflow:ellipsis;font-feature-settings:"tnum"}.style_module_legend__75c167f2 .sublabel{padding-top:1px;font-size:var(--cosmograph-size-legend-sublabel-font-size);opacity:.5;line-height:1;min-width:10px;transition:color .15s ease-in-out}.style_module_hovered__1206707f .label,.style_module_hovered__1206707f .sublabel{color:var(--cosmograph-size-legend-hover-color);cursor:pointer}.style_module_hovered__1206707f .circle,.style_module_hovered__1206707f .line{background-color:var(--cosmograph-size-legend-hover-color);cursor:pointer}:root{--cosmograph-color-legend-range-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-range-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-range-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-label-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-sublabel-font-size: 10px;--cosmograph-color-legend-range-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-range-gradient-height: 6px;--cosmograph-color-legend-range-gradient-radius: 8px;--cosmograph-color-legend-range-gradient-top-margin: 6px;--cosmograph-color-legend-hide-transform: translateY(100%);--cosmograph-color-legend-show-transform: translateX(0)}.style_module_container__05cc807d{display:flex;min-width:150px;min-height:25px;width:100%;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_legend__a3e235e4{width:100%;font-weight:300;letter-spacing:-.04em;display:flex;flex-direction:column;font-size:var(--cosmograph-color-legend-range-font-size);font-family:var(--cosmograph-color-legend-range-font-family);user-select:none;-webkit-user-select:none;pointer-events:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__b3120e27{opacity:1;transform:var(--cosmograph-color-legend-show-transform);pointer-events:auto}.style_module_disabled__c2dc158c{opacity:0;transform:var(--cosmograph-color-legend-hide-transform);pointer-events:none;display:none;min-height:0}@starting-style{.style_module_container__05cc807d.style_module_enabled__b3120e27,.style_module_legend__a3e235e4.style_module_enabled__b3120e27{opacity:0;transform:var(--cosmograph-color-legend-hide-transform)}}.style_module_legend__a3e235e4 .legend-content{display:flex;align-items:end;justify-content:space-between}.style_module_hovered__dfd7bb2c .label,.style_module_hovered__dfd7bb2c .sublabel{color:var(--cosmograph-size-legend-hover-color)!important;cursor:pointer}.style_module_legend__a3e235e4 .extent{white-space:nowrap;transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__a3e235e4 .gradient{width:100%;margin-top:var(--cosmograph-color-legend-range-gradient-top-margin);height:var(--cosmograph-color-legend-range-gradient-height);border-radius:var(--cosmograph-color-legend-range-gradient-radius)}.style_module_legend__a3e235e4 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-color-legend-range-items-margin)}.style_module_legend__a3e235e4 .name{align-items:center;text-align:center;justify-content:space-around;display:flex;color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;width:100%;word-break:break-word;text-wrap:balance;white-space:pre-line;transition:color .15s ease-in-out;margin:0 4px;letter-spacing:-.02em;line-height:1.25}.style_module_legend__a3e235e4 .label{color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;max-width:150px;text-overflow:ellipsis;font-size:var(--cosmograph-color-legend-range-label-font-size);transition:color .15s ease-in-out;line-height:1;font-feature-settings:"tnum"}.style_module_legend__a3e235e4 .sublabel{padding-top:1px;color:var(--cosmograph-color-legend-range-font-color);opacity:.55;font-size:var(--cosmograph-color-legend-range-sublabel-font-size);line-height:1;transition:color .15s ease-in-out}:root{--cosmograph-color-legend-type-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-type-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-type-font-size: 11px;--cosmograph-color-legend-type-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-type-others-color: #bab0ab;--cosmograph-color-legend-type-bullet-size: 8px;--cosmograph-color-legend-type-bullet-radius: 1rem;--cosmograph-color-legend-type-items-margin: 4px;--cosmograph-color-legend-type-hide-transform: translateY(125%);--cosmograph-color-legend-type-show-transform: translateX(0)}.style_module_enabled__277b2403{opacity:1;transform:var(--cosmograph-color-legend-type-show-transform)}.style_module_disabled__7a587f96{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform);display:none!important;min-height:0}.style_module_wrapper__ea8ca7f4{position:relative;max-width:100%;width:fit-content;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_typeLegend__15bf4b2f{position:relative;width:fit-content;max-width:100%;min-height:25px;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.015em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_typeLegend__15bf4b2f .reverted{flex-direction:row-reverse}.style_module_typeLegend__15bf4b2f .scroll-container{width:100%;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-color-legend-type-font-size);font-family:var(--cosmograph-color-legend-type-font-family);user-select:none;-webkit-user-select:none;line-height:normal;overflow-x:hidden;overflow-y:auto;will-change:transform}@starting-style{.style_module_typeLegend__15bf4b2f.style_module_enabled__277b2403,.style_module_wrapper__ea8ca7f4.style_module_enabled__277b2403{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform)}}.style_module_typeLegend__15bf4b2f .legend-item{display:flex;align-items:center;position:absolute;margin-bottom:var(--cosmograph-color-legend-type-items-margin);pointer-events:none;width:100%;padding-left:1px;font-weight:300;transition:filter .1s ease-in-out,opacity .1s ease-in-out;min-height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px + var(--cosmograph-color-legend-type-items-margin));height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px);box-sizing:border-box}.style_module_typeLegend__15bf4b2f .unknown{background-color:var(--cosmograph-color-legend-type-unknown-color)}.style_module_typeLegend__15bf4b2f .others{background-color:var(--cosmograph-color-legend-type-others-color)}.style_module_typeLegend__15bf4b2f .bullet{height:var(--cosmograph-color-legend-type-bullet-size);width:var(--cosmograph-color-legend-type-bullet-size);min-height:var(--cosmograph-color-legend-type-bullet-size);min-width:var(--cosmograph-color-legend-type-bullet-size);border-radius:var(--cosmograph-color-legend-type-bullet-radius);pointer-events:all;margin-right:5px}.style_module_typeLegend__15bf4b2f .label{color:var(--cosmograph-color-legend-type-font-color);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - var(--cosmograph-color-legend-type-bullet-size) - 5px);pointer-events:all;transition:.05s linear color}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.bullet{margin-right:0}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.label{margin-right:5px}.style_module_typeLegend__15bf4b2f .show-more{cursor:pointer;padding-top:4px;display:none;font-weight:300;color:var(--cosmograph-color-legend-type-font-color);font-size:11px;opacity:.6;pointer-events:all;justify-content:space-between;transition:opacity .1s linear;font-feature-settings:"tnum"}.style_module_typeLegend__15bf4b2f .show-more:hover{opacity:1}.style_module_hovered__c0993502 .label,.style_module_hovered__c0993502 .sublabel{color:var(--cosmograph-color-legend-type-hover-color)!important;cursor:pointer}.style_module_selected__36e1dd81{filter:brightness(1)}.style_module_selected__36e1dd81>.style_module_label__afecc7a3{filter:brightness(1.2)}.style_module_unselected__4826cfb7{filter:brightness(.5)}.style_module_typeLegend__15bf4b2f .name{font-size:calc(var(--cosmograph-color-legend-type-font-size) + 1px);font-family:var(--cosmograph-color-legend-type-font-family);color:var(--cosmograph-color-legend-type-font-color);transition:color .15s ease-in-out,opacity .3s ease-in-out,max-height .3s ease-in-out,transform .3s ease-in-out;margin-bottom:4px;margin-top:2px;margin-left:1px;letter-spacing:-.02em;line-height:1.25;overflow:hidden;width:100%;white-space:nowrap;text-overflow:ellipsis;pointer-events:all;-webkit-user-select:none!important;user-select:none!important;max-height:100px;opacity:1;transform:translateY(0)}.style_module_typeLegend__15bf4b2f .name.hidden{opacity:0;max-height:0;margin-bottom:0;margin-top:0;transform:translateY(-10px)}:root{--cosmograph-button-color: var(--cosmograph-ui-text);--cosmograph-button-background: var(--cosmograph-ui-element-color);--cosmograph-button-border-radius: 2px}.style_module_button__e95a1138{background:var(--cosmograph-button-background);color:var(--cosmograph-button-color);border-radius:var(--cosmograph-button-border-radius);display:none;align-items:center;justify-content:center;width:25px;height:25px;margin:3px;padding:5px;cursor:pointer;filter:brightness(.95) contrast(.9);transition:filter .1s}.style_module_button__e95a1138:hover{filter:brightness(1.2) contrast(1)}')),document.head.appendChild(e)}}catch(Xn){}}();var SG=Object.defineProperty,EG=(e,t,n)=>((e,t,n)=>t in e?SG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);let CG=class extends Q${constructor(e,t){const n=R$(vG,t??{});super(e,Q$.extractConfig(n,vG)),EG(this,"_config"),EG(this,"_containerNode"),EG(this,"_resizeObserver"),EG(this,"_svg"),EG(this,"_axisGroup"),EG(this,"_barsGroup"),EG(this,"_highlightedBarsGroup"),EG(this,"_brushGroup"),EG(this,"_firstRender",!0),EG(this,"_height"),EG(this,"_width"),EG(this,"_histogramWidth"),EG(this,"_histogramHeight"),EG(this,"_barWidth",0),EG(this,"_maxCount",0),EG(this,"_extent"),EG(this,"_barsData",[]),EG(this,"_highlightedBarsData",[]),EG(this,"_histogramData"),EG(this,"_highlightedData"),EG(this,"_bandIntervals",[]),EG(this,"_currentSelection"),EG(this,"_currentSelectionInPixels"),EG(this,"_yScale",gH()),EG(this,"_xScale",fH()),EG(this,"_axis",FU(this._xScale)),EG(this,"_brushInstance"),this._config=n,this._containerNode=e,this._containerNode.classList.add("style_module_histogram__9d8a77ea"),this._width=e.offsetWidth,this._height=e.offsetHeight,this._histogramWidth=this._width-this._config.padding.left-this._config.padding.right,this._histogramHeight=this._height-this._config.padding.top-this._config.padding.bottom,this._initializeSVG(),this._initializeGroups(),this._resizeObserver=new IU(()=>this.resize()),this._resizeObserver.observe(this._containerNode)}_initializeSVG(){this._svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._svg.classList.add("style_module_histogramSvg__ccccb628"),this._containerNode.appendChild(this._svg)}setLoadingState(){super.setLoadingState()}_initializeGroups(){this._axisGroup=EO(this._svg).append("g").attr("class","style_module_axis__e37d2f53"),this._barsGroup=EO(this._svg).append("g").attr("class",wG),this._highlightedBarsGroup=EO(this._svg).append("g").attr("class",wG),this._brushGroup=EO(this._svg).append("g").attr("class","style_module_brush__5a0c1368")}get _barPadding(){return this._barWidth*(this._config.barPadding??0)}get _formatter(){return this._config.formatter??P$}getCurrentSelection(){return this._currentSelection}getCurrentSelectionInPixels(){return this._currentSelectionInPixels??[]}getBarWidth(){return this._barWidth-this._barPadding}getConfig(){return this._config}setConfig(e){const t=JSON.parse(JSON.stringify(this._config));this._config=R$(vG,e??{}),this.setDisplayStateConfig(Q$.extractConfig(this._config,vG)),this._config.allowSelection||this._disableBrush(),(this._config.dataStep!==t.dataStep||this._config.barCount!==t.barCount)&&(this._updateHistogramData(this._histogramData),this._updateHistogramData(this._highlightedData,!0)),this._axis.tickFormat(e=>this._formatter(e)),this.resize()}setSelection(e,t=!1){var n,i,r,o;const s=this._currentSelection;if(e&&this._extent){const t=[Math.max(this._extent[0],Math.min(e[0],this._extent[1])),Math.min(this._extent[1],Math.max(e[1],this._extent[0]))];if(t[0]<t[1])if(this._config.stickySelection){const e=t.map(this._xScale);this._mapSelection(e)}else this._currentSelection=t;else this._currentSelection=void 0}else this._currentSelection=void 0;!t&&((null==s?void 0:s[0])!==(null==(n=this._currentSelection)?void 0:n[0])||(null==s?void 0:s[1])!==(null==(i=this._currentSelection)?void 0:i[1]))&&(null==(o=(r=this._config).onBrush)||o.call(r,this._currentSelection,!0)),this._brushCurrentSelection()}resize(){const{offsetWidth:e,offsetHeight:t}=this._containerNode;this._width=e,this._height=t,this._histogramWidth=this._width-this._config.padding.left-this._config.padding.right,this._histogramHeight=this._height-this._config.padding.top-this._config.padding.bottom,this._histogramHeight>this._config.padding.top+this._config.padding.bottom&&(this._updateScales(),this._currentSelection&&this.setSelection(this._currentSelection,!0),this._firstRender||this.render())}render(){this._updateBrush(),this._updateBars(),this._updateBars(!0),this._updateAxis(),this._firstRender&&(this._firstRender=!1)}destroy(){super.destroy(),this._resizeObserver.disconnect(),this._containerNode.innerHTML=""}_parseData(e){if(null==e||!e.length)return[];const t=new Float64Array(e.length);let n=0;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r&&!isNaN(r)&&(t[n++]=r)}return Array.from(t.subarray(0,n))}setHistogramData(e,t){if(t&&t[1]<=t[0])return;this._histogramData=[],this._highlightedBarsData=[],this._currentSelection=void 0,this._brushCurrentSelection();const n=this._parseData(e),i=t||xV(n),r=i[0]<i[1];r&&n.length>1?(this.hideState(),this._histogramData=n,this._extent=i,this._firstRender=!0):this.showState(r?void 0:"Empty or invalid histogram data"),this._updateHistogramData(this._histogramData),this._updateScales(),this.render()}setHighlightedData(e){this._histogramData&&(this._highlightedData=this._parseData(e),this._highlightedBarsData=[],this._updateHistogramData(this._highlightedData,!0),this._updateBars(!0))}_updateAxis(){this._histogramData&&this._histogramData.length?(this._axisGroup.style("transform",`translate(${this._config.padding.left}px, ${this._config.padding.top-(this._config.selectionPadding??0)/2+1}px)`).call(this._axis).call(e=>e.select(".domain").remove()),this._axisGroup.selectAll(".tick").select("text").attr("class","style_module_axisTick__898e1f39").attr("y",0).attr("dy",-2).attr("dx",this._config.labelSideMargin??0),this._axisGroup.selectAll(".tick:last-of-type text").attr("dx",-(this._config.labelSideMargin??0)).style("text-anchor","end"),this._axisGroup.selectAll("line").attr("y2",this._histogramHeight).attr("y1",0).attr("opacity",.1)):this._axisGroup.style("display","none")}_updateBrush(){if(!this._config.allowSelection||this._histogramHeight<0||this._histogramWidth<0)return void this._brushGroup.selectAll("*").remove();const e=this._config.selectionPadding??0,t=this._histogramHeight-e,n=[[0,e/2],[this._histogramWidth,t+e/2]];this._brushInstance=uV().extent(n),this._brushInstance.on("end",({selection:e,sourceEvent:t})=>{var n,i,r,o;t&&(e?(this._config.stickySelection?this._mapSelection(e):this._currentSelection=e.map(e=>this._xScale.invert(e)),null==(i=(n=this._config).onBrush)||i.call(n,this._currentSelection)):(this._currentSelection=void 0,null==(o=(r=this._config).onBrush)||o.call(r,void 0)),this._brushCurrentSelection())}),this._brushGroup.style("transform",`translate(${this._config.padding.left}px, ${this._config.padding.top}px)`).call(this._brushInstance).call(this._brushInstance.move,this._currentSelectionInPixels||null),this._brushGroup.select("rect.selection").classed("style_module_selection__7db96137",!0).attr("rx",this._config.selectionRadius??0).attr("ry",this._config.selectionRadius??0)}_updateBars(e=!1){const t=e?this._highlightedBarsGroup:this._barsGroup;if(!this._histogramData||!this._histogramData.length)return void t.selectAll("rect").remove();t.style("transform",`translate(${this._config.padding.left}px, ${this._config.padding.top-(this._config.selectionPadding??0)/2}px)`);const n=e?.5:1,i=this._createBars(t,e);!e&&this._config.onBarHover&&i.on("mouseover",this._config.onBarHover),this._animateBars(i,e,n)}_createBars(e,t){return e.selectAll(`.${t?xG:bG}`).data(t?this._highlightedBarsData:this._barsData).join("rect").attr("class",t?xG:bG).attr("x",e=>this._xScale(e.rangeStart)+this._barPadding/2).attr("width",this.getBarWidth()).attr("rx",this._config.barRadius??0).attr("ry",this._config.barRadius??0).attr("y",-this._histogramHeight)}_animateBars(e,t,n){e.transition().duration(300).attr("height",e=>t&&0===e.count?0:this._yScale(e.count)).style("opacity",e=>this._yScale(e.count)===this._config.minBarHeight?.4:n)}_updateScales(){if(!this._extent||!this._barsData.length||this._histogramHeight<0||this._histogramWidth<0)this._axisGroup.style("display","none");else{this._axisGroup.style("display","inherit");const e=this._barsData[this._barsData.length-1],t=this._config.dataStep?[this._extent[0],e.rangeEnd]:this._extent;this._xScale.domain(t).range([0,this._histogramWidth]).clamp(!0),this._yScale.range([this._config.minBarHeight??0,this._histogramHeight-(this._config.barTopMargin??0)-(this._config.selectionPadding??0)]).domain([0,this._maxCount]).clamp(!0),this._axis.tickValues(t),this._barWidth=this._xScale(e.rangeEnd)-this._xScale(e.rangeStart)}}_updateHistogramData(e,t=!1){const n=t?"_highlightedBarsData":"_barsData";if(!this._extent)return void(this[n]=[]);if(null==e||!e.length)return void(this[n]=D$([],this._bandIntervals,this._currentSelection,t));t||this._generateBandIntervals();const i=D$(e,this._bandIntervals,this._currentSelection,t);this[n]=i,t||(this._maxCount=Math.max(...i.map(e=>e.count)))}_generateBandIntervals(){if(!this._extent)return;const{barCount:e=yG,dataStep:t}=this._config;this._bandIntervals=M$(this._extent,e,t)}_disableBrush(){this._currentSelection=void 0,this._brushCurrentSelection(),this._brushGroup.selectAll("*").remove()}_mapSelection(e){if(!this._barsData.length)return;const t=this._xScale.invert(e[0]),n=this._xScale.invert(e[1]),i=this._getClosestRange(t),r=this._getClosestRange(n,!0);i&&r&&i.rangeStart<=r.rangeEnd&&e[1]-e[0]>this.getBarWidth()/2?this._currentSelection=[i.rangeStart,r.rangeEnd]:this._currentSelection=void 0}_getClosestRange(e,t){return this._barsData.reduce((n,i)=>{const r=t?n.rangeEnd:n.rangeStart,o=t?i.rangeEnd:i.rangeStart;return Math.abs(o-e)<Math.abs(r-e)?i:n})}_brushCurrentSelection(){var e;this._currentSelection?(this._currentSelectionInPixels=this._currentSelection.map(this._xScale),this._brushInstance&&!this._firstRender&&this._brushGroup.call(this._brushInstance.move,this._currentSelectionInPixels)):(this._currentSelectionInPixels=void 0,null==(e=this._brushInstance)||e.clear(this._brushGroup))}};const TG={maxDisplayedItems:10,showSortingBlock:!0,showSearch:!0,sort:"count",sortAscending:!1,showTotalWhenFiltered:!1,countFormatter:P$,expanded:!1,onClick:void 0,onBarHover:void 0,noDataMessage:"No bars data",loadingMessage:"Data loading...",allowPointerEvents:!0};!function(){try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('@keyframes style_module_fadeIn__ffac87fd{0%{opacity:0}to{opacity:.2}}.style_module_displayState__6ae19b84{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:var(--cosmograph-ui-text);display:flex;justify-content:center;align-items:center;min-width:100px;opacity:.2;font-size:calc(var(--cosmograph-ui-font-size) + 1px);letter-spacing:-.02em;font-weight:200;user-select:none;-webkit-user-select:none;animation:style_module_fadeIn__ffac87fd .3s ease-in-out}:root{--cosmograph-timeline-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-timeline-selection-opacity: .5;--cosmograph-timeline-bar-color: var(--cosmograph-ui-element-color);--cosmograph-timeline-highlighted-bar-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-timeline-font-family: var(--cosmograph-ui-font-family);--cosmograph-timeline-font-size: var(--cosmograph-ui-tick-font-size);--cosmograph-timeline-background: var(--cosmograph-ui-background);--cosmograph-timeline-text-color: var(--cosmograph-ui-text);--cosmograph-timeline-axis-color: var(--cosmograph-ui-text)}.style_module_timeline__736434f7{position:relative;display:flex;background:var(--cosmograph-timeline-background);width:100%;min-height:25px;overflow:hidden}.style_module_timelineSvg__b916ad04{position:relative;width:100%;height:100%}.style_module_selection__ebee57f8{fill:var(--cosmograph-timeline-selection-color);fill-opacity:var(--cosmograph-timeline-selection-opacity);stroke:none}.style_module_axisTick__5865631d{color:var(--cosmograph-timeline-axis-color);font:var(--cosmograph-timeline-font-family);font-size:var(--cosmograph-timeline-font-size);user-select:none;-webkit-user-select:none;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum";alignment-baseline:text-before-edge}.style_module_axisLine__992b502d{opacity:.2;color:var(--cosmograph-timeline-axis-color)}.style_module_bar__114fa79f{fill:var(--cosmograph-timeline-bar-color);transform:scaleY(-1);opacity:0}.style_module_animationControl__ee52cd66{color:var(--cosmograph-timeline-axis-color);width:6%;max-width:30px;min-width:20px;cursor:pointer;display:none;align-items:center;user-select:none;-webkit-user-select:none;opacity:.5;position:relative;justify-content:center}.style_module_animationControl__ee52cd66>svg{width:50%;max-height:20px;padding-right:2px}.style_module_hidden__a73fe81a{display:none}.style_module_disabled__eb988570{opacity:.2;pointer-events:none}.style_module_highlightedBar__c2fc9bdc{fill:var(--cosmograph-timeline-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-search-font-family: var(--cosmograph-ui-font-family);--cosmograph-search-font-size: 14px;--cosmograph-search-list-font-size: 13.5px;--cosmograph-search-text-color: var(--cosmograph-ui-text);--cosmograph-search-background: transparent;--cosmograph-search-list-background: rgba(0, 0, 0, .2);--cosmograph-search-list-match-background: rgba(255, 255, 255, .2);--cosmograph-search-list-match-color: var(--cosmograph-ui-text)}.style_module_searchInput__d7830601:hover{filter:brightness(1.2) contrast(1)}.style_module_searchInput__d7830601{width:100%;background:transparent;color:var(--cosmograph-search-text-color);border:none;border-bottom:.5px solid var(--cosmograph-search-text-color);padding:4px 20px 5px 2px;font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:opacity .2s ease-out}.style_module_searchInput__d7830601::selection{background:var(--cosmograph-search-list-match-background)}.style_module_searchInput__d7830601:focus{outline:none}.style_module_searchSuggestions__b0d3f71e{color:#fff;width:100%;padding:0;margin:0;background:transparent;overflow-y:auto;flex:1;min-height:0}.style_module_searchSuggestions__b0d3f71e li{padding:5px 10px;cursor:pointer;-webkit-user-select:none;user-select:none;display:block;font-weight:500;font-size:var(--cosmograph-search-list-font-size);max-width:100%;overflow:hidden}.style_module_searchSuggestions__b0d3f71e li>div{white-space:nowrap;font-weight:200;overflow:hidden;text-overflow:ellipsis;width:100%}.style_module_searchSuggestions__b0d3f71e li:hover{background:#ffffff1a}.style_module_searchSuggestions__b0d3f71e mark{background:var(--cosmograph-search-list-match-background);color:var(--cosmograph-search-list-match-color);border-radius:2px}.style_module_clearButton__5ebb41de{position:absolute;right:0;top:0;height:100%;background:none;border:none;color:var(--cosmograph-search-text-color);font-weight:300;cursor:pointer;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d{opacity:.7}.style_module_placeholderWrapper__72d5eb0e{z-index:1;color:var(--cosmograph-search-text-color);font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);position:absolute;top:0;left:0;width:100%;bottom:0;display:flex;line-height:1.25;align-items:center;transition:transform .3s ease-out,opacity .3s ease-out}.style_module_placeholderWrapper__72d5eb0e.style_module_hidden__acfb8431{transform:translate(-30px);pointer-events:none;opacity:0}.style_module_searchInput__d7830601:disabled,.style_module_searchInput__d7830601.style_module_disabled__62c35dc5{opacity:.2;cursor:not-allowed;pointer-events:none}.style_module_disabled__62c35dc5 .style_module_clearButton__5ebb41de{display:none}.style_module_disabled__62c35dc5 .style_module_placeholderWrapper__72d5eb0e{opacity:.3;cursor:not-allowed}.style_module_searchInputWrapper__1edbcb22{position:relative;display:flex;width:100%}.style_module_noResults__363397c3{opacity:.3!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none}.style_module_noResults__363397c3:hover{background:none}.style_module_loading__296e0212{opacity:.7!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none;-webkit-user-select:none;user-select:none}.style_module_dropdownContainer__d98287da{position:absolute;top:100%;left:0;width:100%;background:var(--cosmograph-search-list-background);border-radius:4px;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);opacity:0;transform:translateY(-10px);transition:opacity .2s ease-out,transform .2s ease-out;pointer-events:none;overflow:hidden;z-index:10;display:flex;flex-direction:column;padding-bottom:2px}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b{top:auto;bottom:100%;transform:translateY(10px)}.style_module_dropdownContainer__d98287da.style_module_visible__5be7493d{opacity:1;transform:translateY(0);pointer-events:auto}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b.style_module_visible__5be7493d{opacity:1;transform:translateY(-2px);pointer-events:auto}.style_module_footerContainer__73e7a066{flex-shrink:0}:root{--cosmograph-scrollbar-background: rgba(255, 255, 255, .1);--cosmograph-ui-background: rgb(45, 49, 58);--cosmograph-ui-text: #ffffffc7;--cosmograph-ui-tick-font-size: 11px;--cosmograph-ui-font-size: 12px;--cosmograph-ui-font-family: inherit;--cosmograph-ui-element-color: #5C616A;--cosmograph-ui-highlighted-element-color: white;--cosmograph-ui-selection-control-color: #8d949ea8;-webkit-font-smoothing:antialiased!important;text-rendering:optimizeLegibility!important}.style_module_cosmograph-ui__5acb97f1{background:var(--cosmograph-ui-background);color:var(--cosmograph-ui-text)}.style_module_scrollbar__f1516254 *::-webkit-scrollbar{width:5px;height:5px;border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-track{border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-corner{background:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-button{display:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-thumb{background-color:var(--cosmograph-scrollbar-background);transition:background-color .5s;border-radius:20px;border:3px solid var(--cosmograph-scrollbar-background)}@-moz-document url-prefix(){.style_module_scrollbar__f1516254 *{scrollbar-width:thin;scrollbar-color:var(--cosmograph-scrollbar-background) transparent;scrollbar-track-color:transparent;scrollbar-face-color:var(--cosmograph-scrollbar-background)}}:root{--cosmograph-histogram-background: var(--cosmograph-ui-background);--cosmograph-histogram-text-color: var(--cosmograph-ui-text);--cosmograph-histogram-axis-color: var(--cosmograph-ui-text);--cosmograph-histogram-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-histogram-selection-opacity: .5;--cosmograph-histogram-bar-color: var(--cosmograph-ui-element-color);--cosmograph-histogram-highlighted-bar-color: var( --cosmograph-ui-highlighted-element-color);--cosmograph-histogram-font-family: var(--cosmograph-ui-font-family);--cosmograph-histogram-font-size: var(--cosmograph-ui-tick-font-size)}.style_module_histogram__9d8a77ea{position:relative;display:flex;min-height:25px;background:var(--cosmograph-histogram-background);width:100%}.style_module_histogramSvg__ccccb628{position:relative;width:100%;height:100%}.style_module_selection__7db96137{fill:var(--cosmograph-histogram-selection-color);fill-opacity:var(--cosmograph-histogram-selection-opacity);stroke:none}.style_module_axisTick__898e1f39{color:var(--cosmograph-histogram-axis-color);font-family:var(--cosmograph-histogram-font-family);font-size:var(--cosmograph-histogram-font-size);user-select:none;-webkit-user-select:none;alignment-baseline:text-before-edge;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum"}.style_module_bar__3c9ab488{fill:var(--cosmograph-histogram-bar-color);transform:scaleY(-1)}.style_module_highlightedBar__b193a8de{fill:var(--cosmograph-histogram-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-bars-font-color: var(--cosmograph-ui-text);--cosmograph-bars-font-family: var(--cosmograph-ui-font-family);--cosmograph-bars-font-size: var(--cosmograph-ui-font-size);--cosmograph-bars-ui-font-size: 11.5px;--cosmograph-bars-background: var(--cosmograph-ui-element-color);--cosmograph-bars-bar-height: 20px;--cosmograph-bars-bar-bottom-margin: 2px;--cosmograph-bars-highlighted-color: var( --cosmograph-ui-highlighted-element-color)}.style_module_bars__25497ded{position:relative;width:100%;min-height:100px;user-select:none;flex-direction:column;-webkit-user-select:none}.style_module_bars__25497ded .scroll-container{position:relative;width:100%;overflow-y:hidden;overflow-x:hidden}.style_module_bars__25497ded .bars-container{position:relative;width:calc(100% - 1px);font-family:var(--cosmograph-bars-font-family)}.style_module_bars__25497ded .highlighted-bars-container{position:absolute;top:0;left:0;pointer-events:none}.style_module_bars__25497ded .row{height:var(--cosmograph-bars-bar-height);display:flex;align-items:center;margin-bottom:var(--cosmograph-bars-bar-bottom-margin);width:100%;transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row:hover{filter:brightness(1.15) contrast(1.05);transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row.unselected:hover{filter:brightness(.95) contrast(1.15);transition:filter .05s linear}.style_module_bars__25497ded .unselected{opacity:.85;filter:brightness(.8) contrast(1.1)}.style_module_bars__25497ded .selected{filter:brightness(1.05) contrast(1.05)}.style_module_bars__25497ded .selected>.info>.label{font-weight:600;filter:brightness(1.1) contrast(1.05)}.style_module_bars__25497ded .unselected>.info>.label{font-weight:300}.style_module_bars__25497ded .bar{height:100%;background-color:var(--cosmograph-bars-background);opacity:.8;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .bar-highlighted{height:100%;background-color:var(--cosmograph-bars-highlighted-color);opacity:.2;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .info{display:flex;justify-content:space-between;width:100%;padding:0 4px;position:absolute;font-size:var(--cosmograph-bars-font-size);font-feature-settings:"tnum";color:var(--cosmograph-bars-font-color);gap:2px}.style_module_bars__25497ded .label{min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;transition:opacity .05s linear}.style_module_bars__25497ded .count{flex-shrink:0;font-weight:300;opacity:.8;transition:opacity .05s linear}.style_module_bars__25497ded .show-more{cursor:pointer;padding-top:2px;display:flex;font-weight:300;color:var(--cosmograph-bars-font-color);font-size:11px;justify-content:space-between;opacity:.6;font-size:var(--cosmograph-bars-ui-font-size);pointer-events:none;transition:opacity .1s linear}.style_module_bars__25497ded .show-more:hover{opacity:1;text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .show-more>span{pointer-events:all}.style_module_bars__25497ded .show-more-count{padding-right:5px;pointer-events:all;font-feature-settings:"tnum"}.style_module_bars__25497ded .unselected>.info>.label,.style_module_bars__25497ded .unselected>.info>.count{opacity:.5}.style_module_bars__25497ded .unselected:hover>.info>.label,.style_module_bars__25497ded .unselected:hover>.info>.count{opacity:1}.style_module_bars__25497ded .search-input{background:transparent;border:none;border-bottom:1px solid rgba(255,255,255,.3);font-size:13px!important;color:var(--cosmograph-bars-font-color);line-height:1.5;padding:2px;width:100%;position:relative;transition:border-bottom-color .2s}.style_module_bars__25497ded .search-input::placeholder{color:var(--cosmograph-bars-font-color)!important;opacity:.4;font-weight:300;font-family:inherit}.style_module_bars__25497ded .search-container{position:relative;width:100%;margin-bottom:4px;display:none;z-index:1}.style_module_bars__25497ded .clear-button{position:absolute;right:0;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--cosmograph-bars-font-color);font-weight:300;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_bars__25497ded .clear-button.visible:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_bars__25497ded .clear-button.visible{opacity:.7}.style_module_bars__25497ded .clear-button svg{width:10px;height:10px;fill:currentColor}.style_module_bars__25497ded .sorting-block{visibility:hidden;margin-top:1px;display:flex;justify-content:space-between}.style_module_bars__25497ded .buttons-container{margin-top:4px;font-size:var(--cosmograph-bars-ui-font-size);display:flex;gap:4px;line-height:1.25}.style_module_bars__25497ded .buttons-container>div{transition:opacity .05s linear,filter .05s linear;padding:1px 5px;background:var(--cosmograph-bars-background);border-radius:4px;opacity:.9;display:flex;cursor:pointer;align-items:center}.style_module_bars__25497ded .buttons-container>div:hover{filter:brightness(1.2)}.style_module_bars__25497ded .reset-text{transition:opacity .05s linear,filter .05s linear;display:flex;font-size:var(--cosmograph-bars-ui-font-size);align-items:end;padding-right:4px;cursor:pointer;font-weight:300}.style_module_bars__25497ded .reset-text:hover{text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .reset-text.unselected{pointer-events:none;cursor:default;opacity:.7}.style_module_bars__25497ded :scope.reset-text:hover:not(.unselected){filter:brightness(1.5);opacity:1}:root{--cosmograph-size-legend-form-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-family: inherit;--cosmograph-size-legend-font-size: var(--cosmograph-ui-font-size);--cosmograph-size-legend-sublabel-font-size: 10px;--cosmograph-size-legend-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-size-legend-line-radius: 2px;--cosmograph-size-legend-line-width: 30px;--cosmograph-size-legend-hide-transform: translateY(100%);--cosmograph-size-legend-show-transform: translateX(0)}.style_module_container__d2889234{display:flex;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;overflow:hidden;min-height:25px}.style_module_legend__75c167f2{width:auto;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-size-legend-font-size);font-family:var(--cosmograph-size-legend-font-family);user-select:none;-webkit-user-select:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.04em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__91eae57a{opacity:1;transform:var(--cosmograph-size-legend-show-transform)}.style_module_disabled__d51f7a10{opacity:0;transform:var(--cosmograph-size-legend-hide-transform);pointer-events:none;display:none!important;min-height:0}@starting-style{.style_module_container__d2889234.style_module_enabled__91eae57a,.style_module_legend__75c167f2.style_module_enabled__91eae57a{opacity:0;transform:var(--cosmograph-size-legend-hide-transform)}}.style_module_legend__75c167f2 .circle{background-color:var(--cosmograph-size-legend-form-color);border-radius:50%;transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2 .line{background-color:var(--cosmograph-size-legend-form-color);border-radius:var(--cosmograph-size-legend-line-radius);width:var(--cosmograph-size-legend-line-width);transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2.style_module_events__894316a8{pointer-events:auto;cursor:pointer}.style_module_legend__75c167f2 .legend-content{display:flex;align-items:end;justify-content:center;gap:.75rem}.style_module_legend__75c167f2 .legend-content>div{transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__75c167f2 .labels-wrapper{white-space:nowrap}.style_module_legend__75c167f2 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-size-legend-items-margin)}.style_module_legend__75c167f2 .name{align-items:center;text-align:center;justify-content:center;display:flex;color:var(--cosmograph-size-legend-font-color);overflow:hidden;width:100%;margin-top:3px;word-break:break-all;white-space:pre-line;transition:color .15s ease-in-out;letter-spacing:-.02em}.style_module_legend__75c167f2 .label{color:var(--cosmograph-size-legend-font-color);overflow:hidden;transition:color .15s ease-in-out;text-overflow:ellipsis;font-feature-settings:"tnum"}.style_module_legend__75c167f2 .sublabel{padding-top:1px;font-size:var(--cosmograph-size-legend-sublabel-font-size);opacity:.5;line-height:1;min-width:10px;transition:color .15s ease-in-out}.style_module_hovered__1206707f .label,.style_module_hovered__1206707f .sublabel{color:var(--cosmograph-size-legend-hover-color);cursor:pointer}.style_module_hovered__1206707f .circle,.style_module_hovered__1206707f .line{background-color:var(--cosmograph-size-legend-hover-color);cursor:pointer}:root{--cosmograph-color-legend-range-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-range-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-range-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-label-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-sublabel-font-size: 10px;--cosmograph-color-legend-range-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-range-gradient-height: 6px;--cosmograph-color-legend-range-gradient-radius: 8px;--cosmograph-color-legend-range-gradient-top-margin: 6px;--cosmograph-color-legend-hide-transform: translateY(100%);--cosmograph-color-legend-show-transform: translateX(0)}.style_module_container__05cc807d{display:flex;min-width:150px;min-height:25px;width:100%;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_legend__a3e235e4{width:100%;font-weight:300;letter-spacing:-.04em;display:flex;flex-direction:column;font-size:var(--cosmograph-color-legend-range-font-size);font-family:var(--cosmograph-color-legend-range-font-family);user-select:none;-webkit-user-select:none;pointer-events:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__b3120e27{opacity:1;transform:var(--cosmograph-color-legend-show-transform);pointer-events:auto}.style_module_disabled__c2dc158c{opacity:0;transform:var(--cosmograph-color-legend-hide-transform);pointer-events:none;display:none;min-height:0}@starting-style{.style_module_container__05cc807d.style_module_enabled__b3120e27,.style_module_legend__a3e235e4.style_module_enabled__b3120e27{opacity:0;transform:var(--cosmograph-color-legend-hide-transform)}}.style_module_legend__a3e235e4 .legend-content{display:flex;align-items:end;justify-content:space-between}.style_module_hovered__dfd7bb2c .label,.style_module_hovered__dfd7bb2c .sublabel{color:var(--cosmograph-size-legend-hover-color)!important;cursor:pointer}.style_module_legend__a3e235e4 .extent{white-space:nowrap;transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__a3e235e4 .gradient{width:100%;margin-top:var(--cosmograph-color-legend-range-gradient-top-margin);height:var(--cosmograph-color-legend-range-gradient-height);border-radius:var(--cosmograph-color-legend-range-gradient-radius)}.style_module_legend__a3e235e4 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-color-legend-range-items-margin)}.style_module_legend__a3e235e4 .name{align-items:center;text-align:center;justify-content:space-around;display:flex;color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;width:100%;word-break:break-word;text-wrap:balance;white-space:pre-line;transition:color .15s ease-in-out;margin:0 4px;letter-spacing:-.02em;line-height:1.25}.style_module_legend__a3e235e4 .label{color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;max-width:150px;text-overflow:ellipsis;font-size:var(--cosmograph-color-legend-range-label-font-size);transition:color .15s ease-in-out;line-height:1;font-feature-settings:"tnum"}.style_module_legend__a3e235e4 .sublabel{padding-top:1px;color:var(--cosmograph-color-legend-range-font-color);opacity:.55;font-size:var(--cosmograph-color-legend-range-sublabel-font-size);line-height:1;transition:color .15s ease-in-out}:root{--cosmograph-color-legend-type-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-type-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-type-font-size: 11px;--cosmograph-color-legend-type-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-type-others-color: #bab0ab;--cosmograph-color-legend-type-bullet-size: 8px;--cosmograph-color-legend-type-bullet-radius: 1rem;--cosmograph-color-legend-type-items-margin: 4px;--cosmograph-color-legend-type-hide-transform: translateY(125%);--cosmograph-color-legend-type-show-transform: translateX(0)}.style_module_enabled__277b2403{opacity:1;transform:var(--cosmograph-color-legend-type-show-transform)}.style_module_disabled__7a587f96{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform);display:none!important;min-height:0}.style_module_wrapper__ea8ca7f4{position:relative;max-width:100%;width:fit-content;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_typeLegend__15bf4b2f{position:relative;width:fit-content;max-width:100%;min-height:25px;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.015em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_typeLegend__15bf4b2f .reverted{flex-direction:row-reverse}.style_module_typeLegend__15bf4b2f .scroll-container{width:100%;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-color-legend-type-font-size);font-family:var(--cosmograph-color-legend-type-font-family);user-select:none;-webkit-user-select:none;line-height:normal;overflow-x:hidden;overflow-y:auto;will-change:transform}@starting-style{.style_module_typeLegend__15bf4b2f.style_module_enabled__277b2403,.style_module_wrapper__ea8ca7f4.style_module_enabled__277b2403{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform)}}.style_module_typeLegend__15bf4b2f .legend-item{display:flex;align-items:center;position:absolute;margin-bottom:var(--cosmograph-color-legend-type-items-margin);pointer-events:none;width:100%;padding-left:1px;font-weight:300;transition:filter .1s ease-in-out,opacity .1s ease-in-out;min-height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px + var(--cosmograph-color-legend-type-items-margin));height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px);box-sizing:border-box}.style_module_typeLegend__15bf4b2f .unknown{background-color:var(--cosmograph-color-legend-type-unknown-color)}.style_module_typeLegend__15bf4b2f .others{background-color:var(--cosmograph-color-legend-type-others-color)}.style_module_typeLegend__15bf4b2f .bullet{height:var(--cosmograph-color-legend-type-bullet-size);width:var(--cosmograph-color-legend-type-bullet-size);min-height:var(--cosmograph-color-legend-type-bullet-size);min-width:var(--cosmograph-color-legend-type-bullet-size);border-radius:var(--cosmograph-color-legend-type-bullet-radius);pointer-events:all;margin-right:5px}.style_module_typeLegend__15bf4b2f .label{color:var(--cosmograph-color-legend-type-font-color);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - var(--cosmograph-color-legend-type-bullet-size) - 5px);pointer-events:all;transition:.05s linear color}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.bullet{margin-right:0}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.label{margin-right:5px}.style_module_typeLegend__15bf4b2f .show-more{cursor:pointer;padding-top:4px;display:none;font-weight:300;color:var(--cosmograph-color-legend-type-font-color);font-size:11px;opacity:.6;pointer-events:all;justify-content:space-between;transition:opacity .1s linear;font-feature-settings:"tnum"}.style_module_typeLegend__15bf4b2f .show-more:hover{opacity:1}.style_module_hovered__c0993502 .label,.style_module_hovered__c0993502 .sublabel{color:var(--cosmograph-color-legend-type-hover-color)!important;cursor:pointer}.style_module_selected__36e1dd81{filter:brightness(1)}.style_module_selected__36e1dd81>.style_module_label__afecc7a3{filter:brightness(1.2)}.style_module_unselected__4826cfb7{filter:brightness(.5)}.style_module_typeLegend__15bf4b2f .name{font-size:calc(var(--cosmograph-color-legend-type-font-size) + 1px);font-family:var(--cosmograph-color-legend-type-font-family);color:var(--cosmograph-color-legend-type-font-color);transition:color .15s ease-in-out,opacity .3s ease-in-out,max-height .3s ease-in-out,transform .3s ease-in-out;margin-bottom:4px;margin-top:2px;margin-left:1px;letter-spacing:-.02em;line-height:1.25;overflow:hidden;width:100%;white-space:nowrap;text-overflow:ellipsis;pointer-events:all;-webkit-user-select:none!important;user-select:none!important;max-height:100px;opacity:1;transform:translateY(0)}.style_module_typeLegend__15bf4b2f .name.hidden{opacity:0;max-height:0;margin-bottom:0;margin-top:0;transform:translateY(-10px)}:root{--cosmograph-button-color: var(--cosmograph-ui-text);--cosmograph-button-background: var(--cosmograph-ui-element-color);--cosmograph-button-border-radius: 2px}.style_module_button__e95a1138{background:var(--cosmograph-button-background);color:var(--cosmograph-button-color);border-radius:var(--cosmograph-button-border-radius);display:none;align-items:center;justify-content:center;width:25px;height:25px;margin:3px;padding:5px;cursor:pointer;filter:brightness(.95) contrast(.9);transition:filter .1s}.style_module_button__e95a1138:hover{filter:brightness(1.2) contrast(1)}')),document.head.appendChild(e)}}catch(Xn){}}();var kG=Object.defineProperty,IG=(e,t,n)=>((e,t,n)=>t in e?kG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);let AG=class extends Q${constructor(e,t){const n=R$(TG,t??{});super(e,Q$.extractConfig(n,TG)),IG(this,"_data",[]),IG(this,"_originalData",[]),IG(this,"_config"),IG(this,"_container"),IG(this,"_searchContainer"),IG(this,"_searchInput"),IG(this,"_clearButton"),IG(this,"_scrollContainer"),IG(this,"_barsContainer"),IG(this,"_highlightedBarsContainer"),IG(this,"_showMoreButton"),IG(this,"_showMoreCount"),IG(this,"_sortingBlock"),IG(this,"_uniqueValues",new Set),IG(this,"_countMap",new Int32Array(0)),IG(this,"_visibleItemsCount",0),IG(this,"_hiddenItemsSum",0),IG(this,"_itemHeight",0),IG(this,"_itemMargin",0),IG(this,"_startIndex",0),IG(this,"_endIndex",0),IG(this,"_maxCount",0),IG(this,"_selectedItem"),IG(this,"_isExpanded",!1),IG(this,"_sortingHandlers"),IG(this,"_highlightedCounts"),IG(this,"_isFilteringActive",!1),IG(this,"_updateVisibleItems",()=>{const e=this._itemHeight+this._itemMargin;this._startIndex=Math.floor(this._scrollContainer.scrollTop/e),this._endIndex=Math.min(this._startIndex+this._visibleItemsCount+1,this._data.length),this._renderItems()}),IG(this,"_handleShowMoreCount",()=>{var e,t,n,i,r,o;const s=this._data.length-this._maxDisplayedItems,a=(null==(t=(e=this._config).countFormatter)?void 0:t.call(e,this._hiddenItemsSum))??this._hiddenItemsSum.toString();if(this._isFilteringActive&&this._config.showTotalWhenFiltered){const e=this._data.slice(this._maxDisplayedItems).reduce((e,t)=>e+t.count,0),t=(null==(i=(n=this._config).countFormatter)?void 0:i.call(n,e))??e.toString();this._showMoreCount.textContent=`${a} / ${t}`}else this._showMoreCount.textContent=a;this._showMoreButton.firstChild.textContent=`${(null==(o=(r=this._config).countFormatter)?void 0:o.call(r,s))??s.toString()} more`}),IG(this,"_handleScroll",()=>{this._updateVisibleItems()}),IG(this,"_handleSort",()=>{"alphabetical"===this._config.sort?this.sortAlphabetically(this._config.sortAscending):this.sortByCount(this._config.sortAscending)}),IG(this,"_handleSearch",()=>{const e=this._searchInput.value.toLowerCase();this._clearButton.classList[e?"add":"remove"]("visible"),this._data=this._originalData.filter(t=>String(t.label).toLowerCase().includes(e)),this._handleSort()}),IG(this,"_clearSearch",()=>{this._searchInput.value="",this._handleSearch()}),IG(this,"_handleShowMore",()=>{this._isExpanded=!this._isExpanded,this._isExpanded?(this._scrollContainer.style.overflowY="auto",this._showMoreButton.firstChild.textContent="show less",this._showMoreCount.textContent=""):(this._scrollContainer.style.overflowY="hidden",this._scrollContainer.scrollTop=0,this._handleShowMoreCount())}),this._config=n,this._container=e,this._container.classList.add("style_module_bars__25497ded"),this._container.classList.add(pG),this._scrollContainer=document.createElement("div"),this._scrollContainer.classList.add("scroll-container"),this._barsContainer=document.createElement("div"),this._barsContainer.classList.add("bars-container"),this._highlightedBarsContainer=document.createElement("div"),this._highlightedBarsContainer.classList.add("bars-container","highlighted-bars-container"),this._scrollContainer.appendChild(this._barsContainer),this._scrollContainer.appendChild(this._highlightedBarsContainer),this._showMoreButton=this._createShowMoreButton(),this._sortingBlock=this._createSortingBlock(),this._searchContainer=this._createSearch(),this._container.appendChild(this._searchContainer),this._container.appendChild(this._scrollContainer),this._container.appendChild(this._showMoreButton),this._container.appendChild(this._sortingBlock),this._scrollContainer.addEventListener("scroll",this._handleScroll,{passive:!0})}get _maxDisplayedItems(){return this._config.maxDisplayedItems??10}_createSearch(){const e=document.createElement("div");return e.classList.add("search-container"),this._clearButton=document.createElement("button"),this._clearButton.classList.add("clear-button"),this._clearButton.innerHTML="",this._clearButton.addEventListener("click",this._clearSearch),this._searchInput=document.createElement("input"),this._searchInput.classList.add("search-input"),this._searchInput.placeholder="Search...",this._searchInput.addEventListener("input",this._handleSearch),e.appendChild(this._searchInput),e.appendChild(this._clearButton),e}_updateButtonState(e,t){e.classList.add("selected"),e.classList.remove("unselected"),t.classList.add("unselected"),t.classList.remove("selected")}_updateArrowText(e,t,n){e.textContent=`${t?"":""}${n}`}_createSortingHandlers(e,t,n,i){return{alpha:()=>{"alphabetical"===this._config.sort&&(n=!n,this._updateArrowText(e,n,"ABC")),this._config.sort="alphabetical",this._config.sortAscending=n,this._updateButtonState(e,t),this._handleSort()},numeric:()=>{"count"===this._config.sort&&(i=!i,this._updateArrowText(t,i,"123")),this._config.sort="count",this._config.sortAscending=i,this._updateButtonState(t,e),this._handleSort()},reset:()=>{var e,t;null==(t=(e=this._config).onClick)||t.call(e,void 0),this.setSelectedItem(void 0)}}}_createSortingBlock(){const e=document.createElement("div"),t=document.createElement("div"),[n,i]=[document.createElement("div"),document.createElement("div")],r=document.createElement("div");e.classList.add("sorting-block"),t.classList.add("buttons-container"),r.classList.add("reset-text","unselected");const o="alphabetical"!==this._config.sort||this._config.sortAscending,s="count"!==this._config.sort||this._config.sortAscending;return this._updateArrowText(n,o??!1,"ABC"),this._updateArrowText(i,s??!1,"123"),r.textContent="reset selection",this._config.sort&&this._updateButtonState("alphabetical"===this._config.sort?n:i,"alphabetical"===this._config.sort?i:n),this._sortingHandlers=this._createSortingHandlers(n,i,o??!1,s??!1),n.addEventListener("click",this._sortingHandlers.alpha),i.addEventListener("click",this._sortingHandlers.numeric),r.addEventListener("click",this._sortingHandlers.reset),t.append(n,i),e.append(t,r),e}_createShowMoreButton(){const e=document.createElement("div");e.classList.add("show-more"),e.addEventListener("click",this._handleShowMore);const t=document.createElement("span");return this._showMoreCount=document.createElement("span"),this._showMoreCount.classList.add("show-more-count"),e.appendChild(t),e.appendChild(this._showMoreCount),e}_calculateVisibleItems(){const e=this._itemHeight+this._itemMargin;this._visibleItemsCount=Math.ceil(this._scrollContainer.clientHeight/e)}_createBarElement(e,t=!1,n){var i,r,o,s,a,l,c;if(t){const t=document.createElement("div");t.classList.add("bar-highlighted"),t.dataset.label=e.label,t.style.position="absolute";const i=n/e.count*(e.count/this._maxCount)*100;return t.style.width=`${i}%`,t}const u=document.createElement("div");if(u.classList.add("row"),u.style.position="absolute",null!=(i=this._config)&&i.onClick&&(u.style.cursor="pointer",u.addEventListener("click",()=>{var t,n;return null==(n=(t=this._config).onClick)?void 0:n.call(t,e)})),this._selectedItem){const t=this._container.querySelector(".reset-text");null==t||t.classList.remove("unselected"),null==t||t.classList.add("selected"),u.classList.add(this._selectedItem.label===e.label?"selected":"unselected")}const d=e.count/this._maxCount*100,h=document.createElement("div");h.classList.add("bar"),h.style.width=`${d}%`;const f=document.createElement("div");f.classList.add("info");const p=document.createElement("div");p.classList.add("label"),p.textContent=e.label,p.title=e.label;const m=document.createElement("div");if(m.classList.add("count"),this._isFilteringActive&&void 0!==n){const t=(null==(o=(r=this._config).countFormatter)?void 0:o.call(r,n))??n.toString();if(this._config.showTotalWhenFiltered){const n=(null==(a=(s=this._config).countFormatter)?void 0:a.call(s,e.count))??e.count.toString();m.textContent=`${t} / ${n}`}else m.textContent=t}else m.textContent=(null==(c=(l=this._config).countFormatter)?void 0:c.call(l,e.count))??e.count.toString();return f.append(p,m),u.append(h,f),u}_renderItems(){this._renderItemsToContainer(this._barsContainer,!1),this._renderItemsToContainer(this._highlightedBarsContainer,!0)}_renderItemsToContainer(e,t){var n;const i=this._itemHeight+this._itemMargin;if(t){if(!this._highlightedCounts)return void e.replaceChildren();const t=new Map;for(const i of Array.from(e.children)){const e=i;e.classList.contains("bar-highlighted")&&e.dataset.label&&t.set(e.dataset.label,e)}const n=new Set;for(let r=this._startIndex;r<this._endIndex;r++){const o=this._data[r];if(!o)continue;const s=this._highlightedCounts.get(o.label)||0;if(s>0){n.add(o.label);const a=t.get(o.label);if(a){const e=s/o.count*(o.count/this._maxCount)*100;a.style.width=`${e}%`,a.style.top=r*i+"px"}else{const t=this._createBarElement(o,!0,s);t.style.top=r*i+"px",t.style.height=`${this._itemHeight}px`,e.appendChild(t)}}}for(const[e,i]of t)n.has(e)||i.remove()}else{const t=document.createDocumentFragment();for(let e=this._startIndex;e<this._endIndex;e++){const r=this._data[e];if(!r)continue;const o=(null==(n=this._highlightedCounts)?void 0:n.get(r.label))||0,s=this._createBarElement(r,!1,o);s.style.top=e*i+"px",s.style.height=`${this._itemHeight}px`,t.appendChild(s)}e.replaceChildren(t)}}_updateContainerHeights(e){const t=Math.min(this._originalData.length,this._maxDisplayedItems)*e;this._scrollContainer.style.height=`${t}px`;const n=this._data.length*e+"px";this._barsContainer.style.height=n,this._highlightedBarsContainer.style.height=n}_updateShowMoreButton(){if(this._originalData.length>this._maxDisplayedItems){const e=this._data.length>this._maxDisplayedItems;this._showMoreButton.style.visibility=e?"visible":"hidden",this._showMoreButton.style.display="flex"}else this._showMoreButton.style.display="none"}_updateUIElements(e=TG.showSortingBlock,t=TG.showSearch){this._originalData.length?this._data.length?(this._sortingBlock.style.visibility=e?"visible":"hidden",this._searchContainer.style.display=t?"block":"none",this.hideState(),this._scrollContainer.style.visibility="visible"):(this._sortingBlock.style.visibility=e?"visible":"hidden",this._searchContainer.style.display=t?"block":"none",this._scrollContainer.style.visibility="visible",this.showState(this._searchInput.value.length?"No results found":void 0)):(this._sortingBlock.style.visibility="hidden",this._searchContainer.style.display="none",this._scrollContainer.style.visibility="hidden",this._showMoreButton.style.display="none",this.showState())}_render(){this._maxCount=Math.max(...this._data.map(e=>e.count),1),this._calculateItemDimensions();const{showSortingBlock:e,showSearch:t}=this._config,n=this._itemHeight+this._itemMargin;this._updateContainerHeights(n),this._updateShowMoreButton(),this._updateUIElements(e,t),this._calculateVisibleItems(),this._updateVisibleItems()}_calculateItemDimensions(){if(!this._data.length)return;const e=this._createBarElement(this._data[0]);this._barsContainer.appendChild(e);const t=window.getComputedStyle(e);this._itemHeight=e.offsetHeight,this._itemMargin=parseFloat(t.marginTop)+parseFloat(t.marginBottom),this._barsContainer.removeChild(e)}_calcHiddenSum(){if(this._data.length>this._maxDisplayedItems){const e=this._data.slice(this._maxDisplayedItems);this._isFilteringActive?this._hiddenItemsSum=e.reduce((e,t)=>{var n;return e+((null==(n=this._highlightedCounts)?void 0:n.get(t.label))||0)},0):this._hiddenItemsSum=e.reduce((e,t)=>e+t.count,0)}else this._hiddenItemsSum=0;this._handleShowMoreCount()}getConfig(){return this._config}setConfig(e){this._config=R$(TG,e??{}),this.setDisplayStateConfig(Q$.extractConfig(this._config,TG)),this._isExpanded=(null==e?void 0:e.expanded)??!1,this._calcHiddenSum(),this._render()}setData(e=[]){var t,n;this._clearSearch(),this._uniqueValues=new Set(e),this._countMap=new Int32Array(this._uniqueValues.size);const i=new Map([...this._uniqueValues].map((e,t)=>[e,t]));e.forEach(e=>{const t=i.get(e);void 0!==t&&this._countMap[t]++}),this._data=[...this._uniqueValues].map((e,t)=>({label:e,count:this._countMap[t]||0})),this._originalData=[...this._data],!this._originalData.length&&this._selectedItem&&(this.setSelectedItem(void 0),null==(n=(t=this._config).onClick)||n.call(t,void 0)),this._searchContainer.style.display=this._originalData.length?"block":"none",this._handleSort()}sortByCount(e=!1){this._data.sort((t,n)=>e?t.count-n.count:n.count-t.count),this._calcHiddenSum(),this._render()}sortAlphabetically(e=!0){this._data.sort((t,n)=>e?t.label.toString().localeCompare(n.label):n.label.toString().localeCompare(t.label)),this._calcHiddenSum(),this._render()}destroy(){this._scrollContainer.removeEventListener("scroll",this._handleScroll),this._searchInput.removeEventListener("input",this._handleSearch),this._clearButton.removeEventListener("click",this._clearSearch),this._showMoreButton.removeEventListener("click",this._handleShowMore);const e=this._sortingBlock.querySelector("div:first-child"),t=this._sortingBlock.querySelector("div:nth-child(2)"),n=this._sortingBlock.querySelector(".reset-text");null==e||e.removeEventListener("click",this._sortingHandlers.alpha),null==t||t.removeEventListener("click",this._sortingHandlers.numeric),null==n||n.removeEventListener("click",this._sortingHandlers.reset),this._container.innerHTML="",this._data=[],this._originalData=[],this._uniqueValues.clear(),this._countMap=new Int32Array(0),this._hiddenItemsSum=0,this._highlightedCounts=void 0,this._isFilteringActive=!1,super.destroy()}resetList(){this._scrollContainer.scrollTop=0,this._searchInput.value="",this._selectedItem=void 0,this._highlightedCounts=void 0,this._isFilteringActive=!1,this._data=[...this._originalData],this._updateVisibleItems()}getSelectedItem(){return this._selectedItem}setSelectedItem(e){if(!e){const e=this._container.querySelector(".reset-text");null==e||e.classList.remove("selected"),null==e||e.classList.add("unselected")}this._selectedItem=e,this._updateVisibleItems()}setHighlightedData(e){if(null==e)this._highlightedCounts=void 0,this._isFilteringActive=!1;else{this._highlightedCounts=new Map;for(const n of e)this._highlightedCounts.set(n,(this._highlightedCounts.get(n)||0)+1);const t=this._originalData.reduce((e,t)=>e+t.count,0);this._isFilteringActive=e.length<t}this._calcHiddenSum(),this._renderItems()}setLoadingState(){super.setLoadingState()}};const LG={hidden:!1,label:void 0,labelFormatter:P$,extent:void 0,extentLabels:void 0,enableEvents:!0,form:"point",showSublabels:!1,minSubLabel:"min",maxSubLabel:"max",sizeMultiplier:void 0,onClick:void 0,onMinClick:void 0,onMaxClick:void 0,onHover:void 0,noDataMessage:"No legend data",loadingMessage:"Data loading..."},RG="style_module_enabled__91eae57a",PG="style_module_disabled__d51f7a10";!function(){try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('@keyframes style_module_fadeIn__ffac87fd{0%{opacity:0}to{opacity:.2}}.style_module_displayState__6ae19b84{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:var(--cosmograph-ui-text);display:flex;justify-content:center;align-items:center;min-width:100px;opacity:.2;font-size:calc(var(--cosmograph-ui-font-size) + 1px);letter-spacing:-.02em;font-weight:200;user-select:none;-webkit-user-select:none;animation:style_module_fadeIn__ffac87fd .3s ease-in-out}:root{--cosmograph-timeline-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-timeline-selection-opacity: .5;--cosmograph-timeline-bar-color: var(--cosmograph-ui-element-color);--cosmograph-timeline-highlighted-bar-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-timeline-font-family: var(--cosmograph-ui-font-family);--cosmograph-timeline-font-size: var(--cosmograph-ui-tick-font-size);--cosmograph-timeline-background: var(--cosmograph-ui-background);--cosmograph-timeline-text-color: var(--cosmograph-ui-text);--cosmograph-timeline-axis-color: var(--cosmograph-ui-text)}.style_module_timeline__736434f7{position:relative;display:flex;background:var(--cosmograph-timeline-background);width:100%;min-height:25px;overflow:hidden}.style_module_timelineSvg__b916ad04{position:relative;width:100%;height:100%}.style_module_selection__ebee57f8{fill:var(--cosmograph-timeline-selection-color);fill-opacity:var(--cosmograph-timeline-selection-opacity);stroke:none}.style_module_axisTick__5865631d{color:var(--cosmograph-timeline-axis-color);font:var(--cosmograph-timeline-font-family);font-size:var(--cosmograph-timeline-font-size);user-select:none;-webkit-user-select:none;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum";alignment-baseline:text-before-edge}.style_module_axisLine__992b502d{opacity:.2;color:var(--cosmograph-timeline-axis-color)}.style_module_bar__114fa79f{fill:var(--cosmograph-timeline-bar-color);transform:scaleY(-1);opacity:0}.style_module_animationControl__ee52cd66{color:var(--cosmograph-timeline-axis-color);width:6%;max-width:30px;min-width:20px;cursor:pointer;display:none;align-items:center;user-select:none;-webkit-user-select:none;opacity:.5;position:relative;justify-content:center}.style_module_animationControl__ee52cd66>svg{width:50%;max-height:20px;padding-right:2px}.style_module_hidden__a73fe81a{display:none}.style_module_disabled__eb988570{opacity:.2;pointer-events:none}.style_module_highlightedBar__c2fc9bdc{fill:var(--cosmograph-timeline-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-search-font-family: var(--cosmograph-ui-font-family);--cosmograph-search-font-size: 14px;--cosmograph-search-list-font-size: 13.5px;--cosmograph-search-text-color: var(--cosmograph-ui-text);--cosmograph-search-background: transparent;--cosmograph-search-list-background: rgba(0, 0, 0, .2);--cosmograph-search-list-match-background: rgba(255, 255, 255, .2);--cosmograph-search-list-match-color: var(--cosmograph-ui-text)}.style_module_searchInput__d7830601:hover{filter:brightness(1.2) contrast(1)}.style_module_searchInput__d7830601{width:100%;background:transparent;color:var(--cosmograph-search-text-color);border:none;border-bottom:.5px solid var(--cosmograph-search-text-color);padding:4px 20px 5px 2px;font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:opacity .2s ease-out}.style_module_searchInput__d7830601::selection{background:var(--cosmograph-search-list-match-background)}.style_module_searchInput__d7830601:focus{outline:none}.style_module_searchSuggestions__b0d3f71e{color:#fff;width:100%;padding:0;margin:0;background:transparent;overflow-y:auto;flex:1;min-height:0}.style_module_searchSuggestions__b0d3f71e li{padding:5px 10px;cursor:pointer;-webkit-user-select:none;user-select:none;display:block;font-weight:500;font-size:var(--cosmograph-search-list-font-size);max-width:100%;overflow:hidden}.style_module_searchSuggestions__b0d3f71e li>div{white-space:nowrap;font-weight:200;overflow:hidden;text-overflow:ellipsis;width:100%}.style_module_searchSuggestions__b0d3f71e li:hover{background:#ffffff1a}.style_module_searchSuggestions__b0d3f71e mark{background:var(--cosmograph-search-list-match-background);color:var(--cosmograph-search-list-match-color);border-radius:2px}.style_module_clearButton__5ebb41de{position:absolute;right:0;top:0;height:100%;background:none;border:none;color:var(--cosmograph-search-text-color);font-weight:300;cursor:pointer;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d{opacity:.7}.style_module_placeholderWrapper__72d5eb0e{z-index:1;color:var(--cosmograph-search-text-color);font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);position:absolute;top:0;left:0;width:100%;bottom:0;display:flex;line-height:1.25;align-items:center;transition:transform .3s ease-out,opacity .3s ease-out}.style_module_placeholderWrapper__72d5eb0e.style_module_hidden__acfb8431{transform:translate(-30px);pointer-events:none;opacity:0}.style_module_searchInput__d7830601:disabled,.style_module_searchInput__d7830601.style_module_disabled__62c35dc5{opacity:.2;cursor:not-allowed;pointer-events:none}.style_module_disabled__62c35dc5 .style_module_clearButton__5ebb41de{display:none}.style_module_disabled__62c35dc5 .style_module_placeholderWrapper__72d5eb0e{opacity:.3;cursor:not-allowed}.style_module_searchInputWrapper__1edbcb22{position:relative;display:flex;width:100%}.style_module_noResults__363397c3{opacity:.3!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none}.style_module_noResults__363397c3:hover{background:none}.style_module_loading__296e0212{opacity:.7!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none;-webkit-user-select:none;user-select:none}.style_module_dropdownContainer__d98287da{position:absolute;top:100%;left:0;width:100%;background:var(--cosmograph-search-list-background);border-radius:4px;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);opacity:0;transform:translateY(-10px);transition:opacity .2s ease-out,transform .2s ease-out;pointer-events:none;overflow:hidden;z-index:10;display:flex;flex-direction:column;padding-bottom:2px}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b{top:auto;bottom:100%;transform:translateY(10px)}.style_module_dropdownContainer__d98287da.style_module_visible__5be7493d{opacity:1;transform:translateY(0);pointer-events:auto}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b.style_module_visible__5be7493d{opacity:1;transform:translateY(-2px);pointer-events:auto}.style_module_footerContainer__73e7a066{flex-shrink:0}:root{--cosmograph-scrollbar-background: rgba(255, 255, 255, .1);--cosmograph-ui-background: rgb(45, 49, 58);--cosmograph-ui-text: #ffffffc7;--cosmograph-ui-tick-font-size: 11px;--cosmograph-ui-font-size: 12px;--cosmograph-ui-font-family: inherit;--cosmograph-ui-element-color: #5C616A;--cosmograph-ui-highlighted-element-color: white;--cosmograph-ui-selection-control-color: #8d949ea8;-webkit-font-smoothing:antialiased!important;text-rendering:optimizeLegibility!important}.style_module_cosmograph-ui__5acb97f1{background:var(--cosmograph-ui-background);color:var(--cosmograph-ui-text)}.style_module_scrollbar__f1516254 *::-webkit-scrollbar{width:5px;height:5px;border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-track{border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-corner{background:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-button{display:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-thumb{background-color:var(--cosmograph-scrollbar-background);transition:background-color .5s;border-radius:20px;border:3px solid var(--cosmograph-scrollbar-background)}@-moz-document url-prefix(){.style_module_scrollbar__f1516254 *{scrollbar-width:thin;scrollbar-color:var(--cosmograph-scrollbar-background) transparent;scrollbar-track-color:transparent;scrollbar-face-color:var(--cosmograph-scrollbar-background)}}:root{--cosmograph-histogram-background: var(--cosmograph-ui-background);--cosmograph-histogram-text-color: var(--cosmograph-ui-text);--cosmograph-histogram-axis-color: var(--cosmograph-ui-text);--cosmograph-histogram-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-histogram-selection-opacity: .5;--cosmograph-histogram-bar-color: var(--cosmograph-ui-element-color);--cosmograph-histogram-highlighted-bar-color: var( --cosmograph-ui-highlighted-element-color);--cosmograph-histogram-font-family: var(--cosmograph-ui-font-family);--cosmograph-histogram-font-size: var(--cosmograph-ui-tick-font-size)}.style_module_histogram__9d8a77ea{position:relative;display:flex;min-height:25px;background:var(--cosmograph-histogram-background);width:100%}.style_module_histogramSvg__ccccb628{position:relative;width:100%;height:100%}.style_module_selection__7db96137{fill:var(--cosmograph-histogram-selection-color);fill-opacity:var(--cosmograph-histogram-selection-opacity);stroke:none}.style_module_axisTick__898e1f39{color:var(--cosmograph-histogram-axis-color);font-family:var(--cosmograph-histogram-font-family);font-size:var(--cosmograph-histogram-font-size);user-select:none;-webkit-user-select:none;alignment-baseline:text-before-edge;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum"}.style_module_bar__3c9ab488{fill:var(--cosmograph-histogram-bar-color);transform:scaleY(-1)}.style_module_highlightedBar__b193a8de{fill:var(--cosmograph-histogram-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-bars-font-color: var(--cosmograph-ui-text);--cosmograph-bars-font-family: var(--cosmograph-ui-font-family);--cosmograph-bars-font-size: var(--cosmograph-ui-font-size);--cosmograph-bars-ui-font-size: 11.5px;--cosmograph-bars-background: var(--cosmograph-ui-element-color);--cosmograph-bars-bar-height: 20px;--cosmograph-bars-bar-bottom-margin: 2px;--cosmograph-bars-highlighted-color: var( --cosmograph-ui-highlighted-element-color)}.style_module_bars__25497ded{position:relative;width:100%;min-height:100px;user-select:none;flex-direction:column;-webkit-user-select:none}.style_module_bars__25497ded .scroll-container{position:relative;width:100%;overflow-y:hidden;overflow-x:hidden}.style_module_bars__25497ded .bars-container{position:relative;width:calc(100% - 1px);font-family:var(--cosmograph-bars-font-family)}.style_module_bars__25497ded .highlighted-bars-container{position:absolute;top:0;left:0;pointer-events:none}.style_module_bars__25497ded .row{height:var(--cosmograph-bars-bar-height);display:flex;align-items:center;margin-bottom:var(--cosmograph-bars-bar-bottom-margin);width:100%;transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row:hover{filter:brightness(1.15) contrast(1.05);transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row.unselected:hover{filter:brightness(.95) contrast(1.15);transition:filter .05s linear}.style_module_bars__25497ded .unselected{opacity:.85;filter:brightness(.8) contrast(1.1)}.style_module_bars__25497ded .selected{filter:brightness(1.05) contrast(1.05)}.style_module_bars__25497ded .selected>.info>.label{font-weight:600;filter:brightness(1.1) contrast(1.05)}.style_module_bars__25497ded .unselected>.info>.label{font-weight:300}.style_module_bars__25497ded .bar{height:100%;background-color:var(--cosmograph-bars-background);opacity:.8;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .bar-highlighted{height:100%;background-color:var(--cosmograph-bars-highlighted-color);opacity:.2;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .info{display:flex;justify-content:space-between;width:100%;padding:0 4px;position:absolute;font-size:var(--cosmograph-bars-font-size);font-feature-settings:"tnum";color:var(--cosmograph-bars-font-color);gap:2px}.style_module_bars__25497ded .label{min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;transition:opacity .05s linear}.style_module_bars__25497ded .count{flex-shrink:0;font-weight:300;opacity:.8;transition:opacity .05s linear}.style_module_bars__25497ded .show-more{cursor:pointer;padding-top:2px;display:flex;font-weight:300;color:var(--cosmograph-bars-font-color);font-size:11px;justify-content:space-between;opacity:.6;font-size:var(--cosmograph-bars-ui-font-size);pointer-events:none;transition:opacity .1s linear}.style_module_bars__25497ded .show-more:hover{opacity:1;text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .show-more>span{pointer-events:all}.style_module_bars__25497ded .show-more-count{padding-right:5px;pointer-events:all;font-feature-settings:"tnum"}.style_module_bars__25497ded .unselected>.info>.label,.style_module_bars__25497ded .unselected>.info>.count{opacity:.5}.style_module_bars__25497ded .unselected:hover>.info>.label,.style_module_bars__25497ded .unselected:hover>.info>.count{opacity:1}.style_module_bars__25497ded .search-input{background:transparent;border:none;border-bottom:1px solid rgba(255,255,255,.3);font-size:13px!important;color:var(--cosmograph-bars-font-color);line-height:1.5;padding:2px;width:100%;position:relative;transition:border-bottom-color .2s}.style_module_bars__25497ded .search-input::placeholder{color:var(--cosmograph-bars-font-color)!important;opacity:.4;font-weight:300;font-family:inherit}.style_module_bars__25497ded .search-container{position:relative;width:100%;margin-bottom:4px;display:none;z-index:1}.style_module_bars__25497ded .clear-button{position:absolute;right:0;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--cosmograph-bars-font-color);font-weight:300;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_bars__25497ded .clear-button.visible:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_bars__25497ded .clear-button.visible{opacity:.7}.style_module_bars__25497ded .clear-button svg{width:10px;height:10px;fill:currentColor}.style_module_bars__25497ded .sorting-block{visibility:hidden;margin-top:1px;display:flex;justify-content:space-between}.style_module_bars__25497ded .buttons-container{margin-top:4px;font-size:var(--cosmograph-bars-ui-font-size);display:flex;gap:4px;line-height:1.25}.style_module_bars__25497ded .buttons-container>div{transition:opacity .05s linear,filter .05s linear;padding:1px 5px;background:var(--cosmograph-bars-background);border-radius:4px;opacity:.9;display:flex;cursor:pointer;align-items:center}.style_module_bars__25497ded .buttons-container>div:hover{filter:brightness(1.2)}.style_module_bars__25497ded .reset-text{transition:opacity .05s linear,filter .05s linear;display:flex;font-size:var(--cosmograph-bars-ui-font-size);align-items:end;padding-right:4px;cursor:pointer;font-weight:300}.style_module_bars__25497ded .reset-text:hover{text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .reset-text.unselected{pointer-events:none;cursor:default;opacity:.7}.style_module_bars__25497ded :scope.reset-text:hover:not(.unselected){filter:brightness(1.5);opacity:1}:root{--cosmograph-size-legend-form-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-family: inherit;--cosmograph-size-legend-font-size: var(--cosmograph-ui-font-size);--cosmograph-size-legend-sublabel-font-size: 10px;--cosmograph-size-legend-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-size-legend-line-radius: 2px;--cosmograph-size-legend-line-width: 30px;--cosmograph-size-legend-hide-transform: translateY(100%);--cosmograph-size-legend-show-transform: translateX(0)}.style_module_container__d2889234{display:flex;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;overflow:hidden;min-height:25px}.style_module_legend__75c167f2{width:auto;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-size-legend-font-size);font-family:var(--cosmograph-size-legend-font-family);user-select:none;-webkit-user-select:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.04em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__91eae57a{opacity:1;transform:var(--cosmograph-size-legend-show-transform)}.style_module_disabled__d51f7a10{opacity:0;transform:var(--cosmograph-size-legend-hide-transform);pointer-events:none;display:none!important;min-height:0}@starting-style{.style_module_container__d2889234.style_module_enabled__91eae57a,.style_module_legend__75c167f2.style_module_enabled__91eae57a{opacity:0;transform:var(--cosmograph-size-legend-hide-transform)}}.style_module_legend__75c167f2 .circle{background-color:var(--cosmograph-size-legend-form-color);border-radius:50%;transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2 .line{background-color:var(--cosmograph-size-legend-form-color);border-radius:var(--cosmograph-size-legend-line-radius);width:var(--cosmograph-size-legend-line-width);transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2.style_module_events__894316a8{pointer-events:auto;cursor:pointer}.style_module_legend__75c167f2 .legend-content{display:flex;align-items:end;justify-content:center;gap:.75rem}.style_module_legend__75c167f2 .legend-content>div{transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__75c167f2 .labels-wrapper{white-space:nowrap}.style_module_legend__75c167f2 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-size-legend-items-margin)}.style_module_legend__75c167f2 .name{align-items:center;text-align:center;justify-content:center;display:flex;color:var(--cosmograph-size-legend-font-color);overflow:hidden;width:100%;margin-top:3px;word-break:break-all;white-space:pre-line;transition:color .15s ease-in-out;letter-spacing:-.02em}.style_module_legend__75c167f2 .label{color:var(--cosmograph-size-legend-font-color);overflow:hidden;transition:color .15s ease-in-out;text-overflow:ellipsis;font-feature-settings:"tnum"}.style_module_legend__75c167f2 .sublabel{padding-top:1px;font-size:var(--cosmograph-size-legend-sublabel-font-size);opacity:.5;line-height:1;min-width:10px;transition:color .15s ease-in-out}.style_module_hovered__1206707f .label,.style_module_hovered__1206707f .sublabel{color:var(--cosmograph-size-legend-hover-color);cursor:pointer}.style_module_hovered__1206707f .circle,.style_module_hovered__1206707f .line{background-color:var(--cosmograph-size-legend-hover-color);cursor:pointer}:root{--cosmograph-color-legend-range-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-range-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-range-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-label-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-sublabel-font-size: 10px;--cosmograph-color-legend-range-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-range-gradient-height: 6px;--cosmograph-color-legend-range-gradient-radius: 8px;--cosmograph-color-legend-range-gradient-top-margin: 6px;--cosmograph-color-legend-hide-transform: translateY(100%);--cosmograph-color-legend-show-transform: translateX(0)}.style_module_container__05cc807d{display:flex;min-width:150px;min-height:25px;width:100%;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_legend__a3e235e4{width:100%;font-weight:300;letter-spacing:-.04em;display:flex;flex-direction:column;font-size:var(--cosmograph-color-legend-range-font-size);font-family:var(--cosmograph-color-legend-range-font-family);user-select:none;-webkit-user-select:none;pointer-events:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__b3120e27{opacity:1;transform:var(--cosmograph-color-legend-show-transform);pointer-events:auto}.style_module_disabled__c2dc158c{opacity:0;transform:var(--cosmograph-color-legend-hide-transform);pointer-events:none;display:none;min-height:0}@starting-style{.style_module_container__05cc807d.style_module_enabled__b3120e27,.style_module_legend__a3e235e4.style_module_enabled__b3120e27{opacity:0;transform:var(--cosmograph-color-legend-hide-transform)}}.style_module_legend__a3e235e4 .legend-content{display:flex;align-items:end;justify-content:space-between}.style_module_hovered__dfd7bb2c .label,.style_module_hovered__dfd7bb2c .sublabel{color:var(--cosmograph-size-legend-hover-color)!important;cursor:pointer}.style_module_legend__a3e235e4 .extent{white-space:nowrap;transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__a3e235e4 .gradient{width:100%;margin-top:var(--cosmograph-color-legend-range-gradient-top-margin);height:var(--cosmograph-color-legend-range-gradient-height);border-radius:var(--cosmograph-color-legend-range-gradient-radius)}.style_module_legend__a3e235e4 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-color-legend-range-items-margin)}.style_module_legend__a3e235e4 .name{align-items:center;text-align:center;justify-content:space-around;display:flex;color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;width:100%;word-break:break-word;text-wrap:balance;white-space:pre-line;transition:color .15s ease-in-out;margin:0 4px;letter-spacing:-.02em;line-height:1.25}.style_module_legend__a3e235e4 .label{color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;max-width:150px;text-overflow:ellipsis;font-size:var(--cosmograph-color-legend-range-label-font-size);transition:color .15s ease-in-out;line-height:1;font-feature-settings:"tnum"}.style_module_legend__a3e235e4 .sublabel{padding-top:1px;color:var(--cosmograph-color-legend-range-font-color);opacity:.55;font-size:var(--cosmograph-color-legend-range-sublabel-font-size);line-height:1;transition:color .15s ease-in-out}:root{--cosmograph-color-legend-type-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-type-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-type-font-size: 11px;--cosmograph-color-legend-type-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-type-others-color: #bab0ab;--cosmograph-color-legend-type-bullet-size: 8px;--cosmograph-color-legend-type-bullet-radius: 1rem;--cosmograph-color-legend-type-items-margin: 4px;--cosmograph-color-legend-type-hide-transform: translateY(125%);--cosmograph-color-legend-type-show-transform: translateX(0)}.style_module_enabled__277b2403{opacity:1;transform:var(--cosmograph-color-legend-type-show-transform)}.style_module_disabled__7a587f96{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform);display:none!important;min-height:0}.style_module_wrapper__ea8ca7f4{position:relative;max-width:100%;width:fit-content;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_typeLegend__15bf4b2f{position:relative;width:fit-content;max-width:100%;min-height:25px;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.015em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_typeLegend__15bf4b2f .reverted{flex-direction:row-reverse}.style_module_typeLegend__15bf4b2f .scroll-container{width:100%;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-color-legend-type-font-size);font-family:var(--cosmograph-color-legend-type-font-family);user-select:none;-webkit-user-select:none;line-height:normal;overflow-x:hidden;overflow-y:auto;will-change:transform}@starting-style{.style_module_typeLegend__15bf4b2f.style_module_enabled__277b2403,.style_module_wrapper__ea8ca7f4.style_module_enabled__277b2403{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform)}}.style_module_typeLegend__15bf4b2f .legend-item{display:flex;align-items:center;position:absolute;margin-bottom:var(--cosmograph-color-legend-type-items-margin);pointer-events:none;width:100%;padding-left:1px;font-weight:300;transition:filter .1s ease-in-out,opacity .1s ease-in-out;min-height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px + var(--cosmograph-color-legend-type-items-margin));height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px);box-sizing:border-box}.style_module_typeLegend__15bf4b2f .unknown{background-color:var(--cosmograph-color-legend-type-unknown-color)}.style_module_typeLegend__15bf4b2f .others{background-color:var(--cosmograph-color-legend-type-others-color)}.style_module_typeLegend__15bf4b2f .bullet{height:var(--cosmograph-color-legend-type-bullet-size);width:var(--cosmograph-color-legend-type-bullet-size);min-height:var(--cosmograph-color-legend-type-bullet-size);min-width:var(--cosmograph-color-legend-type-bullet-size);border-radius:var(--cosmograph-color-legend-type-bullet-radius);pointer-events:all;margin-right:5px}.style_module_typeLegend__15bf4b2f .label{color:var(--cosmograph-color-legend-type-font-color);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - var(--cosmograph-color-legend-type-bullet-size) - 5px);pointer-events:all;transition:.05s linear color}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.bullet{margin-right:0}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.label{margin-right:5px}.style_module_typeLegend__15bf4b2f .show-more{cursor:pointer;padding-top:4px;display:none;font-weight:300;color:var(--cosmograph-color-legend-type-font-color);font-size:11px;opacity:.6;pointer-events:all;justify-content:space-between;transition:opacity .1s linear;font-feature-settings:"tnum"}.style_module_typeLegend__15bf4b2f .show-more:hover{opacity:1}.style_module_hovered__c0993502 .label,.style_module_hovered__c0993502 .sublabel{color:var(--cosmograph-color-legend-type-hover-color)!important;cursor:pointer}.style_module_selected__36e1dd81{filter:brightness(1)}.style_module_selected__36e1dd81>.style_module_label__afecc7a3{filter:brightness(1.2)}.style_module_unselected__4826cfb7{filter:brightness(.5)}.style_module_typeLegend__15bf4b2f .name{font-size:calc(var(--cosmograph-color-legend-type-font-size) + 1px);font-family:var(--cosmograph-color-legend-type-font-family);color:var(--cosmograph-color-legend-type-font-color);transition:color .15s ease-in-out,opacity .3s ease-in-out,max-height .3s ease-in-out,transform .3s ease-in-out;margin-bottom:4px;margin-top:2px;margin-left:1px;letter-spacing:-.02em;line-height:1.25;overflow:hidden;width:100%;white-space:nowrap;text-overflow:ellipsis;pointer-events:all;-webkit-user-select:none!important;user-select:none!important;max-height:100px;opacity:1;transform:translateY(0)}.style_module_typeLegend__15bf4b2f .name.hidden{opacity:0;max-height:0;margin-bottom:0;margin-top:0;transform:translateY(-10px)}:root{--cosmograph-button-color: var(--cosmograph-ui-text);--cosmograph-button-background: var(--cosmograph-ui-element-color);--cosmograph-button-border-radius: 2px}.style_module_button__e95a1138{background:var(--cosmograph-button-background);color:var(--cosmograph-button-color);border-radius:var(--cosmograph-button-border-radius);display:none;align-items:center;justify-content:center;width:25px;height:25px;margin:3px;padding:5px;cursor:pointer;filter:brightness(.95) contrast(.9);transition:filter .1s}.style_module_button__e95a1138:hover{filter:brightness(1.2) contrast(1)}')),document.head.appendChild(e)}}catch(Xn){}}();var MG=Object.defineProperty,DG=(e,t,n)=>((e,t,n)=>t in e?MG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);let NG=class extends Q${constructor(e,t){const n=R$(LG,t??{});super(e,Q$.extractConfig(n,LG)),DG(this,"_config"),DG(this,"_containerNode"),DG(this,"_legend"),DG(this,"_sizeElements",null),DG(this,"_isHidden",!1),DG(this,"_handleClick",e=>{var t,n;this._config.enableEvents&&(null==(n=(t=this._config).onClick)||n.call(t,e))}),DG(this,"_handleHover",e=>{var t,n;this._config.enableEvents&&(null==(n=(t=this._config).onHover)||n.call(t,e))}),DG(this,"_handleSizeElementHover",e=>{var t,n,i,r;if(!this._config.enableEvents||!this._config.extent||!this._sizeElements)return;const o=e.currentTarget;if(!o)return;const s=o.classList.contains("min")?"min":"max",a="mouseenter"===e.type,l="min"===s?0:this._config.extent.length-1,c=null==(t=this._config.extent)?void 0:t[l],u=null==(n=this._config.extentLabels)?void 0:n[l];o.classList.toggle("style_module_hovered__1206707f",a),null==(r=(i=this._config).onHover)||r.call(i,{target:o,type:s,size:c,value:u})}),DG(this,"_handleSizeElementClick",e=>{var t,n;if(!this._config.enableEvents)return;const i=e.currentTarget.className.includes("min")?"min":"max",r="min"===i?this._config.onMinClick:this._config.onMaxClick;if(r){const o=(null==(t=this._config.extent)?void 0:t["min"===i?0:1])??void 0;r(o,(null==(n=this._config.extentLabels)?void 0:n["min"===i?0:1])??o,e)}}),this._config=n,this._containerNode=e,this._containerNode.classList.add("style_module_container__d2889234"),this._createElements()}hide(){this._isHidden||(this._isHidden=!0,this._containerNode.classList.remove(RG),this._containerNode.classList.add(PG))}show(){this._isHidden&&(this._isHidden=!1,this._containerNode.classList.remove(PG),this._containerNode.classList.add(RG))}setConfig(e){this._config=R$(LG,e??{}),this.setDisplayStateConfig(Q$.extractConfig(this._config,LG)),this._updateLegend()}setLoadingState(){super.setLoadingState()}destroy(){this._legend&&(this._legend.removeEventListener("click",this._handleClick),this._legend.removeEventListener("mouseover",this._handleHover),this._sizeElements&&["min","max"].forEach(e=>{const t=this._sizeElements[e];t.removeEventListener("click",this._handleSizeElementClick),t.removeEventListener("mouseenter",this._handleSizeElementHover),t.removeEventListener("mouseleave",this._handleSizeElementHover)}),this._containerNode.removeChild(this._legend),super.destroy())}get sizeElements(){return this._sizeElements}get config(){return this._config}get isHidden(){return this._isHidden}_createElements(){this._legend=this._createLegendElement(),this._containerNode.appendChild(this._legend),this._isHidden||this.show()}_createLegendElement(){const e=document.createElement("div");e.classList.add("style_module_legend__75c167f2");const t=document.createElement("div");t.className="legend-content",this._sizeElements={min:this._createSizeElement("min"),max:this._createSizeElement("max")},t.appendChild(this._sizeElements.min),t.appendChild(this._sizeElements.max),e.appendChild(t);const n=document.createElement("div");return n.className="name",e.appendChild(n),e}_createSizeElement(e){const t=document.createElement("div");t.classList.add(e);const n=document.createElement("div");t.appendChild(n);const i=document.createElement("div");return i.className="label",t.appendChild(i),t.addEventListener("click",this._handleSizeElementClick),t.addEventListener("mouseenter",this._handleSizeElementHover),t.addEventListener("mouseleave",this._handleSizeElementHover),t}_updateLegend(){const{extent:e,extentLabels:t}=this._config,{noDataMessage:n,loadingMessage:i}=this._displayStateConfig,r=!e&&!1===n&&!1===i;if(this._config.hidden||r?this.hide():this.show(),null!=e&&e.every(Number.isFinite)&&null!=t&&t.every(Number.isFinite)){this.hideState();const e=this._legend.querySelector(".name");e&&(e.textContent=this._config.label??""),this._sizeElements&&(t[0]===t[1]?(this._updateSizeElement("min"),this._sizeElements.min.style.display="block",this._sizeElements.max.style.display="none"):(this._updateSizeElement("min"),this._updateSizeElement("max"),this._sizeElements.min.style.display="block",this._sizeElements.max.style.display="block")),this._legend.classList.remove(PG),this._legend.classList.add(RG)}else this.showState(),this._legend.classList.remove(RG),this._legend.classList.add(PG)}_updateSizeElement(e){var t,n;if(!this._sizeElements)return;const i=this._sizeElements[e];i.style.pointerEvents=this._config.enableEvents?"auto":"none";const r=(null==(t=this._config.extent)?void 0:t["min"===e?0:1])??1,o=(null==(n=this._config.extentLabels)?void 0:n["min"===e?0:1])??r,s=i.querySelector("div");"point"===this._config.form?(s.classList.remove("line"),s.classList.add("circle"),s.style.height=s.style.width=r*(this._config.sizeMultiplier??1)+"px"):(s.style.width="",s.classList.remove("circle"),s.classList.add("line"),s.style.height=r*(this._config.sizeMultiplier??1)+"px"),i.querySelector(".label").textContent=this._formatLabel(o),this._updateSublabel(i,e)}_updateSublabel(e,t){let n=e.querySelector(".sublabel");this._config.showSublabels?(n||(n=document.createElement("div"),n.className="sublabel",e.appendChild(n)),n.textContent="min"===t?this._config.minSubLabel??"min":this._config.maxSubLabel??"max"):n&&n.remove()}_formatLabel(e){return this._config.labelFormatter?this._config.labelFormatter(e):e.toString()}};const FG={hidden:!1,label:void 0,labelFormatter:P$,extent:void 0,extentLabels:void 0,enableEvents:!0,showSublabels:!1,minSubLabel:"min",maxSubLabel:"max",discreteColors:!1,onClick:void 0,onHover:void 0,onMaxClick:void 0,onMinClick:void 0,noDataMessage:"No legend data",loadingMessage:"Data loading..."},OG="style_module_enabled__b3120e27",BG="style_module_disabled__c2dc158c";!function(){try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('@keyframes style_module_fadeIn__ffac87fd{0%{opacity:0}to{opacity:.2}}.style_module_displayState__6ae19b84{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:var(--cosmograph-ui-text);display:flex;justify-content:center;align-items:center;min-width:100px;opacity:.2;font-size:calc(var(--cosmograph-ui-font-size) + 1px);letter-spacing:-.02em;font-weight:200;user-select:none;-webkit-user-select:none;animation:style_module_fadeIn__ffac87fd .3s ease-in-out}:root{--cosmograph-timeline-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-timeline-selection-opacity: .5;--cosmograph-timeline-bar-color: var(--cosmograph-ui-element-color);--cosmograph-timeline-highlighted-bar-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-timeline-font-family: var(--cosmograph-ui-font-family);--cosmograph-timeline-font-size: var(--cosmograph-ui-tick-font-size);--cosmograph-timeline-background: var(--cosmograph-ui-background);--cosmograph-timeline-text-color: var(--cosmograph-ui-text);--cosmograph-timeline-axis-color: var(--cosmograph-ui-text)}.style_module_timeline__736434f7{position:relative;display:flex;background:var(--cosmograph-timeline-background);width:100%;min-height:25px;overflow:hidden}.style_module_timelineSvg__b916ad04{position:relative;width:100%;height:100%}.style_module_selection__ebee57f8{fill:var(--cosmograph-timeline-selection-color);fill-opacity:var(--cosmograph-timeline-selection-opacity);stroke:none}.style_module_axisTick__5865631d{color:var(--cosmograph-timeline-axis-color);font:var(--cosmograph-timeline-font-family);font-size:var(--cosmograph-timeline-font-size);user-select:none;-webkit-user-select:none;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum";alignment-baseline:text-before-edge}.style_module_axisLine__992b502d{opacity:.2;color:var(--cosmograph-timeline-axis-color)}.style_module_bar__114fa79f{fill:var(--cosmograph-timeline-bar-color);transform:scaleY(-1);opacity:0}.style_module_animationControl__ee52cd66{color:var(--cosmograph-timeline-axis-color);width:6%;max-width:30px;min-width:20px;cursor:pointer;display:none;align-items:center;user-select:none;-webkit-user-select:none;opacity:.5;position:relative;justify-content:center}.style_module_animationControl__ee52cd66>svg{width:50%;max-height:20px;padding-right:2px}.style_module_hidden__a73fe81a{display:none}.style_module_disabled__eb988570{opacity:.2;pointer-events:none}.style_module_highlightedBar__c2fc9bdc{fill:var(--cosmograph-timeline-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-search-font-family: var(--cosmograph-ui-font-family);--cosmograph-search-font-size: 14px;--cosmograph-search-list-font-size: 13.5px;--cosmograph-search-text-color: var(--cosmograph-ui-text);--cosmograph-search-background: transparent;--cosmograph-search-list-background: rgba(0, 0, 0, .2);--cosmograph-search-list-match-background: rgba(255, 255, 255, .2);--cosmograph-search-list-match-color: var(--cosmograph-ui-text)}.style_module_searchInput__d7830601:hover{filter:brightness(1.2) contrast(1)}.style_module_searchInput__d7830601{width:100%;background:transparent;color:var(--cosmograph-search-text-color);border:none;border-bottom:.5px solid var(--cosmograph-search-text-color);padding:4px 20px 5px 2px;font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:opacity .2s ease-out}.style_module_searchInput__d7830601::selection{background:var(--cosmograph-search-list-match-background)}.style_module_searchInput__d7830601:focus{outline:none}.style_module_searchSuggestions__b0d3f71e{color:#fff;width:100%;padding:0;margin:0;background:transparent;overflow-y:auto;flex:1;min-height:0}.style_module_searchSuggestions__b0d3f71e li{padding:5px 10px;cursor:pointer;-webkit-user-select:none;user-select:none;display:block;font-weight:500;font-size:var(--cosmograph-search-list-font-size);max-width:100%;overflow:hidden}.style_module_searchSuggestions__b0d3f71e li>div{white-space:nowrap;font-weight:200;overflow:hidden;text-overflow:ellipsis;width:100%}.style_module_searchSuggestions__b0d3f71e li:hover{background:#ffffff1a}.style_module_searchSuggestions__b0d3f71e mark{background:var(--cosmograph-search-list-match-background);color:var(--cosmograph-search-list-match-color);border-radius:2px}.style_module_clearButton__5ebb41de{position:absolute;right:0;top:0;height:100%;background:none;border:none;color:var(--cosmograph-search-text-color);font-weight:300;cursor:pointer;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d{opacity:.7}.style_module_placeholderWrapper__72d5eb0e{z-index:1;color:var(--cosmograph-search-text-color);font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);position:absolute;top:0;left:0;width:100%;bottom:0;display:flex;line-height:1.25;align-items:center;transition:transform .3s ease-out,opacity .3s ease-out}.style_module_placeholderWrapper__72d5eb0e.style_module_hidden__acfb8431{transform:translate(-30px);pointer-events:none;opacity:0}.style_module_searchInput__d7830601:disabled,.style_module_searchInput__d7830601.style_module_disabled__62c35dc5{opacity:.2;cursor:not-allowed;pointer-events:none}.style_module_disabled__62c35dc5 .style_module_clearButton__5ebb41de{display:none}.style_module_disabled__62c35dc5 .style_module_placeholderWrapper__72d5eb0e{opacity:.3;cursor:not-allowed}.style_module_searchInputWrapper__1edbcb22{position:relative;display:flex;width:100%}.style_module_noResults__363397c3{opacity:.3!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none}.style_module_noResults__363397c3:hover{background:none}.style_module_loading__296e0212{opacity:.7!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none;-webkit-user-select:none;user-select:none}.style_module_dropdownContainer__d98287da{position:absolute;top:100%;left:0;width:100%;background:var(--cosmograph-search-list-background);border-radius:4px;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);opacity:0;transform:translateY(-10px);transition:opacity .2s ease-out,transform .2s ease-out;pointer-events:none;overflow:hidden;z-index:10;display:flex;flex-direction:column;padding-bottom:2px}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b{top:auto;bottom:100%;transform:translateY(10px)}.style_module_dropdownContainer__d98287da.style_module_visible__5be7493d{opacity:1;transform:translateY(0);pointer-events:auto}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b.style_module_visible__5be7493d{opacity:1;transform:translateY(-2px);pointer-events:auto}.style_module_footerContainer__73e7a066{flex-shrink:0}:root{--cosmograph-scrollbar-background: rgba(255, 255, 255, .1);--cosmograph-ui-background: rgb(45, 49, 58);--cosmograph-ui-text: #ffffffc7;--cosmograph-ui-tick-font-size: 11px;--cosmograph-ui-font-size: 12px;--cosmograph-ui-font-family: inherit;--cosmograph-ui-element-color: #5C616A;--cosmograph-ui-highlighted-element-color: white;--cosmograph-ui-selection-control-color: #8d949ea8;-webkit-font-smoothing:antialiased!important;text-rendering:optimizeLegibility!important}.style_module_cosmograph-ui__5acb97f1{background:var(--cosmograph-ui-background);color:var(--cosmograph-ui-text)}.style_module_scrollbar__f1516254 *::-webkit-scrollbar{width:5px;height:5px;border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-track{border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-corner{background:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-button{display:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-thumb{background-color:var(--cosmograph-scrollbar-background);transition:background-color .5s;border-radius:20px;border:3px solid var(--cosmograph-scrollbar-background)}@-moz-document url-prefix(){.style_module_scrollbar__f1516254 *{scrollbar-width:thin;scrollbar-color:var(--cosmograph-scrollbar-background) transparent;scrollbar-track-color:transparent;scrollbar-face-color:var(--cosmograph-scrollbar-background)}}:root{--cosmograph-histogram-background: var(--cosmograph-ui-background);--cosmograph-histogram-text-color: var(--cosmograph-ui-text);--cosmograph-histogram-axis-color: var(--cosmograph-ui-text);--cosmograph-histogram-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-histogram-selection-opacity: .5;--cosmograph-histogram-bar-color: var(--cosmograph-ui-element-color);--cosmograph-histogram-highlighted-bar-color: var( --cosmograph-ui-highlighted-element-color);--cosmograph-histogram-font-family: var(--cosmograph-ui-font-family);--cosmograph-histogram-font-size: var(--cosmograph-ui-tick-font-size)}.style_module_histogram__9d8a77ea{position:relative;display:flex;min-height:25px;background:var(--cosmograph-histogram-background);width:100%}.style_module_histogramSvg__ccccb628{position:relative;width:100%;height:100%}.style_module_selection__7db96137{fill:var(--cosmograph-histogram-selection-color);fill-opacity:var(--cosmograph-histogram-selection-opacity);stroke:none}.style_module_axisTick__898e1f39{color:var(--cosmograph-histogram-axis-color);font-family:var(--cosmograph-histogram-font-family);font-size:var(--cosmograph-histogram-font-size);user-select:none;-webkit-user-select:none;alignment-baseline:text-before-edge;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum"}.style_module_bar__3c9ab488{fill:var(--cosmograph-histogram-bar-color);transform:scaleY(-1)}.style_module_highlightedBar__b193a8de{fill:var(--cosmograph-histogram-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-bars-font-color: var(--cosmograph-ui-text);--cosmograph-bars-font-family: var(--cosmograph-ui-font-family);--cosmograph-bars-font-size: var(--cosmograph-ui-font-size);--cosmograph-bars-ui-font-size: 11.5px;--cosmograph-bars-background: var(--cosmograph-ui-element-color);--cosmograph-bars-bar-height: 20px;--cosmograph-bars-bar-bottom-margin: 2px;--cosmograph-bars-highlighted-color: var( --cosmograph-ui-highlighted-element-color)}.style_module_bars__25497ded{position:relative;width:100%;min-height:100px;user-select:none;flex-direction:column;-webkit-user-select:none}.style_module_bars__25497ded .scroll-container{position:relative;width:100%;overflow-y:hidden;overflow-x:hidden}.style_module_bars__25497ded .bars-container{position:relative;width:calc(100% - 1px);font-family:var(--cosmograph-bars-font-family)}.style_module_bars__25497ded .highlighted-bars-container{position:absolute;top:0;left:0;pointer-events:none}.style_module_bars__25497ded .row{height:var(--cosmograph-bars-bar-height);display:flex;align-items:center;margin-bottom:var(--cosmograph-bars-bar-bottom-margin);width:100%;transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row:hover{filter:brightness(1.15) contrast(1.05);transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row.unselected:hover{filter:brightness(.95) contrast(1.15);transition:filter .05s linear}.style_module_bars__25497ded .unselected{opacity:.85;filter:brightness(.8) contrast(1.1)}.style_module_bars__25497ded .selected{filter:brightness(1.05) contrast(1.05)}.style_module_bars__25497ded .selected>.info>.label{font-weight:600;filter:brightness(1.1) contrast(1.05)}.style_module_bars__25497ded .unselected>.info>.label{font-weight:300}.style_module_bars__25497ded .bar{height:100%;background-color:var(--cosmograph-bars-background);opacity:.8;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .bar-highlighted{height:100%;background-color:var(--cosmograph-bars-highlighted-color);opacity:.2;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .info{display:flex;justify-content:space-between;width:100%;padding:0 4px;position:absolute;font-size:var(--cosmograph-bars-font-size);font-feature-settings:"tnum";color:var(--cosmograph-bars-font-color);gap:2px}.style_module_bars__25497ded .label{min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;transition:opacity .05s linear}.style_module_bars__25497ded .count{flex-shrink:0;font-weight:300;opacity:.8;transition:opacity .05s linear}.style_module_bars__25497ded .show-more{cursor:pointer;padding-top:2px;display:flex;font-weight:300;color:var(--cosmograph-bars-font-color);font-size:11px;justify-content:space-between;opacity:.6;font-size:var(--cosmograph-bars-ui-font-size);pointer-events:none;transition:opacity .1s linear}.style_module_bars__25497ded .show-more:hover{opacity:1;text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .show-more>span{pointer-events:all}.style_module_bars__25497ded .show-more-count{padding-right:5px;pointer-events:all;font-feature-settings:"tnum"}.style_module_bars__25497ded .unselected>.info>.label,.style_module_bars__25497ded .unselected>.info>.count{opacity:.5}.style_module_bars__25497ded .unselected:hover>.info>.label,.style_module_bars__25497ded .unselected:hover>.info>.count{opacity:1}.style_module_bars__25497ded .search-input{background:transparent;border:none;border-bottom:1px solid rgba(255,255,255,.3);font-size:13px!important;color:var(--cosmograph-bars-font-color);line-height:1.5;padding:2px;width:100%;position:relative;transition:border-bottom-color .2s}.style_module_bars__25497ded .search-input::placeholder{color:var(--cosmograph-bars-font-color)!important;opacity:.4;font-weight:300;font-family:inherit}.style_module_bars__25497ded .search-container{position:relative;width:100%;margin-bottom:4px;display:none;z-index:1}.style_module_bars__25497ded .clear-button{position:absolute;right:0;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--cosmograph-bars-font-color);font-weight:300;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_bars__25497ded .clear-button.visible:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_bars__25497ded .clear-button.visible{opacity:.7}.style_module_bars__25497ded .clear-button svg{width:10px;height:10px;fill:currentColor}.style_module_bars__25497ded .sorting-block{visibility:hidden;margin-top:1px;display:flex;justify-content:space-between}.style_module_bars__25497ded .buttons-container{margin-top:4px;font-size:var(--cosmograph-bars-ui-font-size);display:flex;gap:4px;line-height:1.25}.style_module_bars__25497ded .buttons-container>div{transition:opacity .05s linear,filter .05s linear;padding:1px 5px;background:var(--cosmograph-bars-background);border-radius:4px;opacity:.9;display:flex;cursor:pointer;align-items:center}.style_module_bars__25497ded .buttons-container>div:hover{filter:brightness(1.2)}.style_module_bars__25497ded .reset-text{transition:opacity .05s linear,filter .05s linear;display:flex;font-size:var(--cosmograph-bars-ui-font-size);align-items:end;padding-right:4px;cursor:pointer;font-weight:300}.style_module_bars__25497ded .reset-text:hover{text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .reset-text.unselected{pointer-events:none;cursor:default;opacity:.7}.style_module_bars__25497ded :scope.reset-text:hover:not(.unselected){filter:brightness(1.5);opacity:1}:root{--cosmograph-size-legend-form-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-family: inherit;--cosmograph-size-legend-font-size: var(--cosmograph-ui-font-size);--cosmograph-size-legend-sublabel-font-size: 10px;--cosmograph-size-legend-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-size-legend-line-radius: 2px;--cosmograph-size-legend-line-width: 30px;--cosmograph-size-legend-hide-transform: translateY(100%);--cosmograph-size-legend-show-transform: translateX(0)}.style_module_container__d2889234{display:flex;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;overflow:hidden;min-height:25px}.style_module_legend__75c167f2{width:auto;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-size-legend-font-size);font-family:var(--cosmograph-size-legend-font-family);user-select:none;-webkit-user-select:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.04em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__91eae57a{opacity:1;transform:var(--cosmograph-size-legend-show-transform)}.style_module_disabled__d51f7a10{opacity:0;transform:var(--cosmograph-size-legend-hide-transform);pointer-events:none;display:none!important;min-height:0}@starting-style{.style_module_container__d2889234.style_module_enabled__91eae57a,.style_module_legend__75c167f2.style_module_enabled__91eae57a{opacity:0;transform:var(--cosmograph-size-legend-hide-transform)}}.style_module_legend__75c167f2 .circle{background-color:var(--cosmograph-size-legend-form-color);border-radius:50%;transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2 .line{background-color:var(--cosmograph-size-legend-form-color);border-radius:var(--cosmograph-size-legend-line-radius);width:var(--cosmograph-size-legend-line-width);transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2.style_module_events__894316a8{pointer-events:auto;cursor:pointer}.style_module_legend__75c167f2 .legend-content{display:flex;align-items:end;justify-content:center;gap:.75rem}.style_module_legend__75c167f2 .legend-content>div{transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__75c167f2 .labels-wrapper{white-space:nowrap}.style_module_legend__75c167f2 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-size-legend-items-margin)}.style_module_legend__75c167f2 .name{align-items:center;text-align:center;justify-content:center;display:flex;color:var(--cosmograph-size-legend-font-color);overflow:hidden;width:100%;margin-top:3px;word-break:break-all;white-space:pre-line;transition:color .15s ease-in-out;letter-spacing:-.02em}.style_module_legend__75c167f2 .label{color:var(--cosmograph-size-legend-font-color);overflow:hidden;transition:color .15s ease-in-out;text-overflow:ellipsis;font-feature-settings:"tnum"}.style_module_legend__75c167f2 .sublabel{padding-top:1px;font-size:var(--cosmograph-size-legend-sublabel-font-size);opacity:.5;line-height:1;min-width:10px;transition:color .15s ease-in-out}.style_module_hovered__1206707f .label,.style_module_hovered__1206707f .sublabel{color:var(--cosmograph-size-legend-hover-color);cursor:pointer}.style_module_hovered__1206707f .circle,.style_module_hovered__1206707f .line{background-color:var(--cosmograph-size-legend-hover-color);cursor:pointer}:root{--cosmograph-color-legend-range-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-range-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-range-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-label-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-sublabel-font-size: 10px;--cosmograph-color-legend-range-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-range-gradient-height: 6px;--cosmograph-color-legend-range-gradient-radius: 8px;--cosmograph-color-legend-range-gradient-top-margin: 6px;--cosmograph-color-legend-hide-transform: translateY(100%);--cosmograph-color-legend-show-transform: translateX(0)}.style_module_container__05cc807d{display:flex;min-width:150px;min-height:25px;width:100%;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_legend__a3e235e4{width:100%;font-weight:300;letter-spacing:-.04em;display:flex;flex-direction:column;font-size:var(--cosmograph-color-legend-range-font-size);font-family:var(--cosmograph-color-legend-range-font-family);user-select:none;-webkit-user-select:none;pointer-events:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__b3120e27{opacity:1;transform:var(--cosmograph-color-legend-show-transform);pointer-events:auto}.style_module_disabled__c2dc158c{opacity:0;transform:var(--cosmograph-color-legend-hide-transform);pointer-events:none;display:none;min-height:0}@starting-style{.style_module_container__05cc807d.style_module_enabled__b3120e27,.style_module_legend__a3e235e4.style_module_enabled__b3120e27{opacity:0;transform:var(--cosmograph-color-legend-hide-transform)}}.style_module_legend__a3e235e4 .legend-content{display:flex;align-items:end;justify-content:space-between}.style_module_hovered__dfd7bb2c .label,.style_module_hovered__dfd7bb2c .sublabel{color:var(--cosmograph-size-legend-hover-color)!important;cursor:pointer}.style_module_legend__a3e235e4 .extent{white-space:nowrap;transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__a3e235e4 .gradient{width:100%;margin-top:var(--cosmograph-color-legend-range-gradient-top-margin);height:var(--cosmograph-color-legend-range-gradient-height);border-radius:var(--cosmograph-color-legend-range-gradient-radius)}.style_module_legend__a3e235e4 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-color-legend-range-items-margin)}.style_module_legend__a3e235e4 .name{align-items:center;text-align:center;justify-content:space-around;display:flex;color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;width:100%;word-break:break-word;text-wrap:balance;white-space:pre-line;transition:color .15s ease-in-out;margin:0 4px;letter-spacing:-.02em;line-height:1.25}.style_module_legend__a3e235e4 .label{color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;max-width:150px;text-overflow:ellipsis;font-size:var(--cosmograph-color-legend-range-label-font-size);transition:color .15s ease-in-out;line-height:1;font-feature-settings:"tnum"}.style_module_legend__a3e235e4 .sublabel{padding-top:1px;color:var(--cosmograph-color-legend-range-font-color);opacity:.55;font-size:var(--cosmograph-color-legend-range-sublabel-font-size);line-height:1;transition:color .15s ease-in-out}:root{--cosmograph-color-legend-type-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-type-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-type-font-size: 11px;--cosmograph-color-legend-type-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-type-others-color: #bab0ab;--cosmograph-color-legend-type-bullet-size: 8px;--cosmograph-color-legend-type-bullet-radius: 1rem;--cosmograph-color-legend-type-items-margin: 4px;--cosmograph-color-legend-type-hide-transform: translateY(125%);--cosmograph-color-legend-type-show-transform: translateX(0)}.style_module_enabled__277b2403{opacity:1;transform:var(--cosmograph-color-legend-type-show-transform)}.style_module_disabled__7a587f96{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform);display:none!important;min-height:0}.style_module_wrapper__ea8ca7f4{position:relative;max-width:100%;width:fit-content;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_typeLegend__15bf4b2f{position:relative;width:fit-content;max-width:100%;min-height:25px;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.015em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_typeLegend__15bf4b2f .reverted{flex-direction:row-reverse}.style_module_typeLegend__15bf4b2f .scroll-container{width:100%;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-color-legend-type-font-size);font-family:var(--cosmograph-color-legend-type-font-family);user-select:none;-webkit-user-select:none;line-height:normal;overflow-x:hidden;overflow-y:auto;will-change:transform}@starting-style{.style_module_typeLegend__15bf4b2f.style_module_enabled__277b2403,.style_module_wrapper__ea8ca7f4.style_module_enabled__277b2403{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform)}}.style_module_typeLegend__15bf4b2f .legend-item{display:flex;align-items:center;position:absolute;margin-bottom:var(--cosmograph-color-legend-type-items-margin);pointer-events:none;width:100%;padding-left:1px;font-weight:300;transition:filter .1s ease-in-out,opacity .1s ease-in-out;min-height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px + var(--cosmograph-color-legend-type-items-margin));height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px);box-sizing:border-box}.style_module_typeLegend__15bf4b2f .unknown{background-color:var(--cosmograph-color-legend-type-unknown-color)}.style_module_typeLegend__15bf4b2f .others{background-color:var(--cosmograph-color-legend-type-others-color)}.style_module_typeLegend__15bf4b2f .bullet{height:var(--cosmograph-color-legend-type-bullet-size);width:var(--cosmograph-color-legend-type-bullet-size);min-height:var(--cosmograph-color-legend-type-bullet-size);min-width:var(--cosmograph-color-legend-type-bullet-size);border-radius:var(--cosmograph-color-legend-type-bullet-radius);pointer-events:all;margin-right:5px}.style_module_typeLegend__15bf4b2f .label{color:var(--cosmograph-color-legend-type-font-color);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - var(--cosmograph-color-legend-type-bullet-size) - 5px);pointer-events:all;transition:.05s linear color}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.bullet{margin-right:0}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.label{margin-right:5px}.style_module_typeLegend__15bf4b2f .show-more{cursor:pointer;padding-top:4px;display:none;font-weight:300;color:var(--cosmograph-color-legend-type-font-color);font-size:11px;opacity:.6;pointer-events:all;justify-content:space-between;transition:opacity .1s linear;font-feature-settings:"tnum"}.style_module_typeLegend__15bf4b2f .show-more:hover{opacity:1}.style_module_hovered__c0993502 .label,.style_module_hovered__c0993502 .sublabel{color:var(--cosmograph-color-legend-type-hover-color)!important;cursor:pointer}.style_module_selected__36e1dd81{filter:brightness(1)}.style_module_selected__36e1dd81>.style_module_label__afecc7a3{filter:brightness(1.2)}.style_module_unselected__4826cfb7{filter:brightness(.5)}.style_module_typeLegend__15bf4b2f .name{font-size:calc(var(--cosmograph-color-legend-type-font-size) + 1px);font-family:var(--cosmograph-color-legend-type-font-family);color:var(--cosmograph-color-legend-type-font-color);transition:color .15s ease-in-out,opacity .3s ease-in-out,max-height .3s ease-in-out,transform .3s ease-in-out;margin-bottom:4px;margin-top:2px;margin-left:1px;letter-spacing:-.02em;line-height:1.25;overflow:hidden;width:100%;white-space:nowrap;text-overflow:ellipsis;pointer-events:all;-webkit-user-select:none!important;user-select:none!important;max-height:100px;opacity:1;transform:translateY(0)}.style_module_typeLegend__15bf4b2f .name.hidden{opacity:0;max-height:0;margin-bottom:0;margin-top:0;transform:translateY(-10px)}:root{--cosmograph-button-color: var(--cosmograph-ui-text);--cosmograph-button-background: var(--cosmograph-ui-element-color);--cosmograph-button-border-radius: 2px}.style_module_button__e95a1138{background:var(--cosmograph-button-background);color:var(--cosmograph-button-color);border-radius:var(--cosmograph-button-border-radius);display:none;align-items:center;justify-content:center;width:25px;height:25px;margin:3px;padding:5px;cursor:pointer;filter:brightness(.95) contrast(.9);transition:filter .1s}.style_module_button__e95a1138:hover{filter:brightness(1.2) contrast(1)}')),document.head.appendChild(e)}}catch(Xn){}}();var zG=Object.defineProperty,UG=(e,t,n)=>((e,t,n)=>t in e?zG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);let VG=class extends Q${constructor(e,t){const n=R$(FG,t??{});super(e,Q$.extractConfig(n,FG)),UG(this,"_config"),UG(this,"_containerNode"),UG(this,"_legend"),UG(this,"_legendElements"),UG(this,"_gradientElement"),UG(this,"_extentElements",null),UG(this,"_isHidden",!1),UG(this,"_handleClick",e=>{var t,n;this._config.enableEvents&&(null==(n=(t=this._config).onClick)||n.call(t,e))}),UG(this,"_handleHover",e=>{var t,n;this._config.enableEvents&&(null==(n=(t=this._config).onHover)||n.call(t,e))}),UG(this,"_handleColorElementClick",e=>{var t,n;if(!this._config.enableEvents)return;const i=e.currentTarget.className.includes("min")?"min":"max",r="min"===i?this._config.onMinClick:this._config.onMaxClick;if(r){const o="min"===i?0:1;r(null==(t=this._config.extent)?void 0:t["min"===i?0:this._config.extent.length-1],null==(n=this._config.extentLabels)?void 0:n[o],e)}}),UG(this,"_handleColorElementHover",e=>{var t,n,i,r;if(!this._config.enableEvents||!this._config.extent)return;const o=e.currentTarget;if(!o)return;const s=o.classList.contains("min")?"min":"max",a="mouseenter"===e.type,l="min"===s?0:this._config.extent.length-1,c=null==(t=this._config.extent)?void 0:t[l],u=null==(n=this._config.extentLabels)?void 0:n[l];o.classList.toggle("style_module_hovered__dfd7bb2c",a),null==(r=(i=this._config).onHover)||r.call(i,{target:o,type:s,color:c,value:u})}),this._config=n,this._containerNode=e,this._containerNode.classList.add("style_module_container__05cc807d"),this._createElements()}get extentElements(){return this._extentElements}get config(){return this._config}hide(){this._isHidden||(this._isHidden=!0,this._containerNode.classList.remove(OG),this._containerNode.classList.add(BG))}show(){this._isHidden&&(this._isHidden=!1,this._containerNode.classList.remove(BG),this._containerNode.classList.add(OG))}setConfig(e){this._config=R$(FG,e??{}),this.setDisplayStateConfig(Q$.extractConfig(this._config,FG)),this._updateLegend()}destroy(){this._legend&&(this._legend.removeEventListener("click",this._handleClick),this._legend.removeEventListener("mouseover",this._handleHover),this._extentElements&&["min","max"].forEach(e=>{const t=this._extentElements[e];t.removeEventListener("click",this._handleColorElementClick),t.removeEventListener("mouseenter",this._handleColorElementHover),t.removeEventListener("mouseleave",this._handleColorElementHover)}),this._containerNode.removeChild(this._legend),super.destroy())}setLoadingState(){super.setLoadingState()}_createElements(){this._legend=document.createElement("div"),this._legend.classList.add("style_module_legend__a3e235e4"),this._legendElements=this._createLegend(),this._gradientElement=this._createGradientElement(),this._legend.appendChild(this._legendElements),this._legend.appendChild(this._gradientElement),this._containerNode.appendChild(this._legend),this._isHidden||this.show()}_createLegend(){const e=document.createElement("div");e.classList.add("legend-content");const t=document.createElement("div");return t.classList.add("name"),this._extentElements={min:this._createLabelExtent("min"),max:this._createLabelExtent("max")},e.appendChild(this._extentElements.min),e.appendChild(t),e.appendChild(this._extentElements.max),e}_createLabelExtent(e){const t=document.createElement("div");t.classList.add("extent"),t.classList.add(e);const n=document.createElement("div");return n.classList.add("label"),t.appendChild(n),t.addEventListener("click",this._handleColorElementClick),t.addEventListener("mouseenter",this._handleColorElementHover),t.addEventListener("mouseleave",this._handleColorElementHover),t}_createGradientElement(){const e=document.createElement("div");return e.classList.add("gradient"),e}_updateLegend(){var e,t,n;const{noDataMessage:i,loadingMessage:r}=this._displayStateConfig,o=!this._config.extent&&!1===i&&!1===r;if(this._config.hidden||o?this.hide():this.show(),this._config.extent){this.hideState();const i=this._legendElements.querySelector(".name");i&&(i.textContent=this._config.label??"");const r=(null==(e=this._config.extentLabels)?void 0:e[0])===(null==(t=this._config.extentLabels)?void 0:t[1]);if(this._extentElements)if(r){if(this._extentElements.min.style.display="none",this._extentElements.max.style.display="none",i&&void 0!==(null==(n=this._config.extentLabels)?void 0:n[0])){const e=this._formatLabel(this._config.extentLabels[0]),t=i.textContent?`${e}\n${i.textContent}`:e;i.textContent=t}}else this._updateLabelWrapper("min"),this._updateLabelWrapper("max"),this._extentElements.min.style.display="block",this._extentElements.max.style.display="block";this._updateGradient(),this._legend.classList.remove(BG),this._legend.classList.add(OG)}else this.showState(),this._legend.classList.remove(OG),this._legend.classList.add(BG)}_updateGradient(){if(!this._config.extent)return;const e=this._config.extent.map(e=>this._getColor(e)).filter((e,t,n)=>0===t||e!==n[t-1]);if(1===e.length)return this._gradientElement.style.backgroundImage="none",void(this._gradientElement.style.backgroundColor=e[0]);if(this._config.discreteColors){const t=100/e.length,n=e.map((e,n)=>`${e} ${n*t}% ${(n+1)*t}%`);this._gradientElement.style.backgroundImage=`linear-gradient(to right, ${n.join(", ")})`}else{const e=this._config.extent.map((e,t)=>`${this._getColor(e)} ${t/(this._config.extent.length-1)*100}%`).join(", ");this._gradientElement.style.backgroundImage=`linear-gradient(to right, ${e})`}}_updateLabelWrapper(e){var t;const n=this._legendElements.querySelector(".extent:"+("min"===e?"first-child":"last-child"));if(!n)return;const i="min"===e?0:1,r=null==(t=this._config.extentLabels)?void 0:t[i],o=n.querySelector(".label");o&&void 0!==r&&(o.textContent=this._formatLabel(r)),this._updateSublabel(n,e)}_updateSublabel(e,t){let n=e.querySelector(".sublabel");this._config.showSublabels?(n||(n=document.createElement("div"),n.classList.add("sublabel"),e.appendChild(n)),n.textContent="min"===t?this._config.minSubLabel??"min":this._config.maxSubLabel??"max"):n&&n.remove()}_formatLabel(e){return"string"==typeof e?e:this._config.labelFormatter?this._config.labelFormatter(e):e.toString()}_getColor(e){return Array.isArray(e)?`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`:e}};const HG=15,WG={hidden:!1,label:void 0,items:[],labelFormatter:void 0,enableEvents:!0,expanded:!1,maxDisplayedItems:15,alignRight:!1,onClick:void 0,onHover:void 0,noDataMessage:"No legend data",loadingMessage:"Data loading..."},$G="style_module_enabled__277b2403",GG="style_module_disabled__7a587f96",jG="style_module_hovered__c0993502";!function(){try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('@keyframes style_module_fadeIn__ffac87fd{0%{opacity:0}to{opacity:.2}}.style_module_displayState__6ae19b84{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:var(--cosmograph-ui-text);display:flex;justify-content:center;align-items:center;min-width:100px;opacity:.2;font-size:calc(var(--cosmograph-ui-font-size) + 1px);letter-spacing:-.02em;font-weight:200;user-select:none;-webkit-user-select:none;animation:style_module_fadeIn__ffac87fd .3s ease-in-out}:root{--cosmograph-timeline-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-timeline-selection-opacity: .5;--cosmograph-timeline-bar-color: var(--cosmograph-ui-element-color);--cosmograph-timeline-highlighted-bar-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-timeline-font-family: var(--cosmograph-ui-font-family);--cosmograph-timeline-font-size: var(--cosmograph-ui-tick-font-size);--cosmograph-timeline-background: var(--cosmograph-ui-background);--cosmograph-timeline-text-color: var(--cosmograph-ui-text);--cosmograph-timeline-axis-color: var(--cosmograph-ui-text)}.style_module_timeline__736434f7{position:relative;display:flex;background:var(--cosmograph-timeline-background);width:100%;min-height:25px;overflow:hidden}.style_module_timelineSvg__b916ad04{position:relative;width:100%;height:100%}.style_module_selection__ebee57f8{fill:var(--cosmograph-timeline-selection-color);fill-opacity:var(--cosmograph-timeline-selection-opacity);stroke:none}.style_module_axisTick__5865631d{color:var(--cosmograph-timeline-axis-color);font:var(--cosmograph-timeline-font-family);font-size:var(--cosmograph-timeline-font-size);user-select:none;-webkit-user-select:none;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum";alignment-baseline:text-before-edge}.style_module_axisLine__992b502d{opacity:.2;color:var(--cosmograph-timeline-axis-color)}.style_module_bar__114fa79f{fill:var(--cosmograph-timeline-bar-color);transform:scaleY(-1);opacity:0}.style_module_animationControl__ee52cd66{color:var(--cosmograph-timeline-axis-color);width:6%;max-width:30px;min-width:20px;cursor:pointer;display:none;align-items:center;user-select:none;-webkit-user-select:none;opacity:.5;position:relative;justify-content:center}.style_module_animationControl__ee52cd66>svg{width:50%;max-height:20px;padding-right:2px}.style_module_hidden__a73fe81a{display:none}.style_module_disabled__eb988570{opacity:.2;pointer-events:none}.style_module_highlightedBar__c2fc9bdc{fill:var(--cosmograph-timeline-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-search-font-family: var(--cosmograph-ui-font-family);--cosmograph-search-font-size: 14px;--cosmograph-search-list-font-size: 13.5px;--cosmograph-search-text-color: var(--cosmograph-ui-text);--cosmograph-search-background: transparent;--cosmograph-search-list-background: rgba(0, 0, 0, .2);--cosmograph-search-list-match-background: rgba(255, 255, 255, .2);--cosmograph-search-list-match-color: var(--cosmograph-ui-text)}.style_module_searchInput__d7830601:hover{filter:brightness(1.2) contrast(1)}.style_module_searchInput__d7830601{width:100%;background:transparent;color:var(--cosmograph-search-text-color);border:none;border-bottom:.5px solid var(--cosmograph-search-text-color);padding:4px 20px 5px 2px;font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:opacity .2s ease-out}.style_module_searchInput__d7830601::selection{background:var(--cosmograph-search-list-match-background)}.style_module_searchInput__d7830601:focus{outline:none}.style_module_searchSuggestions__b0d3f71e{color:#fff;width:100%;padding:0;margin:0;background:transparent;overflow-y:auto;flex:1;min-height:0}.style_module_searchSuggestions__b0d3f71e li{padding:5px 10px;cursor:pointer;-webkit-user-select:none;user-select:none;display:block;font-weight:500;font-size:var(--cosmograph-search-list-font-size);max-width:100%;overflow:hidden}.style_module_searchSuggestions__b0d3f71e li>div{white-space:nowrap;font-weight:200;overflow:hidden;text-overflow:ellipsis;width:100%}.style_module_searchSuggestions__b0d3f71e li:hover{background:#ffffff1a}.style_module_searchSuggestions__b0d3f71e mark{background:var(--cosmograph-search-list-match-background);color:var(--cosmograph-search-list-match-color);border-radius:2px}.style_module_clearButton__5ebb41de{position:absolute;right:0;top:0;height:100%;background:none;border:none;color:var(--cosmograph-search-text-color);font-weight:300;cursor:pointer;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d{opacity:.7}.style_module_placeholderWrapper__72d5eb0e{z-index:1;color:var(--cosmograph-search-text-color);font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);position:absolute;top:0;left:0;width:100%;bottom:0;display:flex;line-height:1.25;align-items:center;transition:transform .3s ease-out,opacity .3s ease-out}.style_module_placeholderWrapper__72d5eb0e.style_module_hidden__acfb8431{transform:translate(-30px);pointer-events:none;opacity:0}.style_module_searchInput__d7830601:disabled,.style_module_searchInput__d7830601.style_module_disabled__62c35dc5{opacity:.2;cursor:not-allowed;pointer-events:none}.style_module_disabled__62c35dc5 .style_module_clearButton__5ebb41de{display:none}.style_module_disabled__62c35dc5 .style_module_placeholderWrapper__72d5eb0e{opacity:.3;cursor:not-allowed}.style_module_searchInputWrapper__1edbcb22{position:relative;display:flex;width:100%}.style_module_noResults__363397c3{opacity:.3!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none}.style_module_noResults__363397c3:hover{background:none}.style_module_loading__296e0212{opacity:.7!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none;-webkit-user-select:none;user-select:none}.style_module_dropdownContainer__d98287da{position:absolute;top:100%;left:0;width:100%;background:var(--cosmograph-search-list-background);border-radius:4px;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);opacity:0;transform:translateY(-10px);transition:opacity .2s ease-out,transform .2s ease-out;pointer-events:none;overflow:hidden;z-index:10;display:flex;flex-direction:column;padding-bottom:2px}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b{top:auto;bottom:100%;transform:translateY(10px)}.style_module_dropdownContainer__d98287da.style_module_visible__5be7493d{opacity:1;transform:translateY(0);pointer-events:auto}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b.style_module_visible__5be7493d{opacity:1;transform:translateY(-2px);pointer-events:auto}.style_module_footerContainer__73e7a066{flex-shrink:0}:root{--cosmograph-scrollbar-background: rgba(255, 255, 255, .1);--cosmograph-ui-background: rgb(45, 49, 58);--cosmograph-ui-text: #ffffffc7;--cosmograph-ui-tick-font-size: 11px;--cosmograph-ui-font-size: 12px;--cosmograph-ui-font-family: inherit;--cosmograph-ui-element-color: #5C616A;--cosmograph-ui-highlighted-element-color: white;--cosmograph-ui-selection-control-color: #8d949ea8;-webkit-font-smoothing:antialiased!important;text-rendering:optimizeLegibility!important}.style_module_cosmograph-ui__5acb97f1{background:var(--cosmograph-ui-background);color:var(--cosmograph-ui-text)}.style_module_scrollbar__f1516254 *::-webkit-scrollbar{width:5px;height:5px;border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-track{border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-corner{background:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-button{display:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-thumb{background-color:var(--cosmograph-scrollbar-background);transition:background-color .5s;border-radius:20px;border:3px solid var(--cosmograph-scrollbar-background)}@-moz-document url-prefix(){.style_module_scrollbar__f1516254 *{scrollbar-width:thin;scrollbar-color:var(--cosmograph-scrollbar-background) transparent;scrollbar-track-color:transparent;scrollbar-face-color:var(--cosmograph-scrollbar-background)}}:root{--cosmograph-histogram-background: var(--cosmograph-ui-background);--cosmograph-histogram-text-color: var(--cosmograph-ui-text);--cosmograph-histogram-axis-color: var(--cosmograph-ui-text);--cosmograph-histogram-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-histogram-selection-opacity: .5;--cosmograph-histogram-bar-color: var(--cosmograph-ui-element-color);--cosmograph-histogram-highlighted-bar-color: var( --cosmograph-ui-highlighted-element-color);--cosmograph-histogram-font-family: var(--cosmograph-ui-font-family);--cosmograph-histogram-font-size: var(--cosmograph-ui-tick-font-size)}.style_module_histogram__9d8a77ea{position:relative;display:flex;min-height:25px;background:var(--cosmograph-histogram-background);width:100%}.style_module_histogramSvg__ccccb628{position:relative;width:100%;height:100%}.style_module_selection__7db96137{fill:var(--cosmograph-histogram-selection-color);fill-opacity:var(--cosmograph-histogram-selection-opacity);stroke:none}.style_module_axisTick__898e1f39{color:var(--cosmograph-histogram-axis-color);font-family:var(--cosmograph-histogram-font-family);font-size:var(--cosmograph-histogram-font-size);user-select:none;-webkit-user-select:none;alignment-baseline:text-before-edge;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum"}.style_module_bar__3c9ab488{fill:var(--cosmograph-histogram-bar-color);transform:scaleY(-1)}.style_module_highlightedBar__b193a8de{fill:var(--cosmograph-histogram-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-bars-font-color: var(--cosmograph-ui-text);--cosmograph-bars-font-family: var(--cosmograph-ui-font-family);--cosmograph-bars-font-size: var(--cosmograph-ui-font-size);--cosmograph-bars-ui-font-size: 11.5px;--cosmograph-bars-background: var(--cosmograph-ui-element-color);--cosmograph-bars-bar-height: 20px;--cosmograph-bars-bar-bottom-margin: 2px;--cosmograph-bars-highlighted-color: var( --cosmograph-ui-highlighted-element-color)}.style_module_bars__25497ded{position:relative;width:100%;min-height:100px;user-select:none;flex-direction:column;-webkit-user-select:none}.style_module_bars__25497ded .scroll-container{position:relative;width:100%;overflow-y:hidden;overflow-x:hidden}.style_module_bars__25497ded .bars-container{position:relative;width:calc(100% - 1px);font-family:var(--cosmograph-bars-font-family)}.style_module_bars__25497ded .highlighted-bars-container{position:absolute;top:0;left:0;pointer-events:none}.style_module_bars__25497ded .row{height:var(--cosmograph-bars-bar-height);display:flex;align-items:center;margin-bottom:var(--cosmograph-bars-bar-bottom-margin);width:100%;transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row:hover{filter:brightness(1.15) contrast(1.05);transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row.unselected:hover{filter:brightness(.95) contrast(1.15);transition:filter .05s linear}.style_module_bars__25497ded .unselected{opacity:.85;filter:brightness(.8) contrast(1.1)}.style_module_bars__25497ded .selected{filter:brightness(1.05) contrast(1.05)}.style_module_bars__25497ded .selected>.info>.label{font-weight:600;filter:brightness(1.1) contrast(1.05)}.style_module_bars__25497ded .unselected>.info>.label{font-weight:300}.style_module_bars__25497ded .bar{height:100%;background-color:var(--cosmograph-bars-background);opacity:.8;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .bar-highlighted{height:100%;background-color:var(--cosmograph-bars-highlighted-color);opacity:.2;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .info{display:flex;justify-content:space-between;width:100%;padding:0 4px;position:absolute;font-size:var(--cosmograph-bars-font-size);font-feature-settings:"tnum";color:var(--cosmograph-bars-font-color);gap:2px}.style_module_bars__25497ded .label{min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;transition:opacity .05s linear}.style_module_bars__25497ded .count{flex-shrink:0;font-weight:300;opacity:.8;transition:opacity .05s linear}.style_module_bars__25497ded .show-more{cursor:pointer;padding-top:2px;display:flex;font-weight:300;color:var(--cosmograph-bars-font-color);font-size:11px;justify-content:space-between;opacity:.6;font-size:var(--cosmograph-bars-ui-font-size);pointer-events:none;transition:opacity .1s linear}.style_module_bars__25497ded .show-more:hover{opacity:1;text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .show-more>span{pointer-events:all}.style_module_bars__25497ded .show-more-count{padding-right:5px;pointer-events:all;font-feature-settings:"tnum"}.style_module_bars__25497ded .unselected>.info>.label,.style_module_bars__25497ded .unselected>.info>.count{opacity:.5}.style_module_bars__25497ded .unselected:hover>.info>.label,.style_module_bars__25497ded .unselected:hover>.info>.count{opacity:1}.style_module_bars__25497ded .search-input{background:transparent;border:none;border-bottom:1px solid rgba(255,255,255,.3);font-size:13px!important;color:var(--cosmograph-bars-font-color);line-height:1.5;padding:2px;width:100%;position:relative;transition:border-bottom-color .2s}.style_module_bars__25497ded .search-input::placeholder{color:var(--cosmograph-bars-font-color)!important;opacity:.4;font-weight:300;font-family:inherit}.style_module_bars__25497ded .search-container{position:relative;width:100%;margin-bottom:4px;display:none;z-index:1}.style_module_bars__25497ded .clear-button{position:absolute;right:0;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--cosmograph-bars-font-color);font-weight:300;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_bars__25497ded .clear-button.visible:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_bars__25497ded .clear-button.visible{opacity:.7}.style_module_bars__25497ded .clear-button svg{width:10px;height:10px;fill:currentColor}.style_module_bars__25497ded .sorting-block{visibility:hidden;margin-top:1px;display:flex;justify-content:space-between}.style_module_bars__25497ded .buttons-container{margin-top:4px;font-size:var(--cosmograph-bars-ui-font-size);display:flex;gap:4px;line-height:1.25}.style_module_bars__25497ded .buttons-container>div{transition:opacity .05s linear,filter .05s linear;padding:1px 5px;background:var(--cosmograph-bars-background);border-radius:4px;opacity:.9;display:flex;cursor:pointer;align-items:center}.style_module_bars__25497ded .buttons-container>div:hover{filter:brightness(1.2)}.style_module_bars__25497ded .reset-text{transition:opacity .05s linear,filter .05s linear;display:flex;font-size:var(--cosmograph-bars-ui-font-size);align-items:end;padding-right:4px;cursor:pointer;font-weight:300}.style_module_bars__25497ded .reset-text:hover{text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .reset-text.unselected{pointer-events:none;cursor:default;opacity:.7}.style_module_bars__25497ded :scope.reset-text:hover:not(.unselected){filter:brightness(1.5);opacity:1}:root{--cosmograph-size-legend-form-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-family: inherit;--cosmograph-size-legend-font-size: var(--cosmograph-ui-font-size);--cosmograph-size-legend-sublabel-font-size: 10px;--cosmograph-size-legend-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-size-legend-line-radius: 2px;--cosmograph-size-legend-line-width: 30px;--cosmograph-size-legend-hide-transform: translateY(100%);--cosmograph-size-legend-show-transform: translateX(0)}.style_module_container__d2889234{display:flex;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;overflow:hidden;min-height:25px}.style_module_legend__75c167f2{width:auto;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-size-legend-font-size);font-family:var(--cosmograph-size-legend-font-family);user-select:none;-webkit-user-select:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.04em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__91eae57a{opacity:1;transform:var(--cosmograph-size-legend-show-transform)}.style_module_disabled__d51f7a10{opacity:0;transform:var(--cosmograph-size-legend-hide-transform);pointer-events:none;display:none!important;min-height:0}@starting-style{.style_module_container__d2889234.style_module_enabled__91eae57a,.style_module_legend__75c167f2.style_module_enabled__91eae57a{opacity:0;transform:var(--cosmograph-size-legend-hide-transform)}}.style_module_legend__75c167f2 .circle{background-color:var(--cosmograph-size-legend-form-color);border-radius:50%;transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2 .line{background-color:var(--cosmograph-size-legend-form-color);border-radius:var(--cosmograph-size-legend-line-radius);width:var(--cosmograph-size-legend-line-width);transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2.style_module_events__894316a8{pointer-events:auto;cursor:pointer}.style_module_legend__75c167f2 .legend-content{display:flex;align-items:end;justify-content:center;gap:.75rem}.style_module_legend__75c167f2 .legend-content>div{transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__75c167f2 .labels-wrapper{white-space:nowrap}.style_module_legend__75c167f2 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-size-legend-items-margin)}.style_module_legend__75c167f2 .name{align-items:center;text-align:center;justify-content:center;display:flex;color:var(--cosmograph-size-legend-font-color);overflow:hidden;width:100%;margin-top:3px;word-break:break-all;white-space:pre-line;transition:color .15s ease-in-out;letter-spacing:-.02em}.style_module_legend__75c167f2 .label{color:var(--cosmograph-size-legend-font-color);overflow:hidden;transition:color .15s ease-in-out;text-overflow:ellipsis;font-feature-settings:"tnum"}.style_module_legend__75c167f2 .sublabel{padding-top:1px;font-size:var(--cosmograph-size-legend-sublabel-font-size);opacity:.5;line-height:1;min-width:10px;transition:color .15s ease-in-out}.style_module_hovered__1206707f .label,.style_module_hovered__1206707f .sublabel{color:var(--cosmograph-size-legend-hover-color);cursor:pointer}.style_module_hovered__1206707f .circle,.style_module_hovered__1206707f .line{background-color:var(--cosmograph-size-legend-hover-color);cursor:pointer}:root{--cosmograph-color-legend-range-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-range-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-range-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-label-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-sublabel-font-size: 10px;--cosmograph-color-legend-range-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-range-gradient-height: 6px;--cosmograph-color-legend-range-gradient-radius: 8px;--cosmograph-color-legend-range-gradient-top-margin: 6px;--cosmograph-color-legend-hide-transform: translateY(100%);--cosmograph-color-legend-show-transform: translateX(0)}.style_module_container__05cc807d{display:flex;min-width:150px;min-height:25px;width:100%;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_legend__a3e235e4{width:100%;font-weight:300;letter-spacing:-.04em;display:flex;flex-direction:column;font-size:var(--cosmograph-color-legend-range-font-size);font-family:var(--cosmograph-color-legend-range-font-family);user-select:none;-webkit-user-select:none;pointer-events:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__b3120e27{opacity:1;transform:var(--cosmograph-color-legend-show-transform);pointer-events:auto}.style_module_disabled__c2dc158c{opacity:0;transform:var(--cosmograph-color-legend-hide-transform);pointer-events:none;display:none;min-height:0}@starting-style{.style_module_container__05cc807d.style_module_enabled__b3120e27,.style_module_legend__a3e235e4.style_module_enabled__b3120e27{opacity:0;transform:var(--cosmograph-color-legend-hide-transform)}}.style_module_legend__a3e235e4 .legend-content{display:flex;align-items:end;justify-content:space-between}.style_module_hovered__dfd7bb2c .label,.style_module_hovered__dfd7bb2c .sublabel{color:var(--cosmograph-size-legend-hover-color)!important;cursor:pointer}.style_module_legend__a3e235e4 .extent{white-space:nowrap;transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__a3e235e4 .gradient{width:100%;margin-top:var(--cosmograph-color-legend-range-gradient-top-margin);height:var(--cosmograph-color-legend-range-gradient-height);border-radius:var(--cosmograph-color-legend-range-gradient-radius)}.style_module_legend__a3e235e4 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-color-legend-range-items-margin)}.style_module_legend__a3e235e4 .name{align-items:center;text-align:center;justify-content:space-around;display:flex;color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;width:100%;word-break:break-word;text-wrap:balance;white-space:pre-line;transition:color .15s ease-in-out;margin:0 4px;letter-spacing:-.02em;line-height:1.25}.style_module_legend__a3e235e4 .label{color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;max-width:150px;text-overflow:ellipsis;font-size:var(--cosmograph-color-legend-range-label-font-size);transition:color .15s ease-in-out;line-height:1;font-feature-settings:"tnum"}.style_module_legend__a3e235e4 .sublabel{padding-top:1px;color:var(--cosmograph-color-legend-range-font-color);opacity:.55;font-size:var(--cosmograph-color-legend-range-sublabel-font-size);line-height:1;transition:color .15s ease-in-out}:root{--cosmograph-color-legend-type-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-type-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-type-font-size: 11px;--cosmograph-color-legend-type-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-type-others-color: #bab0ab;--cosmograph-color-legend-type-bullet-size: 8px;--cosmograph-color-legend-type-bullet-radius: 1rem;--cosmograph-color-legend-type-items-margin: 4px;--cosmograph-color-legend-type-hide-transform: translateY(125%);--cosmograph-color-legend-type-show-transform: translateX(0)}.style_module_enabled__277b2403{opacity:1;transform:var(--cosmograph-color-legend-type-show-transform)}.style_module_disabled__7a587f96{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform);display:none!important;min-height:0}.style_module_wrapper__ea8ca7f4{position:relative;max-width:100%;width:fit-content;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_typeLegend__15bf4b2f{position:relative;width:fit-content;max-width:100%;min-height:25px;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.015em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_typeLegend__15bf4b2f .reverted{flex-direction:row-reverse}.style_module_typeLegend__15bf4b2f .scroll-container{width:100%;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-color-legend-type-font-size);font-family:var(--cosmograph-color-legend-type-font-family);user-select:none;-webkit-user-select:none;line-height:normal;overflow-x:hidden;overflow-y:auto;will-change:transform}@starting-style{.style_module_typeLegend__15bf4b2f.style_module_enabled__277b2403,.style_module_wrapper__ea8ca7f4.style_module_enabled__277b2403{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform)}}.style_module_typeLegend__15bf4b2f .legend-item{display:flex;align-items:center;position:absolute;margin-bottom:var(--cosmograph-color-legend-type-items-margin);pointer-events:none;width:100%;padding-left:1px;font-weight:300;transition:filter .1s ease-in-out,opacity .1s ease-in-out;min-height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px + var(--cosmograph-color-legend-type-items-margin));height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px);box-sizing:border-box}.style_module_typeLegend__15bf4b2f .unknown{background-color:var(--cosmograph-color-legend-type-unknown-color)}.style_module_typeLegend__15bf4b2f .others{background-color:var(--cosmograph-color-legend-type-others-color)}.style_module_typeLegend__15bf4b2f .bullet{height:var(--cosmograph-color-legend-type-bullet-size);width:var(--cosmograph-color-legend-type-bullet-size);min-height:var(--cosmograph-color-legend-type-bullet-size);min-width:var(--cosmograph-color-legend-type-bullet-size);border-radius:var(--cosmograph-color-legend-type-bullet-radius);pointer-events:all;margin-right:5px}.style_module_typeLegend__15bf4b2f .label{color:var(--cosmograph-color-legend-type-font-color);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - var(--cosmograph-color-legend-type-bullet-size) - 5px);pointer-events:all;transition:.05s linear color}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.bullet{margin-right:0}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.label{margin-right:5px}.style_module_typeLegend__15bf4b2f .show-more{cursor:pointer;padding-top:4px;display:none;font-weight:300;color:var(--cosmograph-color-legend-type-font-color);font-size:11px;opacity:.6;pointer-events:all;justify-content:space-between;transition:opacity .1s linear;font-feature-settings:"tnum"}.style_module_typeLegend__15bf4b2f .show-more:hover{opacity:1}.style_module_hovered__c0993502 .label,.style_module_hovered__c0993502 .sublabel{color:var(--cosmograph-color-legend-type-hover-color)!important;cursor:pointer}.style_module_selected__36e1dd81{filter:brightness(1)}.style_module_selected__36e1dd81>.style_module_label__afecc7a3{filter:brightness(1.2)}.style_module_unselected__4826cfb7{filter:brightness(.5)}.style_module_typeLegend__15bf4b2f .name{font-size:calc(var(--cosmograph-color-legend-type-font-size) + 1px);font-family:var(--cosmograph-color-legend-type-font-family);color:var(--cosmograph-color-legend-type-font-color);transition:color .15s ease-in-out,opacity .3s ease-in-out,max-height .3s ease-in-out,transform .3s ease-in-out;margin-bottom:4px;margin-top:2px;margin-left:1px;letter-spacing:-.02em;line-height:1.25;overflow:hidden;width:100%;white-space:nowrap;text-overflow:ellipsis;pointer-events:all;-webkit-user-select:none!important;user-select:none!important;max-height:100px;opacity:1;transform:translateY(0)}.style_module_typeLegend__15bf4b2f .name.hidden{opacity:0;max-height:0;margin-bottom:0;margin-top:0;transform:translateY(-10px)}:root{--cosmograph-button-color: var(--cosmograph-ui-text);--cosmograph-button-background: var(--cosmograph-ui-element-color);--cosmograph-button-border-radius: 2px}.style_module_button__e95a1138{background:var(--cosmograph-button-background);color:var(--cosmograph-button-color);border-radius:var(--cosmograph-button-border-radius);display:none;align-items:center;justify-content:center;width:25px;height:25px;margin:3px;padding:5px;cursor:pointer;filter:brightness(.95) contrast(.9);transition:filter .1s}.style_module_button__e95a1138:hover{filter:brightness(1.2) contrast(1)}')),document.head.appendChild(e)}}catch(Xn){}}();var YG=Object.defineProperty,qG=(e,t,n)=>((e,t,n)=>t in e?YG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class XG extends Q${constructor(e,t){const n=R$(WG,t??{});super(e,Q$.extractConfig(n,WG)),qG(this,"_containerNode"),qG(this,"_config"),qG(this,"_scrollContainer"),qG(this,"_legendItems"),qG(this,"_showMoreButton"),qG(this,"_wrapper"),qG(this,"_itemHeight",0),qG(this,"_itemMargin",0),qG(this,"_visibleItemsCount",0),qG(this,"_startIndex",0),qG(this,"_endIndex",0),qG(this,"_listItems",[]),qG(this,"_selectedItem"),qG(this,"_isExpanded",!1),qG(this,"_isHidden",!1),qG(this,"_calculatedWidth",0),qG(this,"_maxMeasuredWidth",0),qG(this,"_maxMeasuredCharLength",0),qG(this,"_label"),qG(this,"_handleShowMore",()=>{var e,t;this._isExpanded=!this._isExpanded,this._isExpanded?(this._containerNode.style.pointerEvents="all",this._scrollContainer.style.overflowY="auto",this._showMoreButton.firstChild.textContent="show less"):(this._containerNode.style.pointerEvents="none",this._scrollContainer.style.overflowY="hidden",this._scrollContainer.scrollTop=0,this._handleShowMoreCount()),null==(t=(e=this._config).onShowMoreClick)||t.call(e,this._isExpanded),this._calculateOptimalWidth(),this._updateVisibleItems()}),qG(this,"_handleShowMoreCount",()=>{const{maxDisplayedItems:e=HG}=this._config,t=this._listItems.length-e;this._showMoreButton.firstChild.textContent=`${t} more...`}),qG(this,"_handleScroll",()=>{requestAnimationFrame(()=>{this._updateVisibleItems()})}),this._config=n,this._containerNode=e,this._containerNode.classList.add("style_module_typeLegend__15bf4b2f"),this._containerNode.classList.add(pG),this._createElements()}get config(){return this._config}get legendItems(){return this._legendItems}get isExpanded(){return this._isExpanded}setConfig(e){const t=this._isExpanded;this._config=R$(WG,e??{}),this.setDisplayStateConfig(Q$.extractConfig(this._config,WG)),this._isExpanded=(null==e?void 0:e.expanded)??t,this._updateLegend()}setSelectedItem(e){this._selectedItem=e,this._updateVisibleItems()}resetList(){this._scrollContainer.scrollTop=0,this._selectedItem=void 0,this._updateVisibleItems()}getConfig(){return this._config}show(){this._isHidden&&(this._isHidden=!1,this._containerNode.classList.remove(GG),this._containerNode.classList.add($G))}hide(){this._isHidden||(this._isHidden=!0,this._containerNode.classList.remove($G),this._containerNode.classList.add(GG))}destroy(){this._scrollContainer.removeEventListener("scroll",this._handleScroll),this._containerNode.innerHTML="",super.destroy()}setLoadingState(){super.setLoadingState()}_updateLegend(){const{maxDisplayedItems:e=HG,items:t}=this._config,{noDataMessage:n,loadingMessage:i}=this._displayStateConfig,r=!(null!=t&&t.length)&&!1===n&&!1===i;if(this._config.hidden||r?this.hide():this.show(),null!=t&&t.length){this.hideState(),this._wrapper.classList.remove(GG),this._wrapper.classList.add($G);const n=this._config.label;this._label.textContent=n??"",this._label.title=n??"",n?this._label.classList.remove("hidden"):this._label.classList.add("hidden"),this._listItems=t;const i=this._listItems.length;this._calculateItemDimensions(),this._calculateOptimalWidth(),this._visibleItemsCount=e>i?i:e;const r=this._itemHeight+this._itemMargin,o=Math.ceil(this._visibleItemsCount*r-this._itemMargin);this._scrollContainer.style.height=`${o}px`,this._legendItems.style.height=`${Math.ceil(this._listItems.length*r)}px`,this._scrollContainer.style.overflowY=this._isExpanded?"auto":"hidden",this._containerNode.style.pointerEvents=this._isExpanded?"all":"none",this._updateVisibleItems(),this._showMoreButton.style.display=this._listItems.length>e?"block":"none"}else this.showState(),this._wrapper.classList.remove($G),this._wrapper.classList.add(GG)}_updateVisibleItems(){const e=this._itemHeight+this._itemMargin,t=this._scrollContainer.scrollTop;this._startIndex=Math.max(0,Math.floor(t/e)-3);const n=this._isExpanded?Math.ceil(this._scrollContainer.clientHeight/e+6):this._visibleItemsCount;this._endIndex=Math.min(this._startIndex+n,this._listItems.length);const i=document.createDocumentFragment();for(let r=this._startIndex;r<this._endIndex;r++){const t=this._listItems[r];if(t){const n=this._createLegendItem(t);n.style.position="absolute",n.style.top=r*e+"px",i.appendChild(n)}}this._legendItems.innerHTML="",this._legendItems.appendChild(i),this._updateShowMoreButton()}_createElements(){this._wrapper=document.createElement("div"),this._wrapper.classList.add("style_module_wrapper__ea8ca7f4"),this._label=document.createElement("div"),this._label.classList.add("name"),this._wrapper.appendChild(this._label),this._scrollContainer=document.createElement("div"),this._scrollContainer.classList.add("scroll-container"),this._scrollContainer.addEventListener("scroll",this._handleScroll,{passive:!0}),this._legendItems=document.createElement("div"),this._legendItems.className="legend-items",this._scrollContainer.appendChild(this._legendItems),this._showMoreButton=this._createShowMoreButton(),this._wrapper.appendChild(this._scrollContainer),this._wrapper.appendChild(this._showMoreButton),this._containerNode.appendChild(this._wrapper),this._isHidden||this.show()}_createShowMoreButton(){const e=document.createElement("div");e.classList.add("show-more"),e.addEventListener("click",this._handleShowMore);const t=document.createElement("span");return e.appendChild(t),e}_updateShowMoreButton(){this._isExpanded?this._showMoreButton.firstChild.textContent="show less":this._handleShowMoreCount()}_calculateItemDimensions(){const e=this._createLegendItem({label:"Sample",color:"#000000"});e.style.visibility="hidden",e.style.position="absolute",this._legendItems.appendChild(e);const t=window.getComputedStyle(e);this._itemHeight=e.offsetHeight,this._itemMargin=parseFloat(t.marginTop)+parseFloat(t.marginBottom),this._legendItems.removeChild(e)}_createLegendItem(e){const t=document.createElement("div");t.classList.add("legend-item"),t.title=e.label,this._config.alignRight&&t.classList.add("reverted"),this._selectedItem&&t.classList.add(this._selectedItem.label===e.label?"style_module_selected__36e1dd81":"style_module_unselected__4826cfb7"),this._config.enableEvents&&(this._config.onClick&&(t.style.cursor="pointer",t.addEventListener("click",t=>this._config.onClick(t,e))),this._config.onHover&&(t.addEventListener("mouseenter",n=>{t.classList.add(jG),this._config.onHover(n,e)}),t.addEventListener("mouseleave",n=>{t.classList.remove(jG),this._config.onHover(n,e)})));const n=document.createElement("div");n.className="bullet",n.style.backgroundColor=e.color;const i=document.createElement("div");return i.className="label",i.style.whiteSpace="nowrap",i.textContent=e.label,t.appendChild(n),t.appendChild(i),t}_calculateOptimalWidth(){var e;if(!this._listItems.length)return;let t=0;for(const c of this._listItems)c.label&&c.label.length>t&&(t=c.label.length);if(this._listItems.length>(this._config.maxDisplayedItems||HG)){const e=this._listItems.length-(this._config.maxDisplayedItems||HG);t=Math.max(t,`${e} more...`.length,9)}if(t<=this._maxMeasuredCharLength)return void(this._maxMeasuredWidth&&this._applyCalculatedWidth(this._maxMeasuredWidth));this._maxMeasuredCharLength=t;const n=getComputedStyle(this._containerNode).getPropertyValue("--cosmograph-color-legend-type-font-size")||"11px",i=getComputedStyle(this._containerNode).getPropertyValue("--cosmograph-color-legend-type-font-family")||"inherit",r=document.createElement("canvas").getContext("2d");r.font=`300 ${n} ${i}`;let o=0;if(this._listItems.forEach(e=>{const t=r.measureText(e.label).width;t>o&&(o=t)}),this._listItems.length>(this._config.maxDisplayedItems||HG)){const e=this._listItems.length-(this._config.maxDisplayedItems||HG);o=Math.max(o,r.measureText(`${e} more...`).width,r.measureText("show less").width)}const s=13+o+10,a=(null==(e=this._containerNode.parentElement)?void 0:e.offsetWidth)||0,l=a>0?Math.min(a-20,s):s;this._calculatedWidth=Math.max(100,l),this._maxMeasuredWidth=this._calculatedWidth,this._applyCalculatedWidth(this._calculatedWidth)}_applyCalculatedWidth(e){this._containerNode.style.minWidth=`${e}px`,this._wrapper.style.minWidth=`${e}px`}}const KG={onClick:void 0,iconSvg:void 0,description:void 0};!function(){try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode('@keyframes style_module_fadeIn__ffac87fd{0%{opacity:0}to{opacity:.2}}.style_module_displayState__6ae19b84{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:var(--cosmograph-ui-text);display:flex;justify-content:center;align-items:center;min-width:100px;opacity:.2;font-size:calc(var(--cosmograph-ui-font-size) + 1px);letter-spacing:-.02em;font-weight:200;user-select:none;-webkit-user-select:none;animation:style_module_fadeIn__ffac87fd .3s ease-in-out}:root{--cosmograph-timeline-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-timeline-selection-opacity: .5;--cosmograph-timeline-bar-color: var(--cosmograph-ui-element-color);--cosmograph-timeline-highlighted-bar-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-timeline-font-family: var(--cosmograph-ui-font-family);--cosmograph-timeline-font-size: var(--cosmograph-ui-tick-font-size);--cosmograph-timeline-background: var(--cosmograph-ui-background);--cosmograph-timeline-text-color: var(--cosmograph-ui-text);--cosmograph-timeline-axis-color: var(--cosmograph-ui-text)}.style_module_timeline__736434f7{position:relative;display:flex;background:var(--cosmograph-timeline-background);width:100%;min-height:25px;overflow:hidden}.style_module_timelineSvg__b916ad04{position:relative;width:100%;height:100%}.style_module_selection__ebee57f8{fill:var(--cosmograph-timeline-selection-color);fill-opacity:var(--cosmograph-timeline-selection-opacity);stroke:none}.style_module_axisTick__5865631d{color:var(--cosmograph-timeline-axis-color);font:var(--cosmograph-timeline-font-family);font-size:var(--cosmograph-timeline-font-size);user-select:none;-webkit-user-select:none;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum";alignment-baseline:text-before-edge}.style_module_axisLine__992b502d{opacity:.2;color:var(--cosmograph-timeline-axis-color)}.style_module_bar__114fa79f{fill:var(--cosmograph-timeline-bar-color);transform:scaleY(-1);opacity:0}.style_module_animationControl__ee52cd66{color:var(--cosmograph-timeline-axis-color);width:6%;max-width:30px;min-width:20px;cursor:pointer;display:none;align-items:center;user-select:none;-webkit-user-select:none;opacity:.5;position:relative;justify-content:center}.style_module_animationControl__ee52cd66>svg{width:50%;max-height:20px;padding-right:2px}.style_module_hidden__a73fe81a{display:none}.style_module_disabled__eb988570{opacity:.2;pointer-events:none}.style_module_highlightedBar__c2fc9bdc{fill:var(--cosmograph-timeline-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-search-font-family: var(--cosmograph-ui-font-family);--cosmograph-search-font-size: 14px;--cosmograph-search-list-font-size: 13.5px;--cosmograph-search-text-color: var(--cosmograph-ui-text);--cosmograph-search-background: transparent;--cosmograph-search-list-background: rgba(0, 0, 0, .2);--cosmograph-search-list-match-background: rgba(255, 255, 255, .2);--cosmograph-search-list-match-color: var(--cosmograph-ui-text)}.style_module_searchInput__d7830601:hover{filter:brightness(1.2) contrast(1)}.style_module_searchInput__d7830601{width:100%;background:transparent;color:var(--cosmograph-search-text-color);border:none;border-bottom:.5px solid var(--cosmograph-search-text-color);padding:4px 20px 5px 2px;font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:opacity .2s ease-out}.style_module_searchInput__d7830601::selection{background:var(--cosmograph-search-list-match-background)}.style_module_searchInput__d7830601:focus{outline:none}.style_module_searchSuggestions__b0d3f71e{color:#fff;width:100%;padding:0;margin:0;background:transparent;overflow-y:auto;flex:1;min-height:0}.style_module_searchSuggestions__b0d3f71e li{padding:5px 10px;cursor:pointer;-webkit-user-select:none;user-select:none;display:block;font-weight:500;font-size:var(--cosmograph-search-list-font-size);max-width:100%;overflow:hidden}.style_module_searchSuggestions__b0d3f71e li>div{white-space:nowrap;font-weight:200;overflow:hidden;text-overflow:ellipsis;width:100%}.style_module_searchSuggestions__b0d3f71e li:hover{background:#ffffff1a}.style_module_searchSuggestions__b0d3f71e mark{background:var(--cosmograph-search-list-match-background);color:var(--cosmograph-search-list-match-color);border-radius:2px}.style_module_clearButton__5ebb41de{position:absolute;right:0;top:0;height:100%;background:none;border:none;color:var(--cosmograph-search-text-color);font-weight:300;cursor:pointer;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_clearButton__5ebb41de.style_module_visible__5be7493d{opacity:.7}.style_module_placeholderWrapper__72d5eb0e{z-index:1;color:var(--cosmograph-search-text-color);font-family:var(--cosmograph-search-font-family);font-size:var(--cosmograph-search-font-size);position:absolute;top:0;left:0;width:100%;bottom:0;display:flex;line-height:1.25;align-items:center;transition:transform .3s ease-out,opacity .3s ease-out}.style_module_placeholderWrapper__72d5eb0e.style_module_hidden__acfb8431{transform:translate(-30px);pointer-events:none;opacity:0}.style_module_searchInput__d7830601:disabled,.style_module_searchInput__d7830601.style_module_disabled__62c35dc5{opacity:.2;cursor:not-allowed;pointer-events:none}.style_module_disabled__62c35dc5 .style_module_clearButton__5ebb41de{display:none}.style_module_disabled__62c35dc5 .style_module_placeholderWrapper__72d5eb0e{opacity:.3;cursor:not-allowed}.style_module_searchInputWrapper__1edbcb22{position:relative;display:flex;width:100%}.style_module_noResults__363397c3{opacity:.3!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none}.style_module_noResults__363397c3:hover{background:none}.style_module_loading__296e0212{opacity:.7!important;cursor:default;font-weight:300!important;padding:6px!important;text-align:center;pointer-events:none;-webkit-user-select:none;user-select:none}.style_module_dropdownContainer__d98287da{position:absolute;top:100%;left:0;width:100%;background:var(--cosmograph-search-list-background);border-radius:4px;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);opacity:0;transform:translateY(-10px);transition:opacity .2s ease-out,transform .2s ease-out;pointer-events:none;overflow:hidden;z-index:10;display:flex;flex-direction:column;padding-bottom:2px}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b{top:auto;bottom:100%;transform:translateY(10px)}.style_module_dropdownContainer__d98287da.style_module_visible__5be7493d{opacity:1;transform:translateY(0);pointer-events:auto}.style_module_dropdownContainer__d98287da.style_module_upwards__e0b4831b.style_module_visible__5be7493d{opacity:1;transform:translateY(-2px);pointer-events:auto}.style_module_footerContainer__73e7a066{flex-shrink:0}:root{--cosmograph-scrollbar-background: rgba(255, 255, 255, .1);--cosmograph-ui-background: rgb(45, 49, 58);--cosmograph-ui-text: #ffffffc7;--cosmograph-ui-tick-font-size: 11px;--cosmograph-ui-font-size: 12px;--cosmograph-ui-font-family: inherit;--cosmograph-ui-element-color: #5C616A;--cosmograph-ui-highlighted-element-color: white;--cosmograph-ui-selection-control-color: #8d949ea8;-webkit-font-smoothing:antialiased!important;text-rendering:optimizeLegibility!important}.style_module_cosmograph-ui__5acb97f1{background:var(--cosmograph-ui-background);color:var(--cosmograph-ui-text)}.style_module_scrollbar__f1516254 *::-webkit-scrollbar{width:5px;height:5px;border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-track{border-radius:.3rem}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-corner{background:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-button{display:none!important}.style_module_scrollbar__f1516254 *::-webkit-scrollbar-thumb{background-color:var(--cosmograph-scrollbar-background);transition:background-color .5s;border-radius:20px;border:3px solid var(--cosmograph-scrollbar-background)}@-moz-document url-prefix(){.style_module_scrollbar__f1516254 *{scrollbar-width:thin;scrollbar-color:var(--cosmograph-scrollbar-background) transparent;scrollbar-track-color:transparent;scrollbar-face-color:var(--cosmograph-scrollbar-background)}}:root{--cosmograph-histogram-background: var(--cosmograph-ui-background);--cosmograph-histogram-text-color: var(--cosmograph-ui-text);--cosmograph-histogram-axis-color: var(--cosmograph-ui-text);--cosmograph-histogram-selection-color: var(--cosmograph-ui-selection-control-color);--cosmograph-histogram-selection-opacity: .5;--cosmograph-histogram-bar-color: var(--cosmograph-ui-element-color);--cosmograph-histogram-highlighted-bar-color: var( --cosmograph-ui-highlighted-element-color);--cosmograph-histogram-font-family: var(--cosmograph-ui-font-family);--cosmograph-histogram-font-size: var(--cosmograph-ui-tick-font-size)}.style_module_histogram__9d8a77ea{position:relative;display:flex;min-height:25px;background:var(--cosmograph-histogram-background);width:100%}.style_module_histogramSvg__ccccb628{position:relative;width:100%;height:100%}.style_module_selection__7db96137{fill:var(--cosmograph-histogram-selection-color);fill-opacity:var(--cosmograph-histogram-selection-opacity);stroke:none}.style_module_axisTick__898e1f39{color:var(--cosmograph-histogram-axis-color);font-family:var(--cosmograph-histogram-font-family);font-size:var(--cosmograph-histogram-font-size);user-select:none;-webkit-user-select:none;alignment-baseline:text-before-edge;opacity:1;font-weight:300;text-anchor:initial;font-feature-settings:"tnum"}.style_module_bar__3c9ab488{fill:var(--cosmograph-histogram-bar-color);transform:scaleY(-1)}.style_module_highlightedBar__b193a8de{fill:var(--cosmograph-histogram-highlighted-bar-color);transform:scaleY(-1);pointer-events:none}:root{--cosmograph-bars-font-color: var(--cosmograph-ui-text);--cosmograph-bars-font-family: var(--cosmograph-ui-font-family);--cosmograph-bars-font-size: var(--cosmograph-ui-font-size);--cosmograph-bars-ui-font-size: 11.5px;--cosmograph-bars-background: var(--cosmograph-ui-element-color);--cosmograph-bars-bar-height: 20px;--cosmograph-bars-bar-bottom-margin: 2px;--cosmograph-bars-highlighted-color: var( --cosmograph-ui-highlighted-element-color)}.style_module_bars__25497ded{position:relative;width:100%;min-height:100px;user-select:none;flex-direction:column;-webkit-user-select:none}.style_module_bars__25497ded .scroll-container{position:relative;width:100%;overflow-y:hidden;overflow-x:hidden}.style_module_bars__25497ded .bars-container{position:relative;width:calc(100% - 1px);font-family:var(--cosmograph-bars-font-family)}.style_module_bars__25497ded .highlighted-bars-container{position:absolute;top:0;left:0;pointer-events:none}.style_module_bars__25497ded .row{height:var(--cosmograph-bars-bar-height);display:flex;align-items:center;margin-bottom:var(--cosmograph-bars-bar-bottom-margin);width:100%;transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row:hover{filter:brightness(1.15) contrast(1.05);transition:opacity .1s linear,filter .1s linear}.style_module_bars__25497ded .row.unselected:hover{filter:brightness(.95) contrast(1.15);transition:filter .05s linear}.style_module_bars__25497ded .unselected{opacity:.85;filter:brightness(.8) contrast(1.1)}.style_module_bars__25497ded .selected{filter:brightness(1.05) contrast(1.05)}.style_module_bars__25497ded .selected>.info>.label{font-weight:600;filter:brightness(1.1) contrast(1.05)}.style_module_bars__25497ded .unselected>.info>.label{font-weight:300}.style_module_bars__25497ded .bar{height:100%;background-color:var(--cosmograph-bars-background);opacity:.8;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .bar-highlighted{height:100%;background-color:var(--cosmograph-bars-highlighted-color);opacity:.2;transition:opacity .3s ease,width .3s ease}.style_module_bars__25497ded .info{display:flex;justify-content:space-between;width:100%;padding:0 4px;position:absolute;font-size:var(--cosmograph-bars-font-size);font-feature-settings:"tnum";color:var(--cosmograph-bars-font-color);gap:2px}.style_module_bars__25497ded .label{min-width:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;transition:opacity .05s linear}.style_module_bars__25497ded .count{flex-shrink:0;font-weight:300;opacity:.8;transition:opacity .05s linear}.style_module_bars__25497ded .show-more{cursor:pointer;padding-top:2px;display:flex;font-weight:300;color:var(--cosmograph-bars-font-color);font-size:11px;justify-content:space-between;opacity:.6;font-size:var(--cosmograph-bars-ui-font-size);pointer-events:none;transition:opacity .1s linear}.style_module_bars__25497ded .show-more:hover{opacity:1;text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .show-more>span{pointer-events:all}.style_module_bars__25497ded .show-more-count{padding-right:5px;pointer-events:all;font-feature-settings:"tnum"}.style_module_bars__25497ded .unselected>.info>.label,.style_module_bars__25497ded .unselected>.info>.count{opacity:.5}.style_module_bars__25497ded .unselected:hover>.info>.label,.style_module_bars__25497ded .unselected:hover>.info>.count{opacity:1}.style_module_bars__25497ded .search-input{background:transparent;border:none;border-bottom:1px solid rgba(255,255,255,.3);font-size:13px!important;color:var(--cosmograph-bars-font-color);line-height:1.5;padding:2px;width:100%;position:relative;transition:border-bottom-color .2s}.style_module_bars__25497ded .search-input::placeholder{color:var(--cosmograph-bars-font-color)!important;opacity:.4;font-weight:300;font-family:inherit}.style_module_bars__25497ded .search-container{position:relative;width:100%;margin-bottom:4px;display:none;z-index:1}.style_module_bars__25497ded .clear-button{position:absolute;right:0;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--cosmograph-bars-font-color);font-weight:300;font-size:16px;padding:0 4px;opacity:0;display:flex;align-items:center;justify-content:center;transition:opacity .2s ease-out}.style_module_bars__25497ded .clear-button.visible:hover{transition:opacity .1s ease-in-out;opacity:1}.style_module_bars__25497ded .clear-button.visible{opacity:.7}.style_module_bars__25497ded .clear-button svg{width:10px;height:10px;fill:currentColor}.style_module_bars__25497ded .sorting-block{visibility:hidden;margin-top:1px;display:flex;justify-content:space-between}.style_module_bars__25497ded .buttons-container{margin-top:4px;font-size:var(--cosmograph-bars-ui-font-size);display:flex;gap:4px;line-height:1.25}.style_module_bars__25497ded .buttons-container>div{transition:opacity .05s linear,filter .05s linear;padding:1px 5px;background:var(--cosmograph-bars-background);border-radius:4px;opacity:.9;display:flex;cursor:pointer;align-items:center}.style_module_bars__25497ded .buttons-container>div:hover{filter:brightness(1.2)}.style_module_bars__25497ded .reset-text{transition:opacity .05s linear,filter .05s linear;display:flex;font-size:var(--cosmograph-bars-ui-font-size);align-items:end;padding-right:4px;cursor:pointer;font-weight:300}.style_module_bars__25497ded .reset-text:hover{text-decoration:underline;text-underline-offset:1.5px;text-decoration-thickness:.25px}.style_module_bars__25497ded .reset-text.unselected{pointer-events:none;cursor:default;opacity:.7}.style_module_bars__25497ded :scope.reset-text:hover:not(.unselected){filter:brightness(1.5);opacity:1}:root{--cosmograph-size-legend-form-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-color: var(--cosmograph-ui-text);--cosmograph-size-legend-font-family: inherit;--cosmograph-size-legend-font-size: var(--cosmograph-ui-font-size);--cosmograph-size-legend-sublabel-font-size: 10px;--cosmograph-size-legend-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-size-legend-line-radius: 2px;--cosmograph-size-legend-line-width: 30px;--cosmograph-size-legend-hide-transform: translateY(100%);--cosmograph-size-legend-show-transform: translateX(0)}.style_module_container__d2889234{display:flex;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;overflow:hidden;min-height:25px}.style_module_legend__75c167f2{width:auto;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-size-legend-font-size);font-family:var(--cosmograph-size-legend-font-family);user-select:none;-webkit-user-select:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.04em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__91eae57a{opacity:1;transform:var(--cosmograph-size-legend-show-transform)}.style_module_disabled__d51f7a10{opacity:0;transform:var(--cosmograph-size-legend-hide-transform);pointer-events:none;display:none!important;min-height:0}@starting-style{.style_module_container__d2889234.style_module_enabled__91eae57a,.style_module_legend__75c167f2.style_module_enabled__91eae57a{opacity:0;transform:var(--cosmograph-size-legend-hide-transform)}}.style_module_legend__75c167f2 .circle{background-color:var(--cosmograph-size-legend-form-color);border-radius:50%;transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2 .line{background-color:var(--cosmograph-size-legend-form-color);border-radius:var(--cosmograph-size-legend-line-radius);width:var(--cosmograph-size-legend-line-width);transition:background-color .15s ease-in-out;display:inline-block}.style_module_legend__75c167f2.style_module_events__894316a8{pointer-events:auto;cursor:pointer}.style_module_legend__75c167f2 .legend-content{display:flex;align-items:end;justify-content:center;gap:.75rem}.style_module_legend__75c167f2 .legend-content>div{transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__75c167f2 .labels-wrapper{white-space:nowrap}.style_module_legend__75c167f2 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-size-legend-items-margin)}.style_module_legend__75c167f2 .name{align-items:center;text-align:center;justify-content:center;display:flex;color:var(--cosmograph-size-legend-font-color);overflow:hidden;width:100%;margin-top:3px;word-break:break-all;white-space:pre-line;transition:color .15s ease-in-out;letter-spacing:-.02em}.style_module_legend__75c167f2 .label{color:var(--cosmograph-size-legend-font-color);overflow:hidden;transition:color .15s ease-in-out;text-overflow:ellipsis;font-feature-settings:"tnum"}.style_module_legend__75c167f2 .sublabel{padding-top:1px;font-size:var(--cosmograph-size-legend-sublabel-font-size);opacity:.5;line-height:1;min-width:10px;transition:color .15s ease-in-out}.style_module_hovered__1206707f .label,.style_module_hovered__1206707f .sublabel{color:var(--cosmograph-size-legend-hover-color);cursor:pointer}.style_module_hovered__1206707f .circle,.style_module_hovered__1206707f .line{background-color:var(--cosmograph-size-legend-hover-color);cursor:pointer}:root{--cosmograph-color-legend-range-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-range-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-range-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-label-font-size: var(--cosmograph-ui-font-size);--cosmograph-color-legend-range-sublabel-font-size: 10px;--cosmograph-color-legend-range-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-range-gradient-height: 6px;--cosmograph-color-legend-range-gradient-radius: 8px;--cosmograph-color-legend-range-gradient-top-margin: 6px;--cosmograph-color-legend-hide-transform: translateY(100%);--cosmograph-color-legend-show-transform: translateX(0)}.style_module_container__05cc807d{display:flex;min-width:150px;min-height:25px;width:100%;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_legend__a3e235e4{width:100%;font-weight:300;letter-spacing:-.04em;display:flex;flex-direction:column;font-size:var(--cosmograph-color-legend-range-font-size);font-family:var(--cosmograph-color-legend-range-font-family);user-select:none;-webkit-user-select:none;pointer-events:none;cursor:default;text-align:center;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_enabled__b3120e27{opacity:1;transform:var(--cosmograph-color-legend-show-transform);pointer-events:auto}.style_module_disabled__c2dc158c{opacity:0;transform:var(--cosmograph-color-legend-hide-transform);pointer-events:none;display:none;min-height:0}@starting-style{.style_module_container__05cc807d.style_module_enabled__b3120e27,.style_module_legend__a3e235e4.style_module_enabled__b3120e27{opacity:0;transform:var(--cosmograph-color-legend-hide-transform)}}.style_module_legend__a3e235e4 .legend-content{display:flex;align-items:end;justify-content:space-between}.style_module_hovered__dfd7bb2c .label,.style_module_hovered__dfd7bb2c .sublabel{color:var(--cosmograph-size-legend-hover-color)!important;cursor:pointer}.style_module_legend__a3e235e4 .extent{white-space:nowrap;transition:filter .1s ease-in-out,opacity .1s ease-in-out}.style_module_legend__a3e235e4 .gradient{width:100%;margin-top:var(--cosmograph-color-legend-range-gradient-top-margin);height:var(--cosmograph-color-legend-range-gradient-height);border-radius:var(--cosmograph-color-legend-range-gradient-radius)}.style_module_legend__a3e235e4 .legend-item{display:flex;align-items:center;margin-top:var(--cosmograph-color-legend-range-items-margin)}.style_module_legend__a3e235e4 .name{align-items:center;text-align:center;justify-content:space-around;display:flex;color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;width:100%;word-break:break-word;text-wrap:balance;white-space:pre-line;transition:color .15s ease-in-out;margin:0 4px;letter-spacing:-.02em;line-height:1.25}.style_module_legend__a3e235e4 .label{color:var(--cosmograph-color-legend-range-font-color);overflow:hidden;max-width:150px;text-overflow:ellipsis;font-size:var(--cosmograph-color-legend-range-label-font-size);transition:color .15s ease-in-out;line-height:1;font-feature-settings:"tnum"}.style_module_legend__a3e235e4 .sublabel{padding-top:1px;color:var(--cosmograph-color-legend-range-font-color);opacity:.55;font-size:var(--cosmograph-color-legend-range-sublabel-font-size);line-height:1;transition:color .15s ease-in-out}:root{--cosmograph-color-legend-type-font-color: var(--cosmograph-ui-text);--cosmograph-color-legend-type-font-family: var(--cosmograph-ui-font-family);--cosmograph-color-legend-type-font-size: 11px;--cosmograph-color-legend-type-hover-color: var(--cosmograph-ui-highlighted-element-color);--cosmograph-color-legend-type-others-color: #bab0ab;--cosmograph-color-legend-type-bullet-size: 8px;--cosmograph-color-legend-type-bullet-radius: 1rem;--cosmograph-color-legend-type-items-margin: 4px;--cosmograph-color-legend-type-hide-transform: translateY(125%);--cosmograph-color-legend-type-show-transform: translateX(0)}.style_module_enabled__277b2403{opacity:1;transform:var(--cosmograph-color-legend-type-show-transform)}.style_module_disabled__7a587f96{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform);display:none!important;min-height:0}.style_module_wrapper__ea8ca7f4{position:relative;max-width:100%;width:fit-content;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out}.style_module_typeLegend__15bf4b2f{position:relative;width:fit-content;max-width:100%;min-height:25px;transition:opacity .3s ease-in-out,transform .3s ease-in-out,display .3s allow-discrete,min-height .3s ease-in-out;font-weight:300;letter-spacing:-.015em;text-rendering:optimizelegibility;-webkit-font-smoothing:antialiased}.style_module_typeLegend__15bf4b2f .reverted{flex-direction:row-reverse}.style_module_typeLegend__15bf4b2f .scroll-container{width:100%;display:flex;flex-direction:column;position:relative;font-size:var(--cosmograph-color-legend-type-font-size);font-family:var(--cosmograph-color-legend-type-font-family);user-select:none;-webkit-user-select:none;line-height:normal;overflow-x:hidden;overflow-y:auto;will-change:transform}@starting-style{.style_module_typeLegend__15bf4b2f.style_module_enabled__277b2403,.style_module_wrapper__ea8ca7f4.style_module_enabled__277b2403{opacity:0;transform:var(--cosmograph-color-legend-type-hide-transform)}}.style_module_typeLegend__15bf4b2f .legend-item{display:flex;align-items:center;position:absolute;margin-bottom:var(--cosmograph-color-legend-type-items-margin);pointer-events:none;width:100%;padding-left:1px;font-weight:300;transition:filter .1s ease-in-out,opacity .1s ease-in-out;min-height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px + var(--cosmograph-color-legend-type-items-margin));height:calc(var(--cosmograph-color-legend-type-bullet-size) + 2px);box-sizing:border-box}.style_module_typeLegend__15bf4b2f .unknown{background-color:var(--cosmograph-color-legend-type-unknown-color)}.style_module_typeLegend__15bf4b2f .others{background-color:var(--cosmograph-color-legend-type-others-color)}.style_module_typeLegend__15bf4b2f .bullet{height:var(--cosmograph-color-legend-type-bullet-size);width:var(--cosmograph-color-legend-type-bullet-size);min-height:var(--cosmograph-color-legend-type-bullet-size);min-width:var(--cosmograph-color-legend-type-bullet-size);border-radius:var(--cosmograph-color-legend-type-bullet-radius);pointer-events:all;margin-right:5px}.style_module_typeLegend__15bf4b2f .label{color:var(--cosmograph-color-legend-type-font-color);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:calc(100% - var(--cosmograph-color-legend-type-bullet-size) - 5px);pointer-events:all;transition:.05s linear color}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.bullet{margin-right:0}.style_module_typeLegend__15bf4b2f .legend-item.reverted>.label{margin-right:5px}.style_module_typeLegend__15bf4b2f .show-more{cursor:pointer;padding-top:4px;display:none;font-weight:300;color:var(--cosmograph-color-legend-type-font-color);font-size:11px;opacity:.6;pointer-events:all;justify-content:space-between;transition:opacity .1s linear;font-feature-settings:"tnum"}.style_module_typeLegend__15bf4b2f .show-more:hover{opacity:1}.style_module_hovered__c0993502 .label,.style_module_hovered__c0993502 .sublabel{color:var(--cosmograph-color-legend-type-hover-color)!important;cursor:pointer}.style_module_selected__36e1dd81{filter:brightness(1)}.style_module_selected__36e1dd81>.style_module_label__afecc7a3{filter:brightness(1.2)}.style_module_unselected__4826cfb7{filter:brightness(.5)}.style_module_typeLegend__15bf4b2f .name{font-size:calc(var(--cosmograph-color-legend-type-font-size) + 1px);font-family:var(--cosmograph-color-legend-type-font-family);color:var(--cosmograph-color-legend-type-font-color);transition:color .15s ease-in-out,opacity .3s ease-in-out,max-height .3s ease-in-out,transform .3s ease-in-out;margin-bottom:4px;margin-top:2px;margin-left:1px;letter-spacing:-.02em;line-height:1.25;overflow:hidden;width:100%;white-space:nowrap;text-overflow:ellipsis;pointer-events:all;-webkit-user-select:none!important;user-select:none!important;max-height:100px;opacity:1;transform:translateY(0)}.style_module_typeLegend__15bf4b2f .name.hidden{opacity:0;max-height:0;margin-bottom:0;margin-top:0;transform:translateY(-10px)}:root{--cosmograph-button-color: var(--cosmograph-ui-text);--cosmograph-button-background: var(--cosmograph-ui-element-color);--cosmograph-button-border-radius: 2px}.style_module_button__e95a1138{background:var(--cosmograph-button-background);color:var(--cosmograph-button-color);border-radius:var(--cosmograph-button-border-radius);display:none;align-items:center;justify-content:center;width:25px;height:25px;margin:3px;padding:5px;cursor:pointer;filter:brightness(.95) contrast(.9);transition:filter .1s}.style_module_button__e95a1138:hover{filter:brightness(1.2) contrast(1)}')),document.head.appendChild(e)}}catch(Xn){}}();var ZG=Object.defineProperty,QG=(e,t,n)=>((e,t,n)=>t in e?ZG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);let JG=class{constructor(e,t){QG(this,"_container"),QG(this,"config"),QG(this,"_handleClick",()=>{var e,t;null==(t=(e=this.config).onClick)||t.call(e)}),this._container=e,this._container.classList.add("style_module_button__e95a1138"),this.setConfig(t??{}),this._container.addEventListener("click",this._handleClick)}get element(){return this._container}setConfig(e){this.config=R$(KG,e),this._container.title=this.config.description??"",this._container.innerHTML=this.config.iconSvg??""}show(){this._container.style.display="block"}hide(){this._container.style.display="none"}destroy(){this._container.removeEventListener("click",this._handleClick),this._container.innerHTML=""}};const ej={PointColor:"pointColorBy",PointColorMap:"pointColorByMap",PointColorFn:"pointColorByFn",PointColorPalette:"pointColorPalette",PointColorStrategy:"pointColorStrategy",PointSize:"pointSizeBy",PointSizeStrategy:"pointSizeStrategy",PointSizeRange:"pointSizeRange",PointSizeFn:"pointSizeByFn",PointLabel:"pointLabelBy",PointLabelWeight:"pointLabelWeightBy",PointX:"pointXBy",PointY:"pointYBy",PointCluster:"pointClusterBy",PointClusterFn:"pointClusterByFn",PointClusterStrength:"pointClusterStrengthBy",PointIncludeColumns:"pointIncludeColumns"},tj={LinkColor:"linkColorBy",LinkColorFn:"linkColorByFn",LinkColorPalette:"linkColorPalette",LinkColorStrategy:"linkColorStrategy",LinkWidth:"linkWidthBy",LinkWidthRange:"linkWidthRange",LinkWidthFn:"linkWidthByFn",LinkWidthStrategy:"linkWidthStrategy",LinkArrow:"linkArrowBy",LinkArrowFn:"linkArrowByFn",LinkStrength:"linkStrengthBy",LinkStrengthFn:"linkStrengthByFn",LinkStrengthRange:"linkStrengthRange",LinkIncludeColumns:"linkIncludeColumns"},nj=Object.values(ej),ij=Object.values(tj),rj=Object.values({ClusterPositionsMap:"clusterPositionsMap"}),oj=Object.values({Points:"points",PointId:"pointIdBy",PointIndex:"pointIndexBy"}),sj=Object.values({Links:"links",LinkSource:"linkSourceBy",LinkSourceIndex:"linkSourceIndexBy",LinkTarget:"linkTargetBy",LinkTargetIndex:"linkTargetIndexBy"}),aj=[...ij].filter(e=>e!==tj.LinkIncludeColumns).concat("linkDefaultColor","linkDefaultWidth"),lj=[...nj].filter(e=>e!==ej.PointLabel&&e!==ej.PointLabelWeight&&e!==ej.PointIncludeColumns).concat("pointDefaultColor","pointDefaultSize"),cj=[...Object.values({ShowLabels:"showLabels",ShowDynamicLabels:"showDynamicLabels",ShowTopLabels:"showTopLabels",ShowTopLabelsLimit:"showTopLabelsLimit",ShowLabelsFor:"showLabelsFor",ShowClusterLabels:"showClusterLabels",PointLabelClassName:"pointLabelClassName",PointLabelFn:"pointLabelFn",PointLabelWeightFn:"pointLabelWeightFn",PointLabelColor:"pointLabelColor",PointLabelFontSize:"pointLabelFontSize",ClusterLabelFontSize:"clusterLabelFontSize",ClusterLabelClassName:"clusterLabelClassName",ScaleClusterLabels:"scaleClusterLabels",UsePointColorStrategyForClusterLabels:"usePointColorStrategyForClusterLabels",StaticLabelWeight:"staticLabelWeight",DynamicLabelWeight:"dynamicLabelWeight",LabelMargin:"labelMargin",LabelPadding:"labelPadding",CustomLabels:"customLabels"}),ej.PointLabel,ej.PointLabelWeight],uj=.95,dj=.05,hj=[2,9],fj=[1,9],pj=["rgba(43, 85, 168, 0.85)","rgba(153, 82, 213, 0.85)","rgba(240, 105, 180, 0.85)","rgba(255, 149, 131, 0.85)","rgba(254, 224, 139, 0.85)"],mj=["#206176","#38657e","#506987","#686d90","#807098","#9874a1","#af78a9","#c77cb2","#df7fba","#f783c3","#FFB4D3","#f6c0d8"],gj="rgb(45, 49, 58)",_j="rgba(205, 207, 213, 0.9)",yj=_j,vj=16,bj={showLabels:!0,showTopLabels:!0,showDynamicLabels:!0,showHoveredPointLabel:!1,scaleClusterLabels:!0,usePointColorStrategyForClusterLabels:!1,showTopLabelsLimit:30,staticLabelWeight:.8,dynamicLabelWeight:.7,pointGreyoutOpacity:.3,labelMargin:5,pointSamplingDistance:170,labelPadding:[6.5,4.5,6.5,4.5],preservePointPositionsOnDataUpdate:!1,backgroundColor:gj,hoveredPointLabelClassName:"color: white; background: #333841;",pointLabelFontSize:13,clusterLabelFontSize:16,clusterLabelClassName:"background: none; font-weight: 300; opacity: 0.9;",pointSizeRange:hj,linkWidthRange:fj,linkStrengthRange:[.2,1],pointColorPalette:pj,linkColorPalette:mj,pointDefaultColor:yj,linkDefaultColor:_j,unknownColor:_j,hoveredLinkWidthIncrease:0,simulationRepulsion:.5,simulationFriction:.5,simulationLinkSpring:.4,simulationLinkDistance:20,resetSelectionOnEmptyCanvasClick:!0},xj=e=>e===ej.PointLabel?"":e===ej.PointLabelWeight||e===ej.PointX||e===ej.PointY||e===ej.PointCluster?0:e===ej.PointClusterStrength?1:(e===tj.LinkStrength||e!==tj.LinkArrow)&&0,wj=async(e,t)=>{const n=await e.query("SHOW ALL TABLES"),i=null==n?void 0:n.toArray();if(!(null==i?void 0:i.length))return!1;const[r,o]=t.includes(".")?t.split("."):["main",t];return void 0!==i.find(e=>e.name===o&&e.schema===r)},Sj=async(e,t)=>{const n=await e.query(`PRAGMA table_info(${t})`);return n?n.toArray().map(({name:e,type:t})=>({name:e,type:t})):[]},Ej=async(e,t)=>await wj(e,t)?(await e.query(`SUMMARIZE ${t}`)).toArray():[],Cj=async(e,t)=>{const n=await Sj(e,t);return n?n.map(e=>e.name):[]},Tj=async(e,t,n,i)=>{const r=await Cj(e,t);if(!r.length)return null==i||i.push(...n),!1;const o=new Set(r),s=n.filter(e=>!o.has(e));return null==i||i.push(...s),0===s.length},kj=(e,t,n=4)=>{if(e.size>=t.length/n)return new Float32Array(0);const i=new Float32Array(t.length-e.size*n);let r=0;for(let o=0;o<t.length;o+=n)e.has(o/n)||(i.set(t.subarray(o,o+n),r),r+=n);return i},Ij=e=>{const t=new Map;for(const n of e)t.set(n,(t.get(n)||0)+1);return Array.from(t.entries()).sort((e,t)=>t[1]-e[1]).map(e=>e[0])},Aj=(e,t,n)=>e.length?e.reduce((e,i,r)=>(n(i,t)&&e.push(r),e),[]):[],Lj=(e,t)=>{const n=BV(e,dj),i=BV(e,uj);if(n===i){const[n,i]=xV(e);return t?t(n,i):[n,i]}return t?t(n,i):[n,i]},Rj=(e,t,n)=>{if(!e.length)return n;const i=t?Lj(e):xV(e);if(void 0===i[0]||void 0===i[1])return n;if(!n)return i;if(!t)return n;const[r,o]=n,[s,a]=i,l=Math.max(r,s),c=Math.min(o,a);return!Number.isFinite(l)||!Number.isFinite(c)||l>=c?n:[l,c]},Pj=async(e,t,n)=>await e.query(`SELECT ${(null==n?void 0:n.map(e=>`"${e}"`).join(", "))??"*"} FROM ${t}`),Mj=async(e,t,n,i)=>{var r;const o=i.map(e=>"string"==typeof e?`${_N(e)}`:e),s=`SELECT "${n.pointIndexBy}" FROM ${t} WHERE "${n.pointIdBy}" IN (${o})`,a=await e.query(s);return a?(null==(r=a.getChildAt(0))?void 0:r.toArray())??[]:void 0},Dj=async(e,t,n,i)=>{var r;const o=i.join(", "),s=`SELECT "${n.pointIdBy}" FROM ${t} WHERE "${n.pointIndexBy}" IN (${o})`,a=await e.query(s);return a?(null==(r=a.getChildAt(0))?void 0:r.toArray())??[]:void 0},Nj=(e,t=8192,n=t/2,i=t/8)=>Array.from({length:2*e},()=>{const e=n+i*Math.sqrt(-2*Math.log(Math.random()))*Math.cos(2*Math.PI*Math.random());return Math.max(1,Math.min(t-1,e))}),Fj=async(e,t)=>{var n,i;const r=await e.query(t);if(!r)return;const o=(null==(n=r.getChildAt(0))?void 0:n.toArray())??[],s=(null==(i=r.getChildAt(1))?void 0:i.toArray())??[];return[...new Set([...o,...s])]},Oj=async(e,t,n)=>await e.query(`SELECT ${(null==n?void 0:n.map(e=>`"${e}"`).join(", "))??"*"} FROM ${t}`),Bj=[null,void 0,"null","","undefined","nan"],zj=e=>Bj.includes("string"==typeof e?e.toLowerCase():e),Uj=e=>{const t=BV(e,dj),n=BV(e,uj),[i,r]=xV(e),o=t===n?i:t,s=t===n?r:n;return o===s?[o,s+1e-6]:[o,s]},Vj=(e,t,n)=>{const i=new Set(e);for(const o of i)zj(o)&&i.delete(o);const r=HV().domain(Array.from(i)).range(t);return e=>zj(e)?n:r(e)},Hj=(e,t,n,i=!0)=>{const r=i?Uj(e):xV(e);return T$(yz(_z.gamma(1.5),t)).domain(r).unknown(n).clamp(!0)},Wj=(e,t,n,i=!0)=>{const r=i?Uj(e):xV(e);return _H().domain(r).range(t).unknown(n)},$j=(e,t)=>{if(!e)return t;if("string"==typeof e)return e;const[n,i,r]=e.map(e=>Math.round(255*e));return`rgb(${n}, ${i}, ${r})`},Gj=(e,t,n=!1)=>{let i;if(n){const t=BV(e,dj),n=BV(e,uj);i=t===n?xV(e):[t,n]}else i=xV(e);return i[0]===i[1]&&(i[1]=i[1]+1e-6),gH().range(t).domain(i).clamp(!0)};let jj=class{constructor(){s(this,"_colorStore"),this._colorStore=new Map}getColor(e){if(this._colorStore.has(e))return this._colorStore.get(e);{const t=EB(e),n=[t.r/255,t.g/255,t.b/255,t.opacity];return this._colorStore.set(e,n),n}}clearCache(){this._colorStore.clear()}};const Yj=(e,t,n)=>{const i=new Float32Array(e.length);for(let r=0;r<e.length;r++){const o=e.get(r);i[r]=n?n(o,r):o??t}return i},qj=(e,t,n)=>{const i=new Float32Array(4*e.length),r=new jj;for(let o=0;o<e.length;o++){const s=e.get(o),a=n?n(s,o):s??t;let[l,c,u,d]=Array.isArray(a)?a:r.getColor(a);(isNaN(l)||isNaN(c)||isNaN(u)||isNaN(d))&&([l,c,u,d]=Array.isArray(t)?t:r.getColor(t));const h=4*o;i[h]=l,i[h+1]=c,i[h+2]=u,i[h+3]=d}return r.clearCache(),i};var Xj;!function(e){e.Categorical="categorical",e.Continuous="continuous",e.Map="map",e.Degree="degree",e.PreciseDegree="preciseDegree",e.LinkDirection="linkDirection",e.Direct="direct",e.Single="single"}(Xj||(Xj={}));const Kj=(e,t,n,i)=>{const r=$j(t.unknownColor,_j),o=t.pointColorPalette??pj;return{[Xj.Degree]:()=>Hj(n,o,r),[Xj.PreciseDegree]:()=>Hj(n,o,r,!1),[Xj.LinkDirection]:()=>Wj(n,o,r,!1),[Xj.Map]:()=>e=>t.pointColorByMap?t.pointColorByMap[e]??r:r,[Xj.Categorical]:()=>{let e;if(yN(i)&&(e=Wj(n,o,r)),vN(i)||bN(i)){const t=Ij(n);e=Vj(t,o,r)}return e},[Xj.Continuous]:()=>{let e;if(yN(i)&&(e=Hj(n,o,r)),vN(i)||bN(i)){e=((e,t,n)=>{const i=Array.from(new Set(e)),r=function(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e(i/(t-1));return n}(yz(_z.gamma(2.2),t),i.length);return Vj(i,r.reverse(),n)})(Ij(n),o,r)}return e},[Xj.Direct]:()=>t.pointColorByFn,[Xj.Single]:()=>()=>t.pointDefaultColor}[e]()};var Zj;!function(e){e.Sum="sum",e.Average="average",e.Count="count",e.Categorical="categorical",e.Direct="direct",e.Single="single"}(Zj||(Zj={}));const Qj=(e,t,n,i)=>{const r=$j(t.unknownColor,_j),o=t.linkColorPalette??mj;return{[Zj.Sum]:()=>Hj(n,o,r),[Zj.Average]:()=>Hj(n,o,r),[Zj.Count]:()=>Hj(n,o,r),[Zj.Categorical]:()=>{let e;if(yN(i)&&(e=Wj(n,o,r)),vN(i)||bN(i)){const t=Ij(n);e=Vj(t,o,r)}return e},[Zj.Direct]:()=>t.linkColorByFn,[Zj.Single]:()=>()=>t.linkDefaultColor}[e]()};var Jj;!function(e){e.Degree="degree",e.PreciseDegree="preciseDegree",e.Auto="auto",e.Direct="direct",e.Single="single"}(Jj||(Jj={}));const eY=(e,t,n)=>({[Jj.Degree]:()=>Gj(n,t.pointSizeRange??hj,!0),[Jj.PreciseDegree]:()=>Gj(n,t.pointSizeRange??hj),[Jj.Auto]:()=>Gj(n,t.pointSizeRange??hj,!0),[Jj.Direct]:()=>t.pointSizeByFn,[Jj.Single]:()=>()=>t.pointDefaultSize}[e]());var tY;!function(e){e.Sum="sum",e.Average="average",e.Count="count",e.Direct="direct",e.Single="single"}(tY||(tY={}));const nY=(e,t,n)=>{const i=()=>Gj(n,t.linkWidthRange??fj,!0);return{[tY.Sum]:i,[tY.Average]:i,[tY.Count]:i,[tY.Direct]:()=>t.linkWidthByFn??i(),[tY.Single]:()=>()=>t.linkDefaultWidth}[e]()};class iY{constructor(e){s(this,"_"),s(this,"config",bj),s(this,"_rawConfig",{}),s(this,"_cosmosConfig",{}),s(this,"_configUpdatePromise",null),s(this,"_cosmosInitPromise",null),s(this,"_cosmosInitResolved",null),s(this,"_currentPointColorStrategy",Xj.Direct),s(this,"_currentLinkColorStrategy",Zj.Direct),s(this,"_currentPointSizeStrategy",Jj.Direct),s(this,"_currentLinkWidthStrategy",tY.Direct),s(this,"_currentPointColorFn"),s(this,"_currentPointSizeFn"),s(this,"_currentLinkColorFn"),s(this,"_currentLinkWidthFn"),s(this,"_clusterMapping",new Map),s(this,"_clusterIndexToNameMapping",new Map),s(this,"_preservedPointPositions",new Map),s(this,"resetCosmographConfig",()=>{this.config=bj}),s(this,"_checkPointEvents",()=>!(void 0===this.config.onClick&&!this.config.selectPointOnClick&&!this.config.focusPointOnClick)),this._=e,this._cosmosInitPromise=new Promise(e=>{this._cosmosInitResolved=e})}get activePointColorStrategy(){return this._currentPointColorStrategy}get activeLinkColorStrategy(){return this._currentLinkColorStrategy}get activePointSizeStrategy(){return this._currentPointSizeStrategy}get activeLinkWidthStrategy(){return this._currentLinkWidthStrategy}get activePointColorFn(){return this._currentPointColorFn}get activePointSizeFn(){return this._currentPointSizeFn}get activeLinkColorFn(){return this._currentLinkColorFn}get activeLinkWidthFn(){return this._currentLinkWidthFn}get clusterMapping(){return this._clusterMapping}get clusterIndexToNameMapping(){return this._clusterIndexToNameMapping}get cosmosConfig(){return this._cosmosConfig}async configUpdated(){await this._configUpdatePromise}async cosmosInitialized(){await this._cosmosInitPromise}setConfig(e){this._configUpdatePromise=(async()=>{var t,n,i;try{await this._.dbReady();const n=this.config;if(n.points&&!(null==e?void 0:e.points)&&!this._.public.stats.pointsCount)return void this._.public.reset();this.config=R$(bj,e??{}),this._rawConfig=e??{},this._controlBackgroundColor(n,this.config),this._.rectangularSelection.updateSelectionClassName(),window.cosmographDisableLogging=this.config.disableLogging??!1,this._cosmosConfig=this._createCosmosConfig(),null==(t=this._.cosmos)||t.setConfig(this._cosmosConfig),await this._processConfigUpdate(n),this._handleScaleChangeEvents(n,this.config)}finally{this._configUpdatePromise=null,null==(i=(n=this.config).onConfigUpdated)||i.call(n)}})()}async _processConfigUpdate(e){var t,n;const i=this._detectPointsChanged(e),r=this._detectLinksChanged(e),o=this._detectVisualLinkChanges(e),s=this._detectVisualPointChanges(e),a=this._detectClusterChanges(e),l=this._detectLabelChanges(e);if((i||r)&&await this._.dataManager.updateGraphData(i,r))return await this._rebuildGraph(!i&&r,r),void(this._cosmosInitResolved&&(this._cosmosInitResolved(),this._cosmosInitResolved=null));(o||s||a)&&this._.cosmos&&(await this._updateGraphProperties(e,s,this._.public.stats.linksCount>0&&o),this._.cosmos.render((null==(t=this._.cosmos)?void 0:t.isSimulationRunning)?void 0:0)),l&&(null==(n=this._.labels)||n.update()),!this.config.preservePointPositionsOnDataUpdate&&this._preservedPointPositions.size&&this._preservedPointPositions.clear()}async _rebuildGraph(e,t){var n,i,r;try{e?await this._updateGraphProperties(void 0,!1):(this._.dispatchEvent(new CustomEvent("reset")),await this._.initializeCosmos(),this._.initializeLabels(),await this._updateGraphProperties(void 0,!0,t)),this._.updateMessage(null);const o=!this._.public.isSimulationAvailable||!this._.pointsHaveLayout;null==(n=this._.cosmos)||n.render(o?void 0:0),this._.updateStats(),this._.dispatchEvent(new CustomEvent("graphRebuilt")),null==(r=(i=this.config).onGraphRebuilt)||r.call(i,this._.public.stats),this.config.points&&dN((this._.public.stats.pointsCount,this._.public.stats.linksCount))}catch(o){dN(0,0,"error"),this._.updateMessage(` ${o}`)}}async _updateGraphProperties(e,t=!0,n=!0){n&&await this.updateLinkProperties(e),t&&await this.updatePointProperties(e),this._updateClusterProperties(e)}async updatePointProperties(e,t=!1){var n,i,r;const{_:{dbCoordinator:o,config:s,public:{pointsTableName:a}}}=this,l=[s.pointXBy,s.pointYBy,s.pointColorBy,s.pointSizeBy,s.pointClusterBy,s.pointIndexBy,s.pointClusterStrengthBy].filter(Boolean),c=await Cj(o,a),u=new Set(c),d=l.filter(e=>u.has(e)),h=await Pj(o,a,d);let f=!1;(null==h?void 0:h.numRows)?(f=await this._handlePointPositions(e,h,t),f&&(null==(n=this._.cosmos)||n.graph.update()),this._handlePointColors(e,h),this._handlePointSizes(e,h),await this._handlePointClusterProps(e,h),f?null==(i=this._.labels)||i.update():null==(r=this._.labels)||r.render()):await this._.public.reset(!1)}async updateLinkProperties(e){const{dbCoordinator:t,cosmos:n,config:i,public:{linksTableName:r,stats:o}}=this._;if(!o.linksCount&&!(await wj(t,r)))return;const s=[i.linkColorBy,i.linkWidthBy,i.linkStrengthBy,i.linkArrowBy,i.linkSourceIndexBy,i.linkTargetIndexBy].filter(Boolean),a=await Cj(t,r),l=new Set(a),c=s.filter(e=>l.has(e)),u=await Oj(t,r,c);if(u){if(u.numRows!==(null==n?void 0:n.graph.linksNumber)){const e=((e,t)=>{if(!t.linkSourceIndexBy||!t.linkTargetIndexBy)return new Float32Array(0);const n=e.getChild(t.linkSourceIndexBy),i=e.getChild(t.linkTargetIndexBy),r=e.numRows,o=new Float32Array(2*r);for(let s=0,a=0;s<r;s++,a+=2)o[a]=(null==n?void 0:n.get(s))??0,o[a+1]=(null==i?void 0:i.get(s))??0;return o})(u,this.config);null==n||n.setLinks(e),this._.linkAggregationManager.buildCountCache(u),this._.linkAggregationManager.clearColorSumCache(),this._.linkAggregationManager.clearWidthSumCache()}this._handleLinkColors(e,u),this._handleLinkWidths(e,u),this._handleLinkStrengths(e,u),this._handleLinkArrows(e,u)}}_updateClusterProperties(e){const{config:t,_:{cosmos:n}}=this;if(!e||(null==e?void 0:e.clusterPositionsMap)!==t.clusterPositionsMap)if(t.clusterPositionsMap&&this._clusterMapping.size>0){const e=((e,t)=>{const n=[];return t.forEach((t,i)=>{if(e&&t in e){const r=e[t];if(r){const[e,t]=r;n[2*i]=e,n[2*i+1]=t}else n[2*i]=void 0,n[2*i+1]=void 0}else n[2*i]=void 0,n[2*i+1]=void 0}),n})(t.clusterPositionsMap,Array.from(this._clusterMapping.keys()));null==n||n.setClusterPositions(e)}else null==n||n.setClusterPositions([])}async _handlePointPositions(e,t,n=!1){const{config:i,_:{cosmos:r}}=this;if((null==r?void 0:r.graph.pointsNumber)&&e&&e.pointXBy===i.pointXBy&&e.pointYBy===i.pointYBy)return!1;let o=[];if(i.pointXBy||i.pointYBy){if(!(await this._.dataValidator.validatePointPositions()))return!1;o=((e,t)=>{if(!(null==t?void 0:t.pointXBy)||!(null==t?void 0:t.pointYBy))return[];const n=e.getChild(t.pointXBy),i=e.getChild(t.pointYBy),r=e.numRows,o=new Array(2*r);for(let s=0;s<r;s++)o[2*s]=null==n?void 0:n.get(s),o[2*s+1]=null==i?void 0:i.get(s);return o})(t,i)}else o=n?((e,t)=>{const n=null==e?void 0:e.getPointPositions(),i=e.getScaleX(),r=e.getScaleY();if(null==n?void 0:n.length){const o=t-n.length/2;let s=Nj(o,e.config.spaceSize);return i&&r&&(s=s.map((e,t)=>t%2==0?i(e):r(e))),n.concat(s)}return Nj(t,e.config.spaceSize)})(r,t.numRows):Nj(t.numRows,i.spaceSize);return i.preservePointPositionsOnDataUpdate&&this._preservedPointPositions.size>0&&((e,t)=>{const n=e.length/2;for(let i=0;i<n;i++){const n=t.get(i);n&&(e[2*i]=n[0],e[2*i+1]=n[1])}t.clear()})(o,this._preservedPointPositions),null==r||r.setPointPositions(new Float32Array(o),!n&&void 0),!0}_handlePointColors(e,t){const{config:n,_:{cosmos:i}}=this,r=[ej.PointColor,ej.PointColorStrategy,ej.PointColorPalette,ej.PointColorFn,ej.PointColorMap,"pointDefaultColor"];if(e&&!this._hasConfigChanged(e,n,r))return;let o=new Float32Array;const s=n.pointColorBy?t.getChild(n.pointColorBy):void 0;if(this._currentPointColorStrategy=function(e={},t){const{pointColorStrategy:n,pointColorBy:i,pointColorByFn:r,pointColorByMap:o,linkSourceBy:s,linkTargetBy:a}=e;if(n&&Object.values(Xj).includes(n))return n;if(r)return Xj.Direct;if(i){if(o)return Xj.Map;if(yN(t))return Xj.Continuous;if(vN(t)||bN(t))return Xj.Categorical}return!i&&s&&a?Xj.Degree:Xj.Single}(this._rawConfig,null==s?void 0:s.type),this._currentPointColorFn=void 0,this._currentPointColorStrategy===Xj.Degree||this._currentPointColorStrategy===Xj.PreciseDegree){const e=this._.public.pointDegrees;e&&(this._currentPointColorFn=Kj(this._currentPointColorStrategy,n,e),o=qj(sM(e),n.unknownColor,this._currentPointColorFn))}else if(this._currentPointColorStrategy===Xj.LinkDirection){const e=this._.public.pointDirections;e&&(this._currentPointColorFn=Kj(this._currentPointColorStrategy,n,e),o=qj(sM(e),n.unknownColor,this._currentPointColorFn))}else s?(this._currentPointColorFn=Kj(this._currentPointColorStrategy,n,s.toArray(),null==s?void 0:s.type),o=qj(s,n.unknownColor,this._currentPointColorFn)):n.pointColorBy&&dN(n.pointColorBy,0,"warn");null==i||i.setPointColors(o),this._.dispatchEvent(new CustomEvent("pointColorUpdated"))}_handlePointSizes(e,t){const{config:n,_:{cosmos:i}}=this,r=[ej.PointSize,ej.PointSizeStrategy,ej.PointSizeRange,ej.PointSizeFn,"pointDefaultSize"];if(e&&!this._hasConfigChanged(e,n,r))return;let o=new Float32Array;const s=n.pointSizeBy?t.getChild(n.pointSizeBy):void 0;if(this._currentPointSizeStrategy=function(e,t){const{pointSizeStrategy:n,pointSizeBy:i,pointDefaultSize:r,pointSizeByFn:o,linkSourceBy:s,linkTargetBy:a}=e;return n&&Object.values(Jj).includes(n)?n:o?Jj.Direct:i&&yN(t)?Jj.Auto:!r&&!i&&s&&a?Jj.Degree:Jj.Single}(this._rawConfig,null==s?void 0:s.type),this._currentPointSizeFn=void 0,this._currentPointSizeStrategy===Jj.Degree||this._currentPointSizeStrategy===Jj.PreciseDegree){const e=null==i?void 0:i.graph.degree;e&&(this._currentPointSizeFn=eY(this._currentPointSizeStrategy,n,e),o=Yj(sM(e),n.pointDefaultSize,this._currentPointSizeFn))}else s?(this._currentPointSizeFn=eY(this._currentPointSizeStrategy,n,s.toArray()),o=Yj(s,n.pointDefaultSize,this._currentPointSizeFn)):n.pointSizeBy&&dN(n.pointSizeBy,0,"warn");null==i||i.setPointSizes(o),this._.dispatchEvent(new CustomEvent("pointSizeUpdated"))}async _handlePointClusterProps(e,t){const{config:n,_:{cosmos:i}}=this;if(!e||e.pointClusterStrengthBy!==n.pointClusterStrengthBy){const e=n.pointClusterStrengthBy?t.getChild(n.pointClusterStrengthBy):void 0;let r=new Float32Array;e&&(r=Yj(e,xj(ej.PointClusterStrength))),null==i||i.setPointClusterStrength(r)}const r=[ej.PointCluster,ej.PointClusterFn];if(e&&!this._hasConfigChanged(e,n,r))return;const o=n.pointClusterBy?t.getChild(n.pointClusterBy):void 0;if(o){let e=Array.from(o.toArray());n.pointClusterByFn&&(e=e.map(n.pointClusterByFn));const t=new Map;for(const n of e){const e=String(n);t.set(e,(t.get(e)??0)+1)}this._clusterMapping.clear(),this._clusterIndexToNameMapping.clear();let r=0;for(const n of t.keys()){const e=t.get(n);this._clusterMapping.set(n,{index:r,count:e}),this._clusterIndexToNameMapping.set(r,{name:n,count:e}),r++}const s=e.map(e=>{var t;return void 0===e||null==(t=this._clusterMapping.get(String(e)))?void 0:t.index});null==i||i.setPointClusters(s)}else this._clusterMapping.clear(),this._clusterIndexToNameMapping.clear(),null==i||i.setPointClusters([]);this._.dispatchEvent(new CustomEvent("clustersUpdated"))}_handleLinkColors(e,t){const{config:n,_:{cosmos:i}}=this,r=[tj.LinkColor,tj.LinkColorStrategy,tj.LinkColorPalette,tj.LinkColorFn,"linkDefaultColor"];if(e&&e.linkColorBy!==n.linkColorBy&&this._.linkAggregationManager.clearColorSumCache(),e&&!this._hasConfigChanged(e,n,r))return;let o=new Float32Array;const s=n.linkColorBy?t.getChild(n.linkColorBy)??void 0:void 0;if(this._currentLinkColorStrategy=function(e={},t){const{linkColorStrategy:n,linkColorBy:i,linkColorByFn:r,linkSourceBy:o,linkTargetBy:s}=e;if(n&&Object.values(Zj).includes(n))return n;if(r)return Zj.Direct;if(i){if(yN(t))return Zj.Sum;if(vN(t)||bN(t))return Zj.Categorical}return!i&&o&&s?Zj.Count:Zj.Single}(this._rawConfig,null==s?void 0:s.type),this._currentLinkColorFn=void 0,this._currentLinkColorStrategy!==Zj.Sum&&this._currentLinkColorStrategy!==Zj.Average||!s||this._.linkAggregationManager.colorSumCache||this._.linkAggregationManager.buildColorSumCache(t,s),[Zj.Count,Zj.Sum,Zj.Average].includes(this._currentLinkColorStrategy)){const e=this._.linkAggregationManager.aggregateFromCache(t,this._currentLinkColorStrategy,!0);e&&(this._currentLinkColorFn=Qj(this._currentLinkColorStrategy,n,e),o=qj(sM(e),n.unknownColor,this._currentLinkColorFn))}else s?(this._currentLinkColorFn=Qj(this._currentLinkColorStrategy,n,s.toArray(),null==s?void 0:s.type),o=qj(s,n.unknownColor,this._currentLinkColorFn)):n.linkColorBy&&dN(n.linkColorBy,0,"warn");null==i||i.setLinkColors(o),this._.dispatchEvent(new CustomEvent("linkColorUpdated"))}_handleLinkWidths(e,t){const{config:n,_:{cosmos:i}}=this,r=[tj.LinkWidth,tj.LinkWidthRange,tj.LinkWidthStrategy,tj.LinkWidthFn,"linkDefaultWidth"];if(e&&e.linkWidthBy!==n.linkWidthBy&&this._.linkAggregationManager.clearWidthSumCache(),e&&!this._hasConfigChanged(e,n,r))return;let o=new Float32Array;const s=n.linkWidthBy?t.getChild(n.linkWidthBy):void 0;if(this._currentLinkWidthStrategy=function(e,t){const{linkWidthStrategy:n,linkWidthBy:i,linkWidthByFn:r,linkSourceBy:o,linkTargetBy:s}=e;return n&&Object.values(tY).includes(n)?n:r?tY.Direct:i&&yN(t)?tY.Sum:!i&&o&&s?tY.Count:tY.Single}(this._rawConfig,null==s?void 0:s.type),this._currentLinkWidthFn=void 0,this._currentLinkWidthStrategy!==tY.Sum&&this._currentLinkWidthStrategy!==tY.Average||!s||this._.linkAggregationManager.widthSumCache||this._.linkAggregationManager.buildWidthSumCache(t,s),[tY.Count,tY.Sum,tY.Average].includes(this._currentLinkWidthStrategy)){const e=this._.linkAggregationManager.aggregateFromCache(t,this._currentLinkWidthStrategy,!1);e&&(this._currentLinkWidthFn=nY(this._currentLinkWidthStrategy,this.config,e),o=Yj(sM(e),this.config.linkDefaultWidth,this._currentLinkWidthFn))}else s?(this._currentLinkWidthFn=nY(this._currentLinkWidthStrategy,this.config,s.toArray()),o=Yj(s,n.linkDefaultWidth,this._currentLinkWidthFn)):n.linkWidthBy&&dN(n.linkWidthBy,0,"warn");null==i||i.setLinkWidths(o),this._.dispatchEvent(new CustomEvent("linkWidthUpdated"))}_handleLinkStrengths(e,t){const{config:n,_:{cosmos:i}}=this,r=[tj.LinkStrength,tj.LinkStrengthRange,tj.LinkStrengthFn];if(e&&!this._hasConfigChanged(e,n,r))return;let o=new Float32Array;const s=n.linkStrengthBy?t.getChild(n.linkStrengthBy):void 0;if(s){const e=n.linkStrengthByFn??Gj(s.toArray(),n.linkStrengthRange);o=Yj(s,xj(tj.LinkStrength),e)}else n.linkStrengthBy&&dN(n.linkStrengthBy,0,"warn");null==i||i.setLinkStrength(o)}_handleLinkArrows(e,t){const{config:n,_:{cosmos:i}}=this,r=[tj.LinkArrow,tj.LinkArrowFn,"linkDefaultArrows"];if(e&&!this._hasConfigChanged(e,n,r))return;let o=[];const s=n.linkArrowBy?t.getChild(n.linkArrowBy):void 0;s?o=((e,t,n)=>{const i=new Array(e.length);for(let r=0;r<e.length;r++){const o=e.get(r);i[r]=n?n(o,r):o??t}return i})(s,n.linkDefaultArrows,n.linkArrowByFn):n.linkArrowBy&&dN(n.linkArrowBy,0,"warn"),null==i||i.setLinkArrows(o)}_handleScaleChangeEvents(e,t){(null==e?void 0:e.pointSizeScale)===t.pointSizeScale&&(null==e?void 0:e.scalePointsOnZoom)===t.scalePointsOnZoom||this._.dispatchEvent(new CustomEvent("pointSizeScaleUpdated")),(null==e?void 0:e.linkWidthScale)===t.linkWidthScale&&(null==e?void 0:e.scaleLinksOnZoom)===t.scaleLinksOnZoom||this._.dispatchEvent(new CustomEvent("linkWidthScaleUpdated"))}_hasConfigChanged(e,t,n){return n.some(n=>!fN(e[n],t[n]))}_detectPointsChanged(e){return this._hasConfigChanged(e,this.config,oj)}_detectLinksChanged(e){return this._hasConfigChanged(e,this.config,sj)}_detectLabelChanges(e){return this._hasConfigChanged(e,this.config,cj)}_detectVisualLinkChanges(e){return this._hasConfigChanged(e,this.config,aj)}_detectVisualPointChanges(e){return this._hasConfigChanged(e,this.config,lj)}_detectClusterChanges(e){return this._hasConfigChanged(e,this.config,rj)}_controlBackgroundColor(e,t){var n,i;if((null==e?void 0:e.backgroundColor)===t.backgroundColor)return;const r=(e=>{var t,n;if(!e)return;if("string"==typeof e)return null==(t=bB(e))?void 0:t.formatHex();const[i,r,o,s]=e;return null==(n=bB(`rgba(${i}, ${r}, ${o}, ${s})`))?void 0:n.formatHex()})(t.backgroundColor),o=r&&(e=>{const t=(e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt((t[1]||0).toString(),16),g:parseInt((t[2]||0).toString(),16),b:parseInt((t[3]||0).toString(),16)}:{r:0,g:0,b:0}})(e);return(.2126*t.r+.7152*t.g+.0722*t.b)/255})(r)>.65?"#000000":"#ffffff";null==(n=this._.containerElement)||n.style.setProperty("--cosmograph-text-color",o),null==(i=this._.cosmosElement)||i.style.setProperty("backgroundColor",r??gj)}_createCosmosConfig(){var e;const t={...this.config,hoveredPointCursor:this._checkPointEvents()?(null==(e=this.config)?void 0:e.hoveredPointCursor)??"pointer":"auto"};return delete t.enableSimulation,delete t.attribution,this._.eventManager.attachCosmosEvents(t),t}updatePreservedPointPositions(e){this._preservedPointPositions=e}clearCosmosBuffers(e){const{_:{cosmos:t}}=this;e||(null==t||t.setPointPositions(new Float32Array),null==t||t.setPointColors(new Float32Array),null==t||t.setPointSizes(new Float32Array),null==t||t.setPointClusters([]),null==t||t.setPointClusterStrength(new Float32Array),null==t||t.setClusterPositions([])),null==t||t.setLinks(new Float32Array),null==t||t.setLinkColors(new Float32Array),null==t||t.setLinkWidths(new Float32Array),null==t||t.setLinkStrength(new Float32Array),null==t||t.setLinkArrows([])}}let rY=class{constructor(e){s(this,"_"),s(this,"_linksSelection",zC.crossfilter()),s(this,"_pointsSelection",zC.crossfilter()),s(this,"_onLinksFiltered"),s(this,"_onPointsFiltered"),s(this,"_crossfilter",{links:new Set,points:new Set,intersection:new Set}),this._=e,this._onLinksFiltered=e=>this._handleCrossfiltering(e,"links"),this._onPointsFiltered=e=>this._handleCrossfiltering(e,"points")}get filtered(){return this._crossfilter}get pointsSelection(){return this._pointsSelection}get linksSelection(){return this._linksSelection}get onLinksFiltered(){return this._onLinksFiltered}get onPointsFiltered(){return this._onPointsFiltered}get isFilteringActive(){return this._linksSelection.clauses.length>0||this._pointsSelection.clauses.length>0}_handleCrossfiltering(e,t){var n,i;const{config:r,cosmos:o,labels:s}=this._;this._getSetForCrossfilter(e,t),this._getIntersection(),this.isFilteringActive?null==o||o.selectPointsByIndices(Array.from(this._crossfilter.intersection)):null==o||o.unselectPoints();const a=this._.public.getSelectedLinkIndices(),l=null==o?void 0:o.getSelectedIndices();"points"===t&&(null==(n=r.onPointsFiltered)||n.call(r,e,l,a)),"links"===t&&(null==(i=r.onLinksFiltered)||i.call(r,e,l,a)),null==s||s.update(),this._.dispatchEvent(new CustomEvent("dataFiltered"))}_getSetForCrossfilter(e,t){var n;const{config:i}=this._;let r;if("links"===t)r=((e,t)=>{if(!t.linkSourceIndexBy||!t.linkTargetIndexBy)return new Set;const n=e.getChild(t.linkSourceIndexBy),i=e.getChild(t.linkTargetIndexBy);if(!n||!i)return new Set;const r=new Set;for(let o=0;o<n.length;o++)r.add(n.get(o)),r.add(i.get(o));return r})(e,i);else{const t=null==(n=e.getChild(i.pointIndexBy))?void 0:n.toArray();r=new Set(t)}this._crossfilter[t]=r}_getIntersection(){const{links:e,points:t}=this._crossfilter,n=t.values();let i=new Set;if(this._linksSelection.clauses.length&&this._pointsSelection.clauses.length)for(const r of n)e.has(r)&&i.add(r);else i=this._linksSelection.clauses.length?e:t;this._crossfilter.intersection=i}},oY=class{constructor(e){s(this,"_"),s(this,"_dataUploadPromise",null),this._=e}get dataUploadPromise(){return this._dataUploadPromise}async dataReady(){var e;await this._.dbReady(),(null==(e=this._.dbCoordinator)?void 0:e.internalDB)&&this._dataUploadPromise&&await this._dataUploadPromise}async updateGraphData(e,t){let n=!1;return this._dataUploadPromise&&(dN(0,0,"info"),await this._dataUploadPromise),!!this._.dbCoordinator&&(this._dataUploadPromise=(async()=>{var i,r,o,s,a;(null==(i=this._.cosmos)?void 0:i.isSimulationRunning)&&(null==(r=this._.cosmos)||r.stop()),null==(o=this._.dbCoordinator)||o.clearCache();try{if(e){const{pointsOk:e}=await this._uploadAndValidateGraphData(t);n=e}else if(t){const{linksOk:t}=await this._uploadAndValidateLinksData();n=e?n&&t:t}}finally{this._dataUploadPromise=null,this._.dispatchEvent(new CustomEvent("dataUploaded")),null==(a=null==(s=this._.config)?void 0:s.onGraphDataUpdated)||a.call(s)}})(),await this._dataUploadPromise,n)}async _addPreparedData(e,t){var n;const{_:{dbCoordinator:i,public:{linksTableName:r,isSimulationRunning:o,activePointColorStrategy:s,activePointSizeStrategy:a}}}=this;if(i&&(null==i?void 0:i.internalDB)){if(e&&(await this._uploadPoints(e,!0),await this._.configManager.updatePointProperties(void 0,!0)),t){const e=await wj(i,r);await this._uploadLinks(t,e),await this._.configManager.updateLinkProperties(void 0),s!==Xj.Degree&&s!==Xj.LinkDirection&&a!==Jj.Degree||await this._.configManager.updatePointProperties(void 0,!0)}null==(n=this._.cosmos)||n.render(o?this._.config.simulationImpulse:0),this._triggerGraphUpdated()}}async addPoints(e){const{_:{dbCoordinator:t,public:{stats:n}}}=this,{pointIndexBy:i,pointIdBy:r}=this._.config;if(t&&(null==t?void 0:t.internalDB)){const o=n.pointsCount,s=await Cj(t,eF.Points),a=[];for(const t of e){if(void 0===t.id)continue;const e={};for(const n of s)if(n===i)e[n]=BigInt(o+a.length);else if(n===r)e[n]=t.id;else if(void 0!==t[n])e[n]=t[n];else{const t=Object.values(ej).find(e=>this._.config[e]===n);e[n]=t?xj(t):null}a.push(e)}this._preservePointPositionsIfEnabled(),a.length&&await this._addPreparedData(a,void 0)}}async addLinks(e){const{_:{dbCoordinator:t,config:n}}=this;if(!(null==t?void 0:t.internalDB))return;const{linkSourceBy:i,linkTargetBy:r,linkSourceIndexBy:o,linkTargetIndexBy:s}=n;if(!(i&&r&&o&&s))return;const a=e.filter(e=>null!=e.source&&null!=e.target),l=[...new Set(a.flatMap(e=>[e.source,e.target]).map(String))];if(!l.length)return;const c=await Mj(t,eF.Points,n,l);if(!c)return;const u=new Map(l.map((e,t)=>[e,c[t]]));let d=await wj(t,eF.Links)?await Cj(t,eF.Links):[];d.length||(d=[i,r,o,s,...n.linkColorBy?[n.linkColorBy]:[],...n.linkWidthBy?[n.linkWidthBy]:[],...n.linkArrowBy?[n.linkArrowBy]:[],...n.linkStrengthBy?[n.linkStrengthBy]:[],...Array.isArray(n.linkIncludeColumns)?n.linkIncludeColumns:[]]);const h=[];for(const f of a){const e=String(f.source),t=String(f.target),a=u.get(e),l=u.get(t);if(void 0===a||void 0===l)continue;const c={};for(const u of d)if(u===i)c[u]=f.source;else if(u===r)c[u]=f.target;else if(u===o)c[u]=BigInt(a);else if(u===s)c[u]=BigInt(l);else if(u in f&&void 0!==f[u])c[u]=f[u];else{const e=Object.values(tj).find(e=>n[e]===u);c[u]=e?xj(e):null}h.push(c)}h.length&&await this._addPreparedData(void 0,h)}async removePointsByIndices(e,t=!0){var n;const{_:{dbCoordinator:i,public:{pointsTableName:r,linksTableName:o,stats:s,isSimulationRunning:a}}}=this;if(!i||s.pointsCount<=1)return;const l=[...new Set(e)];if(!(l.length>=s.pointsCount)&&(null==i?void 0:i.internalDB)){const e=`${l.join(", ")}`;await i.internalDB.query(`DELETE FROM ${r} WHERE "${this._.config.pointIndexBy}" IN (${e})`),this._removePointsInCosmos(l),t&&s.linksCount&&(await i.internalDB.query(`DELETE FROM ${o} WHERE "${this._.config.linkSourceIndexBy}" IN (${e})\n          OR "${this._.config.linkTargetIndexBy}" IN (${e})`),await this._.configManager.updateLinkProperties(void 0)),null==(n=this._.cosmos)||n.render(a?this._.config.simulationImpulse:0),this._triggerGraphUpdated()}}async removePointsByIds(e){const t=await Mj(this._.dbCoordinator,this._.public.pointsTableName,this._.config,e);t&&await this.removePointsByIndices(t)}async removeLinksByPointIdPairs(e){await this._removeLinks(e,!1)}async removeLinksByPointIndicesPairs(e){await this._removeLinks(e,!0)}async _uploadData(e,t){let n={pointsError:!1,linksError:!1};if(!this._.dbCoordinator||!this._.dbCoordinator.internalDB)return n;try{n=await this._executeUpload(e,t)}catch(i){dN(0,0,"error")}return n}async _uploadPoints(e,t=!1){var n,i;const r=await(null==(i=null==(n=this._.dbCoordinator)?void 0:n.internalDB)?void 0:i.uploadData(e,eF.Points,t));return!!(null==r?void 0:r.error)}async _uploadLinks(e,t=!1){var n,i;const r=await(null==(i=null==(n=this._.dbCoordinator)?void 0:n.internalDB)?void 0:i.uploadData(e,eF.Links,t));return!!(null==r?void 0:r.error)}async _executeUpload(e,t){dN();const n={pointsError:!1,linksError:!1};return await this._.dbReady(),this._.updateMessage(" Loading data..."),e&&(n.pointsError=await this._uploadPoints(e)),t&&(n.linksError=await this._uploadLinks(t)),this._.updateMessage(n.pointsError?" Points data is empty or invalid.":null),n}_preservePointPositionsIfEnabled(){var e;const{config:t,public:{stats:n}}=this._;if(t.pointIdBy&&n.pointsCount&&t.preservePointPositionsOnDataUpdate){const t=null==(e=this._.cosmos)?void 0:e.getPointPositions();if(t&&t.length){const e=((e,t)=>new Map(Array.from({length:t},(t,n)=>[n,[e[2*n],e[2*n+1]]])))(t,n.pointsCount);this._.configManager.updatePreservedPointPositions(e)}}}async _uploadAndValidateGraphData(e){const{_:{config:t}}=this;if(!t.points){await this._.public.reset(!1);const e="Points source data is not provided in `points`.";return dN(0,0,"error"),this._.updateMessage(` ${e}`),{pointsOk:!1,linksOk:!1}}this._preservePointPositionsIfEnabled();const{pointsError:n,linksError:i}=await this._uploadData(t.points,t.links);if(await this._.updateSummary(),n){const e="Failed to upload points data: The data is invalid or empty.";return dN(0,0,"error"),this._.updateMessage(` ${e}`),{pointsOk:!1,linksOk:!1}}try{const r=!n&&await this._.dataValidator.validatePoints();if(!r)return{pointsOk:r,linksOk:!1};const o=e&&!i&&await this._.dataValidator.validateLinks();return t.links&&!o&&dN(0,0,"warn"),{pointsOk:r,linksOk:o}}catch(r){return dN(0,0,"error"),{pointsOk:!1,linksOk:!1}}}async _uploadAndValidateLinksData(){let e=!1;if(0===this._.public.stats.pointsCount)return{linksOk:e};if(this._.configManager.clearCosmosBuffers(!0),!this._.config.links)return await this._.dropLocalTables(!0),{linksOk:e};const{linksError:t}=await this._uploadData(void 0,this._.config.links);return await this._.updateSummary(),e=!t&&await this._.dataValidator.validateLinks(),e||await this._.dropLocalTables(!0),{linksOk:e}}_removePointsInCosmos(e){var t,n,i,r,o,s,a,l,c,u,d,h,f,p,m,g,_,y,v,b;if(!e.length)return;const x=new Set(e);if(null==(n=null==(t=this._.cosmos)?void 0:t.graph.pointPositions)?void 0:n.length){const e=kj(x,null==(i=this._.cosmos)?void 0:i.graph.pointPositions,2);null==(r=this._.cosmos)||r.setPointPositions(e,!1)}if(null==(s=null==(o=this._.cosmos)?void 0:o.graph.pointColors)?void 0:s.length){const e=kj(x,null==(a=this._.cosmos)?void 0:a.graph.pointColors,4);null==(l=this._.cosmos)||l.setPointColors(e)}if(null==(u=null==(c=this._.cosmos)?void 0:c.graph.pointSizes)?void 0:u.length){const e=kj(x,null==(d=this._.cosmos)?void 0:d.graph.pointSizes,1);null==(h=this._.cosmos)||h.setPointSizes(e)}if(null==(p=null==(f=this._.cosmos)?void 0:f.graph.pointClusters)?void 0:p.length){const e=null==(m=this._.cosmos)?void 0:m.graph.pointClusters.filter((e,t)=>!x.has(t));null==(g=this._.cosmos)||g.setPointClusters(e)}if(null==(y=null==(_=this._.cosmos)?void 0:_.graph.clusterStrength)?void 0:y.length){const e=kj(x,null==(v=this._.cosmos)?void 0:v.graph.clusterStrength,1);null==(b=this._.cosmos)||b.setPointClusterStrength(e)}}async _removeLinks(e,t){var n;const{_:{dbCoordinator:i,public:{linksTableName:r,stats:o,isSimulationRunning:s,activePointColorStrategy:a,activePointSizeStrategy:l}}}=this;if(!(null==i?void 0:i.internalDB)||!o.linksCount)return;const c=t?this._.config.linkSourceIndexBy:this._.config.linkSourceBy,u=t?this._.config.linkTargetIndexBy:this._.config.linkTargetBy,d=e=>t?e.toString():`'${e}'`,h=`\n      DELETE FROM ${r}\n      WHERE ${e.map(([e,t])=>`((${c} = ${d(e)} AND ${u} = ${d(t)}) OR\n        (${c} = ${d(t)} AND ${u} = ${d(e)}))`).join(" OR ")}\n    `;await i.internalDB.query(h),await this._.configManager.updateLinkProperties(void 0),a!==Xj.Degree&&a!==Xj.LinkDirection&&l!==Jj.Degree||await this._.configManager.updatePointProperties(void 0,!0),null==(n=this._.cosmos)||n.render(s?this._.config.simulationImpulse:0),this._triggerGraphUpdated()}_triggerGraphUpdated(){var e,t;this._.dbCoordinator.clearCache(),this._.updateStats(),null==(t=(e=this._.config).onGraphRebuilt)||t.call(e,this._.public.stats),this._.dispatchEvent(new CustomEvent("dataUploaded")),this._.dispatchEvent(new CustomEvent("graphRebuilt"))}};const sY=()=>globalThis.__lastDuckdbError;let aY=class{constructor(e){s(this,"_"),this._=e}async validatePoints(){const{config:e,dbCoordinator:t,public:{pointsTableName:n}}=this._,i=oj.slice(1),r=e=>{throw dN(0,0,"error"),this._.updateMessage(` ${e}`),new Error(e)};if(!(await wj(t,n))){const e=sY();return r(e?`Failed to get points data: ${e}`:`Failed to get points data. Table "${n}" does not exist`)}const o=this._getMissingProperties(e,i);if(o.length)return r(`Failed to get points data.\n\nMissing required properties: ${this._formatMissingProps(o)}.`);const{exists:s,missingColumns:a}=await this._validateColumns(e,n,i);if(!s)return r(`Failed to get points data.\n\nMissing provided columns for required properties: ${this._formatMissingColumns(a,i)}.`);const l=(await Sj(t,n)).find(t=>t.name===e.pointIndexBy);return"VARCHAR"!==(null==l?void 0:l.type)||r(`The column specified for \`pointIndexBy\` (${e.pointIndexBy}) cannot be of type VARCHAR. Please use an integer-based column.`)}async validateLinks(){const{config:e,dbCoordinator:t,public:{linksTableName:n}}=this._,i=sj.slice(1),r=e=>{throw dN(0,0,"error"),this._.updateMessage(` ${e}`),new Error(e)};if(!e.links){const e="Found links-related properties but links data is not provided. Rendering points only.";return dN(0,0,"warn"),this._.updateMessage(` ${e}`),!1}if(!(await wj(t,n))){const e=sY();if(e)return r(`Failed to get links data: ${e}`);const t=`Failed to get links data. Table "${n}" does not exist`;return dN(0,0,"error"),this._.updateMessage(` ${t}`),!1}const o=this._getMissingProperties(e,i);if(o.length)return r(`Failed to get links data. \n\nMissing required properties: ${this._formatMissingProps(o)}.`);const{exists:s,missingColumns:a}=await this._validateColumns(e,n,i);return!!s||r(`Failed to get links data. \n\nMissing provided columns for required properties: ${this._formatMissingColumns(a,i)}.`)}async validatePointPositions(){const{config:e,config:{pointXBy:t,pointYBy:n},public:{pointsTableName:i}}=this._;if(Boolean(t)!==Boolean(n)){const e=`Couldn't render points: Only one of \`${ej.PointX}\` or \`${ej.PointY}\` provided.`;throw dN(0,0,"error"),this._.updateMessage(` ${e}`),new Error(e)}if(t&&n){const{exists:t,missingColumns:n}=await this._validateColumns(e,i,[ej.PointX,ej.PointY]);if(!t){const e=`Couldn't render points: Failed to get provided point positions, missing columns for positions: ${this._formatMissingProps(n)}.`;throw dN(0,0,"error"),this._.updateMessage(` ${e}`),new Error(e)}}return!0}async _validateColumns(e,t,n){const i=n.map(t=>e[t]),r=[];return{exists:await Tj(this._.dbCoordinator,t,i,r),missingColumns:r}}_getMissingProperties(e,t){return t.filter(t=>void 0===e[t])}_formatMissingProps(e){return e.map(e=>`"${e}"`).join(", ")}_formatMissingColumns(e,t){return e.map(n=>`"${n}" (${t[e.indexOf(n)]})`).join(", ")}},lY=class{constructor(e){s(this,"_"),s(this,"_hoveredPointIndex"),this._=e}attachCosmosEvents(e={}){e.onSimulationStart=this.onSimulationStart.bind(this),e.onSimulationTick=this.onSimulationTick.bind(this),e.onSimulationEnd=this.onSimulationEnd.bind(this),e.onSimulationPause=this.onSimulationPause.bind(this),e.onSimulationUnpause=this.onSimulationUnpause.bind(this),e.onClick=this.onClick.bind(this),e.onPointMouseOver=this.onPointMouseOver.bind(this),e.onPointMouseOut=this.onPointMouseOut.bind(this),e.onMouseMove=this.onMouseMove.bind(this),e.onZoomStart=this.onZoomStart.bind(this),e.onZoom=this.onZoom.bind(this),e.onZoomEnd=this.onZoomEnd.bind(this),e.onDrag=this.onDrag.bind(this),e.onDragEnd=this.onDragEnd.bind(this),e.onLinkClick=this.onLinkClick.bind(this),e.onLinkMouseOver=this.onLinkMouseOver.bind(this),e.onLinkMouseOut=this.onLinkMouseOut.bind(this)}getLabelEvents(){return{onLabelClick:this.onLabelClick.bind(this),onHoveredLabelClick:this.onHoveredLabelClick.bind(this)}}onClick(...e){var t;const{config:n}=this._;n.selectPointOnClick?this._handlePointClick(e[0],e[2]):e[0]||this._.public.selectPoint(void 0),null==(t=n.onClick)||t.call(n,...e)}async onLabelClick(e,t){var n,i,r;const{public:{pointsTableName:o},config:s,dbCoordinator:a,configManager:l}=this._;if("string"==typeof t.id&&t.id.startsWith("cluster-")){const r=t.id.slice(8),o=Number(r);if(!Number.isNaN(o)){const r=(null==(n=l.clusterIndexToNameMapping.get(o))?void 0:n.name)??t.id;s.selectClusterOnLabelClick&&await this._handleClusterClick(r,e),null==(i=s.onClusterLabelClick)||i.call(s,o,r,e)}return}if(!a)return;const c=await Mj(a,o,s,[t.id]);c&&void 0!==c[0]&&(s.selectPointOnLabelClick&&this._handlePointClick(c[0],e,s.selectPointOnLabelClick,!0),null==(r=s.onLabelClick)||r.call(s,c[0],t.id,e))}async onHoveredLabelClick(e){var t;const{public:{pointsTableName:n},config:i,dbCoordinator:r}=this._;if(void 0===this._hoveredPointIndex||!r)return;const o=await Dj(r,n,i,[this._hoveredPointIndex]);o&&o[0]&&(i.selectPointOnLabelClick&&this._handlePointClick(this._hoveredPointIndex,e,i.selectPointOnLabelClick,!0),null==(t=i.onLabelClick)||t.call(i,this._hoveredPointIndex,o[0],e))}onRectSelect(e,t=!1,n=!0){var i,r;n?this._.public.unselectPointsInRect(e):this._.public.selectPointsInRect(e,t),null==(r=(i=this._.config).onRectSelected)||r.call(i,e),this._.dispatchEvent(new CustomEvent("rectSelected"))}onPolygonSelect(e,t=!1,n=!0){var i,r;n?this._.public.unselectPointsInPolygon(e):this._.public.selectPointsInPolygon(e,t),null==(r=(i=this._.config).onPolygonSelected)||r.call(i,e),this._.dispatchEvent(new CustomEvent("polygonSelected"))}onPointMouseOver(...e){var t,n;const[i]=e;null==(n=(t=this._.config).onPointMouseOver)||n.call(t,...e),this._hoveredPointIndex=i,this._renderCurrentHoveredLabel()}onPointMouseOut(...e){var t,n;null==(n=(t=this._.config).onPointMouseOut)||n.call(t,...e),this._hoveredPointIndex=void 0,this._renderCurrentHoveredLabel()}onLinkMouseOver(...e){var t,n;null==(n=(t=this._.config).onLinkMouseOver)||n.call(t,...e)}onLinkMouseOut(...e){var t,n;null==(n=(t=this._.config).onLinkMouseOut)||n.call(t,...e)}onLinkClick(...e){var t,n;null==(n=(t=this._.config).onLinkClick)||n.call(t,...e)}onMouseMove(...e){var t,n;null==(n=(t=this._.config).onMouseMove)||n.call(t,...e)}onZoomStart(...e){var t,n,i;null==(n=(t=this._.config).onZoomStart)||n.call(t,...e),null==(i=this._.labels)||i.render()}onDrag(...e){var t,n,i;null==(n=(t=this._.config).onDrag)||n.call(t,...e),null==(i=this._.labels)||i.updatePositions(),this._renderCurrentHoveredLabel(),this._.dispatchEvent(new CustomEvent("onDrag"))}onDragEnd(...e){var t,n,i;null==(n=(t=this._.config).onDragEnd)||n.call(t,...e),null==(i=this._.labels)||i.update(),this._renderCurrentHoveredLabel()}async onZoom(...e){var t,n,i,r;null==(n=(t=this._.config).onZoom)||n.call(t,...e),null==(i=this._.labels)||i.setZooming(!0,!!e[0].sourceEvent),await(null==(r=this._.labels)?void 0:r.render()),this._renderCurrentHoveredLabel(),this._.dispatchEvent(new CustomEvent("onZoom")),this._.dispatchEvent(new CustomEvent("pointSizeScaleUpdated")),this._.dispatchEvent(new CustomEvent("linkWidthScaleUpdated"))}onZoomEnd(...e){var t,n,i;null==(n=(t=this._.config).onZoomEnd)||n.call(t,...e),null==(i=this._.labels)||i.setZooming(!1,!!e[0].sourceEvent),this._.dispatchEvent(new CustomEvent("zoomEnded"))}onSimulationStart(...e){var t,n;null==(n=(t=this._.config).onSimulationStart)||n.call(t,...e)}onSimulationTick(...e){var t,n,i;null==(n=(t=this._.config).onSimulationTick)||n.call(t,...e),null==(i=this._.labels)||i.updatePositions(),this._.dispatchEvent(new CustomEvent("onSimulationTick"))}onSimulationEnd(...e){var t,n;null==(n=(t=this._.config).onSimulationEnd)||n.call(t,...e),this._.dispatchEvent(new CustomEvent("onSimulationEnd"))}onSimulationPause(...e){var t,n,i;null==(n=(t=this._.config).onSimulationPause)||n.call(t,...e),null==(i=this._.labels)||i.render()}onSimulationUnpause(...e){var t,n,i,r;null==(n=(t=this._.config).onSimulationUnpause)||n.call(t,...e),null==(r=(i=this._.config).onSimulationRestart)||r.call(i,...e)}_handlePointClick(e,t,n,i=!1){const{config:r}=this._,{shiftKey:o,altKey:s}=t;if(s)this._.public.unselectPoint(e);else{const t=!0===n||"single"!==n&&void 0;this._.public.selectPoint(e,o,t)}(i?r.focusPointOnLabelClick??r.selectPointOnLabelClick:r.focusPointOnClick??r.selectPointOnClick)&&!s&&this._.public.setFocusedPoint(e)}async _handleClusterClick(e,t){const{config:n}=this._,{pointClusterBy:i}=n;if(!i)return;const r=await this._.public.getPointIndicesByExactValues(i,[e]);if(!r||!r.length)return;const{shiftKey:o,altKey:s}=t;s?this._.public.unselectPointsByIndices(r):this._.public.selectPoints(r,o)}_renderCurrentHoveredLabel(){var e,t,n;if(void 0===this._hoveredPointIndex)return void(null==(e=this._.labels)||e.renderHoveredLabel());const i=this._.public.getPointPositionByIndex(this._hoveredPointIndex);i?null==(t=this._.labels)||t.renderHoveredLabel(this._hoveredPointIndex,i):null==(n=this._.labels)||n.renderHoveredLabel()}};const cY=(e,t)=>0x100000000n*BigInt(e)+BigInt(t),uY=e=>{const t=Number(e%0x100000000n);return{sourceIdx:Number(e/0x100000000n),targetIdx:t}};let dY=class{constructor(e){s(this,"_"),s(this,"_countCache",null),s(this,"_colorSumCache",null),s(this,"_widthSumCache",null),s(this,"_colorSumCacheColumn",null),s(this,"_widthSumCacheColumn",null),this._=e}get countCache(){return this._countCache}get colorSumCache(){return this._colorSumCache}get widthSumCache(){return this._widthSumCache}buildCountCache(e){const t=this._getIndexColumns(e);if(!t)return void(this._countCache=null);const{sourceIdxColumn:n,targetIdxColumn:i,numRows:r}=t,o=new Map;for(let s=0;s<r;s++){const e=n.get(s),t=i.get(s),r=cY(e,t);o.set(r,(o.get(r)??0)+1)}this._countCache=o}buildColorSumCache(e,t){const{config:n}=this._;this._buildSumCacheForType(e,t,n.linkColorBy,!0)}buildWidthSumCache(e,t){const{config:n}=this._;this._buildSumCacheForType(e,t,n.linkWidthBy,!1)}_buildSumCacheForType(e,t,n,i){const r=n??null;if(!r)return void(i?(this._colorSumCache=null,this._colorSumCacheColumn=null):(this._widthSumCache=null,this._widthSumCacheColumn=null));const o=i?this._widthSumCache:this._colorSumCache;if(r===(i?this._widthSumCacheColumn:this._colorSumCacheColumn)&&o)return void(i?(this._colorSumCache=o,this._colorSumCacheColumn=r):(this._widthSumCache=o,this._widthSumCacheColumn=r));const s=i?this._colorSumCache:this._widthSumCache;if(r===(i?this._colorSumCacheColumn:this._widthSumCacheColumn)&&s)return;const a=this._buildSumCache(e,t);i?(this._colorSumCache=a,this._colorSumCacheColumn=a?r:null):(this._widthSumCache=a,this._widthSumCacheColumn=a?r:null)}_buildSumCache(e,t){if(!t)return null;const n=this._getIndexColumns(e);if(!n)return null;const{sourceIdxColumn:i,targetIdxColumn:r,numRows:o}=n,s=new Map;for(let a=0;a<o;a++){const e=i.get(a),n=r.get(a),o=cY(e,n),l=t.get(a);s.set(o,(s.get(o)??0)+l)}return s}_getIndexColumns(e){const{config:t}=this._;if(!t.linkSourceIndexBy||!t.linkTargetIndexBy)return null;const n=e.getChild(t.linkSourceIndexBy),i=e.getChild(t.linkTargetIndexBy);return n&&i?{sourceIdxColumn:n,targetIdxColumn:i,numRows:e.numRows}:null}aggregateFromCache(e,t,n=!0){const{config:i}=this._;if(!i.linkSourceIndexBy||!i.linkTargetIndexBy)return;const r=e.getChild(i.linkSourceIndexBy),o=e.getChild(i.linkTargetIndexBy);if(!r||!o)return;if(!this._countCache)return;const s=n?this._colorSumCache:this._widthSumCache,a=e.numRows,l=new Array(a);for(let c=0;c<a;c++){const e=r.get(c),n=o.get(c),i=cY(e,n),a=this._countCache.get(i)??0;if("count"===t)l[c]=a;else if("sum"===t)l[c]=(null==s?void 0:s.get(i))??0;else{const e=(null==s?void 0:s.get(i))??0;l[c]=a>0?e/a:0}}return l}getKeysByValueCondition(e,t){if(!e)return[];const n=[];for(const[i,r]of e)t(r)&&n.push(i);return n}getIndicesSetFromKeys(e){if(!e)return[];const t=new Set;for(const n of e){const{sourceIdx:e,targetIdx:i}=uY(n);t.add(e),t.add(i)}return Array.from(t)}getIndicesByValueCondition(e,t){const n=this.getKeysByValueCondition(e,t);return this.getIndicesSetFromKeys(n)}getIndicesByAverageCondition(e,t,n){if(!e||!t)return[];const i=[];for(const[r,o]of e){const e=t.get(r)??0;n(o>0?e/o:0)&&i.push(r)}return this.getIndicesSetFromKeys(i)}clear(){this._countCache=null,this._colorSumCache=null,this._widthSumCache=null,this._colorSumCacheColumn=null,this._widthSumCacheColumn=null}clearColorSumCache(){this._colorSumCache=null,this._colorSumCacheColumn=null}clearWidthSumCache(){this._widthSumCache=null,this._widthSumCacheColumn=null}};const hY="css-label--labels-container",fY="css-label--labels-container-hidden",pY="css-label--label",mY="css-label--hidden",gY=`\n  :root {\n    --css-label-background-color: #1e2428;\n    --css-label-brightness: brightness(150%);\n  }\n\n  .${hY} {\n    transition: opacity 100ms;\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n    top: 0%;\n    pointer-events: none;\n    opacity: 1;\n  }\n\n  .${fY} {\n    opacity: 0;\n\n    div {\n      pointer-events: none;\n    }\n  }\n`,_Y=`\n  .${pY} {\n    position: absolute;\n    top: 0;\n    left: 0;\n\n    cursor: pointer;\n    \n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n\n    filter: var(--css-label-brightness);\n    pointer-events: none;\n    background-color: var(--css-label-background-color);\n    font-weight: 700;\n    border-radius: 6px;\n    \n    transition: opacity 600ms;\n    opacity: 1;\n  }\n\n  /* We use "important" here because the users may pass their own label class, overriding the opacity */\n  .${mY} {\n    opacity: 0 !important;\n  }\n`,yY=e=>{const t=document.createElement("style");t.innerHTML=e;const n=document.head.getElementsByTagName("style")[0];return n?document.head.insertBefore(t,n):document.head.appendChild(t),t};let vY,bY;class xY{constructor(e,t,n){this.element=document.createElement("div"),this.fontWidthHeightRatio=.6,this._x=0,this._y=0,this._estimatedWidth=0,this._estimatedHeight=0,this._visible=!1,this._prevVisible=!1,this._weight=0,this._needsMeasureUpdate=!0,this._customFontSize=14,this._customColor=void 0,this._customOpacity=void 0,this._shouldBeShown=!1,this._text="",this._customPadding={left:9,top:6,right:9,bottom:6},n||vY||(vY=yY(_Y)),this._container=e,this._updateClasses(),t&&this.setText(t),this.resetFontSize(),this.resetPadding()}setText(e){this._text!==e&&(this._text=e,this.element.innerHTML=e,this._needsMeasureUpdate=!0)}setPosition(e,t){this._x=e,this._y=t}setStyle(e){if(this._customStyle!==e&&(this._customStyle=e,this.element.style.cssText=this._customStyle,this._customColor&&(this.element.style.color=this._customColor),this._customOpacity&&(this.element.style.opacity=String(this._customOpacity)),this._customPointerEvents&&(this.element.style.pointerEvents=this._customPointerEvents),this._customFontSize&&(this.element.style.fontSize=`${this._customFontSize}px`),this._customPadding)){const{top:e,right:t,bottom:n,left:i}=this._customPadding;this.element.style.padding=`${e}px ${t}px ${n}px ${i}px`}}setClassName(e){this._customClassName!==e&&(this._customClassName=e,this._updateClasses())}setFontSize(e=14){this._customFontSize!==e&&(this.element.style.fontSize=`${e}px`,this._customFontSize=e,this._needsMeasureUpdate=!0)}resetFontSize(){14!==this._customFontSize&&(this.element.style.fontSize="14px",this._customFontSize=14,this._needsMeasureUpdate=!0)}setColor(e){this._customColor!==e&&(this.element.style.color=e,this._customColor=e)}resetColor(){this.element.style.removeProperty("color"),this._customColor=void 0}setOpacity(e){this._customOpacity!==e&&(this.element.style.opacity=String(e),this._customOpacity=e)}resetOpacity(){this.element.style.removeProperty("opacity"),this._customOpacity=void 0}setPointerEvents(e){this._customPointerEvents!==e&&(this.element.style.pointerEvents=`${e}`,this._customPointerEvents=e)}resetPointerEvents(){this.element.style.removeProperty("pointer-events"),this._customPointerEvents=void 0}setPadding(e={left:9,top:6,right:9,bottom:6}){this._customPadding.left===e.left&&this._customPadding.top===e.top&&this._customPadding.right===e.right&&this._customPadding.bottom===e.bottom||(this._customPadding=e,this.element.style.padding=`${e.top}px ${e.right}px ${e.bottom}px ${e.left}px`,this._needsMeasureUpdate=!0)}resetPadding(){if(9===this._customPadding.left&&6===this._customPadding.top&&9===this._customPadding.right&&6===this._customPadding.bottom)return;const e={left:9,top:6,right:9,bottom:6};this.element.style.padding=`${e.top}px ${e.right}px ${e.bottom}px ${e.left}px`,this._customPadding=e,this._needsMeasureUpdate=!0}setForceShow(e){this._shouldBeShown=e}getForceShow(){return this._shouldBeShown}draw(){const e=this.getVisibility();e!==this._prevVisible&&(!1===this._prevVisible?this._container.appendChild(this.element):this._container.removeChild(this.element),this._updateClasses(),this._prevVisible=e),e&&(this.element.style.transform=`\n        translate(-50%, -100%)\n        translate3d(${this._x}px, ${this._y}px, 0)\n      `)}overlaps(e){return this._measureText(),e._measureText(),function(e,t){const[n,i,r,o]=[e.x,e.y+e.height,e.x+e.width,e.y],[s,a,l,c]=[t.x,t.y+t.height,t.x+t.width,t.y];return!(i<c||a<o||r<s||l<n)}({height:this._estimatedHeight,width:this._estimatedWidth,x:this._x,y:this._y},{height:e._estimatedHeight,width:e._estimatedWidth,x:e._x,y:e._y})}setVisibility(e=!0){this._visible=e}getVisibility(){return this._visible}isOnScreen(){return this._x>0&&this._y>0&&this._x<this._container.offsetWidth&&this._y<this._container.offsetHeight}setWeight(e){this._weight=e}getWeight(){return this._weight}raise(){this._container.appendChild(this.element)}destroy(){this.element.remove()}_updateClasses(){this.getVisibility()?window.requestAnimationFrame(()=>{this.element.className=`${pY} ${this._customClassName||""}`}):this.element.className=`${pY} ${this._customClassName||""} ${mY}`}_measureText(){if(this._needsMeasureUpdate){const{left:e,top:t,right:n,bottom:i}=this._customPadding;this._estimatedWidth=this._customFontSize*this.fontWidthHeightRatio*this.element.innerHTML.length+e+n,this._estimatedHeight=this._customFontSize+t+i,this._needsMeasureUpdate=!1}}}class wY{constructor(e,t){this._cssLabels=new Map,this._elementToData=new Map,(null==t?void 0:t.dontInjectStyles)||bY||(bY=yY(gY)),this._container=e,e.addEventListener("click",this._onClick.bind(this)),this._container.className=hY,(null==t?void 0:t.onLabelClick)&&(this._onClickCallback=t.onLabelClick),(null==t?void 0:t.pointerEvents)&&(this._pointerEvents=t.pointerEvents),(null==t?void 0:t.dontInjectStyles)&&(this._dontInjectStyles=t.dontInjectStyles),(null==t?void 0:t.padding)&&(this._padding=t.padding),(null==t?void 0:t.fontSize)&&(this._fontSize=t.fontSize),(null==t?void 0:t.dispatchWheelEventElement)&&(this._dispatchWheelEventElement=t.dispatchWheelEventElement,this._container.addEventListener("wheel",this._onWheel.bind(this)))}setLabels(e){const t=new Map(this._cssLabels);e.forEach(e=>{const{x:n,y:i,fontSize:r,color:o,text:s,weight:a,opacity:l,shouldBeShown:c,style:u,className:d,padding:h}=e;if(this._cssLabels.get(e.id))t.delete(e.id);else{const t=new xY(this._container,e.text,this._dontInjectStyles);this._cssLabels.set(e.id,t),this._elementToData.set(t.element,e)}const f=this._cssLabels.get(e.id);f&&(f.setText(s),f.setPosition(n,i),void 0!==u&&f.setStyle(u),void 0!==a&&f.setWeight(a),void 0!==o&&f.setColor(o),void 0!==r?f.setFontSize(r):void 0!==this._fontSize?f.setFontSize(this._fontSize):f.resetFontSize(),void 0!==h?f.setPadding(h):void 0!==this._padding?f.setPadding(this._padding):f.resetPadding(),void 0!==this._pointerEvents&&f.setPointerEvents(this._pointerEvents),void 0!==l&&f.setOpacity(l),void 0!==c&&f.setForceShow(c),void 0!==d&&f.setClassName(d))});for(const[n]of t){const e=this._cssLabels.get(n);e&&(this._elementToData.delete(e.element),e.destroy()),this._cssLabels.delete(n)}}draw(e=!0){e&&this._intersectLabels(),this._cssLabels.forEach(e=>e.draw())}show(){this._container.className=hY}hide(){this._container.className=`${hY} ${fY}`}destroy(){this._container.removeEventListener("click",this._onClick.bind(this)),this._container.removeEventListener("wheel",this._onWheel.bind(this)),this._cssLabels.forEach(e=>e.destroy())}_onClick(e){var t;const n=this._elementToData.get(e.target);n&&(null===(t=this._onClickCallback)||void 0===t||t.call(this,e,n))}_onWheel(e){var t;e.preventDefault();const n=new WheelEvent("wheel",e);null===(t=this._dispatchWheelEventElement)||void 0===t||t.dispatchEvent(n)}_intersectLabels(){const e=Array.from(this._cssLabels.values());e.forEach(e=>e.setVisibility(e.isOnScreen()));for(let t=0;t<e.length;t+=1){const n=e[t];if(n.getVisibility())for(let i=t+1;i<e.length;i+=1){const t=e[i];t.getVisibility()&&(n.overlaps(t)&&(t.getWeight()>n.getWeight()?n.setVisibility(!t.getForceShow()&&n.getForceShow()):t.setVisibility(!n.getForceShow()&&t.getForceShow())))}}}}const SY=async(e,t,n,i,r)=>{if(!n.pointIdBy||!n.pointIndexBy||!n.pointLabelBy)return{indices:null,ids:null,labels:null,weights:null};let o=`SELECT ${[...new Set([n.pointLabelBy,n.pointIndexBy,n.pointIdBy,...r?[r]:[]])].map(e=>`"${e}"`).join(", ")} FROM ${t}`;i&&(o+=` ${i}`),r&&(o+=` ORDER BY "${r}" DESC`),o+=` LIMIT ${n.showTopLabelsLimit}`;const s=await e.query(o,{cache:!0});if(!s)return{indices:null,ids:null,labels:null,weights:null};const a=s.getChild(n.pointIdBy),l=s.getChild(n.pointIndexBy);let c=s.getChild(n.pointLabelBy),u=null;r&&(u=s.getChild(r));const d=n.pointLabelFn,h=n.pointLabelWeightFn,f=Boolean(c)&&"function"==typeof d,p=Boolean(u)&&"function"==typeof h;if(n.pointLabelFn&&!f&&dN(0,0,"warn"),n.pointLabelWeightFn&&!p&&dN(0,0,"warn"),f||p){const e=f?c.toArray():null,t=p?u.toArray():null,n=Math.max((null==e?void 0:e.length)??0,(null==t?void 0:t.length)??0);for(let i=0;i<n;i++){const n=null==l?void 0:l.get(i);f&&e&&d&&(e[i]=d(e[i],n)),p&&t&&h&&(t[i]=h(t[i],n))}e&&(c=sM(e)),t&&(u=sM(t))}return{indices:l,ids:a,labels:c,weights:u}},EY=async(e,t,n,i,r)=>SY(e,t,n,`WHERE ${n.pointIndexBy} IN (${i.join(", ")})`,r);var CY=[],TY=[];function kY(e,t){if(e&&"undefined"!=typeof document){var n,i=!0===t.prepend?"prepend":"append",r=!0===t.singleTag,o="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(r){var s=CY.indexOf(o);-1===s&&(s=CY.push(o)-1,TY[s]={}),n=TY[s]&&TY[s][i]?TY[s][i]:TY[s][i]=a()}else n=a();65279===e.charCodeAt(0)&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function a(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var n=Object.keys(t.attributes),r=0;r<n.length;r++)e.setAttribute(n[r],t.attributes[n[r]]);var s="prepend"===i?"afterbegin":"beforeend";return o.insertAdjacentElement(s,e),e}}var IY={cosmographStaticLabel:"style_module_cosmographStaticLabel__2e27a4a3",cosmographDynamicLabel:"style_module_cosmographDynamicLabel__2e27a4a3",cosmographLabel:"style_module_cosmographLabel__2e27a4a3 style_module_cosmographLabelBase__2e27a4a3",cosmographLabelHovered:"style_module_cosmographLabelHovered__2e27a4a3 style_module_cosmographLabelBase__2e27a4a3",cosmographLabelInteractive:"style_module_cosmographLabelInteractive__2e27a4a3",cosmographLabelHidden:"style_module_cosmographLabelHidden__2e27a4a3 style_module_cosmographLabelBase__2e27a4a3",cosmographCustomLabel:"style_module_cosmographCustomLabel__2e27a4a3 style_module_cosmographLabelBase__2e27a4a3",cosmographClusterLabel:"style_module_cosmographClusterLabel__2e27a4a3 style_module_cosmographLabelBase__2e27a4a3"};kY(".style_module_cosmographDynamicLabel__2e27a4a3,.style_module_cosmographStaticLabel__2e27a4a3{opacity:1}.style_module_cosmographLabelBase__2e27a4a3{-webkit-font-smoothing:antialiased!important;background-color:#24272fe0;cursor:default;font-weight:400!important;line-height:1!important;max-width:350px;overflow:hidden;text-overflow:ellipsis;text-rendering:optimizeLegibility!important;transition:opacity .25s;white-space:nowrap}.style_module_cosmographLabelHovered__2e27a4a3{z-index:1}.style_module_cosmographLabelInteractive__2e27a4a3{cursor:pointer;pointer-events:all}.style_module_cosmographLabelHidden__2e27a4a3{opacity:.1}.style_module_cosmographClusterLabel__2e27a4a3{background:#3f4562a1;font-weight:500!important;opacity:.9;text-shadow:-1px -1px 0 #3f4562a1,-1px -1px 5px #00000026,1px -1px 0 #3f4562a1,1px -1px 5px #00000026,-1px 1px 0 #3f4562a1,-1px 1px 5px #00000026,1px 1px 0 #3f4562a1,1px 1px 5px #00000026}",{});let AY=class{constructor(e,t){var n;s(this,"_"),s(this,"_onHoveredLabelClick"),s(this,"_hoveredCssLabel"),s(this,"_cssLabelsRenderer"),s(this,"_focusedLabel"),s(this,"_staticLabelsMap",new Map),s(this,"_dynamicLabelsMap",new Map),s(this,"_validLabelAccessor",!1),s(this,"_validLabelWeightAccessor",!1),s(this,"_labelDataMap",new Map),s(this,"_customLabelsMap",new Map),s(this,"_columnNames",""),s(this,"_cachedTrackedPointsPositions"),s(this,"_lastTrackedPointsQueryTime",0),s(this,"_isZooming",!1),s(this,"_isManualZooming",!1),s(this,"_clustersFontScale"),s(this,"_clustersWeightScale"),s(this,"_updateClustersFontScaleHandler"),s(this,"_minDegree"),s(this,"_maxDegree"),s(this,"_degreeRange"),s(this,"_degreeSummaryCalculated",!1),s(this,"labelsContainer",document.createElement("div")),s(this,"_checkLabelEvents",()=>this._hasPointLabelEvents()?"all":"none"),this._=e;const i=this._.eventManager.getLabelEvents();null==(n=e.containerElement)||n.appendChild(this.labelsContainer),this._cssLabelsRenderer=new wY(this.labelsContainer,{dispatchWheelEventElement:t,onLabelClick:i.onLabelClick}),this._onHoveredLabelClick=i.onHoveredLabelClick,this._hoveredCssLabel=new xY(this.labelsContainer),this._hoveredCssLabel.setPointerEvents(this._checkLabelEvents()),this._hoveredCssLabel.element.addEventListener("click",this._onHoveredLabelClick,{passive:!0}),this._updateClustersFontScaleHandler=()=>this._updateClustersFontScale(),this._.addEventListener("clustersUpdated",this._updateClustersFontScaleHandler)}get _labelWeightAccessor(){const{pointLabelWeightBy:e,pointSizeBy:t}=this._.config;return e||t}async render(){const{customLabels:e,showClusterLabels:t}=this._.config;this._.cosmos&&this._.config&&((this._validLabelAccessor||e||t)&&!this._isZooming?await this._updateLabels():this._isZooming&&this._populateLabelDataMap(this._isManualZooming),this._renderLabels())}async update(){if(this._degreeSummaryCalculated=!1,!this._.cosmos||!this._.dbCoordinator)return;const{config:e,public:{pointsTableName:t}}=this._,{pointLabelBy:n,customLabels:i,showClusterLabels:r}=e;await this._.configManager.configUpdated();const o=this._columnNames;this._columnNames=`${n||""}-${this._labelWeightAccessor||""}`,this.setCustomLabels(i);let s=!1;if(n){if(o!==this._columnNames){const e=[];await Tj(this._.dbCoordinator,t,[n,this._labelWeightAccessor].filter(Boolean),e),this._validLabelAccessor=!e.includes(n),this._validLabelWeightAccessor=!!this._labelWeightAccessor&&!e.includes(this._labelWeightAccessor),this._validLabelAccessor&&!this._validLabelWeightAccessor&&(s=!0)}this._validLabelAccessor?(s&&this._calculateDegreeSummary(),await this._updateStaticLabels(),await this.render()):(dN(0,0,"warn"),this.clear())}else this._customLabelsMap.size>0||r?await this.render():this.clear()}updatePositions(){var e,t;const n=null==(e=this._.cosmos)?void 0:e.getPointPositions(),i=null==(t=this._.cosmos)?void 0:t.getClusterPositions();n&&this._labelDataMap.forEach(e=>{const t=e.index,i=n[2*t],r=n[2*t+1];void 0!==i&&void 0!==r&&(e.position=[i,r])}),i&&this._labelDataMap.forEach((e,t)=>{var n;if(null==(n=t.startsWith)?void 0:n.call(t,"cluster-")){const t=e.index,n=i[2*t],r=i[2*t+1];void 0!==n&&void 0!==r&&(e.position=[n,r])}}),this._renderLabels()}async _updateLabels(){var e,t,n,i;const{config:r,cosmosInitialized:o,dbCoordinator:s,public:{pointsTableName:a,focusedPointIndex:l}}=this._,{showDynamicLabels:c,pointLabelBy:u,showLabels:d}=r;if(this._dynamicLabelsMap.clear(),this._validLabelAccessor&&u&&d&&s)if(c&&await this._updateDynamicLabels(),l){if(!this._focusedLabel||this._focusedLabel&&this._focusedLabel[0]!==l){const c=await EY(s,a,r,[l]);if(this._focusedLabel=[null==(e=c.indices)?void 0:e.get(0),null==(t=c.ids)?void 0:t.get(0),null==(n=c.labels)?void 0:n.get(0)],o){const e=Array.from(this._staticLabelsMap.keys()).concat(l);null==(i=this._.cosmos)||i.trackPointPositionsByIndices(e)}}}else this._focusedLabel=void 0;this._populateLabelDataMap()}async _updateDynamicLabels(){const{config:e,dbCoordinator:t,public:{pointsTableName:n}}=this._,i=this._.public.getSampledPointPositionsMap();if(!(null==i?void 0:i.size))return;const r=Array.from(i.keys()),o=await EY(t,n,e,r);this._setLabels(this._dynamicLabelsMap,o)}async _updateStaticLabels(){var e;const{config:t,dbCoordinator:n,public:{pointsTableName:i,focusedPointIndex:r}}=this._,{pointLabelBy:o,showTopLabels:s,showLabelsFor:a,showLabels:l}=t;if(this._staticLabelsMap.clear(),!l||!n||!o)return;const c=[];(null==a?void 0:a.length)&&c.push((async(e,t,n,i)=>{const r=(n.showLabelsFor??[]).map(e=>`'${e}'`).join(", ");return SY(e,t,n,`WHERE ${n.pointIdBy} IN (${r})`,i)})(n,i,t,this._validLabelWeightAccessor?this._labelWeightAccessor:void 0).then(e=>this._setLabels(this._staticLabelsMap,e))),s&&c.push(this._getTopLabels().then(e=>this._setLabels(this._staticLabelsMap,e))),c.length&&await Promise.all(c);const u=Array.from(this._staticLabelsMap.keys());r&&u.push(r),u.length&&(null==(e=this._.cosmos)||e.trackPointPositionsByIndices(u))}async _getTopLabels(){const{config:e,dbCoordinator:t,public:{pointsTableName:n}}=this._;if(!t)return;const i=this._.public.getSelectedPointIndices();if(null==i?void 0:i.length)return await EY(t,n,e,i,this._validLabelWeightAccessor?this._labelWeightAccessor:void 0);if(this._labelWeightAccessor&&this._validLabelWeightAccessor)return await(async(e,t,n)=>SY(e,t,n))(t,n,e);this._labelWeightAccessor&&!this._validLabelWeightAccessor&&dN(this._labelWeightAccessor,0,"warn");const r=this._findTopIndicesByDegree();return r.length?await EY(t,n,e,r,this._validLabelWeightAccessor?this._labelWeightAccessor:void 0):void 0}_setLabels(e,t){var n;if(!(null==t?void 0:t.indices)||!t.labels||!t.ids)return;const i=t.indices.length;for(let r=0;r<i;r++)e.set(t.indices.get(r),[t.ids.get(r),t.labels.get(r),null==(n=t.weights)?void 0:n.get(r)])}_findTopIndicesByDegree(){const{showTopLabelsLimit:e=100}=this._.config,{pointDegrees:t}=this._.public;if(!t)return[];const n=new Set(this._.public.getSelectedPointIndices()),i=[];if(n.size>0){const r=Array.from(n).sort((e,n)=>(t[n]||0)-(t[e]||0)).slice(0,e);i.push(...r)}if(i.length<e){const r=e-i.length,o=[];for(let e=0;e<t.length;e++)!n.has(e)&&t[e]&&(o.length<r?(o.push({index:e,degree:t[e]??0}),o.length===r&&o.sort((e,t)=>t.degree-e.degree)):t[e]>o[r-1].degree&&(o[r-1]={index:e,degree:t[e]},o.sort((e,t)=>t.degree-e.degree)));i.push(...o.map(e=>e.index))}return i}_populateLabelDataMap(e=!1){const{showLabels:t,staticLabelWeight:n,dynamicLabelWeight:i,showDynamicLabels:r,showTopLabels:o,showLabelsFor:s,pointLabelBy:a}=this._.config;if(e&&t||this._labelDataMap.clear(),!t)return;const l=this._.crossfilter.isFilteringActive;if((!this._.config.showClusterLabels||l)&&this._validLabelAccessor&&a&&t){const t=this._getTrackedPositions(e);if(t&&((o||(null==s?void 0:s.length))&&this._addLabelsToDataMap(this._staticLabelsMap,t,IY.cosmographStaticLabel,n),this._addFocusedLabelToDataMap(t)),!e&&r){const e=this._.public.getSampledPointPositionsMap();e&&this._addLabelsToDataMap(this._dynamicLabelsMap,e,IY.cosmographDynamicLabel,i)}}this._addClusterLabelsToDataMap(),this._addCustomLabelsToDataMap()}_getTrackedPositions(e){var t;const n=Date.now();if(e&&this._cachedTrackedPointsPositions&&n-this._lastTrackedPointsQueryTime<1e3)return this._cachedTrackedPointsPositions;const i=null==(t=this._.cosmos)?void 0:t.getTrackedPointPositionsMap();return this._cachedTrackedPointsPositions=i,this._lastTrackedPointsQueryTime=n,i}_addLabelsToDataMap(e,t,n,i){e.size&&t.forEach((t,r)=>{const o=e.get(r);if(o){const[e,s,a]=o;this._labelDataMap.set(e,{index:r,text:s,position:t,className:n,weight:a??i})}})}_updateClustersFontScale(){const{config:e}=this._;if(!e.pointClusterBy)return;const t=xV(Array.from(this._.configManager.clusterIndexToNameMapping.values()).map(({count:e})=>e)),n=e.clusterLabelFontSize??vj,i=Math.max(10,Math.floor(.7*n)),r=Math.ceil(1.5*n);this._clustersFontScale=fH().domain(t).range([i,r]),this._clustersWeightScale=fH().domain(t).range([1100,1e4])}_addClusterLabelsToDataMap(){var e,t,n,i,r;const{config:{showClusterLabels:o,clusterLabelFontSize:s=vj,scaleClusterLabels:a,usePointColorStrategyForClusterLabels:l,pointDefaultColor:c}}=this._;if(!o||this._.crossfilter.isFilteringActive)return;const u=null==(e=this._.cosmos)?void 0:e.getClusterPositions();if(u)for(let d=0;d<u.length;d+=2){const e=Number(u[d]),o=Number(u[d+1]),h=d/2,f=this._.configManager.clusterIndexToNameMapping.get(h);if(!f)continue;const p=a?null==(t=this._clustersFontScale)?void 0:t.call(this,(null==f?void 0:f.count)??0):s,m=$j(c,yj),g=l?null==(i=(n=this._.configManager).activePointColorFn)?void 0:i.call(n,null==f?void 0:f.name):void 0,_=g?"string"==typeof g?g:$j(g,m):void 0,{text:y,maxWidth:v}=this._getClusterLabelText((null==f?void 0:f.name)??`Cluster ${h}`,p);this._labelDataMap.set(`cluster-${h}`,{text:y,position:[e,o],className:IY.cosmographClusterLabel,index:h,fontSize:p,color:l?_:"white",weight:(null==(r=this._clustersWeightScale)?void 0:r.call(this,(null==f?void 0:f.count)??0))??5e3,padding:this._getClusterPadding(p),maxWidth:v})}}_addCustomLabelsToDataMap(){const{staticLabelWeight:e,pointLabelColor:t}=this._.config;this._customLabelsMap.forEach((n,i)=>{this._labelDataMap.set(i,{index:0,text:n.text,position:n.position,className:n.className??IY.cosmographCustomLabel,color:t??(n.className?void 0:"white"),weight:e})})}_addFocusedLabelToDataMap(e){if(!this._focusedLabel)return;const[t,n,i]=this._focusedLabel,r=e.get(t);r&&this._labelDataMap.set(n,{index:t,text:i,position:r,className:IY.cosmographStaticLabel,weight:1e4})}_normalizeWeight(e,t,n){var i,r;if(n)return 1e3;if(this._validLabelWeightAccessor&&void 0!==e){const t=null==(r=null==(i=this._.summary)?void 0:i.pointsSummary)?void 0:r.find(e=>e.column_name===this._labelWeightAccessor);if(t){const{min:n,max:i}=t,r=i-n;return r>0?(e-n)/r*100:50}}const o=this._.public.pointDegrees;if(this._degreeSummaryCalculated&&o&&void 0!==o[t]){const e=o[t]??this._minDegree??0;return(this._degreeRange??0)>0?(e-(this._minDegree??0))/this._degreeRange*100:50}return 1}_calculateDegreeSummary(){const e=this._.public.pointDegrees;if(e&&!this._degreeSummaryCalculated){this._minDegree=1/0,this._maxDegree=-1/0;for(let t=0;t<e.length;t++){const n=e[t];void 0!==n&&(this._maxDegree=Math.max(this._maxDegree,n),this._minDegree=Math.min(this._minDegree,n))}this._minDegree===1/0&&(this._minDegree=0),this._maxDegree===-1/0&&(this._maxDegree=this._minDegree),this._degreeRange=this._maxDegree-this._minDegree,this._degreeSummaryCalculated=!0}}_renderLabels(){var e,t;const{public:{crossfilter:n}}=this._,{pointLabelClassName:i,clusterLabelClassName:r,labelMargin:o,pointLabelColor:s,pointLabelFontSize:a,clusterLabelFontSize:l=vj,labelPadding:c}=this._.config,u=n.intersection,d=this._.crossfilter.isFilteringActive,h=IY.cosmographLabelHidden,f=Array.from(this._labelDataMap.entries()).map(([e,t])=>{var n;const{index:f,text:p,position:m,className:g,weight:_,color:y,fontSize:v,padding:b,maxWidth:x}=t,w=e.startsWith("custom-"),S=e.startsWith("cluster-"),E=S?IY.cosmographClusterLabel:IY.cosmographLabel,[C,T]=this._.public.spaceToScreenPosition(m),k=this._.public.getPointScreenRadiusByIndex(f),I=(null==(n=this._focusedLabel)?void 0:n[0])===f,A=!!d&&u.has(f),L=!d||A,R=S?r:i;let P;if(P="function"==typeof R?R(p,f,e)??"":R??"",S&&x){const e=`max-width: ${x}px;`;P=P.includes(":")?`${P} ${e}`:e}const M=P.includes(":");let D,N=M?`${L?E:h} ${g}`:`${L?E:h} ${P} ${g}`;return(S?this._hasClusterLabelEvents():this._hasPointLabelEvents())&&(N+=` ${IY.cosmographLabelInteractive}`),D=w?T:S?T+l/2+o:T-k/2-o,{id:e,text:p,x:C,y:D,padding:S?b:this._getPaddingObject(c),weight:S?_:this._normalizeWeight(_,f,A),shouldBeShown:I,fontSize:v??a,color:w?y:y??(void 0!==i?void 0:s??this._getLabelColorByIndex(f)),style:M?P:"",className:N}});null==(e=this._cssLabelsRenderer)||e.setLabels(f),null==(t=this._cssLabelsRenderer)||t.draw(!0)}async renderHoveredLabel(e,t){var n,i;if(!this._.cosmos)return;const{config:r,dbCoordinator:o,public:{pointsTableName:s}}=this._,{pointLabelBy:a,showHoveredPointLabel:l,hoveredPointLabelClassName:c,labelMargin:u,pointLabelFontSize:d,labelPadding:h}=r;if(this._hoveredCssLabel.setPointerEvents(this._checkLabelEvents()),!(o&&l&&a&&void 0!==e&&t&&this._validLabelAccessor))return this._hoveredCssLabel.setVisibility(!1),void this._hoveredCssLabel.draw();const f=await EY(o,s,r,[e]);if(!f)return;const p=null==(n=f.ids)?void 0:n.get(0),m=(null==(i=f.labels)?void 0:i.get(0))??"",[g,_]=this._.public.spaceToScreenPosition(t),y=this._.public.getPointScreenRadiusByIndex(e);let v,b;v="function"==typeof c?c(m,e,p)??"":c??"";const x=v.includes(":");b=x?IY.cosmographLabelHovered:[IY.cosmographLabelHovered,v].join(" "),"all"===this._checkLabelEvents()&&(b+=` ${IY.cosmographLabelInteractive}`),this._hoveredCssLabel.setText(m),this._hoveredCssLabel.setVisibility(!0),this._hoveredCssLabel.setPosition(g,_-y/2-u),this._hoveredCssLabel.setClassName(b),this._hoveredCssLabel.setStyle(x?v:""),this._hoveredCssLabel.setFontSize(d),this._hoveredCssLabel.setPadding(this._getPaddingObject(h)),c||this._hoveredCssLabel.setColor(this._getLabelColorByIndex(e)),this._hoveredCssLabel.draw()}setCustomLabels(e){const{rescaleXFn:t,rescaleYFn:n}=this._.public;this._customLabelsMap.clear(),e&&e.forEach((e,i)=>{const r={...e};t&&n&&void 0!==r.position[0]&&void 0!==r.position[1]&&(r.position=[t(r.position[0]),n(r.position[1])]),this._customLabelsMap.set(`custom-${i}`,r)})}setZooming(e,t=!0){const n=this._isZooming;this._isZooming=e,this._isManualZooming=t,n&&!e&&this.render().catch(console.error)}destroy(){var e,t,n,i;this.clear(),null==(e=this._hoveredCssLabel)||e.element.removeEventListener("click",this._onHoveredLabelClick,{passive:!0}),null==(t=this._hoveredCssLabel)||t.destroy(),null==(n=this._cssLabelsRenderer)||n.destroy(),null==(i=this._.containerElement)||i.removeChild(this.labelsContainer)}clear(){var e,t,n;this._cachedTrackedPointsPositions=void 0,this._lastTrackedPointsQueryTime=0,this._isZooming=!1,this._degreeSummaryCalculated=!1,this._minDegree=void 0,this._maxDegree=void 0,this._degreeRange=void 0,this._labelDataMap.size&&(this._customLabelsMap.clear(),this._staticLabelsMap.clear(),this._dynamicLabelsMap.clear(),this._labelDataMap.clear(),null==(e=this._cssLabelsRenderer)||e.setLabels([]),null==(t=this._cssLabelsRenderer)||t.draw(),null==(n=this._hoveredCssLabel)||n.destroy())}_getLabelColorByIndex(e){var t;const n=((e,t)=>e?[e[4*t]??0,e[4*t+1]??0,e[4*t+2]??0,e[4*t+3]??0]:void 0)(null==(t=this._.cosmos)?void 0:t.graph.pointColors,e)??this._.config.pointDefaultColor,i=$j(this._.config.pointDefaultColor,yj);return $j(n,i)}_hasPointLabelEvents(){const{onLabelClick:e,selectPointOnLabelClick:t,focusPointOnLabelClick:n}=this._.config;return void 0!==e||Boolean(t)||Boolean(n)}_hasClusterLabelEvents(){const{onClusterLabelClick:e,selectClusterOnLabelClick:t}=this._.config;return void 0!==e||Boolean(t)}_getPaddingObject(e){if(e&&!(e.length<4))return{left:e[0]??0,top:e[1]??0,right:e[2]??0,bottom:e[3]??0}}_getClusterPadding(e){const{scaleClusterLabels:t,clusterLabelFontSize:n=vj}=this._.config,i=this._getPaddingObject(this._.config.labelPadding);if(!t||!e)return i;const r=e/n;return{left:i.left*r,top:i.top*r,right:i.right*r,bottom:i.bottom*r}}_getClusterLabelText(e,t){const{scaleClusterLabels:n,clusterLabelFontSize:i=vj}=this._.config;if(!n||!t)return{text:e,maxWidth:350};const r=t/i,o=Math.max(350,Math.min(900,500*r)),s=.6*t,a=Math.floor(o/s);return e.length*s>o?{text:`${e.substring(0,Math.max(3,a-3))}...`,maxWidth:o}:{text:e,maxWidth:o}}};kY(".style_module_rectSelect__6c3b1fe5{height:100%;left:0;position:absolute;top:0;width:100%}",{});let LY=class{constructor(e){var t;s(this,"_"),s(this,"_svg"),s(this,"_onSelectCallback"),s(this,"_brush",dV(JU).keyModifiers(!1).on("end",e=>{var t;if(!e.sourceEvent)return;const{shiftKey:n,altKey:i}=e.sourceEvent,r=e.selection;null==(t=this._onSelectCallback)||t.call(this,r,n,i)})),this._=e,this._svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._svg.classList.add("style_module_rectSelect__6c3b1fe5"),null==(t=this._.containerElement)||t.appendChild(this._svg),this._onSelectCallback=this._.eventManager.onRectSelect,EO(this._svg).select(".brush-group").remove(),this._brush.extent([[0,0],[this._svg.clientWidth,this._svg.clientHeight]]),EO(this._svg).append("g").attr("class","brush-group").call(this._brush),this.updateSelectionClassName(),EO(this._svg).style("display","none")}updateSelectionClassName(){const e=`selection ${this._.config.rectangularSelectorClassName??""}`;EO(this._svg).select(".brush-group").selectAll(".selection").attr("class",e)}enable(){EO(this._svg).style("display",null),this._brush.extent([[0,0],[this._svg.clientWidth,this._svg.clientHeight]]),EO(this._svg).select(".brush-group").call(this._brush)}disable(){EO(this._svg).style("display","none"),EO(this._svg).select(".brush-group").call(this._brush.clear)}destroy(){EO(this._svg).select(".brush-group").remove(),this._svg.remove()}};kY(".style_module_polygonalSelect__f21ae84d{height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}",{});let RY=class{constructor(e){s(this,"_"),s(this,"_canvas"),s(this,"_ctx"),s(this,"_isDrawing",!1),s(this,"_points",[]),s(this,"_onSelectCallback"),s(this,"_resizeObserver"),s(this,"_startDrawing",e=>{this._isDrawing=!0,this._points=[];const t=this._canvas.getBoundingClientRect();this._points.push({x:e.clientX-t.left,y:e.clientY-t.top});const n=window.devicePixelRatio||1;this._ctx.clearRect(0,0,this._canvas.width/n,this._canvas.height/n)}),s(this,"_draw",e=>{if(!this._isDrawing)return;const t=this._canvas.getBoundingClientRect();this._points.push({x:e.clientX-t.left,y:e.clientY-t.top});const n=window.devicePixelRatio||1;this._ctx.clearRect(0,0,this._canvas.width/n,this._canvas.height/n),this._ctx.beginPath(),this._points.length>0&&this._points[0]&&this._ctx.moveTo(this._points[0].x,this._points[0].y);for(let i=1;i<this._points.length;i++){const e=this._points[i];e&&this._ctx.lineTo(e.x,e.y)}this._ctx.strokeStyle=this._.config.polygonalSelectorStrokeColor||"#ffffff",this._ctx.lineWidth=this._.config.polygonalSelectorLineWidth||2,this._ctx.stroke()}),s(this,"_stopDrawing",e=>{var t;if(!this._isDrawing)return;if(this._isDrawing=!1,this._points.length>2){this._ctx.closePath(),this._ctx.stroke();const n=this._points.map(e=>[e.x,e.y]),i=n[0],r=n[n.length-1];i&&r&&(i[0]!==r[0]||i[1]!==r[1])&&n.push(i),null==(t=this._onSelectCallback)||t.call(this,n,e.shiftKey,e.altKey)}const n=window.devicePixelRatio||1;this._ctx.clearRect(0,0,this._canvas.width/n,this._canvas.height/n)}),this._=e,this._onSelectCallback=this._.eventManager.onPolygonSelect,this._initializeCanvas(),this._resizeObserver=new ResizeObserver(()=>this._resizeCanvas()),this._resizeObserver.observe(this._.containerElement)}_initializeCanvas(){const e=this._.containerElement;if(!e)return;this._canvas=document.createElement("canvas"),this._canvas.classList.add("style_module_polygonalSelect__f21ae84d"),e.appendChild(this._canvas);const t=this._canvas.getContext("2d");if(!t)return;this._ctx=t;const n=window.devicePixelRatio||1;this._canvas.width=e.clientWidth*n,this._canvas.height=e.clientHeight*n,this._canvas.style.width=`${e.clientWidth}px`,this._canvas.style.height=`${e.clientHeight}px`,this._ctx.scale(n,n)}enable(){this._canvas.style.display="block",this._canvas.style.pointerEvents="auto",this._canvas.style.cursor="crosshair",this._canvas.addEventListener("mousedown",this._startDrawing),this._canvas.addEventListener("mousemove",this._draw),this._canvas.addEventListener("mouseup",this._stopDrawing)}disable(){if(this._canvas.style.display="none",this._canvas.style.pointerEvents="none",this._canvas.style.cursor="default",this._canvas.removeEventListener("mousedown",this._startDrawing),this._canvas.removeEventListener("mousemove",this._draw),this._canvas.removeEventListener("mouseup",this._stopDrawing),this._ctx){const e=window.devicePixelRatio||1;this._ctx.clearRect(0,0,this._canvas.width/e,this._canvas.height/e)}}destroy(){var e;null==(e=this._resizeObserver)||e.disconnect(),this.disable(),this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas)}_resizeCanvas(){const{width:e,height:t}=this._.containerElement.getBoundingClientRect(),n=window.devicePixelRatio||1;this._canvas.width=e*n,this._canvas.height=t*n,this._canvas.style.width=`${e}px`,this._canvas.style.height=`${t}px`,this._ctx.scale(n,n)}};const PY=new WeakMap;function MY(e){return PY.get(e)}let DY=(t=class{constructor(e){s(this,"_id"),s(this,"_isActive",!0),s(this,"_client"),s(this,"_selection"),s(this,"_config"),s(this,"_currentData"),s(this,"_isArrayColumn",!1),this._config=e,this._client=this._createClient();const t=`${this.fieldsToQuery.join(",")}-${SN()}`;this._id=e.id?`${e.id}-${t}`:t}static getOrCreateClient(e){if(e.id){const n=t._clientRegistry.get(e.id);if(n)return n._config=e,n._isArrayColumn=!1,n._currentData&&n._detectArrayColumn(),n}const n=new t(e);return e.id&&t._clientRegistry.set(e.id,n),n}get selection(){return this._selection}get tableName(){return this._config.getTableName()}get accessor(){return this._config.getAccessor()}get id(){return this._id}get active(){return this._client.enabled}get currentData(){return this._currentData}get fieldsToQuery(){const e=this._config.includeFields?this._config.includeFields():[];return this._isActive?[...new Set([...this.accessor?[RS(this.accessor)]:[],...e].filter(Boolean))]:["*"]}setActive(e){this._isActive=e}async getCurrentData(){const e=await this._config.coordinator.query(rE.from(this.tableName).select(this.fieldsToQuery));return this._currentData=e,this._detectArrayColumn(),e}_detectArrayColumn(){var e;try{const t=this.accessor,n=t?null==(e=this._currentData)?void 0:e.getChild(t):void 0;this._isArrayColumn=!(!n||!(xN(n.type)||n.length>0&&Array.isArray(n.get(0))))}catch{this._isArrayColumn=!1}}applyFilter(e){var t;null==(t=this.selection)||t.update({source:this,predicate:e??null,value:e??null})}applyRangeFilter(e){this.accessor&&this.applyFilter(e?PE(RS(this.accessor),e):void 0)}applyExactFilter(e){if(void 0===e)return void this.applyFilter(void 0);if("null"===e)return void this.applyFilter((t=RS(this.accessor),wE("IS NULL",t)));var t;const n=this._isArrayColumn?DE`list_contains(${RS(this.accessor)}, ${MS(e)})`:SE("=",RS(this.accessor),MS(e));this.applyFilter(n)}applyInFilter(e){if(this.accessor)if(e&&e.length>0){const t=(Array.isArray(e)?e:Array.from(e)).map(e=>MS(e));this.applyFilter(ME(RS(this.accessor),t))}else this.applyFilter(void 0)}applyLessOrEqFilter(e){this.accessor&&this.applyFilter(void 0!==e?LE(RS(this.accessor),MS(e)):void 0)}applyGreaterOrEqFilter(e){this.accessor&&this.applyFilter(void 0!==e?RE(RS(this.accessor),MS(e)):void 0)}resetFilter(){var e,t;this.selection&&(null==(t=null==(e=this.selection)?void 0:e.clauses)?void 0:t.filter(e=>e.source.id===this.id).length)>0&&this.selection.update({source:this,predicate:null,value:null})}update(){this._client.update()}destroy(){this.resetFilter(),this._client.destroy(),this._config.id&&t._clientRegistry.delete(this._config.id)}regenerateClient(){this.destroy(),this._client=this._createClient()}_createClient(){return this._selection=this._config.getSelection(),function(e){const{coordinator:t=RC(),...n}=e,i=new MC(n);return t.connect(i),i}({coordinator:this._config.coordinator,selection:this.selection,query:e=>{var t;return this._isActive&&(null==(t=this.selection)?void 0:t.clauses.active)?rE.from(this.tableName).select(this.fieldsToQuery).where(e??[]):null},queryResult:e=>{var t,n;const i=e;this._currentData=i,null==(n=(t=this._config).onFiltered)||n.call(t,i)}})}reset(){this.resetFilter()}},s(t,"_clientRegistry",new Map),t),NY=class{constructor(e,t,n){s(this,"_dataUpdatedHandler"),s(this,"_dataFilteredHandler"),s(this,"_resetSelectionsHandler"),s(this,"_internalApi"),s(this,"_isValidAccessor",!1),s(this,"_currentData"),s(this,"_client"),s(this,"_uiComponent"),s(this,"_config"),s(this,"_targetElement"),s(this,"_abortController",new AbortController),s(this,"_readyPromise"),s(this,"_isInitialLoad",!0),this._internalApi=MY(e),this._targetElement=t,this._config=this._mergeWithDefaultConfig(n),this._dataUpdatedHandler=async()=>await this.fetchData(),this._dataFilteredHandler=()=>this.onDataFiltered(),this._resetSelectionsHandler=()=>this._onResetSelections(),this._internalApi.addEventListener("dataUploaded",this._dataUpdatedHandler),this._internalApi.addEventListener("dataFiltered",this._dataFilteredHandler),this._internalApi.addEventListener("resetSelections",this._resetSelectionsHandler),this._readyPromise=this._initialize()}onInitialize(){}onResetClientSelections(){}getCurrentData(){return null}async shouldUpdateComponentData(){return!1}get useLinksData(){return this._config.useLinksData??!1}get pointAccessors(){const{pointIdBy:e,pointIndexBy:t}=this._internalApi.config;return e&&t?[e,t]:[]}get linkAccessors(){const{linkSourceIndexBy:e,linkTargetIndexBy:t}=this._internalApi.config;return e&&t?[e,t]:[]}get selection(){return this.useLinksData?this._internalApi.crossfilter.linksSelection:this._internalApi.crossfilter.pointsSelection}get tableName(){return this.useLinksData?this._internalApi.public.linksTableName:this._internalApi.public.pointsTableName}async _initialize(){await((e,t)=>{const{signal:n}=t;return e.reduce((e,t)=>e.then(async()=>{var e;if(!n.aborted)try{await t()}catch(i){(e=i)&&(e.message||String(e)),n.aborted}}),Promise.resolve()).then(()=>{})})([async()=>{await this._internalApi.dbReady();const e=await this._getGlobalDisplayStateSettings(this._config);this._config={...this._config,...e}},async()=>{this._uiComponent=this.createUIComponent(this._targetElement),await this._internalApi.configManager.cosmosInitialized()},()=>this._createClient(),()=>this.fetchData(),()=>this.setConfig(this._config),()=>this.onConfigUpdate(),()=>Promise.resolve(this.onInitialize())],this._abortController)}async _getGlobalDisplayStateSettings(e){await this._internalApi.dbReady();const{componentsDisplayStateMode:t}=this._internalApi.config;let{disableStateMessages:n,noDataMessage:i}=e;return!1===t?n=!0:"loading"===t&&(i=!1),{disableStateMessages:n,noDataMessage:i,loadingMessage:e.loadingMessage}}async setConfig(e){var t;const n=this._config,i=this.accessor;this._config=this._mergeWithDefaultConfig(e),this._config={...this._config,...await this._getGlobalDisplayStateSettings(this._config)};const r=await this.shouldUpdateComponentData();this._config.useLinksData!==n.useLinksData&&(null==(t=this._client)||t.regenerateClient()),(r||this._config.useLinksData!==n.useLinksData||this._config.useQuantiles!==n.useQuantiles||this.accessor!==i)&&(await this.fetchData(),this.onResetClientSelections()),await this.onConfigUpdate(n)}async fetchData(){var e,t,n,i,r;const{dbCoordinator:o,dataManager:s}=this._internalApi;if(!o||!this.accessor)return;await s.dataReady(),null==(t=null==(e=this._uiComponent)?void 0:e.setLoadingState)||t.call(e);const a=!this.accessor||await wj(o,this.tableName);if(this._isValidAccessor=!this.accessor||a&&await Tj(o,this.tableName,[this.accessor]),this._isInitialLoad||null==(n=this._client)||n.resetFilter(),null==(i=this._client)||i.setActive(this._isValidAccessor),this._isValidAccessor){const e=await this.getCurrentData();this._currentData=null!==e?e:await(null==(r=this._client)?void 0:r.getCurrentData())}else this._currentData=void 0;this._isInitialLoad&&(this._isInitialLoad=!1)}ready(){return this._readyPromise}checkReady(e){return!!this._uiComponent||(this.ready().then(e),!1)}async _createClient(){if(await this._internalApi.dbReady(),!this._internalApi.dbCoordinator)return;const e={coordinator:this._internalApi.dbCoordinator,getTableName:()=>this.tableName,getSelection:()=>this.selection,getAccessor:()=>this.accessor,includeFields:()=>this.useLinksData?this.linkAccessors:this.pointAccessors,onFiltered:this._handleSelectionUpdate.bind(this),id:this._config.id||this.constructor.name+this.accessor+SN()};this._client=DY.getOrCreateClient(e)}_handleSelectionUpdate(e){var t,n,i,r;if(!this.accessor)return;const o=this._internalApi.crossfilter;if(this.useLinksData){const i=o.linksSelection.active;(null==(t=null==i?void 0:i.source)?void 0:t.id)===(null==(n=this._client)?void 0:n.id)&&o.onLinksFiltered(e)}else{const t=o.pointsSelection.active;(null==(i=null==t?void 0:t.source)?void 0:i.id)===(null==(r=this._client)?void 0:r.id)&&o.onPointsFiltered(e)}}_onResetSelections(){var e;null==(e=this._client)||e.resetFilter(),this.onResetClientSelections()}_mergeWithDefaultConfig(e){return R$(this.defaultConfig,e??{})}remove(){var e,t;this._abortController.abort(),null==(e=this._uiComponent)||e.destroy(),this._config.preserveSelectionOnUnmount||null==(t=this._client)||t.resetFilter(),this._internalApi.removeEventListener("dataUploaded",this._dataUpdatedHandler),this._internalApi.removeEventListener("dataFiltered",this._dataFilteredHandler),this._internalApi.removeEventListener("resetSelections",this._resetSelectionsHandler),this._isInitialLoad=!0}},FY=(n=class extends NY{static isInclusiveComponent(e){return n._inclusiveComponentIds.has(e)}static register(e){n._inclusiveComponentIds.add(e)}static unregister(e){n._inclusiveComponentIds.delete(e)}onInitialize(){var e;(null==(e=this._client)?void 0:e.id)&&n.register(this._client.id)}onDataFiltered(){var e;const{pointsSelection:t,linksSelection:i}=this._internalApi.crossfilter,r=t.active,o=i.active,s=!((null==r?void 0:r.predicate)||t.clauses.length||(null==o?void 0:o.predicate)||i.clauses.length),a=e=>{var t,i,r;return void 0!==(null==e?void 0:e.predicate)&&(null==(t=null==e?void 0:e.source)?void 0:t.id)===(null==(i=this._client)?void 0:i.id)&&!n.isInclusiveComponent(null==(r=null==e?void 0:e.source)?void 0:r.id)};(a(r)||a(o)||s)&&(null==(e=this._client)||e.resetFilter(),this.onResetClientSelections()),this.updateCrossfilteredData()}updateCrossfilteredData(){var e,t;const{crossfilter:n}=this._internalApi;if(!this._currentData||!this._isValidAccessor||!this.accessor)return;const i=n.filtered.intersection;if(n.isFilteringActive){const e=this._filterByIdx(this._currentData,i);this.updateHighlightedData(e)}else{const n=null==(t=null==(e=this._currentData)?void 0:e.getChild(this.accessor))?void 0:t.toArray();this.updateHighlightedData(n)}}_filterByIdx(e,t){var n,i;const{config:r}=this._internalApi;if(!this.accessor||!t.size)return[];const o=e.getChild(this.accessor);if(!o)return[];const s=this.useLinksData?r.linkSourceIndexBy:r.pointIndexBy,a=null==(n=e.getChild(s))?void 0:n.toArray();if(!a)return[];const l=this.useLinksData?null==(i=e.getChild(r.linkTargetIndexBy))?void 0:i.toArray():void 0,c=o.toArray(),u=t,d=[];for(let h=0,f=c.length;h<f;++h){const e=a[h];if(u.has(e)||void 0!==l&&u.has(l[h])){const e=c[h];Array.isArray(e)?d.push(...e):d.push(e)}}return d}remove(){var e;(null==(e=this._client)?void 0:e.id)&&n.unregister(this._client.id),super.remove()}},s(n,"_inclusiveComponentIds",new Set),n),OY=class{constructor(e){s(this,"_internalApi"),s(this,"_pointSelectionClient"),this._internalApi=e;const t={coordinator:this._internalApi.dbCoordinator,getSelection:()=>this._internalApi.crossfilter.pointsSelection,getTableName:()=>this._internalApi.public.pointsTableName,getAccessor:()=>this._internalApi.config.pointIndexBy,onFiltered:e=>this._onPointsFiltered(e),id:"pointsSelectionClient"};this._pointSelectionClient=new DY(t),this._pointSelectionClient.setActive(!0),FY.register(this._pointSelectionClient.id)}_onPointsFiltered(e){this._internalApi.crossfilter.onPointsFiltered(e)}selectPoints(e){void 0===e?this._pointSelectionClient.resetFilter():this._pointSelectionClient.applyInFilter(e)}get id(){return this._pointSelectionClient.id}destroy(){FY.unregister(this._pointSelectionClient.id)}};var BY=Array.prototype.slice;function zY(e,t){return e-t}const UY=e=>()=>e;function VY(e,t){for(var n,i=-1,r=t.length;++i<r;)if(n=HY(e,t[i]))return n;return 0}function HY(e,t){for(var n=t[0],i=t[1],r=-1,o=0,s=e.length,a=s-1;o<s;a=o++){var l=e[o],c=l[0],u=l[1],d=e[a],h=d[0],f=d[1];if(WY(l,d,t))return 0;u>i!=f>i&&n<(h-c)*(i-u)/(f-u)+c&&(r=-r)}return r}function WY(e,t,n){var i;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&function(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}(e[i=+(e[0]===t[0])],n[i],t[i])}function $Y(){}var GY=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function jY(){var e=1,t=1,n=MV,i=a;function r(e){var t=n(e);if(Array.isArray(t))t=t.slice().sort(zY);else{const n=xV(e,YY);for(t=LV(...function(e,t,n){let i;for(;;){const r=RV(e,t,n);if(r===i||0===r||!isFinite(r))return[e,t];r>0?(e=Math.floor(e/r)*r,t=Math.ceil(t/r)*r):r<0&&(e=Math.ceil(e*r)/r,t=Math.floor(t*r)/r),i=r}}(n[0],n[1],t),t);t[t.length-1]>=n[1];)t.pop();for(;t[1]<n[0];)t.shift()}return t.map(t=>o(e,t))}function o(n,r){const o=null==r?NaN:+r;if(isNaN(o))throw new Error(`invalid value: ${r}`);var a=[],l=[];return function(n,i,r){var o,a,l,c,u,d,h=new Array,f=new Array;for(o=a=-1,c=qY(n[0],i),GY[c<<1].forEach(p);++o<e-1;)l=c,c=qY(n[o+1],i),GY[l|c<<1].forEach(p);for(GY[0|c].forEach(p);++a<t-1;){for(o=-1,c=qY(n[a*e+e],i),u=qY(n[a*e],i),GY[c<<1|u<<2].forEach(p);++o<e-1;)l=c,c=qY(n[a*e+e+o+1],i),d=u,u=qY(n[a*e+o+1],i),GY[l|c<<1|u<<2|d<<3].forEach(p);GY[c|u<<3].forEach(p)}for(o=-1,u=n[a*e]>=i,GY[u<<2].forEach(p);++o<e-1;)d=u,u=qY(n[a*e+o+1],i),GY[u<<2|d<<3].forEach(p);function p(e){var t,n,i=[e[0][0]+o,e[0][1]+a],l=[e[1][0]+o,e[1][1]+a],c=s(i),u=s(l);(t=f[c])?(n=h[u])?(delete f[t.end],delete h[n.start],t===n?(t.ring.push(l),r(t.ring)):h[t.start]=f[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete f[t.end],t.ring.push(l),f[t.end=u]=t):(t=h[u])?(n=f[c])?(delete h[t.start],delete f[n.end],t===n?(t.ring.push(l),r(t.ring)):h[n.start]=f[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete h[t.start],t.ring.unshift(i),h[t.start=c]=t):h[c]=f[u]={start:c,end:u,ring:[i,l]}}GY[u<<3].forEach(p)}(n,o,function(e){i(e,n,o),function(e){for(var t=0,n=e.length,i=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}(e)>0?a.push([e]):l.push(e)}),l.forEach(function(e){for(var t,n=0,i=a.length;n<i;++n)if(-1!==VY((t=a[n])[0],e))return void t.push(e)}),{type:"MultiPolygon",value:r,coordinates:a}}function s(t){return 2*t[0]+t[1]*(e+1)*4}function a(n,i,r){n.forEach(function(n){var o=n[0],s=n[1],a=0|o,l=0|s,c=XY(i[l*e+a]);o>0&&o<e&&a===o&&(n[0]=KY(o,XY(i[l*e+a-1]),c,r)),s>0&&s<t&&l===s&&(n[1]=KY(s,XY(i[(l-1)*e+a]),c,r))})}return r.contour=o,r.size=function(n){if(!arguments.length)return[e,t];var i=Math.floor(n[0]),o=Math.floor(n[1]);if(!(i>=0&&o>=0))throw new Error("invalid size");return e=i,t=o,r},r.thresholds=function(e){return arguments.length?(n="function"==typeof e?e:Array.isArray(e)?UY(BY.call(e)):UY(e),r):n},r.smooth=function(e){return arguments.length?(i=e?a:$Y,r):i===a},r}function YY(e){return isFinite(e)?e:NaN}function qY(e,t){return null!=e&&+e>=t}function XY(e){return null==e||isNaN(e=+e)?-1/0:e}function KY(e,t,n,i){const r=i-t,o=n-t,s=isFinite(r)||isFinite(o)?r/o:Math.sign(r)/Math.sign(o);return isNaN(s)?e:e+s-.5}function ZY(e){return e[0]}function QY(e){return e[1]}function JY(){return 1}function eq(){var e=ZY,t=QY,n=JY,i=960,r=500,o=20,s=2,a=3*o,l=i+2*a>>s,c=r+2*a>>s,u=UY(20);function d(i){var r=new Float32Array(l*c),u=Math.pow(2,-s),d=-1;for(const o of i){var h=(e(o,++d,i)+a)*u,f=(t(o,d,i)+a)*u,p=+n(o,d,i);if(p&&h>=0&&h<l&&f>=0&&f<c){var m=Math.floor(h),g=Math.floor(f),_=h-m-.5,y=f-g-.5;r[m+g*l]+=(1-_)*(1-y)*p,r[m+1+g*l]+=_*(1-y)*p,r[m+1+(g+1)*l]+=_*y*p,r[m+(g+1)*l]+=(1-_)*y*p}}return _V({data:r,width:l,height:c},o*u),r}function h(e){var t=d(e),n=u(t),i=Math.pow(2,2*s);return Array.isArray(n)||(n=LV(Number.MIN_VALUE,DV(t)/i,n)),jY().size([l,c]).thresholds(n.map(e=>e*i))(t).map((e,t)=>(e.value=+n[t],f(e)))}function f(e){return e.coordinates.forEach(p),e}function p(e){e.forEach(m)}function m(e){e.forEach(g)}function g(e){e[0]=e[0]*Math.pow(2,s)-a,e[1]=e[1]*Math.pow(2,s)-a}function _(){return l=i+2*(a=3*o)>>s,c=r+2*a>>s,h}return h.contours=function(e){var t=d(e),n=jY().size([l,c]),i=Math.pow(2,2*s),r=e=>{e=+e;var r=f(n.contour(t,e*i));return r.value=e,r};return Object.defineProperty(r,"max",{get:()=>DV(t)/i}),r},h.x=function(t){return arguments.length?(e="function"==typeof t?t:UY(+t),h):e},h.y=function(e){return arguments.length?(t="function"==typeof e?e:UY(+e),h):t},h.weight=function(e){return arguments.length?(n="function"==typeof e?e:UY(+e),h):n},h.size=function(e){if(!arguments.length)return[i,r];var t=+e[0],n=+e[1];if(!(t>=0&&n>=0))throw new Error("invalid size");return i=t,r=n,_()},h.cellSize=function(e){if(!arguments.length)return 1<<s;if(!((e=+e)>=1))throw new Error("invalid cell size");return s=Math.floor(Math.log(e)/Math.LN2),_()},h.thresholds=function(e){return arguments.length?(u="function"==typeof e?e:Array.isArray(e)?UY(BY.call(e)):UY(e),h):u},h.bandwidth=function(e){if(!arguments.length)return Math.sqrt(o*(o+1));if(!((e=+e)>=0))throw new Error("invalid bandwidth");return o=(Math.sqrt(4*e*e+1)-1)/2,_()},h}function tq(e,t,n){this.k=e,this.x=t,this.y=n}tq.prototype={constructor:tq,scale:function(e){return 1===e?this:new tq(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new tq(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},tq.prototype;const nq=rq(e=>{const t=iq(e);return e=>null==e?"":"number"==typeof e?t(e):e instanceof Date?function(e,t){if(e instanceof Date||(e=new Date(+e)),isNaN(+e))return t;const n=e.getUTCHours(),i=e.getUTCMinutes(),r=e.getUTCSeconds(),o=e.getUTCMilliseconds();return`${s=e.getUTCFullYear(),s<0?`-${oq(-s,6)}`:s>9999?`+${oq(s,6)}`:oq(s,4)}-${oq(e.getUTCMonth()+1,2)}-${oq(e.getUTCDate(),2)}${n||i||r||o?`T${oq(n,2)}:${oq(i,2)}${r||o?`:${oq(r,2)}${o?`.${oq(o,3)}`:""}`:""}Z`:""}`;var s}(e,"Invalid Date"):`${e}`}),iq=rq(e=>t=>0===t?"0":t.toLocaleString(e));function rq(e){let t,n=null;return(i="en")=>i===n?t:t=e(n=i)}function oq(e,t){return`${e}`.padStart(t,"0")}nq(),iq();let sq=class{constructor(e){s(this,"_id"),s(this,"_component"),s(this,"_container"),s(this,"_isDestroyed",!1),s(this,"_errorMessage"),s(this,"_internalApi"),s(this,"_marks",[]),this._id=e.id||`mosaic-component-${SN()}`,this._internalApi=e.internalApi}get id(){return this._id}get errorMessage(){return this._errorMessage}async mount(e,t){if(this._isDestroyed)return this._errorMessage=`Cannot mount component: component ${this._id} has been destroyed`,void dN(this._id,0,"warn");this._component&&(dN(this._id,0,"warn"),await this._unmount()),this._errorMessage=void 0;try{const n=await this._resolveElement(e);if(!n)return this._errorMessage="Component did not resolve to an HTMLElement",void dN((this._id,this._errorMessage),0,"warn");const i=null==n?void 0:n.value;if(i&&!(await this._validatePlot(i)))return this._abortMount(t,this._errorMessage||"Chart references columns not available in dataset");i&&(this._attachErrorInterceptors(i,t),this._connectPlot(i),this._marks=i.marks?[...i.marks]:[]),this._component=e,this._container=t,t.innerHTML="",t.appendChild(n)}catch(n){this._abortMount(t,n instanceof Error?n.message:String(n))}}_abortMount(e,t){this._errorMessage=t,this._marks=[],this._showError(e),dN(this._id,0,"warn")}async _resolveElement(e){if(e instanceof HTMLElement)return e}async _validatePlot(e){var t,n;if(!this._internalApi.dbCoordinator||!(null==(t=null==e?void 0:e.marks)?void 0:t.length))return!0;for(const i of e.marks){const e=i.sourceTable(),t=null==(n=i.channels)?void 0:n.map(e=>{var t;return null==(t=null==e?void 0:e.field)?void 0:t.column}).filter(e=>"string"==typeof e);if(!e||!(null==t?void 0:t.length))continue;const r=[];if(!(await Tj(this._internalApi.dbCoordinator,e,t,r)))return this._errorMessage=`Missing columns for table "${e}"${r.length?`: ${[...new Set(r)].join(", ")}`:""}`,!1}return!0}_attachErrorInterceptors(e,t){var n,i;if(null==(n=null==e?void 0:e.marks)?void 0:n.length)for(const r of e.marks){if(!r)continue;const n=null==(i=r.queryError)?void 0:i.bind(r);r.queryError=i=>this._handleQueryError(i,e,t)?r:(null==n?void 0:n(i))??r}}_connectPlot(e){var t,n;if((null==(t=null==e?void 0:e.marks)?void 0:t.length)&&this._internalApi.dbCoordinator)for(const r of e.marks)if(r&&r.coordinator!==this._internalApi.dbCoordinator)try{null==(n=r.coordinator)||n.disconnect(r),this._internalApi.dbCoordinator.connect(r),r.queryPending()}catch(i){dN(this._id,0,"warn")}}_handleQueryError(e,t,n){var i;const r=e instanceof Error?e.message:String(e);return!!/no such column|cannot find column/i.test(r)&&(this._errorMessage="Mosaic query failed because required columns are missing.",this._cleanupSelections(),null==(i=null==t?void 0:t.marks)||i.forEach(e=>{var t,n;e&&(e.enabled=!1,null==(n=null==(t=e.coordinator)?void 0:t.disconnect)||n.call(t,e))}),this._component=void 0,this._marks=[],this._showError(n),dN(this._id,0,"warn"),!0)}_cleanupSelections(){if(!this._marks.length)return;const e=new Set(this._marks.flatMap(e=>{var t;return(null==(t=null==e?void 0:e.plot)?void 0:t.interactors)||[]}).filter(e=>(null==e?void 0:e.mark)&&this._marks.includes(e.mark)));e.size&&[this._internalApi.crossfilter.pointsSelection,this._internalApi.crossfilter.linksSelection].filter(Boolean).forEach(t=>{t.clauses.filter(t=>e.has(null==t?void 0:t.source)).forEach(e=>{t.update({source:e.source,predicate:null,value:null})})})}async _unmount(){this._container&&(this._cleanupSelections(),this._container.innerHTML="",this._component=void 0,this._container=void 0,this._errorMessage=void 0,this._marks=[],dN(this._id,0,"ok"))}async destroy(){this._isDestroyed||(await this._unmount(),this._isDestroyed=!0,dN(this._id,0,"ok"))}_showError(e){e&&(e.innerHTML=`\n      <div style="padding: 15px; background: #fff3cd; border: 1px solid #ffc107; border-radius: 4px; color: #856404; font-size: 13px;">\n        <strong>Chart Error: ${this._id}</strong>\n        <p style="margin: 5px 0 0 0;">This chart cannot be displayed. Check configuration, it may reference columns that don't exist in your data.</p>\n      </div>\n    `)}};"function"==typeof RC&&RC({connect:()=>{},disconnect:()=>{}});let aq=class{constructor(e){s(this,"_internalApi"),s(this,"_components",new Map),this._internalApi=e}get components(){return this._components}async addComponent(e,t,n){const i=new sq({...n,internalApi:this._internalApi});if(this._components.has(i.id)){const e=this._components.get(i.id);dN(i.id,0,"warn"),await e.destroy()}return await i.mount(e,t),this._components.set(i.id,i),i.errorMessage?dN((i.id,i.errorMessage),0,"warn"):dN(i.id,0,"ok"),i}async removeComponent(e){const t=this._components.get(e);return!!t&&(await t.destroy(),this._components.delete(e),!0)}async destroyAll(){const e=Array.from(this._components.values()).map(e=>e.destroy());await Promise.all(e),this._components.clear()}};var lq="style_module_messageError__8ee622df",cq="style_module_spinner__8ee622df";kY(".style_module_cosmograph__8ee622df{--cosmograph-text-color:#fff;-webkit-font-smoothing:antialiased!important;display:flex;height:100%;overflow:hidden;position:relative;text-rendering:optimizeLegibility!important;width:100%}.style_module_popupContainer__8ee622df{height:100%;pointer-events:none;position:absolute;width:100%;z-index:1}.style_module_attribution__8ee622df{bottom:0;color:var(--cosmograph-text-color);cursor:pointer;line-height:0;margin:0 .6rem .6rem 0;opacity:.7;position:absolute;right:0;user-select:none;-webkit-user-select:none;z-index:1}.style_module_message__8ee622df{color:var(--cosmograph-text-color);font-size:14px;font-weight:300;left:50%;max-width:300px;opacity:.6;position:absolute;text-align:center;top:50%;transform:translate(-50%,-50%);z-index:1000}.style_module_messageError__8ee622df{max-width:min(800px,90vw);text-align:left}.style_module_messagePre__8ee622df{white-space:pre-wrap}.style_module_message__8ee622df>br{display:none}@keyframes style_module_spin__8ee622df{to{transform:rotate(1turn)}}@keyframes style_module_fadeIn__8ee622df{0%{opacity:0}to{opacity:1}}.style_module_spinner__8ee622df{animation:style_module_fadeIn__8ee622df .3s ease forwards,style_module_spin__8ee622df 1s linear infinite;border:4px solid hsla(0,0%,100%,.3);border-radius:50%;border-top:4px solid var(--cosmograph-text-color);display:block;height:30px;margin:0 auto;opacity:0;width:30px}",{});class uq{constructor(e,t,n){s(this,"_internalApi"),s(this,"_eventTarget",new EventTarget),s(this,"_dbReadinessPromise",null),s(this,"_labels"),s(this,"_cosmos"),s(this,"_cosmosInitialized",!1),s(this,"_dbCoordinator"),s(this,"_dataValidator"),s(this,"_configManager"),s(this,"_dataManager"),s(this,"_eventManager"),s(this,"_crossfilter"),s(this,"_linkAggregationManager"),s(this,"_rectangularSelection"),s(this,"_polygonalSelection"),s(this,"_pointSelectionClient"),s(this,"_mosaicComponentManager"),s(this,"_containerElement"),s(this,"_popupElement"),s(this,"_attributionDivElement"),s(this,"_cosmosElement"),s(this,"_messageDivElement"),s(this,"_focusedPointIndex"),s(this,"_enableSimulation",!0),s(this,"_pointsHaveLayout",!1),s(this,"_isDestroyed",!1),s(this,"_summary",{}),s(this,"_stats",{pointsCount:0,linksCount:0,pointsSummary:void 0,linksSummary:void 0}),s(this,"_initializeLabels",()=>{this._labels&&this._labels.destroy();const e=this._cosmosElement.querySelector("canvas");e&&(this._labels=new AY(this._internalApi,e))}),s(this,"_initializeClients",async()=>{this._pointSelectionClient=new OY(this._internalApi),this._mosaicComponentManager=new aq(this._internalApi)}),s(this,"_dropLocalTables",async e=>{var t,n;this._dbCoordinator&&(e||await(null==(t=this._dbCoordinator.internalDB)?void 0:t.dropTable(eF.Points)),await(null==(n=this._dbCoordinator.internalDB)?void 0:n.dropTable(eF.Links)))}),window.cosmographDisableLogging=t.disableLogging??!1,this._containerElement=e,this._internalApi=this._initializeInternalApi(this),function(e,t){PY.set(e,t)}(this,this._internalApi),dN(),this._initializeDB(n),this._dataValidator=new aY(this._internalApi),this._eventManager=new lY(this._internalApi),this._linkAggregationManager=new dY(this._internalApi),this._configManager=new iY(this._internalApi),this._dataManager=new oY(this._internalApi),this._crossfilter=new rY(this._internalApi),this._rectangularSelection=new LY(this._internalApi),this._polygonalSelection=new RY(this._internalApi),void 0!==t.statusIndicatorMode&&(this._configManager.config.statusIndicatorMode=t.statusIndicatorMode),this._initializeHTMLElements(),this.setConfig(t)}_initializeInternalApi(e){return{get public(){return e},get labels(){return e._labels},get cosmos(){return e._cosmos},get summary(){return e._summary},get eventManager(){return e._eventManager},get configManager(){return e._configManager},get dataManager(){return e._dataManager},get dataValidator(){return e._dataValidator},get linkAggregationManager(){return e._linkAggregationManager},get rectangularSelection(){return e._rectangularSelection},get polygonalSelection(){return e._polygonalSelection},get crossfilter(){return e._crossfilter},get selectionClient(){return e._pointSelectionClient},get dbCoordinator(){return e._dbCoordinator},get containerElement(){return e._containerElement},get cosmosElement(){return e._cosmosElement},get popupElement(){return e._popupElement},get config(){return e._configManager.config},get cosmosInitialized(){return e._cosmosInitialized},get pointsHaveLayout(){return e._pointsHaveLayout},dropLocalTables:async t=>await e._dropLocalTables(t),updateMessage:t=>e._updateMessage(t),initializeLabels:()=>e._initializeLabels(),initializeCosmos:()=>e._initializeCosmos(),updateStats:()=>e._updateStats(),updateSummary:async()=>e._updateSummary(),dbReady:async()=>e._dbReady(),addEventListener:(t,n)=>{e._eventTarget.addEventListener(t,n,{passive:!0})},removeEventListener:(t,n)=>{e._eventTarget.removeEventListener(t,n,{passive:!0})},dispatchEvent:t=>e._eventTarget.dispatchEvent(t)}}_initializeDB(e){this._dbReadinessPromise=hF.create(e).then(async t=>{if(this._ensureAlive())if(this._dbCoordinator=t,t)this._updateMessage(" Cosmograph is ready, load your data!",!0),await this._initializeClients();else{const t=e?" Couldn't create coordinator for specified DuckDB connection. Please check your external DuckDB instance configuration and try to initialize Cosmograph again.":" Failed to fetch DuckDB-Wasm bundles. Please try to initialize Cosmograph again.";this._updateMessage(t)}else this.destroy()}).catch(e=>{throw this._isDestroyed||dN(0,0,"error"),e})}_initializeHTMLElements(){var e,t;this._containerElement.classList.add("style_module_cosmograph__8ee622df"),null==(e=this._containerElement)||e.style.setProperty("--cosmograph-text-color","#ffffff"),this._popupElement=document.createElement("div"),this._popupElement.classList.add("style_module_popupContainer__8ee622df"),this._cosmosElement=document.createElement("div"),this._cosmosElement.style.width="100%",this._cosmosElement.style.height="100%",null==(t=this._cosmosElement)||t.style.setProperty("backgroundColor",gj),this._containerElement.appendChild(this._cosmosElement),this._containerElement.appendChild(this._popupElement),this._addAttribution(),this._addMessageElement()}_addAttribution(){var e;this._attributionDivElement=document.createElement("div"),this._attributionDivElement.classList.add("style_module_attribution__8ee622df"),this._attributionDivElement.onclick=()=>{var e;return null==(e=window.open("https://cosmograph.app/","_blank"))?void 0:e.focus()};const t=(new DOMParser).parseFromString('<svg fill="currentColor" height="11" viewBox="0 0 163 11" width="163" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor"><path d="m2.45674 8-1.925002-5.379h.924002l1.617 4.73h.154l1.617-4.73h.924l-1.925 5.379z"/><path d="m7.02243 8v-5.379h.869v5.379zm.44-6.215c-.19067 0-.352-.06233-.484-.187-.12467-.12467-.187-.28233-.187-.473 0-.198.06233-.359333.187-.484.132-.124667.29333-.187.484-.187.19066 0 .34833.062333.473.187.12466.124667.187.286.187.484 0 .19067-.06234.34833-.187.473-.12467.12467-.28234.187-.473.187z"/><path d="m11.8857 8.154c-.6673 0-1.232-.154-1.694-.462-.45465-.308-.72965-.79567-.82499-1.463l.82499-.187c.0587.352.1687.63067.33.836.1613.198.3593.341.594.429.242.08067.4987.121.77.121.4033 0 .7223-.08067.957-.242s.352-.37767.352-.649c0-.27867-.1137-.473-.341-.583-.22-.11733-.5243-.21267-.913-.286l-.451-.077c-.3447-.05867-.66-.15033-.946-.275s-.5133-.29333-.68199-.506c-.16866-.21267-.25299-.48033-.25299-.803 0-.484.18699-.86167.56098-1.133.374-.27133.869-.407 1.485-.407.6087 0 1.1.13933 1.474.418.3813.27133.627.65633.737 1.155l-.814.209c-.066-.38867-.2237-.66-.473-.814-.2493-.16133-.5573-.242-.924-.242s-.6563.06967-.869.209c-.2127.132-.319.33-.319.594 0 .25667.099.44733.297.572.2053.11733.4767.20533.814.264l.451.077c.3813.066.7223.15767 1.023.275.308.11.55.27133.726.484.1833.21267.275.49133.275.836 0 .528-.198.935-.594 1.221-.3887.286-.913.429-1.573.429z"/><path d="m17.5765 8.099c-.3887 0-.748-.08433-1.078-.253-.3227-.16867-.5793-.418-.77-.748-.1833-.33733-.275-.74433-.275-1.221v-3.256h.869v3.19c0 .53533.132.924.396 1.166.2713.242.6343.363 1.089.363.5133 0 .935-.16867 1.265-.506s.495-.83967.495-1.507v-2.706h.869v5.379h-.847v-.913h-.154c-.1173.25667-.319.49133-.605.704-.286.20533-.704.308-1.254.308z"/><path d="m23.9048 8.154c-.374 0-.715-.066-1.023-.198s-.55-.32267-.726-.572-.264-.55367-.264-.913c0-.36667.088-.66733.264-.902.176-.242.418-.42167.726-.539.308-.12467.6527-.187 1.034-.187h1.815v-.396c0-.38133-.1136-.682-.341-.902-.22-.22-.55-.33-.99-.33-.4326 0-.77.10633-1.012.319-.242.20533-.407.484-.495.836l-.814-.264c.088-.30067.2274-.572.418-.814.1907-.24933.4437-.44733.759-.594.3227-.154.7077-.231 1.155-.231.6894 0 1.2247.17967 1.606.539.3814.352.572.85067.572 1.496v2.431c0 .22.1027.33.308.33h.495v.737h-.759c-.242 0-.4363-.066-.583-.198-.1466-.13933-.22-.32267-.22-.55v-.055h-.132c-.0806.13933-.1906.286-.33.44-.132.14667-.3153.26767-.55.363-.2346.10267-.539.154-.913.154zm.099-.748c.5134 0 .9277-.15033 1.243-.451.3227-.308.484-.737.484-1.287v-.121h-1.782c-.3446 0-.6306.077-.858.231-.22.14667-.33.37033-.33.671s.1137.53533.341.704c.2347.16867.5354.253.902.253z"/><path d="m28.582 8v-7.7h.869v7.7z"/><path d="m31.2783 8v-5.379h.869v5.379zm.44-6.215c-.1907 0-.352-.06233-.484-.187-.1247-.12467-.187-.28233-.187-.473 0-.198.0623-.359333.187-.484.132-.124667.2933-.187.484-.187s.3483.062333.473.187.187.286.187.484c0 .19067-.0623.34833-.187.473s-.2823.187-.473.187z"/><path d="m33.7326 8v-1.122l3.421-3.377v-.121h-3.311v-.759h4.224v1.122l-3.432 3.377v.132h3.52v.748z"/><path d="m41.9601 8.154c-.5427 0-1.0194-.11367-1.43-.341-.4107-.23467-.7297-.561-.957-.979-.2274-.418-.341-.902-.341-1.452v-.132c0-.55733.1136-1.045.341-1.463.2273-.418.5426-.74067.946-.968.4033-.23467.8653-.352 1.386-.352.506 0 .9533.11 1.342.33.3886.21267.693.52067.913.924s.33.87633.33 1.419v.396h-4.389c.022.57933.209 1.034.561 1.364.352.32267.792.484 1.32.484.462 0 .8176-.10633 1.067-.319.2493-.21267.44-.46567.572-.759l.748.363c-.11.22733-.264.45467-.462.682-.1907.22733-.4437.418-.759.572-.308.154-.704.231-1.188.231zm-1.848-3.333h3.498c-.0294-.49867-.2017-.88733-.517-1.166-.308-.27867-.704-.418-1.188-.418-.4914 0-.8947.13933-1.21.418-.3154.27867-.5097.66733-.583 1.166z"/><path d="m48.2828 8.154c-.462 0-.8873-.11-1.276-.33-.3886-.22-.6966-.539-.924-.957-.2273-.418-.341-.913-.341-1.485v-.143c0-.572.1137-1.06333.341-1.474.2274-.418.5317-.737.913-.957.3887-.22733.8177-.341 1.287-.341.374 0 .6894.05133.946.154.264.09533.4767.22.638.374.1614.14667.286.30433.374.473h.154v-3.168h.869v7.7h-.847v-.891h-.154c-.1466.27133-.374.51333-.682.726s-.7406.319-1.298.319zm.231-.77c.5574 0 1.0084-.176 1.353-.528.352-.35933.528-.858.528-1.496v-.099c0-.638-.176-1.133-.528-1.485-.3446-.35933-.7956-.539-1.353-.539-.55 0-1.0046.17967-1.364.539-.352.352-.528.847-.528 1.485v.099c0 .638.176 1.13667.528 1.496.3594.352.814.528 1.364.528z"/><path d="m58.8911 8.154c-.5573 0-.9936-.10633-1.309-.319-.308-.21267-.5316-.45467-.671-.726h-.154v.891h-.847v-7.7h.869v3.168h.154c.088-.16867.2127-.32633.374-.473.1614-.154.3704-.27867.627-.374.264-.10267.583-.154.957-.154.4694 0 .8947.11367 1.276.341.3887.22.6967.539.924.957.2274.41067.341.902.341 1.474v.143c0 .572-.1173 1.067-.352 1.485-.2273.418-.5353.737-.924.957-.3813.22-.803.33-1.265.33zm-.231-.77c.5574 0 1.0084-.176 1.353-.528.352-.35933.528-.858.528-1.496v-.099c0-.638-.176-1.133-.528-1.485-.3446-.35933-.7956-.539-1.353-.539-.55 0-1.0046.17967-1.364.539-.352.352-.528.847-.528 1.485v.099c0 .638.176 1.13667.528 1.496.3594.352.814.528 1.364.528z"/><path d="m63.6382 10.2v-.77h3.08c.2127 0 .319-.11.319-.33v-1.958h-.154c-.0733.154-.187.308-.341.462-.1466.14667-.341.26767-.583.363-.242.088-.5463.132-.913.132-.3886 0-.748-.08433-1.078-.253-.3226-.16867-.5793-.418-.77-.748-.1833-.33-.275-.73333-.275-1.21v-3.267h.869v3.201c0 .528.132.913.396 1.155.2714.242.6344.363 1.089.363.5134 0 .935-.16867 1.265-.506s.495-.83967.495-1.507v-2.706h.869v6.633c0 .29333-.0843.52433-.253.693-.1613.1687-.3996.253-.715.253z"/><path d="m75.2998 8.154c-.9167 0-1.6464-.264-2.189-.792-.5427-.53533-.814-1.31267-.814-2.332v-1.76c0-1.01933.2713-1.793.814-2.321.5426-.535333 1.2723-.803 2.189-.803.9093 0 1.606.253 2.09.759.4913.506.737 1.199.737 2.079v.055h-.913v-.088c0-.57933-.1577-1.05233-.473-1.419-.308-.374-.7884-.561-1.441-.561-.6527 0-1.1624.20167-1.529.605-.3667.396-.55.95333-.55 1.672v1.804c0 .71867.1833 1.27967.55 1.683.3666.396.8763.594 1.529.594.6526 0 1.133-.18333 1.441-.55.3153-.374.473-.85067.473-1.43v-.176h.913v.143c0 .88-.2457 1.573-.737 2.079-.484.506-1.1807.759-2.09.759z"/><path d="m82.0934 8.154c-.5427 0-1.023-.11367-1.441-.341-.4107-.22733-.7333-.54633-.968-.957-.2273-.418-.341-.90933-.341-1.474v-.143c0-.55733.1137-1.045.341-1.463.2347-.418.5573-.74067.968-.968.418-.22733.8983-.341 1.441-.341s1.0193.11367 1.43.341c.418.22733.7407.55.968.968.2347.418.352.90567.352 1.463v.143c0 .56467-.1173 1.056-.352 1.474-.2273.41067-.55.72967-.968.957-.4107.22733-.8873.341-1.43.341zm0-.781c.572 0 1.0267-.17967 1.364-.539.3447-.36667.517-.858.517-1.474v-.099c0-.616-.1723-1.10367-.517-1.463-.3373-.36667-.792-.55-1.364-.55-.5647 0-1.0193.18333-1.364.55-.3447.35933-.517.847-.517 1.463v.099c0 .616.1723 1.10733.517 1.474.3447.35933.7993.539 1.364.539z"/><path d="m88.5742 8.154c-.6673 0-1.232-.154-1.694-.462-.4547-.308-.7297-.79567-.825-1.463l.825-.187c.0587.352.1687.63067.33.836.1613.198.3593.341.594.429.242.08067.4987.121.77.121.4033 0 .7223-.08067.957-.242s.352-.37767.352-.649c0-.27867-.1137-.473-.341-.583-.22-.11733-.5243-.21267-.913-.286l-.451-.077c-.3447-.05867-.66-.15033-.946-.275s-.5133-.29333-.682-.506-.253-.48033-.253-.803c0-.484.187-.86167.561-1.133s.869-.407 1.485-.407c.6087 0 1.1.13933 1.474.418.3813.27133.627.65633.737 1.155l-.814.209c-.066-.38867-.2237-.66-.473-.814-.2493-.16133-.5573-.242-.924-.242s-.6563.06967-.869.209c-.2127.132-.319.33-.319.594 0 .25667.099.44733.297.572.2053.11733.4767.20533.814.264l.451.077c.3813.066.7223.15767 1.023.275.308.11.55.27133.726.484.1833.21267.275.49133.275.836 0 .528-.198.935-.594 1.221-.3887.286-.913.429-1.573.429z"/><path d="m92.208 8v-5.379h.847v.671h.154c.1026-.19067.2713-.36667.506-.528.2346-.16133.5646-.242.99-.242.418 0 .7553.09167 1.012.275.264.18333.4546.407.572.671h.154c.1246-.264.3116-.48767.561-.671.2566-.18333.6123-.275 1.067-.275.3593 0 .6746.07333.946.22.2713.14667.484.35933.638.638.1613.27133.242.59767.242.979v3.641h-.869v-3.564c0-.35933-.1064-.64167-.319-.847-.2054-.21267-.495-.319-.869-.319-.396 0-.7224.12833-.979.385-.2494.25667-.374.627-.374 1.111v3.234h-.869v-3.564c0-.35933-.1064-.64167-.319-.847-.2054-.21267-.495-.319-.869-.319-.396 0-.7224.12833-.979.385-.2494.25667-.374.627-.374 1.111v3.234z"/><path d="m104.158 8.154c-.543 0-1.023-.11367-1.441-.341-.411-.22733-.733-.54633-.968-.957-.227-.418-.341-.90933-.341-1.474v-.143c0-.55733.114-1.045.341-1.463.235-.418.557-.74067.968-.968.418-.22733.898-.341 1.441-.341s1.019.11367 1.43.341c.418.22733.741.55.968.968.235.418.352.90567.352 1.463v.143c0 .56467-.117 1.056-.352 1.474-.227.41067-.55.72967-.968.957-.411.22733-.887.341-1.43.341zm0-.781c.572 0 1.027-.17967 1.364-.539.345-.36667.517-.858.517-1.474v-.099c0-.616-.172-1.10367-.517-1.463-.337-.36667-.792-.55-1.364-.55-.565 0-1.019.18333-1.364.55-.345.35933-.517.847-.517 1.463v.099c0 .616.172 1.10733.517 1.474.345.35933.799.539 1.364.539z"/><path d="m108.208 5.338v-.154c0-.56467.113-1.04867.341-1.452.227-.40333.535-.715.924-.935.388-.22.814-.33 1.276-.33.564 0 .997.11 1.298.33.308.21267.535.451.682.715h.154v-.891h.825v6.633c0 .29333-.081.52433-.242.693-.162.1687-.396.253-.704.253h-3.652v-.77h3.421c.22 0 .33-.11.33-.33v-2.046h-.154c-.088.16133-.213.319-.374.473-.162.154-.371.28233-.627.385-.257.09533-.576.143-.957.143-.462 0-.888-.11-1.276-.33-.389-.22-.697-.53167-.924-.935-.228-.41067-.341-.89467-.341-1.452zm2.772 1.947c.557 0 1.008-.176 1.353-.528.352-.352.528-.836.528-1.452v-.088c0-.62333-.176-1.10733-.528-1.452-.345-.352-.796-.528-1.353-.528-.55 0-1.005.176-1.364.528-.352.34467-.528.82867-.528 1.452v.088c0 .616.176 1.1.528 1.452.359.352.814.528 1.364.528z"/><path d="m115.529 8v-5.379h.847v.66h.154c.096-.23467.242-.407.44-.517s.459-.165.781-.165h.638v.792h-.693c-.388 0-.704.11-.946.33-.234.21267-.352.54633-.352 1.001v3.278z"/><path d="m121.143 8.154c-.374 0-.715-.066-1.023-.198s-.55-.32267-.726-.572-.264-.55367-.264-.913c0-.36667.088-.66733.264-.902.176-.242.418-.42167.726-.539.308-.12467.653-.187 1.034-.187h1.815v-.396c0-.38133-.114-.682-.341-.902-.22-.22-.55-.33-.99-.33-.433 0-.77.10633-1.012.319-.242.20533-.407.484-.495.836l-.814-.264c.088-.30067.227-.572.418-.814.191-.24933.444-.44733.759-.594.323-.154.708-.231 1.155-.231.689 0 1.225.17967 1.606.539.381.352.572.85067.572 1.496v2.431c0 .22.103.33.308.33h.495v.737h-.759c-.242 0-.436-.066-.583-.198-.147-.13933-.22-.32267-.22-.55v-.055h-.132c-.081.13933-.191.286-.33.44-.132.14667-.315.26767-.55.363-.235.10267-.539.154-.913.154zm.099-.748c.513 0 .928-.15033 1.243-.451.323-.308.484-.737.484-1.287v-.121h-1.782c-.345 0-.631.077-.858.231-.22.14667-.33.37033-.33.671s.114.53533.341.704c.235.16867.535.253.902.253z"/><path d="m125.82 10.2v-7.579h.847v.891h.154c.14-.27133.363-.51333.671-.726.316-.21267.752-.319 1.309-.319.462 0 .884.11367 1.265.341.389.22.697.53533.924.946.235.41067.352.90567.352 1.485v.143c0 .572-.113 1.067-.341 1.485-.227.418-.535.737-.924.957-.381.22-.806.33-1.276.33-.374 0-.693-.05133-.957-.154-.256-.09533-.465-.22-.627-.374-.161-.154-.286-.31167-.374-.473h-.154v3.047zm2.75-2.816c.558 0 1.009-.176 1.353-.528.352-.35933.528-.858.528-1.496v-.099c0-.638-.176-1.133-.528-1.485-.344-.35933-.795-.539-1.353-.539-.55 0-1.004.17967-1.364.539-.352.352-.528.847-.528 1.485v.099c0 .638.176 1.13667.528 1.496.36.352.814.528 1.364.528z"/><path d="m132.899 8v-7.7h.869v3.179h.154c.074-.16133.184-.31167.33-.451.154-.14667.349-.26767.583-.363.242-.09533.547-.143.913-.143.404 0 .763.088 1.078.264.323.16867.58.418.77.748.191.32267.286.726.286 1.21v3.256h-.869v-3.19c0-.53533-.135-.924-.407-1.166-.264-.242-.623-.363-1.078-.363-.52 0-.946.16867-1.276.506-.322.33733-.484.83967-.484 1.507v2.706z"/><path d="m140.118 8.154c-.212 0-.392-.06967-.539-.209-.139-.13933-.209-.319-.209-.539s.07-.39967.209-.539c.147-.13933.327-.209.539-.209.22 0 .4.06967.539.209.14.13933.209.319.209.539s-.069.39967-.209.539c-.139.13933-.319.209-.539.209z"/><path d="m144.078 8.154c-.374 0-.715-.066-1.023-.198s-.55-.32267-.726-.572-.264-.55367-.264-.913c0-.36667.088-.66733.264-.902.176-.242.418-.42167.726-.539.308-.12467.652-.187 1.034-.187h1.815v-.396c0-.38133-.114-.682-.341-.902-.22-.22-.55-.33-.99-.33-.433 0-.77.10633-1.012.319-.242.20533-.407.484-.495.836l-.814-.264c.088-.30067.227-.572.418-.814.19-.24933.443-.44733.759-.594.322-.154.707-.231 1.155-.231.689 0 1.224.17967 1.606.539.381.352.572.85067.572 1.496v2.431c0 .22.102.33.308.33h.495v.737h-.759c-.242 0-.437-.066-.583-.198-.147-.13933-.22-.32267-.22-.55v-.055h-.132c-.081.13933-.191.286-.33.44-.132.14667-.316.26767-.55.363-.235.10267-.539.154-.913.154zm.099-.748c.513 0 .927-.15033 1.243-.451.322-.308.484-.737.484-1.287v-.121h-1.782c-.345 0-.631.077-.858.231-.22.14667-.33.37033-.33.671s.113.53533.341.704c.234.16867.535.253.902.253z"/><path d="m148.755 10.2v-7.579h.847v.891h.154c.139-.27133.363-.51333.671-.726.315-.21267.752-.319 1.309-.319.462 0 .884.11367 1.265.341.389.22.697.53533.924.946.235.41067.352.90567.352 1.485v.143c0 .572-.114 1.067-.341 1.485s-.535.737-.924.957c-.381.22-.807.33-1.276.33-.374 0-.693-.05133-.957-.154-.257-.09533-.466-.22-.627-.374s-.286-.31167-.374-.473h-.154v3.047zm2.75-2.816c.557 0 1.008-.176 1.353-.528.352-.35933.528-.858.528-1.496v-.099c0-.638-.176-1.133-.528-1.485-.345-.35933-.796-.539-1.353-.539-.55 0-1.005.17967-1.364.539-.352.352-.528.847-.528 1.485v.099c0 .638.176 1.13667.528 1.496.359.352.814.528 1.364.528z"/><path d="m155.834 10.2v-7.579h.847v.891h.154c.139-.27133.363-.51333.671-.726.315-.21267.752-.319 1.309-.319.462 0 .884.11367 1.265.341.389.22.697.53533.924.946.235.41067.352.90567.352 1.485v.143c0 .572-.114 1.067-.341 1.485s-.535.737-.924.957c-.381.22-.807.33-1.276.33-.374 0-.693-.05133-.957-.154-.257-.09533-.466-.22-.627-.374s-.286-.31167-.374-.473h-.154v3.047zm2.75-2.816c.557 0 1.008-.176 1.353-.528.352-.35933.528-.858.528-1.496v-.099c0-.638-.176-1.133-.528-1.485-.345-.35933-.796-.539-1.353-.539-.55 0-1.005.17967-1.364.539-.352.352-.528.847-.528 1.485v.099c0 .638.176 1.13667.528 1.496.359.352.814.528 1.364.528z"/><path d="m71.6368 9.375h90.3682v.55h-90.3682z"/></g></svg>',"image/svg+xml").firstChild;null==(e=this._attributionDivElement)||e.appendChild(t),this._containerElement.appendChild(this._attributionDivElement)}_addMessageElement(){this._messageDivElement=document.createElement("div"),this._messageDivElement.classList.add("style_module_message__8ee622df"),this._containerElement.appendChild(this._messageDivElement),this._updateMessage(" Initializing Cosmograph...")}async _initializeCosmos(){const{_config:e}=this;this._cosmos&&(this._cosmos.destroy(),this._cosmosInitialized=!1),this._pointsHaveLayout=await(async(e,t,n)=>{if(!(null==n?void 0:n.pointXBy)||!(null==n?void 0:n.pointYBy))return!1;const i=await Cj(e,t);return i.includes(n.pointXBy)&&i.includes(n.pointYBy)})(this._dbCoordinator,this.pointsTableName,e),this._enableSimulation=e.enableSimulation??(!!e.links||!this._pointsHaveLayout),this._configManager.cosmosConfig.enableSimulation=this._enableSimulation,this._cosmos=new Yv(this._cosmosElement,this._configManager.cosmosConfig),this._cosmosInitialized=!0}_ensureAlive(){return!this._isDestroyed&&!!this._containerElement.isConnected}_updateMessage(e,t){if(!this._messageDivElement)return;const n=this._configManager.config.statusIndicatorMode??"spinner";if(!1===n||"spinner"===n&&t||null===e)this._messageDivElement.style.display="none";else if(this._messageDivElement.style.display="block","spinner"===n){const t=e.startsWith("");if(this._messageDivElement.classList.toggle(lq,t),t){if(this._messageDivElement.innerText!==e||this._messageDivElement.querySelector(`.${cq}`)){this._messageDivElement.innerHTML="";const t=document.createElement("div");t.classList.add("style_module_messagePre__8ee622df"),t.innerText=e,this._messageDivElement.appendChild(t)}}else if(!this._messageDivElement.querySelector(`.${cq}`)){this._messageDivElement.innerHTML="";const e=document.createElement("div");e.classList.add(cq),this._messageDivElement.appendChild(e)}}else this._messageDivElement.classList.remove(lq),(this._messageDivElement.textContent!==e||this._messageDivElement.querySelector(`.${cq}`))&&(this._messageDivElement.innerHTML="",this._messageDivElement.innerText=e)}async _updateSummary(){this._dbCoordinator&&(this._summary={pointsSummary:await Ej(this._dbCoordinator,this.pointsTableName),linksSummary:this._config.links?await Ej(this._dbCoordinator,this.linksTableName):void 0})}_updateStats(){var e,t;const{pointsSummary:n,linksSummary:i}=this._summary;this._stats={pointsCount:(null==(e=this._cosmos)?void 0:e.graph.pointsNumber)??0,linksCount:(null==(t=this._cosmos)?void 0:t.graph.linksNumber)??0,pointsSummary:n,linksSummary:i}}async _dbReady(){return this._dbReadinessPromise?await this._dbReadinessPromise:new Promise((e,t)=>{const n=setTimeout(()=>{t(new Error("Cosmograph: Database initialization timeout"))},3e4),i=()=>{this._dbReadinessPromise?(clearTimeout(n),this._dbReadinessPromise.then(e).catch(t)):setTimeout(i,10)};i()})}async dataUploaded(){return await this._dataManager.dataReady()}get _config(){return this._configManager.config}get stats(){return this._stats}get crossfilter(){return this._crossfilter.filtered}get maxPointSize(){var e;return(null==(e=this._cosmos)?void 0:e.maxPointSize)??0}get progress(){var e;return null==(e=this._cosmos)?void 0:e.progress}get isSimulationRunning(){var e;return null==(e=this._cosmos)?void 0:e.isSimulationRunning}get isSimulationAvailable(){return this._enableSimulation}get pointDegrees(){var e;return null==(e=this._cosmos)?void 0:e.graph.degree}get pointDirections(){var e,t;return null==(t=null==(e=this._cosmos)?void 0:e.graph.inDegree)?void 0:t.map((e,t)=>{var n,i;const r=null==(i=null==(n=this._cosmos)?void 0:n.graph.outDegree)?void 0:i[t],o=null!==e&&0!==e,s=null!==r&&0!==r;return o&&s?1:s?0:o?2:3})}get rescaleXFn(){var e;return null==(e=this._cosmos)?void 0:e.getScaleX()}get rescaleYFn(){var e;return null==(e=this._cosmos)?void 0:e.getScaleY()}get focusedPointIndex(){return this._config.focusedPointIndex??this._focusedPointIndex}get clusterMapping(){return this._configManager.clusterMapping}get activePointColorStrategy(){return this._configManager.activePointColorStrategy}get activePointSizeStrategy(){return this._configManager.activePointSizeStrategy}get activeLinkColorStrategy(){return this._configManager.activeLinkColorStrategy}get activeLinkWidthStrategy(){return this._configManager.activeLinkWidthStrategy}get linksTableName(){var e;return(null==(e=this._dbCoordinator)?void 0:e.internalDB)||"string"!=typeof this._config.links?eF.Links:this._config.links}get pointsTableName(){var e;return(null==(e=this._dbCoordinator)?void 0:e.internalDB)||"string"!=typeof this._config.points?eF.Points:this._config.points}async getConfig(){return await this._configManager.configUpdated(),this._configManager.config}async getActivePointColorFn(){return await this._configManager.configUpdated(),this._configManager.activePointColorFn}async getActivePointSizeFn(){return await this._configManager.configUpdated(),this._configManager.activePointSizeFn}async getActiveLinkColorFn(){return await this._configManager.configUpdated(),this._configManager.activeLinkColorFn}async getActiveLinkWidthFn(){return await this._configManager.configUpdated(),this._configManager.activeLinkWidthFn}setConfig(e){return this._configManager.setConfig(e),this._configManager.configUpdated()}captureScreenshot(e="cosmograph-screenshot.png"){var t;const n=null==(t=this._cosmosElement)?void 0:t.querySelector("canvas");if(!n)return;const i=document.createElement("a");i.download=e,i.href=n.toDataURL("image/png"),i.click()}getPointPositions(){var e;return null==(e=this._cosmos)?void 0:e.getPointPositions()}getClusterPositions(){var e;return null==(e=this._cosmos)?void 0:e.getClusterPositions()}getPointColors(){var e,t;return null==(t=null==(e=this._cosmos)?void 0:e.getPointColors)?void 0:t.call(e)}getPointSizes(){var e,t;return null==(t=null==(e=this._cosmos)?void 0:e.getPointSizes)?void 0:t.call(e)}getLinkColors(){var e,t;return null==(t=null==(e=this._cosmos)?void 0:e.getLinkColors)?void 0:t.call(e)}getLinkWidths(){var e,t;return null==(t=null==(e=this._cosmos)?void 0:e.getLinkWidths)?void 0:t.call(e)}setPointShapes(e){var t;null==(t=this._cosmos)||t.setPointShapes(new Float32Array(e))}setPointImageIndices(e){var t;null==(t=this._cosmos)||t.setPointImageIndices(new Float32Array(e))}setPointImageSizes(e){var t;null==(t=this._cosmos)||t.setPointImageSizes(new Float32Array(e))}setImageData(e){var t;null==(t=this._cosmos)||t.setImageData([e])}getPointPositionByIndex(e){var t;const n=null==(t=this._cosmos)?void 0:t.getPointPositions();if(!n||!n.length)return;const i=n[2*e],r=n[2*e+1];return null==i||null==r?void 0:[i,r]}activateRectSelection(){this._rectangularSelection.enable(),this._polygonalSelection.disable()}deactivateRectSelection(){this._rectangularSelection.disable()}activatePolygonalSelection(){this._polygonalSelection.enable(),this._rectangularSelection.disable()}deactivatePolygonalSelection(){this._polygonalSelection.disable()}getSelectedPointIndices(){var e;return(null==(e=this._cosmos)?void 0:e.getSelectedIndices())??void 0}getSelectedLinkIndices(){var e,t;const n=null==(e=this._cosmos)?void 0:e.getSelectedIndices();if(!n||0===n.length)return;const i=null==(t=this._cosmos)?void 0:t.graph.sourceIndexToTargetIndices;if(!i)return;const r=new Set(n),o=new Set;for(let s=0;s<n.length;s++){const e=i[n[s]];if(e)for(let t=0;t<e.length;t++){const[n,i]=e[t];r.has(n)&&o.add(i)}}return o.size?Array.from(o):void 0}selectPointsInRect(e,t=!1){if(!this._cosmos||!e)return;const n=this._cosmos.getPointsInRect(e);this.selectPoints(Array.from(n),t)}selectPointsInPolygon(e,t=!1){if(!this._cosmos||!e.length)return;const n=this._cosmos.getPointsInPolygon(e);this.selectPoints(Array.from(n),t)}unselectPointsInRect(e){if(!this._cosmos||!e)return;const t=this._cosmos.getPointsInRect(e);this.unselectPointsByIndices(Array.from(t))}unselectPointsInPolygon(e){if(!this._cosmos||!e.length)return;const t=this._cosmos.getPointsInPolygon(e);this.unselectPointsByIndices(Array.from(t))}selectPoints(e,t=!1){var n,i;this._cosmos&&((null==e?void 0:e.length)?(t&&(e=[...this._cosmos.getSelectedIndices()||[],...e]),null==(n=this._pointSelectionClient)||n.selectPoints(e)):null==(i=this._pointSelectionClient)||i.selectPoints(void 0))}selectPoint(e,t=!1,n=!0===this._config.selectPointOnClick){var i,r;if(this._cosmos&&(void 0!==e||!t))if(void 0!==e){let r=[e];if(t&&(r=[...this._cosmos.getSelectedIndices()||[],e]),n){const t=this._cosmos.getAdjacentIndices(e);r=[...r,...t]}null==(i=this._pointSelectionClient)||i.selectPoints(r)}else this._config.resetSelectionOnEmptyCanvasClick&&(null==(r=this._pointSelectionClient)||r.selectPoints(void 0))}unselectPoint(e,t=!0===this._config.selectPointOnClick){var n;if(!this._cosmos||void 0===e)return;const i=this._cosmos.getSelectedIndices()||[];if(0===i.length||!i.includes(e))return;let r=i.filter(t=>t!==e);if(t){const t=this._cosmos.getAdjacentIndices(e);r=r.filter(e=>!t.includes(e))}this._focusedPointIndex&&!r.includes(this._focusedPointIndex)&&this.setFocusedPoint(void 0),null==(n=this._pointSelectionClient)||n.selectPoints(r.length?r:void 0)}unselectPointsByIndices(e){var t;if(!this._cosmos)return;const n=this._cosmos.getSelectedIndices()||[];if(0===n.length)return;const i=n.filter(t=>!e.includes(t));this._focusedPointIndex&&!i.includes(this._focusedPointIndex)&&this.setFocusedPoint(void 0),null==(t=this._pointSelectionClient)||t.selectPoints(i.length?i:void 0)}unselectAllPoints(){var e;this._cosmos&&(this.focusedPointIndex&&this.setFocusedPoint(void 0),null==(e=this._pointSelectionClient)||e.selectPoints(void 0),this._internalApi.dispatchEvent(new CustomEvent("resetSelections")))}setFocusedPoint(e){var t,n;this._focusedPointIndex=this._config.focusedPointIndex??e,this._cosmos&&!this._config.focusedPointIndex&&(null==(t=this._cosmos)||t.setConfig({focusedPointIndex:this._focusedPointIndex}),null==(n=this._labels)||n.render())}setPinnedPoints(e){var t;null==(t=this._cosmos)||t.setPinnedPoints(e)}start(e){var t;!1!==this._enableSimulation&&this._cosmos&&(null==(t=this._cosmos)||t.start(e),this._internalApi.dispatchEvent(new CustomEvent("onSimulationStart")))}pause(){var e;!1!==this._enableSimulation&&this._cosmos&&(null==(e=this._cosmos)||e.pause(),this._internalApi.dispatchEvent(new CustomEvent("onSimulationPause")))}unpause(){var e;!1!==this._enableSimulation&&this._cosmos&&(null==(e=this._cosmos)||e.unpause(),this._internalApi.dispatchEvent(new CustomEvent("onSimulationStart")))}restart(){this.unpause()}stop(){var e;!1!==this._enableSimulation&&this._cosmos&&(null==(e=this._cosmos)||e.stop(),this._internalApi.dispatchEvent(new CustomEvent("onSimulationPause")))}step(){var e;null==(e=this._cosmos)||e.step()}setZoomLevel(e,t=0){var n;null==(n=this._cosmos)||n.setZoomLevel(e,t)}getZoomLevel(){var e;return null==(e=this._cosmos)?void 0:e.getZoomLevel()}zoomToPoint(e,t=this._config.fitViewDuration,n,i){var r;null==(r=this._cosmos)||r.zoomToPointByIndex(e,t,n,i)}fitView(e=this._config.fitViewDuration,t=this._config.fitViewPadding){var n;null==(n=this._cosmos)||n.fitView(e,t)}fitViewByIndices(e,t=this._config.fitViewDuration,n=this._config.fitViewPadding){var i;null==(i=this._cosmos)||i.fitViewByPointIndices(e,t,n)}fitViewByCoordinates(e,t=this._config.fitViewDuration,n=this._config.fitViewPadding){var i;null==(i=this._cosmos)||i.fitViewByPointPositions(e,t,n)}getConnectedPointIndices(e){var t;return null==(t=this._cosmos)?void 0:t.getAdjacentIndices(e)}getPointDegrees(e){var t,n;if(this._cosmos)return{inDegree:(null==(t=this._cosmos.graph.inDegree)?void 0:t[e])??0,outDegree:(null==(n=this._cosmos.graph.outDegree)?void 0:n[e])??0}}spaceToScreenPosition(e){var t;return null==(t=this._cosmos)?void 0:t.spaceToScreenPosition(e)}screenToSpacePosition(e){var t;return null==(t=this._cosmos)?void 0:t.spaceToScreenPosition(e)}spaceToScreenRadius(e){var t;return null==(t=this._cosmos)?void 0:t.spaceToScreenRadius(e)}getPointRadiusByIndex(e){var t;return null==(t=this._cosmos)?void 0:t.getPointRadiusByIndex(e)}getPointScreenRadiusByIndex(e){var t,n;const i=(null==(t=this._cosmos)?void 0:t.config.pointSizeScale)??1,r=null==(n=this._cosmos)?void 0:n.getPointRadiusByIndex(e);if(!r)return 0;const o=r*i,{scalePointsOnZoom:s}=this._config,a=this.getZoomLevel(),l=this.maxPointSize;return s?Math.min(o*a,l):o}trackPointPositionsByIndices(e){var t;null==(t=this._cosmos)||t.trackPointPositionsByIndices(e)}getTrackedPointPositionsArray(){var e,t;return null==(t=null==(e=this._cosmos)?void 0:e.getTrackedPointPositionsArray)?void 0:t.call(e)}getTrackedPointPositionsMap(){var e,t;return null==(t=null==(e=this._cosmos)?void 0:e.getTrackedPointPositionsMap)?void 0:t.call(e)}getSampledPoints(){var e,t;return null==(t=null==(e=this._cosmos)?void 0:e.getSampledPoints)?void 0:t.call(e)}getSampledPointPositionsMap(){var e;if(this._cosmosInitialized)return null==(e=this._cosmos)?void 0:e.getSampledPointPositionsMap()}getActiveSelectionSourceId(){const e=this._crossfilter.pointsSelection.active,t=null==e?void 0:e.source;return null==t?void 0:t.id}get pointsSelection(){return this._crossfilter.pointsSelection}get linksSelection(){return this._crossfilter.linksSelection}async getPointIndicesByIds(e){if(this._dbCoordinator&&this.stats.pointsCount&&e.length)return await Mj(this._dbCoordinator,this.pointsTableName,this._config,e)}async getPointIdsByIndices(e){if(this._dbCoordinator&&this.stats.pointsCount&&e.length)return await Dj(this._dbCoordinator,this.pointsTableName,this._config,e)}async getPointsByIndices(e){if(this._dbCoordinator&&this.stats.pointsCount&&e.length)return await(async(e,t,n,i)=>{const r=i.join(", ");return await e.query(`SELECT * FROM ${t} WHERE "${n}" IN (${r})`)})(this._dbCoordinator,this.pointsTableName,this._config.pointIndexBy,e)}async getPointIndicesByExactValues(e,t){if(this._dbCoordinator&&this.stats.pointsCount)return t.length?await(async(e,t,n,i,r)=>{var o;const s=r.map(e=>"string"==typeof e?`${_N(e)}`:e),a=`SELECT "${n.pointIndexBy}" FROM ${t} WHERE "${i}" IN (${s.join(", ")})`,l=await e.query(a);return l?(null==(o=l.getChildAt(0))?void 0:o.toArray())??[]:void 0})(this._dbCoordinator,this.pointsTableName,this._config,e,t):[]}async getPointIndicesByNumericValue(e,t,n){if(this._dbCoordinator&&this.stats.pointsCount)return t?await(async(e,t,n,i,r,o)=>{var s;const a=o?">=":"<=",l=`SELECT "${n.pointIndexBy}" FROM ${t} WHERE "${i}" ${a} ${r}`,c=await e.query(l);if(c)return(null==(s=c.getChildAt(0))?void 0:s.toArray())??[]})(this._dbCoordinator,this.pointsTableName,this._config,e,t,n):[]}async getPointIndicesByLinksExactValues(e,t){if(this._dbCoordinator&&this.stats.linksCount)return t.length?await(async(e,t,n,i,r)=>{const o=r.map(e=>"string"==typeof e?`${_N(e)}`:e),s=`SELECT "${n.linkSourceIndexBy}", "${n.linkTargetIndexBy}" FROM ${t} WHERE "${i}" IN (${o.join(", ")})`;return Fj(e,s)})(this._dbCoordinator,this.linksTableName,this._config,e,t):[]}async getPointIndicesByLinksNumericValue(e,t,n){if(this._dbCoordinator&&this.stats.linksCount)return t?await(async(e,t,n,i,r,o)=>{const s=o?">=":"<=",a=`SELECT "${n.linkSourceIndexBy}", "${n.linkTargetIndexBy}" FROM ${t} WHERE "${i}" ${s} ${r}`;return Fj(e,a)})(this._dbCoordinator,this.linksTableName,this._config,e,t,n):[]}async getLinksByPointIds(e){if(this._dbCoordinator&&this.stats.linksCount&&e.length)return await(async(e,t,n,i)=>{const r=i.map(e=>"string"==typeof e?`${_N(e)}`:e);return await e.query(`SELECT * FROM ${t} WHERE "${n.linkSourceBy}" IN (${r}) OR "${n.linkTargetBy}" IN (${r})`)})(this._dbCoordinator,this.pointsTableName,this._config,e)}async getLinksByPointIndices(e){if(this._dbCoordinator&&this.stats.linksCount&&e.length)return await(async(e,t,n,i)=>{const r=i.join(", ");return await e.query(`SELECT * FROM ${t} WHERE "${n.linkSourceIndexBy}" IN (${r}) OR "${n.linkTargetIndexBy}" IN (${r})`)})(this._dbCoordinator,this.pointsTableName,this._config,e)}async getLinksData(){if(this._dbCoordinator&&this.stats.linksCount)return await Oj(this._dbCoordinator,this.linksTableName)}async getPointsData(){if(this._dbCoordinator&&this.stats.pointsCount)return await Pj(this._dbCoordinator,this.pointsTableName)}convertCosmographDataToObject(e){return pN(e)}flattenPositions(e){var t;return null==(t=this._cosmos)?void 0:t.flatten(e)}pair(e){var t;return null==(t=this._cosmos)?void 0:t.pair(e)}async addPoints(e){await this._dataManager.addPoints(e)}async addLinks(e){await this._dataManager.addLinks(e)}async removePointsByIndices(e,t=!0){await this._dataManager.removePointsByIndices(e,t)}async removePointsByIds(e){await this._dataManager.removePointsByIds(e)}async removeLinksByPointIdPairs(e){await this._dataManager.removeLinksByPointIdPairs(e)}async removeLinksByPointIndicesPairs(e){await this._dataManager.removeLinksByPointIndicesPairs(e)}async addMosaicComponent(e,t,n){if(await this._dataManager.dataReady(),this._ensureAlive()){if(this._mosaicComponentManager)return await this._mosaicComponentManager.addComponent(e,t,n);dN(0,0,"error")}}async removeMosaicComponent(e){return this._mosaicComponentManager?await this._mosaicComponentManager.removeComponent(e):(dN(0,0,"error"),!1)}getMosaicComponents(){var e;return null==(e=this._mosaicComponentManager)?void 0:e.components}async reset(e=!0){var t,n,i,r,o;e&&(this._configManager.resetCosmographConfig(),this._messageDivElement.innerText=" Cosmograph is ready, load your data!",this._messageDivElement.style.display="block"),null==(t=this._labels)||t.clear(),this._configManager.clearCosmosBuffers(),null==(n=this._cosmos)||n.render(),await this._dropLocalTables(),null==(i=this._dbCoordinator)||i.clearCache(),this._linkAggregationManager.clear(),this._stats={pointsCount:0,linksCount:0,pointsSummary:void 0,linksSummary:void 0},await(null==(r=this._mosaicComponentManager)?void 0:r.destroyAll()),null==(o=this._pointSelectionClient)||o.destroy(),this._pointSelectionClient=void 0,this._internalApi.dispatchEvent(new CustomEvent("reset")),this._internalApi.dispatchEvent(new CustomEvent("dataUploaded"))}async destroy(){var e,t,n,i,r;dN(0,0,"warn"),this._isDestroyed?dN(0,0,"warn"):(this._isDestroyed=!0,this._internalApi.dispatchEvent(new CustomEvent("reset")),null==(e=this._labels)||e.destroy(),null==(t=this._cosmos)||t.destroy(),this._cosmos=void 0,await this._dropLocalTables(),await(null==(n=this._dbCoordinator)?void 0:n.destroy()),this._dbCoordinator=void 0,this._linkAggregationManager.clear(),this._containerElement.innerHTML="",this._rectangularSelection.destroy(),this._polygonalSelection.destroy(),await(null==(i=this._mosaicComponentManager)?void 0:i.destroyAll()),this._mosaicComponentManager=void 0,null==(r=this._pointSelectionClient)||r.destroy(),this._pointSelectionClient=void 0,delete window.cosmographDisableLogging)}}const dq=mN(),hq=async(e,t)=>{const n=await e.query(`DESCRIBE ${t}`);return new Map((null==n?void 0:n.toArray().map(e=>[e.column_name,e.column_type]))??[])},fq=(e,t)=>({existing:[...new Set(e.filter(e=>t.has(e.name)).map(e=>e.name))],missing:e.filter(e=>!t.has(e.name))}),pq=async(e,t)=>{var n,i,r,o;const s=await hq(e,eF.RawPoints),{missing:a}=fq((e=>{const{pointIdBy:t,linkSourceBy:n,linkTargetsBy:i}=e;return t?[{prop:"pointIdBy",name:t}]:n&&i?[{prop:"linkSourceBy",name:n},...i.map(e=>({prop:"linkTargetBy",name:e}))]:[{prop:"pointIdBy",name:t??"undefined"}]})(t),s);if(a.length>0)return{missingRequiredColumns:a,missingOptionalColumns:[],processedFully:!0,pointsAdded:!1};const{existing:l,missing:c}=fq((e=>{const{pointSizeBy:t,pointColorBy:n,pointClusterBy:i,pointClusterStrengthBy:r,pointLabelBy:o,pointLabelWeightBy:s,pointXBy:a,pointYBy:l,pointIncludeColumns:c=[]}=e;return[...t?[{prop:"pointSizeBy",name:t}]:[],...n?[{prop:"pointColorBy",name:n}]:[],...i?[{prop:"pointClusterBy",name:i}]:[],...r?[{prop:"pointClusterStrengthBy",name:r}]:[],...o?[{prop:"pointLabelBy",name:o}]:[],...s?[{prop:"pointLabelWeightBy",name:s}]:[],...[...new Set(c)].map(e=>({prop:"pointIncludeColumns",name:e})),...a&&l?[{prop:"pointXBy",name:a},{prop:"pointYBy",name:l}]:[]]})(t),s),u=l.filter(e=>e!==tF.Id);if(await e.exec(`\n    BEGIN;\n    DROP SEQUENCE IF EXISTS ${tF.Sequence} CASCADE;\n    CREATE SEQUENCE ${tF.Sequence} MINVALUE 0;\n    CREATE TABLE ${eF.PreparedPoints} (\n      ${tF.Id} VARCHAR,\n      ${tF.Idx} INT DEFAULT nextval('${tF.Sequence}')\n    );\n    COMMIT;\n  `),u.length>0){const t=u.map(e=>`ALTER TABLE ${eF.PreparedPoints} ADD COLUMN IF NOT EXISTS "${e}" ${s.get(e)};`).join("\n");await e.exec(t)}const{pointIdBy:d,linkSourceBy:h,linkTargetsBy:f}=t,p=h&&f?[h,...f]:[d],m=null==(i=null==(n=await e.query(`SELECT COUNT(*) as cnt FROM ${eF.RawPoints}`))?void 0:n.getChild("cnt"))?void 0:i.get(0);let g=!0;if(1===p.length&&m>25e4)try{await(async(e,t,n,i)=>{let r=0;for(;r<i;)await e.exec(`\n      CREATE TEMP TABLE chunk_temp AS \n      SELECT "${t}" AS ${tF.Id}, ${n.map(e=>`"${e}"`).join(", ")}\n      FROM ${eF.RawPoints}\n      WHERE "${t}" IS NOT NULL\n      LIMIT 250000\n    `),await e.exec(`INSERT INTO ${eF.PreparedPoints} (${[`"${tF.Id}"`,...n.map(e=>`"${e}"`)].join(", ")}) SELECT * FROM chunk_temp`),await e.exec(`DELETE FROM ${eF.RawPoints} WHERE "${t}" IN (SELECT ${tF.Id} FROM chunk_temp)`),await e.exec("DROP TABLE chunk_temp"),r+=25e4})(e,p[0],u,m),(null==(o=null==(r=await e.query(`SELECT COUNT(*) as cnt FROM ${eF.RawPoints}`))?void 0:r.getChild("cnt"))?void 0:o.get(0))>0&&(g=!1)}catch(qn){g=!1}else{const t=`\n      INSERT INTO ${eF.PreparedPoints} (${[tF.Id,...u].map(e=>`"${e}"`).join(", ")})\n      SELECT DISTINCT ON (${tF.Id}) combined_points.*\n      FROM (\n        ${p.map(e=>`\n          SELECT "${e}" AS ${tF.Id}${u.length>0?`, ${u.map(e=>`"${e}"`).join(", ")}`:""}\n          FROM ${eF.RawPoints}\n          WHERE "${e}" IS NOT NULL\n        `).join(" UNION ALL ")}\n      ) AS combined_points\n    `;await e.exec(t)}return dq&&await e.logTable(eF.PreparedPoints),{missingRequiredColumns:[],missingOptionalColumns:c,processedFully:g,pointsAdded:!1}},mq=async(e,t)=>{var n;const{linkSourceBy:i=tF.Source,linkTargetsBy:r=[tF.Target],linkIncludeColumns:o=[],linkColorBy:s,linkWidthBy:a,linkArrowBy:l,linkStrengthBy:c}=t;if(!(null==r?void 0:r.length))return{missingRequiredColumns:[],missingOptionalColumns:[],processedFully:!0,pointsAdded:!1};const u=await hq(e,eF.RawLinks),d=[{prop:"linkSourceBy",name:i},...r.map(e=>({prop:"linkTargetsBy",name:e}))],{missing:h}=fq(d,u);if(h.length>0)return{missingRequiredColumns:h,missingOptionalColumns:[],processedFully:!0,pointsAdded:!1};const f=[...s?[{prop:"linkColorBy",name:s}]:[],...a?[{prop:"linkWidthBy",name:a}]:[],...l?[{prop:"linkArrowBy",name:l}]:[],...c?[{prop:"linkStrengthBy",name:c}]:[],...o.map(e=>({prop:"linkIncludeColumns",name:e}))],{existing:p,missing:m}=fq(f,u),g=[tF.SourceIdx,tF.TargetIdx,tF.Source,tF.Target],_=p.filter(e=>!g.includes(e));if(await e.exec(`\n    CREATE TABLE IF NOT EXISTS ${eF.PreparedLinks} (\n      ${tF.SourceIdx} INTEGER,\n      ${tF.TargetIdx} INTEGER,\n      ${tF.Source} VARCHAR,\n      ${tF.Target} VARCHAR\n    );\n  `.trim()),_.length>0){const t=_.map(e=>`ALTER TABLE ${eF.PreparedLinks} ADD COLUMN IF NOT EXISTS "${e}" ${u.get(e)||"VARCHAR"};`).join("\n");await e.exec(t)}await e.exec(`\n    CREATE TEMP TABLE temp_points AS\n    SELECT ${tF.Id}, ${tF.Idx}\n    FROM ${eF.PreparedPoints}\n  `.trim());let y=!1;if(t.createMissingPoints){const t=[i,...r].map(e=>`\n    SELECT DISTINCT "${e}"::text as ${tF.Id}\n    FROM ${eF.RawLinks}\n    WHERE "${e}" IS NOT NULL\n  `).join(" UNION "),o=await e.query(`\n    SELECT COUNT(*) as cnt\n    FROM (${t}) all_ids\n    WHERE ${tF.Id} NOT IN (SELECT ${tF.Id} FROM temp_points)\n  `.trim()),s=(null==(n=null==o?void 0:o.getChild("cnt"))?void 0:n.get(0))||0;y=s>0,s>0&&(await e.exec(`\n      CREATE TEMP TABLE missing_ids AS\n      SELECT DISTINCT ${tF.Id}\n      FROM (${t}) all_ids\n      WHERE ${tF.Id} NOT IN (SELECT ${tF.Id} FROM temp_points)\n    `.trim()),await e.exec(`\n      CREATE TEMP TABLE missing_ids_with_idx AS\n      SELECT ${tF.Id},\n             ROW_NUMBER() OVER (ORDER BY ${tF.Id}) + (SELECT COALESCE(MAX(${tF.Idx}), 0) FROM ${eF.PreparedPoints}) as ${tF.Idx}\n      FROM missing_ids\n    `.trim()),await e.exec(`\n      INSERT INTO ${eF.PreparedPoints} (${tF.Id}, ${tF.Idx})\n      SELECT ${tF.Id}, ${tF.Idx} FROM missing_ids_with_idx\n    `.trim()),await e.exec("DROP TABLE temp_points"),await e.exec(`\n      CREATE TEMP TABLE temp_points AS\n      SELECT ${tF.Id}, ${tF.Idx}\n      FROM ${eF.PreparedPoints}\n    `.trim()),await e.exec("DROP TABLE missing_ids"),await e.exec("DROP TABLE missing_ids_with_idx"))}const v=[tF.SourceIdx,tF.TargetIdx,tF.Source,tF.Target,..._];for(const b of r){const t=`\n      INSERT INTO ${eF.PreparedLinks} (${v.map(e=>`"${e}"`).join(", ")})\n      SELECT DISTINCT\n        sp.${tF.Idx} AS ${tF.SourceIdx},\n        tp.${tF.Idx} AS ${tF.TargetIdx},\n        d."${i}" AS ${tF.Source},\n        d."${b}" AS ${tF.Target}\n        ${_.length>0?`, ${_.map(e=>`d."${e}"`).join(", ")}`:""}\n      FROM ${eF.RawLinks} d\n      INNER JOIN temp_points sp ON sp.${tF.Id} = d."${i}"::text\n      INNER JOIN temp_points tp ON tp.${tF.Id} = d."${b}"::text\n    `;await e.exec(t.trim())}return await e.exec("DROP TABLE temp_points"),dq&&await(null==e?void 0:e.logTable(eF.PreparedLinks)),{missingRequiredColumns:[],missingOptionalColumns:m,processedFully:!0,pointsAdded:y}};let gq,_q=null;const yq=async(e,t,n=!1)=>{switch(e){case nF.Parquet:return await gq.exportTableToPq(t)??new Uint8Array;case nF.Arrow:return n?await gq.exportTableToArrow(t)??new fM:await gq.exportTableToArrowBuffer(t)??new Uint8Array;case nF.CSV:return await gq.exportTableToCSV(t)??new Uint8Array;default:throw new Error(`Unsupported format: ${e}`)}},vq=async(e,t,n,i,r,o,s,a=!1)=>{const{ok:l,processedFully:c,pointsAdded:u}=await(async(e,t,n,i)=>{try{let r;if(r=Array.isArray(e)?await gq.uploadObject(e,t):await gq.uploadData(e,t,!1,i.csvParseTimeFormat,i.csvColumnTypesMap),null==r?void 0:r.error)return dN(r.error,0,"error"),{ok:!1,processedFully:!0,pointsAdded:!1};"pointIdBy"in i&&(void 0!==i.pointIdBy||i.linkSourceBy||i.linkTargetsBy||(dN(0,0,"warn"),await gq.query(`ALTER TABLE ${t} ADD COLUMN ${tF.Id} INTEGER; UPDATE ${t} SET ${tF.Id} = rowid;`),await gq.logTable(t),i.pointIdBy=tF.Id));const{missingRequiredColumns:o,missingOptionalColumns:s,processedFully:a,pointsAdded:l}=await n(gq,i);return o.length>0?(dN(o.map(e=>`'${e.name}' (\`${e.prop}\`)`).join(", "),0,"error"),{ok:!1,processedFully:a,pointsAdded:l??!1}):s.length>0?(dN(s.map(e=>`'${e.name}' (\`${e.prop}\`)`).join(", "),0,"warn"),{ok:!0,processedFully:a,pointsAdded:l??!1}):{ok:!0,processedFully:a,pointsAdded:l??!1}}catch(r){return{ok:!1,processedFully:!0,pointsAdded:!1}}})(e,t,i,r);if(!l)return void dN(0,0,"error");await gq.dropTable(t);const d=await yq(o,n,a),h=await gq.query(`SUMMARIZE ${n}`);return d instanceof Uint8Array&&d.length||d instanceof fM&&d.numRows?{data:s(d),summary:null==h?void 0:h.toArray(),processedFully:c,pointsAdded:u}:void dN(d instanceof Uint8Array?d.length:d instanceof fM&&d.numRows,0,"warn")},bq=async(e,t,n)=>(async e=>_q||(dN(0,0,"util"),_q=(async()=>{try{const t=await e();return t&&dN(0,0,"util"),t}catch(t){return void dN(0,0,"error")}finally{_q=null}})(),_q))(()=>(async(t,n,i,r,o,s=!1)=>{let a,l;await(async()=>{gq=await uF.getInstance()})(),await gq.query(`DROP TABLE IF EXISTS ${eF.PreparedPoints}`),await gq.query(`DROP TABLE IF EXISTS ${eF.PreparedLinks}`);let c=!0,u=!0;try{if(!t.points||void 0!==t.points.pointIdBy&&(void 0!==t.points.linkSourceBy||void 0!==t.points.linkTargetsBy))return void dN(0,0,"error");const d=await vq(n,eF.RawPoints,eF.PreparedPoints,pq,t.points,r,o,s);if(!d)return void dN(0,0,"error");let h=d.data;a=d.summary,c=d.processedFully;const f={...t};let p;if(i&&t.links)if(t.links.linkSourceBy&&t.links.linkTargetsBy)try{const e=await vq(i,eF.RawLinks,eF.PreparedLinks,mq,t.links,r,o,s);if(e){if(p=e.data,l=e.summary,u=e.processedFully,e.pointsAdded){const e=await yq(r,eF.PreparedPoints,s),t=await gq.query(`SUMMARIZE ${eF.PreparedPoints}`);(e instanceof Uint8Array&&e.length||e instanceof fM&&e.numRows)&&(h=o(e),a=null==t?void 0:t.toArray())}}else dN(0,0,"error")}catch(e){dN(0,0,"error")}else dN(0,0,"error");!p&&t.links&&(f.links=void 0,dN(0,0,"warn"));const m=(e=>{const t={...Object.fromEntries(Object.entries(e.points).filter(([e,t])=>"outputFilename"!==e&&"linkTargetsBy"!==e&&"linkSourceBy"!==e&&void 0!==t)),pointIdBy:tF.Id,pointIndexBy:tF.Idx};return e.links?{...t,...Object.fromEntries(Object.entries(e.links).filter(([e,t])=>"linkTargetsBy"!==e&&"outputFilename"!==e&&void 0!==t)),linkSourceBy:tF.Source,linkSourceIndexBy:tF.SourceIdx,linkTargetBy:tF.Target,linkTargetIndexBy:tF.TargetIdx}:t})(f);return{points:h,links:p,pointsSummary:a,linksSummary:l,cosmographConfig:m,pointsProcessedFully:c,linksProcessedFully:u}}catch(e){return}finally{await gq.destroy()}})(e,t,n,nF.Arrow,e=>e,!0)),xq={highlightSelectedData:!0,showAnimationControls:!0,useLinksData:!1,useQuantiles:!1},wq={highlightSelectedData:!0,useLinksData:!1,useQuantiles:!1};let Sq=(i=class extends NY{constructor(){super(...arguments),s(this,"selected")}checkCurrentSelection(){this.selected&&this.setSelectedItem(this.selected)}onSelect(e){var t,n,r;this.compareSelectedItem(e)?(null==(t=this._client)||t.resetFilter(),this.onResetClientSelections(),i._activeComponentId=null):(i._activeComponentId!==(null==(n=this._client)?void 0:n.id)&&(this._internalApi.public.unselectAllPoints(),this._internalApi.dispatchEvent(new CustomEvent("resetSelections"))),i._activeComponentId=(null==(r=this._client)?void 0:r.id)||null,this.selected=e,this.setSelectedItem(e),this.accessor&&this.applyFilter(e))}onResetClientSelections(){this.selected=void 0,this.setSelectedItem(void 0)}onDataFiltered(){var e,t;(null==(e=this._client)?void 0:e.id)!==i._activeComponentId&&(this.selected=void 0,this.setSelectedItem(void 0),null==(t=this._client)||t.resetFilter())}},s(i,"_activeComponentId",null),i);const Eq={suggestionsLimit:50,placeholderText:"Search...",showAccessorsMenu:!0,suggestionTruncationLength:50,accessor:"id",suggestionFieldsPalette:["#fbb4aebf","#b3cde3bf","#ccebc5bf","#decbe4bf","#fed9a6bf","#ffffccbf","#e5d8bdbf","#fddaecbf"],showFooter:!1};var Cq="style_module_searchContainer__1bed75df",Tq="style_module_accessorButton__1bed75df",kq="style_module_upwards__1bed75df",Iq="style_module_visible__1bed75df",Aq="style_module_placeholderInput__1bed75df",Lq="style_module_disabled__1bed75df",Rq="style_module_separator__1bed75df";kY(".style_module_searchContainer__1bed75df{align-items:center;display:flex;gap:6px;position:relative;width:100%}.style_module_accessorButton__1bed75df{align-items:center;backdrop-filter:blur(8px);background:var(--cosmograph-search-accessors-background);border-radius:4px;cursor:pointer;display:flex;flex-shrink:0;font-size:13px;font-weight:300;line-height:1;max-width:100px;overflow:hidden;padding:2.5px 5px;text-overflow:ellipsis;white-space:nowrap}.style_module_accessorsMenuPlaceholder__1bed75df{font-size:11.5px;font-weight:600;letter-spacing:.07em;line-height:2;opacity:.9;padding-bottom:0;padding-left:10px;padding-top:4px;pointer-events:none;text-transform:uppercase;user-select:none}.style_module_accessorsMenu__1bed75df{backdrop-filter:blur(8px);background:var(--cosmograph-search-list-background);border-radius:4px;color:#fff;left:0;margin:2px 0 0;min-width:100%;opacity:0;overflow:hidden;padding:0 0 2px;pointer-events:none;position:absolute;right:0;top:100%;transform:translateY(-10px);transition:opacity .2s ease-out,transform .2s ease-out;width:100%}.style_module_accessorsMenu__1bed75df.style_module_upwards__1bed75df{bottom:100%;top:auto;transform:translateY(10px)}.style_module_accessorsMenu__1bed75df.style_module_visible__1bed75df{opacity:1;pointer-events:auto;transform:translateY(0)}.style_module_accessorsMenu__1bed75df.style_module_upwards__1bed75df.style_module_visible__1bed75df{opacity:1;pointer-events:auto;transform:translateY(-7px)}.style_module_accessorsMenu__1bed75df li{cursor:pointer;display:block;font-size:var(--cosmograph-search-list-font-size,13.5px);font-weight:500;line-height:normal;max-width:100%;opacity:0;padding:5px 10px;transform:translateY(5px);transition:opacity .2s ease-out,transform .2s ease-out;user-select:none}.style_module_accessorsMenu__1bed75df.style_module_visible__1bed75df li{opacity:1;transform:translateY(0)}.style_module_accessorsMenu__1bed75df li:hover{background:hsla(0,0%,100%,.1)}.style_module_accessorsMenu__1bed75df li>div{font-weight:200;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}.style_module_placeholderInput__1bed75df{align-items:center;cursor:text;display:flex;font-weight:300;min-width:0;opacity:.7;width:100%}.style_module_placeholderInput__1bed75df.style_module_disabled__1bed75df{cursor:not-allowed;opacity:.5;pointer-events:none}.style_module_searchResult__1bed75df{align-items:center;display:flex;flex-wrap:wrap}.style_module_searchResultMultiField__1bed75df{text-wrap:initial;align-items:center;color:hsla(0,0%,100%,.8);display:inline-block;font-size:var(--cosmograph-search-list-font-size,13.5px);font-weight:300;line-height:normal;margin-right:8px;max-width:100%;overflow-wrap:anywhere;word-break:normal}.style_module_searchResultMultiField__1bed75df span{text-wrap:balance;display:inline;font-size:calc(var(--cosmograph-search-list-font-size)*.95);hyphens:auto;line-height:1.25;overflow-wrap:anywhere;white-space:normal;word-break:break-all}.style_module_searchResultMultiField__1bed75df .style_module_separator__1bed75df{display:inline;opacity:.5}.style_module_searchResultMultiField__1bed75df b{font-size:calc(var(--cosmograph-search-list-font-size)*.9);font-weight:600;letter-spacing:.015em;opacity:.7;text-transform:uppercase;white-space:pre}.style_module_selectAllContainer__1bed75df{align-items:center;display:flex;gap:4px;justify-content:start;line-height:1;margin:.25rem .5rem .15rem;padding:.2rem 0;width:100%}.style_module_selectAllButton__1bed75df{align-items:center;backdrop-filter:blur(4px);background:var(--cosmograph-search-select-all-background,hsla(0,0%,100%,.1));border:none;border-radius:4px;color:var(--cosmograph-search-select-all-color,hsla(0,0%,100%,.75));cursor:pointer;font-size:var(--cosmograph-search-list-font-size,13.5px);font-weight:300;margin:0!important;padding:2px 8px;text-align:center;transition:background-color .2s ease,border-color .2s ease}.style_module_selectAllButton__1bed75df:hover{background:var(--cosmograph-search-select-all-hover-background,hsla(0,0%,100%,.15))}.style_module_resultsCounter__1bed75df{color:hsla(0,0%,100%,.4);font-size:12px;font-weight:400;user-select:none;white-space:nowrap}.style_module_selectAllContainer__1bed75df .style_module_separator__1bed75df{color:hsla(0,0%,100%,.4);opacity:.7;user-select:none}",{}),kY(":root{--cosmograph-search-accessors-background:#8791a159}",{});let Pq=(r=class extends Sq{constructor(){super(...arguments),s(this,"_isDataFetched",!1),s(this,"_accessorsMenu",null),s(this,"_placeholderElement",null),s(this,"_accessorButton",null),s(this,"_clickOutsideHandler",e=>this._handleClickOutside(e)),s(this,"_enterFilterActive",!1),s(this,"_currentSearchInput",""),s(this,"_currentSearchResults",[]),s(this,"_totalResultsCount",0),s(this,"_resultsCounter",null),s(this,"_arrayColumnsCache",new Set),s(this,"_selectedSearchField",Eq.accessor)}get defaultConfig(){return Eq}get accessor(){return this._config.accessor??Eq.accessor}_isAllFieldsSelected(){return this._selectedSearchField===r.ALL_FIELDS_TOKEN}_getSelectedFieldLabel(){return this._isAllFieldsSelected()?r.ALL_FIELDS_LABEL:this.accessor}_syncSelectedSearchFieldWithConfig(){this._isAllFieldsSelected()||(this._selectedSearchField=this.accessor)}_getAutoSuggestionFields(){const{config:e}=this._internalApi,t=this._internalApi.summary.pointsSummary;if(!t||0===t.length)return;const n={};for(const i of t){const t=String(i.column_name);t!==e.pointIndexBy&&(n[t]=t)}if(this._config.suggestionFields)for(const[i,r]of Object.entries(this._config.suggestionFields))void 0!==n[i]&&(n[i]=r);return n}_getEffectiveSuggestionFields(){return this._isAllFieldsSelected()?this._getAutoSuggestionFields():this._config.suggestionFields}_getAllFields(){return Object.keys(this._getAutoSuggestionFields()??{})}_valueAccessor(e,t=this.accessor){const n=e[t];return null==n?"null":String(n)}_indexAccessor(e){const{config:t}=this._internalApi;return Number(e[t.pointIndexBy])}_calculateDisabledState(){return!this._isDataFetched||("boolean"==typeof this._config.disabled?this._config.disabled:!this._isDataFetched)}async fetchData(){if(!this._internalApi.dbCoordinator)return;await this._internalApi.dataManager.dataReady(),this._isDataFetched=!0,this._syncSelectedSearchFieldWithConfig();const e=this._calculateDisabledState();this._uiComponent.setDisabled(e),this._findPlaceholderElement(),this._updatePlaceholderDisabledState(),this._config.showAccessorsMenu&&(await this._updateAccessorsMenu(),this._updateAccessorButton()),this._detectArrayColumns(),this._client&&this.accessor&&await this._client.getCurrentData()}_detectArrayColumns(){this._arrayColumnsCache.clear();for(const e of this._internalApi.summary.pointsSummary??[])wN(String(e.column_type??""))&&this._arrayColumnsCache.add(String(e.column_name))}_isArrayColumn(e){return this._arrayColumnsCache.has(e)}applyFilter(e){var t,n,i;const{config:r}=this._internalApi;if(e)if(this._getEffectiveSuggestionFields()){const n=this._indexAccessor(e);null==(t=this._client)||t.applyFilter(ME(RS(r.pointIndexBy),[n])),this._internalApi.public.zoomToPoint(n),(r.focusPointOnClick??r.selectPointOnClick)&&this._internalApi.public.setFocusedPoint(n)}else null==(n=this._client)||n.applyExactFilter(this._valueAccessor(e));else null==(i=this._client)||i.resetFilter()}setSelectedItem(e){e||this._uiComponent.clearInput()}compareSelectedItem(e){var t;return!(e||!this.selected)||(null==(t=this.selected)?void 0:t.id)===(null==e?void 0:e.id)}createUIComponent(e){return new _G(e,this.createComponentConfig({...this._config}))}onResetClientSelections(){this._uiComponent.clearInput()}async onConfigUpdate(){const e=this._config.openListUpwards;this._uiComponent.setConfig(this.createComponentConfig({...this._config})),this._updatePlaceholderDisabledState(),this._syncSelectedSearchFieldWithConfig(),this._config.showAccessorsMenu&&this._accessorsMenu&&e!==this._config.openListUpwards&&(this._config.openListUpwards?this._accessorsMenu.classList.add(kq):this._accessorsMenu.classList.remove(kq)),this._config.showAccessorsMenu&&this._updateAccessorButton(),this._uiComponent.clearInput(),this.onResetClientSelections()}async _getSuggestions(e){if(this._internalApi.dbCoordinator)return await this._internalApi.dataManager.dataReady(),this._syncSelectedSearchFieldWithConfig(),this._isAllFieldsSelected()?this._getAllFieldsSuggestions(e):this._getSingleFieldSuggestions(e)}async _executeQuery(e){var t;return await(null==(t=this._internalApi.dbCoordinator)?void 0:t.query(e))}_buildOrderByClause(e,t){return this._isNullSearch(t)?`"${this.accessor}"`:`\n      CASE WHEN ${e} = LOWER('${t}') THEN 0 ELSE 1 END,\n      CASE WHEN ${e} LIKE LOWER('${t}%') THEN 0 ELSE 1 END,\n      STRPOS(${e}, LOWER('${t}'))\n    `}_isNullSearch(e){return"null"===e.toLowerCase().trim()}_buildFieldUtilities(e){const t=e=>this._isArrayColumn(e)?`LOWER(array_to_string("${e}", ', '))`:`LOWER(CAST("${e}" AS VARCHAR))`;return{fieldCast:t,fieldMatchCondition:n=>this._isNullSearch(e)?`"${n}" IS NULL`:this._isArrayColumn(n)?`EXISTS(\n          SELECT 1 FROM UNNEST("${n}") AS element\n          WHERE LOWER(CAST(element AS VARCHAR)) LIKE LOWER('%${e}%')\n        )`:`${t(n)} LIKE LOWER('%${e}%')`}}_buildSingleFieldWhereCondition(e){const{fieldMatchCondition:t}=this._buildFieldUtilities(e);return t(this.accessor)}_buildAllFieldsWhereCondition(e){const t=this._getAllFields();if(0===t.length)return this._buildSingleFieldWhereCondition(e);const{fieldMatchCondition:n}=this._buildFieldUtilities(e);return t.map(n).join(" OR ")}_truncateAroundMatch(e,t,n){if(0===n||e.length<=n)return e;const i=e.toLowerCase(),r=t.toLowerCase(),o=i.indexOf(r);if(-1===o)return e.length>n?`${e.substring(0,n)}...`:e;const s=o+t.length,a=Math.floor(n/2);let l=Math.max(0,o-a),c=Math.min(e.length,s+a);0===l?c=Math.min(e.length,l+n):c===e.length&&(l=Math.max(0,c-n));let u=e.substring(l,c);return l>0&&(u=`...${u}`),c<e.length&&(u=`${u}...`),u}async _getSingleFieldSuggestions(e){const{fieldCast:t}=this._buildFieldUtilities(e),n=this._config.suggestionsLimit??Eq.suggestionsLimit,i=this._buildSingleFieldWhereCondition(e);if(!this._getEffectiveSuggestionFields()){if(this._isNullSearch(e)){const e=`\n          SELECT 'null' AS "${this.accessor}",\n                 'null' AS id,\n                 1 AS total_count\n          FROM (SELECT 1) AS dummy\n          WHERE EXISTS (\n            SELECT 1 FROM ${this.tableName}\n            WHERE "${this.accessor}" IS NULL\n            LIMIT 1\n          )\n          LIMIT 1\n        `;return this._executeQuery(e)}if(this._isArrayColumn(this.accessor)){const t=`\n          WITH values AS (\n            SELECT DISTINCT CAST(u.value AS VARCHAR) AS value\n            FROM ${this.tableName} t,\n                 UNNEST(t."${this.accessor}") AS u(value)\n            WHERE LOWER(CAST(u.value AS VARCHAR)) LIKE LOWER('%${e}%')\n          ),\n          ranked AS (\n            SELECT value,\n                   LOWER(value) AS lower_value,\n                   COUNT(*) OVER() AS total_count\n            FROM values\n          )\n          SELECT value AS "${this.accessor}",\n                 value AS id,\n                 total_count\n          FROM ranked\n          ORDER BY ${this._buildOrderByClause("lower_value",e)},\n                   value\n          LIMIT ${n}\n        `;return this._executeQuery(t)}const t=`\n        WITH values AS (\n          SELECT DISTINCT CAST("${this.accessor}" AS VARCHAR) AS value\n          FROM ${this.tableName}\n          WHERE ${i}\n        ),\n        ranked AS (\n          SELECT value,\n                 LOWER(value) AS lower_value,\n                 COUNT(*) OVER() AS total_count\n          FROM values\n        )\n        SELECT value AS "${this.accessor}",\n               value AS id,\n               total_count\n        FROM ranked\n        ORDER BY ${this._buildOrderByClause("lower_value",e)},\n                 value\n        LIMIT ${n}\n      `;return this._executeQuery(t)}if(this._isNullSearch(e)){const t=`\n        SELECT *,\n               COUNT(*) OVER() AS total_count\n        FROM ${this.tableName}\n        WHERE ${i}\n        ORDER BY ${this._buildOrderByClause("",e)}\n        LIMIT ${n}\n      `;return this._executeQuery(t)}const r=`\n      SELECT *,\n             COUNT(*) OVER() AS total_count\n      FROM (\n        SELECT *,\n               ${t(this.accessor)} AS lower_value\n        FROM ${this.tableName}\n        WHERE ${i}\n      ) t\n      ORDER BY ${this._buildOrderByClause("lower_value",e)}\n      LIMIT ${n}\n    `;return this._executeQuery(r)}async _getAllFieldsSuggestions(e){const t=this._getAllFields(),n=this._config.suggestionsLimit??Eq.suggestionsLimit,i=this._buildAllFieldsWhereCondition(e),{fieldCast:r,fieldMatchCondition:o}=this._buildFieldUtilities(e);if(0===t.length)return this._getSingleFieldSuggestions(e);const s=t.map(e=>`WHEN ${o(e)} THEN '${e}'`).join(" ");if(this._isNullSearch(e)){const e=`\n        SELECT *,\n               COUNT(*) OVER() AS total_count,\n               'null' AS matched_value,\n               CASE ${s} END AS matched_field\n        FROM ${this.tableName}\n        WHERE ${i}\n        ORDER BY "${this.accessor}"\n        LIMIT ${n}\n      `;return this._executeQuery(e)}const a=`\n      SELECT *,\n             COUNT(*) OVER() AS total_count\n      FROM (\n        SELECT *,\n               CASE ${s} END AS matched_field,\n               CASE ${t.map(e=>`WHEN ${o(e)} THEN ${r(e)}`).join(" ")} END AS matched_value\n        FROM ${this.tableName}\n        WHERE ${i}\n      ) t\n      ORDER BY ${this._buildOrderByClause("matched_value",e)}\n      LIMIT ${n}\n    `;return this._executeQuery(a)}async _getSearchItems(e){var t,n;if(!this._isDataFetched||0===(null==(t=this._internalApi.summary.pointsSummary)?void 0:t.length))return this._currentSearchResults=[],this._totalResultsCount=0,this._updateResultsCounter(),[];const i=await this._getSuggestions(e),r=(null==i?void 0:i.toArray())??[];this._currentSearchResults=r;const o=null==(n=r[0])?void 0:n.total_count;return this._totalResultsCount="number"==typeof o?o:r.length,this._updateResultsCounter(),this._currentSearchResults}_createAccessorButton(){const e=document.createElement("div");return e.classList.add(Tq),e.dataset.ignoreFocus="true",e.textContent=this._getSelectedFieldLabel(),e.onclick=()=>{this._accessorsMenu&&(this._accessorsMenu.classList.contains(Iq)?this._accessorsMenu.classList.remove(Iq):this._accessorsMenu.classList.add(Iq))},e}_createFooter(){const e=document.createElement("div");e.classList.add("style_module_selectAllContainer__1bed75df");const t=document.createElement("button");t.classList.add("style_module_selectAllButton__1bed75df"),t.textContent="select found results",t.onclick=async e=>{e.stopPropagation(),await this._handleSelectAllClick()},this._resultsCounter=document.createElement("span"),this._resultsCounter.classList.add("style_module_resultsCounter__1bed75df"),this._resultsCounter.textContent=this._getResultsCountText(),e.appendChild(t);const n=document.createElement("span");return n.classList.add(Rq),n.textContent="  ",e.appendChild(n),e.appendChild(this._resultsCounter),e}_getResultsCountText(){const e=this._totalResultsCount,t=this._currentSearchResults.length,n=(e,t,n=`${t}s`)=>1===e?t:n;return e===t?`${P$(e)} ${n(e,"result")} found`:`${P$(t)} of ${P$(e)} ${n(e,"result")} shown`}_updateResultsCounter(){this._resultsCounter&&(this._resultsCounter.textContent=this._getResultsCountText())}async _handleSelectAllClick(){var e,t,n;if(0!==this._currentSearchResults.length&&this._currentSearchInput)try{const{config:i}=this._internalApi,r=i.pointIndexBy,o=this._isAllFieldsSelected()?this._buildAllFieldsWhereCondition(this._currentSearchInput):this._buildSingleFieldWhereCondition(this._currentSearchInput),s=`\n        SELECT DISTINCT "${r}" as point_index\n        FROM ${this.tableName}\n        WHERE ${o}\n      `,a=await this._executeQuery(s),l=((null==a?void 0:a.toArray())??[]).map(e=>e.point_index);null==(e=this._client)||e.applyFilter(ME(RS(this._internalApi.config.pointIndexBy),l)),this._enterFilterActive=!0,null==(n=(t=this._config).onSelectAll)||n.call(t,l),this._uiComponent.hideSuggestions()}catch(qe){this._uiComponent.hideSuggestions()}}_createAccessorsMenu(){const e=document.createElement("ul");return e.dataset.ignoreFocus="true",e.classList.add("style_module_accessorsMenu__1bed75df"),this._config.openListUpwards&&e.classList.add(kq),e}_handleClickOutside(e){var t;this._accessorsMenu&&this._accessorsMenu.classList.contains(Iq)&&!(null==(t=this._accessorButton)?void 0:t.contains(e.target))&&!this._accessorsMenu.contains(e.target)&&this._accessorsMenu.classList.remove(Iq)}_createPlaceholderElement(){if(!this._placeholderElement){this._placeholderElement=document.createElement("div"),this._placeholderElement.classList.add(Cq),this._config.showAccessorsMenu&&(this._accessorsMenu=this._createAccessorsMenu(),this._accessorButton=this._createAccessorButton(),this._placeholderElement.appendChild(this._accessorButton),this._placeholderElement.appendChild(this._accessorsMenu),document.addEventListener("click",this._clickOutsideHandler));const e=document.createElement("div");e.classList.add(Aq),e.innerHTML=this._config.placeholderText??"Search...",this._calculateDisabledState()&&e.classList.add(Lq),e.onclick=()=>{this._calculateDisabledState()||this._uiComponent.focus()},this._placeholderElement.appendChild(e)}return this._placeholderElement}_updateAccessorButton(){if(this._accessorButton){const e=this._getSelectedFieldLabel();this._accessorButton.textContent=e,this._accessorButton.title=e}}_findPlaceholderElement(){if(!this._placeholderElement){const e=`.${Cq}`,t=document.querySelector(e);if(!t)return;this._placeholderElement=t,this._accessorButton=t.querySelector(`.${Tq}`),this._config.showAccessorsMenu&&!this._accessorsMenu&&(this._accessorsMenu=this._createAccessorsMenu(),this._placeholderElement.appendChild(this._accessorsMenu))}}_updatePlaceholderDisabledState(){if(!this._placeholderElement)return;const e=this._placeholderElement.querySelector(`.${Aq}`);e&&(this._calculateDisabledState()?e.classList.add(Lq):e.classList.remove(Lq))}async _updateAccessorsMenu(){var e;if(!this._config.showAccessorsMenu||!this._accessorsMenu)return;const{config:t}=this._internalApi;if(!this._internalApi.summary.pointsSummary)return;this._config.openListUpwards?this._accessorsMenu.classList.add(kq):this._accessorsMenu.classList.remove(kq);const n=null==(e=this._internalApi.summary.pointsSummary)?void 0:e.map(e=>String(e.column_name)).filter(e=>e!==t.pointIndexBy);this._accessorsMenu.innerHTML="";const i=document.createElement("div");i.classList.add("style_module_accessorsMenuPlaceholder__1bed75df"),i.textContent="Select field to search",this._accessorsMenu.appendChild(i),this._accessorsMenu.appendChild(this._createAccessorItem(r.ALL_FIELDS_TOKEN,r.ALL_FIELDS_LABEL)),n.forEach(e=>{const t=this._createAccessorItem(e);this._accessorsMenu.appendChild(t)})}_createAccessorItem(e,t){const n=document.createElement("li"),i=document.createElement("div"),r=t??e;return i.textContent=r,i.title=r,i.onclick=t=>this._handleAccessorClick(e,t),n.onclick=t=>this._handleAccessorClick(e,t),n.appendChild(i),n}async _handleAccessorClick(e,t){t.stopPropagation(),e===r.ALL_FIELDS_TOKEN?this._isAllFieldsSelected()||(this._selectedSearchField=r.ALL_FIELDS_TOKEN,this._updateAccessorButton(),this._uiComponent.clearInput(),await this.onConfigUpdate()):(this._config.accessor!==e||this._isAllFieldsSelected())&&(this._selectedSearchField=e,this._config.accessor=e,this._updateAccessorButton(),this._uiComponent.clearInput(),await this.onConfigUpdate(),this._client&&await this._client.getCurrentData()),this._accessorsMenu&&this._accessorsMenu.classList.remove(Iq)}_renderSuggestionField(e,t,n,i,r){const o=void 0!==t[n]&&null!==t[n],s=(null===t[n]||void 0===t[n])&&this._isNullSearch(this._currentSearchInput);if(o||s){const o=r[n];let s=this._valueAccessor(t,n);const a=this._config.suggestionTruncationLength??Eq.suggestionTruncationLength;if(a>0&&this._currentSearchInput&&s.length>a&&(s=this._truncateAroundMatch(s,this._currentSearchInput,a)),i>0){const t=document.createElement("div");t.classList.add(Rq),t.innerHTML="  ",e.appendChild(t)}const l=document.createElement("span"),c=document.createElement("b");c.textContent=`${o}: `,l.appendChild(c);const u=document.createElement("span");let d;if(i>0&&this._config.suggestionFieldsPalette&&this._config.suggestionFieldsPalette.length>0){const e=(i-1)%this._config.suggestionFieldsPalette.length;d=this._config.suggestionFieldsPalette[e],l.style.color=d??"inherit"}if(this._isAllFieldsSelected()?this._currentSearchInput&&(this._isNullSearch(this._currentSearchInput)?"null"===s.toLowerCase():s.toLowerCase().includes(this._currentSearchInput.toLowerCase())):n===this.accessor){const e=this._uiComponent.getHighlightedMatch(s);u.innerHTML=d?e.replace(/<mark[^>]*>/g,`<mark style="color: ${d}">`):e}else u.textContent=s;l.appendChild(u),e.appendChild(l)}}_renderSuggestion(e){const t=this._getEffectiveSuggestionFields();if(!t){let t=this._valueAccessor(e);const n=this._config.suggestionTruncationLength??Eq.suggestionTruncationLength;return n>0&&this._currentSearchInput&&t.length>n&&(t=this._truncateAroundMatch(t,this._currentSearchInput,n)),t}const n=document.createElement("div");n.classList.add("style_module_searchResult__1bed75df");const i={...t};let r=Object.keys(i);i[this.accessor]?r[0]!==this.accessor&&(r=r.filter(e=>e!==this.accessor),r.unshift(this.accessor)):(i[this.accessor]=this.accessor,r.unshift(this.accessor));const o=document.createElement("span");return o.classList.add("style_module_searchResultMultiField__1bed75df"),r.forEach((t,n)=>{this._renderSuggestionField(o,e,t,n,i)}),n.appendChild(o),n}createComponentConfig(e){return{...e,onEnter:async(...e)=>{var t,n,i;const[,r]=e;Array.isArray(r)&&r.length>0?await this._handleSelectAllClick():(null==(t=this._client)||t.resetFilter(),this._enterFilterActive=!1),this._uiComponent.hideSuggestions(),Array.isArray(r)&&r.splice(0,r.length),null==(i=(n=this._config).onEnter)||i.call(n,...e)},onInput:(...e)=>{var t,n;const[i]=e;this._currentSearchInput=i,null==(n=(t=this._config).onInput)||n.call(t,...e)},onSelect:(...e)=>{var t,n;this._enterFilterActive=!1,this.onSelect(e[0]),null==(n=(t=this._config).onSelect)||n.call(t,e[0])},onClear:()=>{var e,t;this._enterFilterActive=!1,this.onSelect(void 0),null==(t=(e=this._config).onClear)||t.call(e)},disabled:this._calculateDisabledState(),searchFn:async(...e)=>await this._getSearchItems(e[0]),suggestionRenderer:e=>this._renderSuggestion(e),selectedSuggestionRenderer:e=>{let t=this._valueAccessor(e);const n=this._config.suggestionTruncationLength??Eq.suggestionTruncationLength;return n>0&&this._currentSearchInput&&t.length>n&&(t=this._truncateAroundMatch(t,this._currentSearchInput,n)),t},placeholderRenderer:this._createPlaceholderElement(),footerComponent:this._config.showFooter?this._createFooter():void 0}}remove(){document.removeEventListener("click",this._clickOutsideHandler),this._accessorButton&&(this._accessorButton.onclick=null),this._uiComponent.destroy(),this._accessorsMenu=null,this._placeholderElement=null,this._accessorButton=null,this._resultsCounter=null,this._currentSearchResults=[],this._totalResultsCount=0,super.remove()}onDataFiltered(){this._enterFilterActive||super.onDataFiltered()}hideSuggestions(){this.checkReady(()=>this.hideSuggestions())&&this._uiComponent.hideSuggestions()}clearInput(){this.checkReady(()=>this.clearInput())&&this._uiComponent.clearInput()}focus(){this.checkReady(()=>this.focus())&&this._uiComponent.focus()}blur(){this.checkReady(()=>this.blur())&&this._uiComponent.blur()}},s(r,"ALL_FIELDS_TOKEN","__all_fields__"),s(r,"ALL_FIELDS_LABEL","all fields"),r);const Mq={useLinksData:!1,selectOnClick:!0,highlightSelectedData:!0},{entries:Dq,setPrototypeOf:Nq,isFrozen:Fq,getPrototypeOf:Oq,getOwnPropertyDescriptor:Bq}=Object;let{freeze:zq,seal:Uq,create:Vq}=Object,{apply:Hq,construct:Wq}="undefined"!=typeof Reflect&&Reflect;zq||(zq=function(e){return e}),Uq||(Uq=function(e){return e}),Hq||(Hq=function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return e.apply(t,i)}),Wq||(Wq=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new e(...n)});const $q=oX(Array.prototype.forEach),Gq=oX(Array.prototype.lastIndexOf),jq=oX(Array.prototype.pop),Yq=oX(Array.prototype.push),qq=oX(Array.prototype.splice),Xq=oX(String.prototype.toLowerCase),Kq=oX(String.prototype.toString),Zq=oX(String.prototype.match),Qq=oX(String.prototype.replace),Jq=oX(String.prototype.indexOf),eX=oX(String.prototype.trim),tX=oX(Object.prototype.hasOwnProperty),nX=oX(RegExp.prototype.test),iX=(rX=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Wq(rX,t)});var rX;function oX(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return Hq(e,t,i)}}function sX(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xq;Nq&&Nq(e,null);let i=t.length;for(;i--;){let r=t[i];if("string"==typeof r){const e=n(r);e!==r&&(Fq(t)||(t[i]=e),r=e)}e[r]=!0}return e}function aX(e){for(let t=0;t<e.length;t++)tX(e,t)||(e[t]=null);return e}function lX(e){const t=Vq(null);for(const[n,i]of Dq(e))tX(e,n)&&(Array.isArray(i)?t[n]=aX(i):i&&"object"==typeof i&&i.constructor===Object?t[n]=lX(i):t[n]=i);return t}function cX(e,t){for(;null!==e;){const n=Bq(e,t);if(n){if(n.get)return oX(n.get);if("function"==typeof n.value)return oX(n.value)}e=Oq(e)}return function(){return null}}const uX=zq(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),dX=zq(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),hX=zq(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),fX=zq(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),pX=zq(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),mX=zq(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),gX=zq(["#text"]),_X=zq(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),yX=zq(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),vX=zq(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),bX=zq(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),xX=Uq(/\{\{[\w\W]*|[\w\W]*\}\}/gm),wX=Uq(/<%[\w\W]*|[\w\W]*%>/gm),SX=Uq(/\$\{[\w\W]*/gm),EX=Uq(/^data-[\-\w.\u00B7-\uFFFF]+$/),CX=Uq(/^aria-[\-\w]+$/),TX=Uq(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),kX=Uq(/^(?:\w+script|data):/i),IX=Uq(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),AX=Uq(/^html$/i),LX=Uq(/^[a-z][.\w]*(-[.\w]+)+$/i);var RX=Object.freeze({__proto__:null,ARIA_ATTR:CX,ATTR_WHITESPACE:IX,CUSTOM_ELEMENT:LX,DATA_ATTR:EX,DOCTYPE_NAME:AX,ERB_EXPR:wX,IS_ALLOWED_URI:TX,IS_SCRIPT_OR_DATA:kX,MUSTACHE_EXPR:xX,TMPLIT_EXPR:SX});var PX=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window;const n=t=>e(t);if(n.version="3.3.1",n.removed=[],!t||!t.document||9!==t.document.nodeType||!t.Element)return n.isSupported=!1,n;let{document:i}=t;const r=i,o=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:l,Element:c,NodeFilter:u,NamedNodeMap:d=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:f,trustedTypes:p}=t,m=c.prototype,g=cX(m,"cloneNode"),_=cX(m,"remove"),y=cX(m,"nextSibling"),v=cX(m,"childNodes"),b=cX(m,"parentNode");if("function"==typeof a){const e=i.createElement("template");e.content&&e.content.ownerDocument&&(i=e.content.ownerDocument)}let x,w="";const{implementation:S,createNodeIterator:E,createDocumentFragment:C,getElementsByTagName:T}=i,{importNode:k}=r;let I={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"==typeof Dq&&"function"==typeof b&&S&&void 0!==S.createHTMLDocument;const{MUSTACHE_EXPR:A,ERB_EXPR:L,TMPLIT_EXPR:R,DATA_ATTR:P,ARIA_ATTR:M,IS_SCRIPT_OR_DATA:D,ATTR_WHITESPACE:N,CUSTOM_ELEMENT:F}=RX;let{IS_ALLOWED_URI:O}=RX,B=null;const z=sX({},[...uX,...dX,...hX,...pX,...gX]);let U=null;const V=sX({},[..._X,...yX,...vX,...bX]);let H=Object.seal(Vq(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),W=null,$=null;const G=Object.seal(Vq(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let j=!0,Y=!0,q=!1,X=!0,K=!1,Z=!0,Q=!1,J=!1,ee=!1,te=!1,ne=!1,ie=!1,re=!0,oe=!1,se=!0,ae=!1,le={},ce=null;const ue=sX({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let de=null;const he=sX({},["audio","video","img","source","image","track"]);let fe=null;const pe=sX({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),me="http://www.w3.org/1998/Math/MathML",ge="http://www.w3.org/2000/svg",_e="http://www.w3.org/1999/xhtml";let ye=_e,ve=!1,be=null;const xe=sX({},[me,ge,_e],Kq);let we=sX({},["mi","mo","mn","ms","mtext"]),Se=sX({},["annotation-xml"]);const Ee=sX({},["title","style","font","a","script"]);let Ce=null;const Te=["application/xhtml+xml","text/html"];let ke=null,Ie=null;const Ae=i.createElement("form"),Le=function(e){return e instanceof RegExp||e instanceof Function},Re=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!Ie||Ie!==e){if(e&&"object"==typeof e||(e={}),e=lX(e),Ce=-1===Te.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,ke="application/xhtml+xml"===Ce?Kq:Xq,B=tX(e,"ALLOWED_TAGS")?sX({},e.ALLOWED_TAGS,ke):z,U=tX(e,"ALLOWED_ATTR")?sX({},e.ALLOWED_ATTR,ke):V,be=tX(e,"ALLOWED_NAMESPACES")?sX({},e.ALLOWED_NAMESPACES,Kq):xe,fe=tX(e,"ADD_URI_SAFE_ATTR")?sX(lX(pe),e.ADD_URI_SAFE_ATTR,ke):pe,de=tX(e,"ADD_DATA_URI_TAGS")?sX(lX(he),e.ADD_DATA_URI_TAGS,ke):he,ce=tX(e,"FORBID_CONTENTS")?sX({},e.FORBID_CONTENTS,ke):ue,W=tX(e,"FORBID_TAGS")?sX({},e.FORBID_TAGS,ke):lX({}),$=tX(e,"FORBID_ATTR")?sX({},e.FORBID_ATTR,ke):lX({}),le=!!tX(e,"USE_PROFILES")&&e.USE_PROFILES,j=!1!==e.ALLOW_ARIA_ATTR,Y=!1!==e.ALLOW_DATA_ATTR,q=e.ALLOW_UNKNOWN_PROTOCOLS||!1,X=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,K=e.SAFE_FOR_TEMPLATES||!1,Z=!1!==e.SAFE_FOR_XML,Q=e.WHOLE_DOCUMENT||!1,te=e.RETURN_DOM||!1,ne=e.RETURN_DOM_FRAGMENT||!1,ie=e.RETURN_TRUSTED_TYPE||!1,ee=e.FORCE_BODY||!1,re=!1!==e.SANITIZE_DOM,oe=e.SANITIZE_NAMED_PROPS||!1,se=!1!==e.KEEP_CONTENT,ae=e.IN_PLACE||!1,O=e.ALLOWED_URI_REGEXP||TX,ye=e.NAMESPACE||_e,we=e.MATHML_TEXT_INTEGRATION_POINTS||we,Se=e.HTML_INTEGRATION_POINTS||Se,H=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&Le(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(H.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Le(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(H.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(H.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),K&&(Y=!1),ne&&(te=!0),le&&(B=sX({},gX),U=[],!0===le.html&&(sX(B,uX),sX(U,_X)),!0===le.svg&&(sX(B,dX),sX(U,yX),sX(U,bX)),!0===le.svgFilters&&(sX(B,hX),sX(U,yX),sX(U,bX)),!0===le.mathMl&&(sX(B,pX),sX(U,vX),sX(U,bX))),e.ADD_TAGS&&("function"==typeof e.ADD_TAGS?G.tagCheck=e.ADD_TAGS:(B===z&&(B=lX(B)),sX(B,e.ADD_TAGS,ke))),e.ADD_ATTR&&("function"==typeof e.ADD_ATTR?G.attributeCheck=e.ADD_ATTR:(U===V&&(U=lX(U)),sX(U,e.ADD_ATTR,ke))),e.ADD_URI_SAFE_ATTR&&sX(fe,e.ADD_URI_SAFE_ATTR,ke),e.FORBID_CONTENTS&&(ce===ue&&(ce=lX(ce)),sX(ce,e.FORBID_CONTENTS,ke)),e.ADD_FORBID_CONTENTS&&(ce===ue&&(ce=lX(ce)),sX(ce,e.ADD_FORBID_CONTENTS,ke)),se&&(B["#text"]=!0),Q&&sX(B,["html","head","body"]),B.table&&(sX(B,["tbody"]),delete W.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw iX('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw iX('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');x=e.TRUSTED_TYPES_POLICY,w=x.createHTML("")}else void 0===x&&(x=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(n=t.getAttribute(i));const r="dompurify"+(n?"#"+n:"");try{return e.createPolicy(r,{createHTML:e=>e,createScriptURL:e=>e})}catch(o){return null}}(p,o)),null!==x&&"string"==typeof w&&(w=x.createHTML(""));zq&&zq(e),Ie=e}},Pe=sX({},[...dX,...hX,...fX]),Me=sX({},[...pX,...mX]),De=function(e){Yq(n.removed,{element:e});try{b(e).removeChild(e)}catch(t){_(e)}},Ne=function(e,t){try{Yq(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(i){Yq(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(te||ne)try{De(t)}catch(i){}else try{t.setAttribute(e,"")}catch(i){}},Fe=function(e){let t=null,n=null;if(ee)e="<remove></remove>"+e;else{const t=Zq(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===Ce&&ye===_e&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const r=x?x.createHTML(e):e;if(ye===_e)try{t=(new f).parseFromString(r,Ce)}catch(s){}if(!t||!t.documentElement){t=S.createDocument(ye,"template",null);try{t.documentElement.innerHTML=ve?w:r}catch(s){}}const o=t.body||t.documentElement;return e&&n&&o.insertBefore(i.createTextNode(n),o.childNodes[0]||null),ye===_e?T.call(t,Q?"html":"body")[0]:Q?t.documentElement:o},Oe=function(e){return E.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},Be=function(e){return e instanceof h&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof d)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},ze=function(e){return"function"==typeof l&&e instanceof l};function Ue(e,t,i){$q(e,e=>{e.call(n,t,i,Ie)})}const Ve=function(e){let t=null;if(Ue(I.beforeSanitizeElements,e,null),Be(e))return De(e),!0;const i=ke(e.nodeName);if(Ue(I.uponSanitizeElement,e,{tagName:i,allowedTags:B}),Z&&e.hasChildNodes()&&!ze(e.firstElementChild)&&nX(/<[/\w!]/g,e.innerHTML)&&nX(/<[/\w!]/g,e.textContent))return De(e),!0;if(7===e.nodeType)return De(e),!0;if(Z&&8===e.nodeType&&nX(/<[/\w]/g,e.data))return De(e),!0;if(!(G.tagCheck instanceof Function&&G.tagCheck(i))&&(!B[i]||W[i])){if(!W[i]&&We(i)){if(H.tagNameCheck instanceof RegExp&&nX(H.tagNameCheck,i))return!1;if(H.tagNameCheck instanceof Function&&H.tagNameCheck(i))return!1}if(se&&!ce[i]){const t=b(e)||e.parentNode,n=v(e)||e.childNodes;if(n&&t)for(let i=n.length-1;i>=0;--i){const r=g(n[i],!0);r.__removalCount=(e.__removalCount||0)+1,t.insertBefore(r,y(e))}}return De(e),!0}return e instanceof c&&!function(e){let t=b(e);t&&t.tagName||(t={namespaceURI:ye,tagName:"template"});const n=Xq(e.tagName),i=Xq(t.tagName);return!!be[e.namespaceURI]&&(e.namespaceURI===ge?t.namespaceURI===_e?"svg"===n:t.namespaceURI===me?"svg"===n&&("annotation-xml"===i||we[i]):Boolean(Pe[n]):e.namespaceURI===me?t.namespaceURI===_e?"math"===n:t.namespaceURI===ge?"math"===n&&Se[i]:Boolean(Me[n]):e.namespaceURI===_e?!(t.namespaceURI===ge&&!Se[i])&&!(t.namespaceURI===me&&!we[i])&&!Me[n]&&(Ee[n]||!Pe[n]):!("application/xhtml+xml"!==Ce||!be[e.namespaceURI]))}(e)?(De(e),!0):"noscript"!==i&&"noembed"!==i&&"noframes"!==i||!nX(/<\/no(script|embed|frames)/i,e.innerHTML)?(K&&3===e.nodeType&&(t=e.textContent,$q([A,L,R],e=>{t=Qq(t,e," ")}),e.textContent!==t&&(Yq(n.removed,{element:e.cloneNode()}),e.textContent=t)),Ue(I.afterSanitizeElements,e,null),!1):(De(e),!0)},He=function(e,t,n){if(re&&("id"===t||"name"===t)&&(n in i||n in Ae))return!1;if(Y&&!$[t]&&nX(P,t));else if(j&&nX(M,t));else if(G.attributeCheck instanceof Function&&G.attributeCheck(t,e));else if(!U[t]||$[t]){if(!(We(e)&&(H.tagNameCheck instanceof RegExp&&nX(H.tagNameCheck,e)||H.tagNameCheck instanceof Function&&H.tagNameCheck(e))&&(H.attributeNameCheck instanceof RegExp&&nX(H.attributeNameCheck,t)||H.attributeNameCheck instanceof Function&&H.attributeNameCheck(t,e))||"is"===t&&H.allowCustomizedBuiltInElements&&(H.tagNameCheck instanceof RegExp&&nX(H.tagNameCheck,n)||H.tagNameCheck instanceof Function&&H.tagNameCheck(n))))return!1}else if(fe[t]);else if(nX(O,Qq(n,N,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==Jq(n,"data:")||!de[e])if(q&&!nX(D,Qq(n,N,"")));else if(n)return!1;return!0},We=function(e){return"annotation-xml"!==e&&Zq(e,F)},$e=function(e){Ue(I.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||Be(e))return;const i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:U,forceKeepAttr:void 0};let r=t.length;for(;r--;){const s=t[r],{name:a,namespaceURI:l,value:c}=s,u=ke(a),d=c;let h="value"===a?d:eX(d);if(i.attrName=u,i.attrValue=h,i.keepAttr=!0,i.forceKeepAttr=void 0,Ue(I.uponSanitizeAttribute,e,i),h=i.attrValue,!oe||"id"!==u&&"name"!==u||(Ne(a,e),h="user-content-"+h),Z&&nX(/((--!?|])>)|<\/(style|title|textarea)/i,h)){Ne(a,e);continue}if("attributename"===u&&Zq(h,"href")){Ne(a,e);continue}if(i.forceKeepAttr)continue;if(!i.keepAttr){Ne(a,e);continue}if(!X&&nX(/\/>/i,h)){Ne(a,e);continue}K&&$q([A,L,R],e=>{h=Qq(h,e," ")});const f=ke(e.nodeName);if(He(f,u,h)){if(x&&"object"==typeof p&&"function"==typeof p.getAttributeType)if(l);else switch(p.getAttributeType(f,u)){case"TrustedHTML":h=x.createHTML(h);break;case"TrustedScriptURL":h=x.createScriptURL(h)}if(h!==d)try{l?e.setAttributeNS(l,a,h):e.setAttribute(a,h),Be(e)?De(e):jq(n.removed)}catch(o){Ne(a,e)}}else Ne(a,e)}Ue(I.afterSanitizeAttributes,e,null)},Ge=function e(t){let n=null;const i=Oe(t);for(Ue(I.beforeSanitizeShadowDOM,t,null);n=i.nextNode();)Ue(I.uponSanitizeShadowNode,n,null),Ve(n),$e(n),n.content instanceof s&&e(n.content);Ue(I.afterSanitizeShadowDOM,t,null)};return n.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=null,o=null,a=null,c=null;if(ve=!e,ve&&(e="\x3c!--\x3e"),"string"!=typeof e&&!ze(e)){if("function"!=typeof e.toString)throw iX("toString is not a function");if("string"!=typeof(e=e.toString()))throw iX("dirty is not a string, aborting")}if(!n.isSupported)return e;if(J||Re(t),n.removed=[],"string"==typeof e&&(ae=!1),ae){if(e.nodeName){const t=ke(e.nodeName);if(!B[t]||W[t])throw iX("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof l)i=Fe("\x3c!----\x3e"),o=i.ownerDocument.importNode(e,!0),1===o.nodeType&&"BODY"===o.nodeName||"HTML"===o.nodeName?i=o:i.appendChild(o);else{if(!te&&!K&&!Q&&-1===e.indexOf("<"))return x&&ie?x.createHTML(e):e;if(i=Fe(e),!i)return te?null:ie?w:""}i&&ee&&De(i.firstChild);const u=Oe(ae?e:i);for(;a=u.nextNode();)Ve(a),$e(a),a.content instanceof s&&Ge(a.content);if(ae)return e;if(te){if(ne)for(c=C.call(i.ownerDocument);i.firstChild;)c.appendChild(i.firstChild);else c=i;return(U.shadowroot||U.shadowrootmode)&&(c=k.call(r,c,!0)),c}let d=Q?i.outerHTML:i.innerHTML;return Q&&B["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&nX(AX,i.ownerDocument.doctype.name)&&(d="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+d),K&&$q([A,L,R],e=>{d=Qq(d,e," ")}),x&&ie?x.createHTML(d):d},n.setConfig=function(){Re(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),J=!0},n.clearConfig=function(){Ie=null,J=!1},n.isValidAttribute=function(e,t,n){Ie||Re({});const i=ke(e),r=ke(t);return He(i,r,n)},n.addHook=function(e,t){"function"==typeof t&&Yq(I[e],t)},n.removeHook=function(e,t){if(void 0!==t){const n=Gq(I[e],t);return-1===n?void 0:qq(I[e],n,1)[0]}return jq(I[e])},n.removeHooks=function(e){I[e]=[]},n.removeAllHooks=function(){I={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}();const MX={content:"",bindTo:void 0,placement:"top",offset:[0,8],hidden:!0};var DX="style_module_visible__d19738e9";kY(".style_module_popup__d19738e9{box-shadow:0 2px 8px rgba(0,0,0,.15);opacity:0;pointer-events:auto;position:absolute;transition:opacity .15s ease,visibility .15s ease;visibility:hidden;z-index:1}.style_module_visible__d19738e9{opacity:1;transition:opacity .4s ease,visibility .4s ease;visibility:visible}",{});let NX=class{constructor(e,t){s(this,"_internalApi"),s(this,"_config"),s(this,"_popupContent"),s(this,"_popupElement"),s(this,"_isVisible",!1),s(this,"_lastBindId"),s(this,"_lastBindIndex"),s(this,"_initialize",()=>{this._popupElement=this._internalApi.popupElement,this._initializePopupContent(),requestAnimationFrame(()=>this.setConfig(this._config)),this._internalApi.addEventListener("onSimulationTick",this._render),this._internalApi.addEventListener("onZoom",this._render),this._internalApi.addEventListener("onDrag",this._render),this._internalApi.addEventListener("reset",this._reset),this._internalApi.addEventListener("graphRebuilt",this._reset)}),s(this,"_initializePopupContent",()=>{this._popupContent||(this._popupContent=document.createElement("div"),this._popupContent.classList.add("style_module_popup__d19738e9"),this._popupElement.appendChild(this._popupContent))}),s(this,"_updatePosition",()=>{const{bindTo:e}=this._config;this._internalApi.cosmosInitialized&&void 0!==e&&("number"==typeof e?this._showOnPointIndex(e):"string"==typeof e?this._showOnPointId(e):Array.isArray(e)&&this._showAt(e))}),s(this,"_render",()=>{this._isVisible&&this._updatePosition()}),s(this,"_removePopupContent",()=>{var e;this._isVisible=!1,null==(e=this._popupContent)||e.remove(),this._popupContent=void 0}),s(this,"_reset",()=>{this._lastBindId=void 0,this._lastBindIndex=void 0,this._render()}),s(this,"remove",()=>{this._lastBindId=void 0,this._lastBindIndex=void 0,this._internalApi.removeEventListener("onSimulationTick",this._render),this._internalApi.removeEventListener("onZoom",this._render),this._internalApi.removeEventListener("onDrag",this._render),this._internalApi.removeEventListener("reset",this._reset),this._internalApi.removeEventListener("graphRebuilt",this._reset),this.hide(),this._popupContent&&this._popupContent.addEventListener("transitionend",()=>this._removePopupContent(),{once:!0})}),this._internalApi=MY(e),this._config={...MX,...t},this._initialize()}_showAt(e){var t,n;const i=PX.sanitize(this._config.content??"",{USE_PROFILES:{html:!0}});if(!this._popupContent)return;this._popupContent.innerHTML=i,this._popupContent.style.display="block";const{placement:r="bottom",offset:o=[0,8]}=this._config,s=null==(t=this._popupContent)?void 0:t.offsetWidth,a=null==(n=this._popupContent)?void 0:n.offsetHeight,l=this._internalApi.public.spaceToScreenPosition(e);if(!l)return this._removePopupContent();const[c,u]=l,d=c-s/2+o[0],h="bottom"===r?u+o[1]:u-a-o[1];this._popupContent.style.left=`${d}px`,this._popupContent.style.top=`${h}px`,this._popupContent.style.display="block"}_showOnPointIndex(e){const{placement:t}=this._config;this._internalApi.configManager.configUpdated().then(async()=>{const n=this._internalApi.public.getPointPositionByIndex(e);if(!n)return this._removePopupContent();const[i,r]=n;if(null==i||null==r)return this._removePopupContent();const o=this._internalApi.public.getPointScreenRadiusByIndex(e)/2/this._internalApi.public.getZoomLevel(),s=r+("bottom"===t?-o:o);this._showAt([i,s])})}_showOnPointId(e){this._lastBindId!==e||void 0===this._lastBindIndex?this._internalApi.configManager.cosmosInitialized().then(async()=>{const t=await this._internalApi.public.getPointIndicesByIds([e]);if(!t||void 0===t[0])return this._removePopupContent();const n=t[0];this._lastBindId=e,this._lastBindIndex=n,this._showOnPointIndex(n)}):this._showOnPointIndex(this._lastBindIndex)}setConfig(e){this._config={...this._config,...e},this._config.hidden||this._updatePosition(),void 0!==(null==e?void 0:e.hidden)&&(this._config.hidden?this.hide():this._config.hidden||this.show())}hide(){var e;this._isVisible&&(this._isVisible=!1,null==(e=this._popupContent)||e.classList.remove(DX))}show(){var e;this._isVisible||(this._isVisible=!0,null==(e=this._popupContent)||e.classList.add(DX))}};const FX={useLinksData:!1,hideWhenSizeMoreThan:120,selectOnClick:!0,useQuantiles:!0,minSubLabel:"and less",maxSubLabel:"and more"};var OX="style_module_selected__91af67ac",BX="style_module_unselected__91af67ac";kY(".style_module_selected__91af67ac{filter:brightness(1.2)}.style_module_unselected__91af67ac{filter:brightness(.5);opacity:.7}",{});const zX={useLinksData:!1,selectOnClick:!0,steps:10,overrideColors:void 0,useQuantiles:!0,useDiscreteColors:!1,minSubLabel:"and less",maxSubLabel:"and more"};var UX="style_module_selected__12a865d0",VX="style_module_unselected__12a865d0";kY(".style_module_selected__12a865d0{filter:brightness(1.2)}.style_module_unselected__12a865d0{filter:brightness(.5);opacity:.7}",{});const HX={0:"source",1:"source+target",2:"target",3:"not linked"},WX=Object.fromEntries(Object.entries(HX).map(([e,t])=>[t,e])),$X={useLinksData:!1,selectOnClick:!0,hideUnknown:!0,resetSelectionOnCollapse:!0,showLabel:!1},GX={onClick:void 0,iconSvg:'\n<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n  <path d="m21 21-6-6m6 6v-4.8m0 4.8h-4.8"/>\n  <path d="M3 16.2V21m0 0h4.8M3 21l6-6"/>\n  <path d="M21 7.8V3m0 0h-4.8M21 3l-6 6"/>\n  <path d="M3 7.8V3m0 0h4.8M3 3l6 6"/>\n</svg>\n',duration:250,padding:.1,description:"Fit view"},jX='\n<svg width="100%" height="100%" viewBox="0 0 15 18" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M15 9L-8.15666e-07 17.6603L-5.85621e-08 0.339745L15 9Z"/>\n</svg>',YX={onClick:void 0,iconSvg:jX,description:"Play/Pause"},qX={onClick:void 0,iconSvg:'\n<svg width="100%" height="100%" viewBox="0 0 96 96" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-miterlimit:2;">\n    <style type="text/css">\n        .st0{fill:none;fill-rule:nonzero;stroke:currentColor;stroke-width:8px;}\n    </style>\n    <g>\n        <path d="M92.8,71.003L92.8,83.2L75.058,83.2" class="st0"/>\n        <path d="M65.014,83.2L34.968,83.2" class="st0"/>\n        <path d="M24.994,83.2L4,83.2L4,71.003" class="st0"/>\n        <path d="M4,60.954L4,35.036" class="st0"/>\n        <path d="M4,25.06L4,11.8L24.994,11.8" class="st0"/>\n        <path d="M34.968,11.8L65.014,11.8" class="st0"/>\n        <path d="M75.058,11.8L92.8,11.8L92.8,25.06" class="st0"/>\n        <path d="M92.8,35.036L92.8,60.954" class="st0"/>\n    </g>\n</svg>\n',description:"Rectangle selection"},XX={onClick:void 0,iconSvg:'\n<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" transform="scale(1.15)"><path fill="currentColor" fill-rule="evenodd" d="M21.72.226a1 1 0 0 1 .587.936l-.336 13.583a1 1 0 0 1-.685.924l-8.893 2.948a2.6 2.6 0 0 1-.028.692a2.93 2.93 0 0 1 1.429 1.495c.342.792.33 1.645.198 2.267a1 1 0 0 1-1.956-.417c.07-.328.06-.739-.078-1.056c-.098-.226-.27-.444-.655-.565l-.064.05c-.667.512-1.545.8-2.475.8s-1.808-.288-2.476-.8c-.668-.511-1.165-1.289-1.165-2.224s.497-1.712 1.165-2.224q.232-.178.495-.318L1.782 5.237a1 1 0 0 1 1.092-1.394l11.694 2.146L20.63.402a1 1 0 0 1 1.09-.176m-1.73 13.766l-8.53 2.828a3 3 0 0 0-.22-.185c-.668-.511-1.546-.799-2.476-.799H8.76L4.39 6.154l10.308 1.892a1 1 0 0 0 .859-.248l4.692-4.326zm-12.485 4.23c-.288.22-.382.455-.382.637s.094.416.382.637c.288.22.73.386 1.259.386s.97-.165 1.259-.386c.288-.22.382-.455.382-.637s-.094-.416-.382-.637c-.289-.22-.73-.386-1.26-.386s-.97.165-1.258.386" clip-rule="evenodd"/></svg>\n',description:"Polygonal selection"},KX={onZoomInClick:void 0,onZoomOutClick:void 0,zoomInIconSvg:'\n<svg width="100%" height="100%" viewBox="0 0 24 24" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4 12H20M12 4V20" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',zoomOutIconSvg:'\n<svg width="100%" height="100%" viewBox="0 0 24 24" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4 12H20" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n',duration:250,zoomIncrement:1.4};var ZX="style_module_zoomButton__738b35dc";kY(".style_module_zoomButtons__738b35dc{height:50px;margin:3px;width:25px}.style_module_zoomButton__738b35dc{height:50%;margin:0;width:100%}.style_module_zoomInButton__738b35dc{border-radius:2px 2px 0 0}.style_module_zoomOutButton__738b35dc{border-radius:0 0 2px 2px}",{});const QX=x.memo(x.forwardRef(function({style:e,className:t,onMount:n,duckDBConnection:i,...r},o){const s=Ea(),a=b.useRef(null),l=b.useRef(),c=b.useRef(!1),u=b.useRef(!1),[d,h]=b.useState(!1);return c.current&&(u.current=!0),b.useEffect(()=>{if(!c.current&&a.current){const e=new uq(a.current,r,i);l.current=e,c.current=!0,null==s||s.initCosmograph(l.current),h(!0),n&&n(l.current)}return()=>{var e;u.current&&(null==(e=l.current)||e.destroy(),h(!1))}},[]),b.useEffect(()=>{(async()=>{l.current&&d&&await l.current.setConfig(r)})()},[r,d]),b.useImperativeHandle(o,()=>l.current,[d]),x.createElement("div",{style:e,className:t,ref:a})})),JX={display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",opacity:.25,fontSize:12,fontWeight:300,whiteSpace:"pre-wrap"},eK=(e,t,n=new Set)=>{if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;if(n.has(e))return!0;n.add(e);for(let i=0;i<e.length;i++)if(!eK(e[i],t[i],n))return!1;return!0}if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if("function"==typeof e&&"function"==typeof t)return e.toString()===t.toString();if("object"==typeof e&&null!==e&&null!==t){if("object"!=typeof t)return!1;if(e===t)return!0;if(Object.keys(e).length!==Object.keys(t).length)return!1;if(n.has(e))return!0;n.add(e);for(const i in e)if(!eK(e[i],t[i],n))return!1;return!0}return e===t};function tK(e){const t=e.name,n=x.forwardRef((n,i)=>{const r=Ea(),o=b.useRef(null),s=b.useRef(),a=b.useRef({}),[l,c]=b.useState(!1);return b.useEffect(()=>{if(o.current&&(null==r?void 0:r.cosmograph)){const{style:t,className:i,...l}=n;s.current=new e(r.cosmograph,o.current,l),a.current=n,c(!0)}return()=>{var e,t;null==(t=null==(e=s.current)?void 0:e.remove)||t.call(e)}},[null==r?void 0:r.cosmograph]),b.useEffect(()=>{var e,t;if(!eK(n,a.current)){const{style:i,className:r,...o}=n;null==(t=null==(e=s.current)?void 0:e.setConfig)||t.call(e,o),a.current=n}},[n]),b.useImperativeHandle(i,()=>s.current,[l]),r?x.createElement("div",{id:t,style:n.style,className:n.className,ref:o}):x.createElement("div",{style:n.style,className:n.className},x.createElement("div",{style:JX}," ",x.createElement("b",null,t)," should be used under ",x.createElement("b",null,"CosmographProvider")))});return n.displayName=t,x.memo(n)}tK(Pq),tK(class extends FY{constructor(){super(...arguments),s(this,"_dataExtent"),s(this,"_visualExtent")}getCurrentSelection(){if(this.checkReady(()=>this.getCurrentSelection()))return this._uiComponent.getCurrentSelection()}getCurrentSelectionInPixels(){if(this.checkReady(()=>this.getCurrentSelectionInPixels()))return this._uiComponent.getCurrentSelectionInPixels()}getBarWidth(){if(this.checkReady(()=>this.getBarWidth()))return this._uiComponent.getBarWidth()}setSelection(e){var t,n,i;this.checkReady(()=>this.setSelection(e))&&(this._uiComponent.setSelection(e,!0),null==(t=this._client)||t.applyRangeFilter(e),null==(i=(n=this._config).onSelection)||i.call(n,e,!0))}getIsAnimationRunning(){return!!this.checkReady(()=>this.getIsAnimationRunning())&&this._uiComponent.getIsAnimationRunning()}playAnimation(){this.checkReady(()=>this.playAnimation())&&this._uiComponent.playAnimation()}pauseAnimation(){this.checkReady(()=>this.pauseAnimation())&&this._uiComponent.pauseAnimation()}stopAnimation(){this.checkReady(()=>this.stopAnimation())&&this._uiComponent.stopAnimation()}get defaultConfig(){return xq}get accessor(){return this._config.accessor??xq.accessor}async fetchData(){var e,t;if(await super.fetchData(),this._currentData){const n=null==(t=null==(e=this._currentData)?void 0:e.getChild(this.accessor))?void 0:t.toArray(),i=null==n?void 0:n.map(e=>e instanceof Date?e.getTime():e);this._dataExtent=(null==i?void 0:i.length)?xV(i):void 0;const r=Rj(i??[],this._config.useQuantiles,this._config.customExtent);this._visualExtent=r,this._uiComponent.setTimeData(n,r),this.updateCrossfilteredData()}else this._uiComponent.setTimeData(void 0),this.updateHighlightedData(void 0);this._uiComponent.pauseAnimation()}createUIComponent(e){return new lG(e,this.createComponentConfig(this._config))}createComponentConfig(e){return{...e,formatter:t=>{const n="number"==typeof t?t:t.getTime(),i=((null==e?void 0:e.formatter)??P$)(n);if(!this._config.useQuantiles||!this._dataExtent||!this._visualExtent)return i;const[r,o]=this._visualExtent,[s,a]=this._dataExtent;return n===r&&r>s?`< ${i}`:n===o&&o<a?`> ${i}`:i},onBrush:(e,t)=>{var n,i,r,o;let s=e;if(e&&this._config.useQuantiles&&this._visualExtent&&this._dataExtent){const t=e.map(e=>e instanceof Date?e.getTime():e),[n,i]=t,[r,o]=this._visualExtent,[a,l]=this._dataExtent,c=n===r?a:n,u=i===o?l:i;s=e[0]instanceof Date?[new Date(c),new Date(u)]:[c,u]}const a=null==(n=this._currentData)?void 0:n.getChild(this.accessor),l=s?yN(null==a?void 0:a.type)?null==s?void 0:s.map(e=>+e):s.map(e=>new Date(e)):void 0;null==(i=this._client)||i.applyRangeFilter(l),null==(o=(r=this._config).onSelection)||o.call(r,s,t)},onBarHover:e=>{var t,n;null==(n=(t=this._config).onBarHover)||n.call(t,e)},onAnimationPlay:(e,t)=>{var n,i;null==(i=(n=this._config).onAnimationPlay)||i.call(n,e,t)},onAnimationPause:(e,t)=>{var n,i;null==(i=(n=this._config).onAnimationPause)||i.call(n,e,t)},onAnimationTick:e=>{var t,n;null==(n=(t=this._config).onAnimationTick)||n.call(t,e)}}}onResetClientSelections(){this.setSelection()}updateHighlightedData(e){const{highlightSelectedData:t}=this._config;t&&this._uiComponent.setHighlightedData(e)}async onConfigUpdate(){this._uiComponent.setConfig(this.createComponentConfig(this._config))}}),tK(class extends FY{constructor(){super(...arguments),s(this,"_dataExtent"),s(this,"_visualExtent")}getCurrentSelection(){if(this.checkReady(()=>this.getCurrentSelection()))return this._uiComponent.getCurrentSelection()}getCurrentSelectionInPixels(){if(this.checkReady(()=>this.getCurrentSelectionInPixels()))return this._uiComponent.getCurrentSelectionInPixels()}getBarWidth(){if(this.checkReady(()=>this.getBarWidth()))return this._uiComponent.getBarWidth()}setSelection(e){var t,n,i;this.checkReady(()=>this.setSelection(e))&&(this._uiComponent.setSelection(e,!0),null==(t=this._client)||t.applyRangeFilter(e),null==(i=(n=this._config).onSelection)||i.call(n,e,!0))}get defaultConfig(){return wq}get accessor(){return this._config.accessor??wq.accessor}async fetchData(){var e,t;if(await super.fetchData(),this._currentData){const n=null==(t=null==(e=this._currentData)?void 0:e.getChild(this.accessor))?void 0:t.toArray();this._dataExtent=(null==n?void 0:n.length)?xV(n):void 0;const i=Rj(n??[],this._config.useQuantiles,this._config.customExtent);this._visualExtent=i,this._uiComponent.setHistogramData(n,i),this.updateCrossfilteredData()}else this._uiComponent.setHistogramData(void 0),this.updateHighlightedData(void 0)}createUIComponent(e){return new CG(e,this.createComponentConfig(this._config))}createComponentConfig(e){return{...e,formatter:t=>{const n=((null==e?void 0:e.formatter)??P$)(t);if(!this._config.useQuantiles||!this._dataExtent||!this._visualExtent)return n;const[i,r]=this._visualExtent,[o,s]=this._dataExtent;return t===i&&i>o?`< ${n}`:t===r&&r<s?`> ${n}`:n},onBrush:(e,t)=>{var n,i,r;let o=e;if(e&&this._config.useQuantiles&&this._visualExtent&&this._dataExtent){const[t,n]=e,[i,r]=this._visualExtent,[s,a]=this._dataExtent;o=[t===i?s:t,n===r?a:n]}null==(n=this._client)||n.applyRangeFilter(o),null==(r=(i=this._config).onSelection)||r.call(i,o,t)},onBarHover:e=>{var t,n;null==(n=(t=this._config).onBarHover)||n.call(t,e)}}}updateHighlightedData(e){const{highlightSelectedData:t}=this._config;t&&this._uiComponent.setHighlightedData(e)}onResetClientSelections(){this.setSelection()}async onConfigUpdate(){this._uiComponent.setConfig(this.createComponentConfig(this._config))}}),tK(class extends FY{setSelectedItem(e){var t;this.checkReady(()=>this.setSelectedItem(e))&&(this._uiComponent.setSelectedItem(e),e||null==(t=this._client)||t.resetFilter())}get defaultConfig(){return Mq}get accessor(){return this._config.accessor}onResetClientSelections(){this.setSelectedItem(void 0)}async fetchData(){var e,t;if(await super.fetchData(),this._currentData){this._uiComponent.resetList();const n=this.accessor?((e,t)=>{if(!(null==e?void 0:e.length))return[];const n=[],i=t;for(let r=0;r<e.length;r++){const t=e[r];if(Array.isArray(t))for(let e=0;e<t.length;e++){const r=t[e];null!=r&&n.push(i?i(r):r)}else null!=t&&n.push(i?i(t):t)}return n})(null==(t=null==(e=this._currentData)?void 0:e.getChild(this.accessor))?void 0:t.toArray(),String):[];this._uiComponent.setData(n),this.updateCrossfilteredData()}else this._uiComponent.setData(void 0),this.updateHighlightedData(void 0)}createUIComponent(e){return new AG(e,this.createComponentConfig(this._config))}createComponentConfig(e){return{...e,onClick:e=>{var t,n,i,r,o,s,a,l,c;const u=this._uiComponent.getSelectedItem();e&&(null==u?void 0:u.label)===e.label?(null==(t=this._client)||t.resetFilter(),this.setSelectedItem(void 0),null==(i=(n=this._config).onClick)||i.call(n,void 0)):e?(null==(r=this._client)||r.applyExactFilter(e.label),this.setSelectedItem(e),null==(s=(o=this._config).onClick)||s.call(o,e)):(null==(a=this._client)||a.resetFilter(),this.setSelectedItem(void 0),null==(c=(l=this._config).onClick)||c.call(l,void 0))},onBarHover:e=>{var t,n;null==(n=(t=this._config).onBarHover)||n.call(t,e)}}}async onConfigUpdate(){this._uiComponent.setConfig(this.createComponentConfig(this._config))}updateHighlightedData(e){const{highlightSelectedData:t}=this._config;if(t)if(this._internalApi.crossfilter.isFilteringActive)if(e&&e.length>0){const t=e.map(e=>String(e));this._uiComponent.setHighlightedData(t)}else this._uiComponent.setHighlightedData([]);else this._uiComponent.setHighlightedData(void 0)}});const nK=x.forwardRef((e,t)=>{const n=Ea(),i=b.useRef(),r=b.useRef(e),[o,s]=b.useState(!1);return b.useEffect(()=>((null==n?void 0:n.cosmograph)&&(i.current=new NX(n.cosmograph,e),r.current=e,s(!0)),()=>{var e;null==(e=i.current)||e.remove()}),[null==n?void 0:n.cosmograph]),b.useEffect(()=>{var t;eK(e,r.current)||(null==(t=i.current)||t.setConfig(e),r.current=e)},[e]),b.useImperativeHandle(t,()=>i.current,[o]),n?null:x.createElement("div",{style:JX}," ",x.createElement("b",null,"CosmographPopup")," should be used under ",x.createElement("b",null,"CosmographProvider"))});nK.displayName="CosmographPopup",x.memo(nK),tK(class extends Sq{constructor(){super(...arguments),s(this,"_uiComponentConfig",{}),s(this,"_extent"),s(this,"_manuallyHidden",!1),s(this,"_originalMaxValue",0),s(this,"_pointSizeScaleUpdateHandler"),s(this,"_linkWidthScaleUpdateHandler"),s(this,"_pointSizeUpdateHandler"),s(this,"_linkWidthUpdateHandler"),s(this,"_currentSizeAccessor"),s(this,"_currentExtent"),s(this,"_remapValues",async e=>{const t=await this._getMappingFunction();return t?e.map(e=>+t(e)):e}),s(this,"_getExtentAndRange",async()=>{const e=await this._calculateExtent();return!e||isNaN(null==e?void 0:e[0])||isNaN(null==e?void 0:e[1])?{extent:void 0,range:void 0}:{extent:e,range:await this._calculateRange(e)}}),s(this,"_onSizeScaleUpdated",async()=>{await this._updateLegend()}),s(this,"_onSizeUpdated",async()=>{var e;await this._internalApi.configManager.configUpdated(),this._currentExtent=this._uiComponentConfig.extentLabels,this._currentSizeAccessor!==this.accessor?await this.fetchData():await this._updateExtents(),await this._updateLegend(),fN(this._currentExtent,this._uiComponentConfig.extentLabels)||(null==(e=this._client)||e.resetFilter(),this.onResetClientSelections())})}get _isLinkAggregateStrategy(){const e=this._internalApi.public.activeLinkWidthStrategy;return!!this._config.useLinksData&&[tY.Count,tY.Sum,tY.Average].includes(e)}get _isPointDegreeStrategy(){const e=this._internalApi.public.activePointSizeStrategy;return!this._config.useLinksData&&[Jj.Degree,Jj.PreciseDegree].includes(e)}get domain(){var e;const t=null==(e=this._currentData)?void 0:e.toArray()[0];return this._currentData?[t.min,t.max]:void 0}get defaultConfig(){return FX}get accessor(){const{linkWidthBy:e,pointSizeBy:t,pointIndexBy:n}=this._internalApi.config,i=this._isPointDegreeStrategy?n:t,r=e;return this._config.useLinksData?r:i}get _hasClickableEvents(){const{onClick:e,onMaxClick:t,onMinClick:n,overrideExtent:i}=this._config;return!i||void 0!==e||void 0!==t||void 0!==n}onInitialize(){this._pointSizeScaleUpdateHandler=async()=>{this._config.useLinksData||await this._onSizeScaleUpdated()},this._linkWidthScaleUpdateHandler=async()=>{this._config.useLinksData&&await this._onSizeScaleUpdated()},this._pointSizeUpdateHandler=async()=>{this._config.useLinksData||await this._onSizeUpdated()},this._linkWidthUpdateHandler=async()=>{this._config.useLinksData&&await this._onSizeUpdated()},this._internalApi.addEventListener("pointSizeScaleUpdated",this._pointSizeScaleUpdateHandler),this._internalApi.addEventListener("linkWidthScaleUpdated",this._linkWidthScaleUpdateHandler),this._internalApi.addEventListener("pointSizeUpdated",this._pointSizeUpdateHandler),this._internalApi.addEventListener("linkWidthUpdated",this._linkWidthUpdateHandler)}createUIComponent(e){return new NG(e,this.createComponentConfig(this._config))}createComponentConfig(e){return{...e,onClick:e=>{var t,n;null==(n=(t=this._config).onClick)||n.call(t,e)},onHover:e=>{var t,n;null==(n=(t=this._config).onHover)||n.call(t,e)},onMaxClick:(e,t,n)=>{var i,r;null==(r=(i=this._config).onMaxClick)||r.call(i,e,t,n),this._hasClickableEvents&&this.onSelect("max")},onMinClick:(e,t,n)=>{var i,r;null==(r=(i=this._config).onMinClick)||r.call(i,e,t,n),this._hasClickableEvents&&this.onSelect("min")}}}compareSelectedItem(e){return this.selected===e}setSelectedItem(e){var t;if(null==(t=this._uiComponent)?void 0:t.sizeElements)if(e){const t=e,n="min"===e?"max":"min";this._uiComponent.sizeElements[t].classList.remove(BX),this._uiComponent.sizeElements[t].classList.add(OX),this._uiComponent.sizeElements[n].classList.remove(OX),this._uiComponent.sizeElements[n].classList.add(BX)}else this._uiComponent.sizeElements.min.classList.remove(OX,BX),this._uiComponent.sizeElements.max.classList.remove(OX,BX)}_filterPointsByDegree(e,t){if(!this._isPointDegreeStrategy)return;const{public:{pointDegrees:n}}=this._internalApi;return void 0!==e&&(null==n?void 0:n.length)?Aj(n,e,t):void 0}applyFilter(e){var t,n,i,r,o,s,a,l,c,u,d,h;if("min"===e)if(this._isPointDegreeStrategy){const e=this._filterPointsByDegree(null==(t=this._extent)?void 0:t[0],(e,t)=>e<=t);null==(n=this._client)||n.applyInFilter(e)}else if(this._isLinkAggregateStrategy){const e=this._createLinkAggregatePredicate(null==(i=this._extent)?void 0:i[0],"min");null==(r=this._client)||r.applyFilter(e)}else null==(s=this._client)||s.applyLessOrEqFilter(null==(o=this._extent)?void 0:o[0]);else if(this._isPointDegreeStrategy){const e=this._filterPointsByDegree(null==(a=this._extent)?void 0:a[1],(e,t)=>e>=t);null==(l=this._client)||l.applyInFilter(e)}else if(this._isLinkAggregateStrategy){const e=this._createLinkAggregatePredicate(null==(c=this._extent)?void 0:c[1],"max");null==(u=this._client)||u.applyFilter(e)}else null==(h=this._client)||h.applyGreaterOrEqFilter(null==(d=this._extent)?void 0:d[1])}async getCurrentData(){await this._internalApi.configManager.configUpdated();const{summary:{linksSummary:e,pointsSummary:t}}=this._internalApi,n=this._config.useLinksData?e:t,i=null==n?void 0:n.find(e=>e.column_name===this.accessor);if(i)return this._config.useQuantiles?await this._getQuantiledExtentDataForColumn():pM({min:[Number(i.min)],max:[Number(i.max)]})}async fetchData(){var e;this._currentSizeAccessor=this.accessor,this.onResetClientSelections();const{public:{activeLinkWidthStrategy:t}}=this._internalApi;this._config.useLinksData&&t===tY.Count?(this._isValidAccessor=!0,this._currentData=void 0,null==(e=this._client)||e.setActive(!0)):await super.fetchData(),await this._updateExtents(),void 0===this._uiComponentConfig.extent&&this._uiComponent.showState()}async onConfigUpdate(){this._manuallyHidden=!!this._config.hidden,await this._updateLegend()}async shouldUpdateComponentData(){return!this._currentSizeAccessor||(await this._internalApi.configManager.configUpdated(),this._currentSizeAccessor!==this.accessor)}_getPointsDegreeExtent(){const{public:{activePointSizeStrategy:e,pointDegrees:t}}=this._internalApi;if(!(null==t?void 0:t.length))return[0,0];if(e===Jj.Degree)return Lj(t,gN);const[n,i]=xV(t);return gN(n,i)}async _getQuantiledExtentDataForColumn(){const e=`\n        SELECT \n          quantile("${this.accessor}", 0.05) as min,\n          quantile("${this.accessor}", 0.95) as max\n        FROM ${this.tableName}\n      `;return await this._internalApi.dbCoordinator.query(e)}_calculateExtent(){const{public:{activeLinkWidthStrategy:e}}=this._internalApi,t=e===tY.Count;if(!this._config.useLinksData)return this._isPointDegreeStrategy?this._getPointsDegreeExtent():this.domain;if(this._isLinkAggregateStrategy){if(!t&&!this.accessor)return;const{linkAggregationManager:{countCache:n,widthSumCache:i}}=this._internalApi;if(!n||0===n.size)return this.domain;const r=Array.from(n.entries(),([n,r])=>{if(t)return r;if(e===tY.Sum)return(null==i?void 0:i.get(n))??0;{const e=(null==i?void 0:i.get(n))??0;return r>0?e/r:0}});return Lj(r,t?gN:void 0)}return this.domain}async _calculateRange(e){const{config:t,public:{activePointSizeStrategy:n}}=this._internalApi;return this._config.useLinksData||t.pointSizeByFn&&n!==Jj.Auto&&!this._isPointDegreeStrategy?await this._remapValues(e):n===Jj.Direct?e:t.pointSizeRange||hj}async _updateExtents(){const{public:{activePointSizeStrategy:e,activeLinkWidthStrategy:t}}=this._internalApi;if(!this._isValidAccessor||!this.useLinksData&&e===Jj.Single||this.useLinksData&&t===tY.Single)this._uiComponentConfig.extent=void 0;else if(this._config.overrideExtent)this._uiComponentConfig.extent=this._config.overrideExtent,this._uiComponentConfig.extentLabels=this._config.overrideExtent;else{const{extent:e,range:t}=await this._getExtentAndRange();(e||e&&this._isPointDegreeStrategy&&(0!==e[0]||0!==e[1]))&&t?(this._originalMaxValue=e[1],this._extent=e,this._uiComponentConfig.extent=t[0]<0?[0,t[1]]:t,this._uiComponentConfig.extentLabels=this._config.extentLabels??[e[0],e[1]]):this._uiComponentConfig.extent=void 0}}async _updateLegend(){await this._updateSizeMultiplier(),this._updateLegendVisibility(),this._checkEvents(),this._updateLabels(),this._uiComponentConfig.form=this._config.useLinksData?"line":"point",this._uiComponent.setConfig(this.createComponentConfig({...this._config,...this._uiComponentConfig}))}_updateLabels(){const{showSublabels:e,useQuantiles:t}=this._config,{public:{activePointSizeStrategy:n}}=this._internalApi,i=this._getLabelValue();this._uiComponentConfig.label=i,this._uiComponentConfig.showSublabels=e??(this._isPointDegreeStrategy?n===Jj.Degree:t)}_checkEvents(){const{enableEvents:e,overrideExtent:t,onHover:n}=this._config;let i=e??!0;t&&(i=e??(this._hasClickableEvents||void 0!==n)),this._uiComponentConfig.enableEvents=i}_updateLegendVisibility(){const{extent:e,sizeMultiplier:t}=this._uiComponentConfig,{hideWhenSizeMoreThan:n}=this._config;let i=this._manuallyHidden;if(!i&&e){const r=t?t*e[1]:e[1];n&&n<r&&(i=!0)}this._uiComponentConfig.hidden=i}async _updateSizeMultiplier(){const{config:e}=this._internalApi,t=this._internalApi.public.getZoomLevel()??1,n=this._config.useLinksData?e.scaleLinksOnZoom:e.scalePointsOnZoom,i=this._config.useLinksData?e.linkWidthScale??1:e.pointSizeScale??1;this._uiComponentConfig.sizeMultiplier=n?i*t:i,n&&await this._updateMaxLabel()}async _updateMaxLabel(){const{config:e,public:{maxPointSize:t}}=this._internalApi,{extentLabels:n,sizeMultiplier:i}=this._uiComponentConfig;if(e.pointSizeByFn&&n&&!this._uiComponent.isHidden&&i){const e=await this._calcVisibleMaxLabel(t/i,n[0],this._originalMaxValue);this._uiComponentConfig.extentLabels=[n[0],e]}}async _calcVisibleMaxLabel(e,t,n){const i=await this._getMappingFunction();if(i){const r=e/i(1),o=Math.min(Math.abs(n),Math.max(Math.abs(t),Math.abs(r))),s=Math.sign(n)*o;let a=0;const l=Math.abs(s);return l>0&&(a=l<.001?6:l<.01?4:l<.1?3:l<1?2:l<10?1:0),Number(s.toFixed(a))}return 0}_getLabelValue(){const{useLinksData:e,overrideExtent:t}=this._config,{public:{activeLinkWidthStrategy:n}}=this._internalApi;if(this._isLinkAggregateStrategy)return n===tY.Count?"count":n===tY.Sum?`sum by ${this.accessor}`:n===tY.Average?`average by ${this.accessor}`:this.accessor;if(!t&&!e&&this._isPointDegreeStrategy)return"connections count";const i=this._config.labelResolver;return i&&"function"==typeof i?i(this.accessor):i??this.accessor}async _getMappingFunction(){return this._config.useLinksData?await this._internalApi.public.getActiveLinkWidthFn():await this._internalApi.public.getActivePointSizeFn()}_createLinkAggregatePredicate(e,t){if(void 0===e)return;const{public:{activeLinkWidthStrategy:n}}=this._internalApi,{linkSourceIndexBy:i,linkTargetIndexBy:r,linkWidthBy:o}=this._internalApi.config;if(!i||!r)return;let s,a;switch(n){case tY.Count:s=hE();break;case tY.Sum:if(!o)return;s=fE(o);break;case tY.Average:if(!o)return;s=dE(o);break;default:return}a="min"===t?LE(s,MS(e)):RE(s,MS(e));const l=rE.from(this.tableName).select(i,r).groupby(i,r).having(a);return DE`(${RS(i)}, ${RS(r)}) IN (${l})`}hide(){this._manuallyHidden=!0,this.checkReady(()=>this.hide())&&this._uiComponent.hide()}show(){this._manuallyHidden=!1,this.checkReady(()=>this.show())&&this._uiComponent.show()}remove(){this._internalApi.removeEventListener("pointSizeScaleUpdated",this._pointSizeScaleUpdateHandler),this._internalApi.removeEventListener("linkWidthScaleUpdated",this._linkWidthScaleUpdateHandler),this._internalApi.removeEventListener("pointSizeUpdated",this._pointSizeUpdateHandler),this._internalApi.removeEventListener("linkWidthUpdated",this._linkWidthUpdateHandler),super.remove()}}),tK(class extends Sq{constructor(){super(...arguments),s(this,"_uiComponentConfig",{}),s(this,"_linkColorUpdateHandler"),s(this,"_pointColorUpdateHandler"),s(this,"_extent"),s(this,"_currentColorAccessor"),s(this,"_currentExtent"),s(this,"_remapValues",async e=>{if(!e)return;const[t,n]=e,i=await this._getMappingFunction();return i?Array.from({length:this._config.steps},(e,r)=>{const o=t+r/(this._config.steps-1)*(n-t);return i(o)}):void 0}),s(this,"_getExtentAndRange",async()=>{const e=await this._calculateExtent();return!e||isNaN(null==e?void 0:e[0])||isNaN(null==e?void 0:e[1])?{extent:void 0,range:void 0}:{extent:e,range:await this._calculateRange(e)}})}get _isLinkAggregateStrategy(){const e=this._internalApi.public.activeLinkColorStrategy;return!!this._config.useLinksData&&[Zj.Count,Zj.Sum,Zj.Average].includes(e)}get _isPointDegreeStrategy(){const e=this._internalApi.public.activePointColorStrategy;return!this._config.useLinksData&&[Xj.Degree,Xj.PreciseDegree].includes(e)}get domain(){var e;const t=null==(e=this._currentData)?void 0:e.toArray()[0];return this._currentData?[t.min,t.max]:void 0}get defaultConfig(){return zX}get accessor(){const{linkColorBy:e,pointColorBy:t,pointIndexBy:n}=this._internalApi.config,i=this._isPointDegreeStrategy?n:t,r=e;return this._config.useLinksData?r:i}get _hasClickableEvents(){const{onClick:e,onMaxClick:t,onMinClick:n,overrideColors:i}=this._config;return!i||void 0!==e||void 0!==t||void 0!==n}onInitialize(){this._linkColorUpdateHandler=async()=>{this._config.useLinksData&&await this._onColorUpdated()},this._pointColorUpdateHandler=async()=>{this._config.useLinksData||await this._onColorUpdated()},this._internalApi.addEventListener("pointColorUpdated",this._pointColorUpdateHandler),this._internalApi.addEventListener("linkColorUpdated",this._linkColorUpdateHandler)}createUIComponent(e){return new VG(e,this.createComponentConfig(this._config))}createComponentConfig(e){return{...e,onClick:e=>{var t,n;null==(n=(t=this._config).onClick)||n.call(t,e)},onHover:e=>{var t,n;null==(n=(t=this._config).onHover)||n.call(t,e)},onMaxClick:(e,t,n)=>{var i,r;null==(r=(i=this._config).onMaxClick)||r.call(i,e,t,n),this._hasClickableEvents&&this.onSelect("max")},onMinClick:(e,t,n)=>{var i,r;null==(r=(i=this._config).onMinClick)||r.call(i,e,t,n),this._hasClickableEvents&&this.onSelect("min")}}}compareSelectedItem(e){return this.selected===e}setSelectedItem(e){var t,n,i,r,o,s;if(e){const o=e,s="min"===e?"max":"min";null==(t=this._uiComponent.extentElements)||t[o].classList.remove(VX),null==(n=this._uiComponent.extentElements)||n[o].classList.add(UX),null==(i=this._uiComponent.extentElements)||i[s].classList.remove(UX),null==(r=this._uiComponent.extentElements)||r[s].classList.add(VX)}else null==(o=this._uiComponent.extentElements)||o.min.classList.remove(UX,VX),null==(s=this._uiComponent.extentElements)||s.max.classList.remove(UX,VX)}_filterPointsByDegree(e,t){if(!this._isPointDegreeStrategy)return;const{public:{pointDegrees:n}}=this._internalApi;return void 0!==e&&(null==n?void 0:n.length)?Aj(n,e,t):void 0}applyFilter(e){var t,n,i,r,o,s,a,l,c,u,d,h;if("min"===e)if(this._isPointDegreeStrategy){const e=this._filterPointsByDegree(null==(t=this._extent)?void 0:t[0],(e,t)=>e<=t);null==(n=this._client)||n.applyInFilter(e)}else if(this._isLinkAggregateStrategy){const e=this._createLinkAggregatePredicate(null==(i=this._extent)?void 0:i[0],"min");null==(r=this._client)||r.applyFilter(e)}else null==(s=this._client)||s.applyLessOrEqFilter(null==(o=this._extent)?void 0:o[0]);else if(this._isPointDegreeStrategy){const e=this._filterPointsByDegree(null==(a=this._extent)?void 0:a[1],(e,t)=>e>=t);null==(l=this._client)||l.applyInFilter(e)}else if(this._isLinkAggregateStrategy){const e=this._createLinkAggregatePredicate(null==(c=this._extent)?void 0:c[1],"max");null==(u=this._client)||u.applyFilter(e)}else null==(h=this._client)||h.applyGreaterOrEqFilter(null==(d=this._extent)?void 0:d[1])}async getCurrentData(){await this._internalApi.configManager.configUpdated();const{summary:{linksSummary:e,pointsSummary:t}}=this._internalApi,n=this._config.useLinksData?e:t,i=null==n?void 0:n.find(e=>e.column_name===this.accessor);if(i)return this._config.useQuantiles?await this._getQuantiledExtentDataForColumn():pM({min:[Number(i.min)],max:[Number(i.max)]})}async fetchData(){var e;this._currentColorAccessor=null==(e=this.accessor)?void 0:e.toString(),this.onResetClientSelections(),await super.fetchData(),await this._updateExtents(),void 0===this._uiComponentConfig.extent&&this._uiComponent.showState()}async onConfigUpdate(){await this._updateLegend()}async shouldUpdateComponentData(){return!this._currentColorAccessor||(await this._internalApi.configManager.configUpdated(),this._currentColorAccessor!==this.accessor)}_createLinkAggregatePredicate(e,t){if(void 0===e)return;const{public:{activeLinkColorStrategy:n}}=this._internalApi,{linkSourceIndexBy:i,linkTargetIndexBy:r,linkColorBy:o}=this._internalApi.config;if(!i||!r)return;let s,a;switch(n){case Zj.Count:s=hE();break;case Zj.Sum:if(!o)return;s=fE(o);break;case Zj.Average:if(!o)return;s=dE(o);break;default:return}a="min"===t?LE(s,MS(e)):RE(s,MS(e));const l=rE.from(this.tableName).select(i,r).groupby(i,r).having(a);return DE`(${RS(i)}, ${RS(r)}) IN (${l})`}async _onColorUpdated(){var e;await this._internalApi.configManager.configUpdated(),this._currentExtent=this._uiComponentConfig.extentLabels,this._currentColorAccessor!==this.accessor?await this.fetchData():await this._updateExtents(),await this._updateLegend(),fN(this._currentExtent,this._uiComponentConfig.extentLabels)||(null==(e=this._client)||e.resetFilter(),this.onResetClientSelections())}_getPointsDegreeExtent(){const{public:{activePointColorStrategy:e,pointDegrees:t}}=this._internalApi;if(!(null==t?void 0:t.length))return[0,0];if(e===Xj.Degree)return Lj(t,gN);const[n,i]=xV(t);return gN(n,i)}async _getQuantiledExtentDataForColumn(){const e=`\n        SELECT \n          quantile("${this.accessor}", 0.05) as min,\n          quantile("${this.accessor}", 0.95) as max\n        FROM ${this.tableName}\n      `;return await this._internalApi.dbCoordinator.query(e)}_calculateExtent(){const{public:{activeLinkColorStrategy:e}}=this._internalApi,t=e===Zj.Count;if(!this._config.useLinksData)return this._isPointDegreeStrategy?this._getPointsDegreeExtent():this.domain;if(this._isLinkAggregateStrategy){if(!this.accessor)return;const{linkAggregationManager:{countCache:n,colorSumCache:i}}=this._internalApi;if(!n||0===n.size)return this.domain;const r=Array.from(n.entries(),([n,r])=>{if(t)return r;if(e===Zj.Sum)return(null==i?void 0:i.get(n))??0;{const e=(null==i?void 0:i.get(n))??0;return r>0?e/r:0}});return Lj(r,t?gN:void 0)}return this.domain}async _calculateRange(e){const{public:{activePointColorStrategy:t}}=this._internalApi;if(this._config.useLinksData||t!==Xj.Map&&t!==Xj.LinkDirection)return await this._remapValues(e);this._uiComponent.showState()}async _getMappingFunction(){return this._config.useLinksData?await this._internalApi.public.getActiveLinkColorFn():await this._internalApi.public.getActivePointColorFn()}async _updateExtents(){const{public:{activePointColorStrategy:e,activeLinkColorStrategy:t}}=this._internalApi;if(!this._isValidAccessor||!this.useLinksData&&e===Xj.Single||this.useLinksData&&t===Zj.Single)this._uiComponentConfig.extent=void 0;else if(this._config.overrideColors)this._uiComponentConfig.extent=this._config.overrideColors,this._uiComponentConfig.extentLabels=this._config.extentLabels;else{const{extent:e,range:t}=await this._getExtentAndRange();e||e&&this._isPointDegreeStrategy&&(0!==e[0]||0!==e[1])?(this._extent=e,this._uiComponentConfig.extent=t,this._uiComponentConfig.extentLabels=this._config.extentLabels??[e[0],e[1]]):this._uiComponentConfig.extent=void 0}}_checkEvents(){const{enableEvents:e,overrideColors:t,onHover:n}=this._config;let i=e??!0;t&&(i=e??(this._hasClickableEvents||void 0!==n)),this._uiComponentConfig.enableEvents=i}_updateLabels(){const{showSublabels:e,useQuantiles:t}=this._config,{public:{activePointColorStrategy:n}}=this._internalApi;this._uiComponentConfig.label=this._getLabelValue(),this._uiComponentConfig.showSublabels=e??(this._isPointDegreeStrategy?n===Xj.Degree:t)}async _updateLegend(){const{public:{activePointColorStrategy:e,activeLinkColorStrategy:t}}=this._internalApi,{overrideColors:n,useDiscreteColors:i}=this._config,r=this._config.useLinksData?t===Zj.Categorical:e===Xj.Categorical;this._uiComponentConfig.discreteColors=n?i:r,this._checkEvents(),this._updateLabels(),this._uiComponent.setConfig(this.createComponentConfig({...this._config,...this._uiComponentConfig}))}_getLabelValue(){const{useLinksData:e,overrideColors:t}=this._config,{public:{activeLinkColorStrategy:n}}=this._internalApi;if(this._isLinkAggregateStrategy)return n===Zj.Count?"count":n===Zj.Sum?`sum by ${this.accessor}`:n===Zj.Average?`average by ${this.accessor}`:this.accessor;if(!t&&!e&&this._isPointDegreeStrategy)return"connections count";const i=this._config.labelResolver;return i&&"function"==typeof i?i(this.accessor):i??this.accessor}hide(){this.checkReady(()=>this.hide())&&this._uiComponent.hide()}show(){this.checkReady(()=>this.show())&&this._uiComponent.show()}remove(){this._internalApi.removeEventListener("pointColorUpdated",this._pointColorUpdateHandler),this._internalApi.removeEventListener("linkColorUpdated",this._linkColorUpdateHandler),super.remove()}}),tK(class extends Sq{constructor(){super(...arguments),s(this,"_uiComponentConfig",{}),s(this,"_linkColorUpdateHandler"),s(this,"_pointColorUpdateHandler"),s(this,"_currentColorAccessor"),s(this,"_fetchDataPromise",null),s(this,"_onColorUpdated",async()=>{this._fetchDataPromise&&await this._fetchDataPromise,await this._internalApi.configManager.configUpdated(),this._currentColorAccessor!==this.accessor?await this.fetchData():await this._updateItems(),await this._updateLegend()})}get _summary(){const{summary:{linksSummary:e,pointsSummary:t}}=this._internalApi;return this._config.useLinksData?e:t}get _isLinkDirectionStrategy(){return!this.useLinksData&&this._internalApi.public.activePointColorStrategy===Xj.LinkDirection}get defaultConfig(){return $X}get accessor(){const{linkColorBy:e,pointColorBy:t,pointIndexBy:n}=this._internalApi.config;return this._config.useLinksData?e:this._isLinkDirectionStrategy?n:t}get _hasClickableEvents(){const{onClick:e,overrideItems:t}=this._config;return!t||void 0!==e}onInitialize(){this._linkColorUpdateHandler=async()=>{this._config.useLinksData&&await this._onColorUpdated()},this._pointColorUpdateHandler=async()=>{this._config.useLinksData||await this._onColorUpdated()},this._internalApi.addEventListener("pointColorUpdated",this._pointColorUpdateHandler),this._internalApi.addEventListener("linkColorUpdated",this._linkColorUpdateHandler)}createUIComponent(e){return new XG(e,this.createComponentConfig(this._config))}createComponentConfig(e){return{...e,onClick:(e,t)=>{var n,i;null==(i=(n=this._config).onClick)||i.call(n,e,t),this._hasClickableEvents&&this.onSelect(t)},onHover:(e,t)=>{var n,i;null==(i=(n=this._config).onHover)||i.call(n,e,t)},onShowMoreClick:e=>{var t,n;null==(n=(t=this._config).onShowMoreClick)||n.call(t,e),this._config.resetSelectionOnCollapse&&this.selected&&!e&&this.onSelect(void 0)}}}compareSelectedItem(e){var t;return(null==(t=this.selected)?void 0:t.label)===(null==e?void 0:e.label)}setSelectedItem(e){this._uiComponent.setSelectedItem(e)}applyFilter(e){var t,n;if(this._isLinkDirectionStrategy){if(!e)return;const n=Number(WX[e.label]),i=this._internalApi.public.pointDirections;if(!i)return;const r=Aj(i,n,(e,t)=>e===t);null==(t=this._client)||t.applyInFilter(r)}else null==(n=this._client)||n.applyExactFilter(null==e?void 0:e.label)}async fetchData(){return this._fetchDataPromise&&await this._fetchDataPromise,this._fetchDataPromise=(async()=>{var e;try{this._currentColorAccessor=null==(e=this.accessor)?void 0:e.toString(),await super.fetchData(),await this._updateItems(),this.onResetClientSelections()}finally{this._fetchDataPromise=null}})(),this._fetchDataPromise}async onConfigUpdate(){await this._updateLegend()}async getCurrentData(){var e;if(await this._internalApi.configManager.configUpdated(),(null==(e=this._summary)?void 0:e.find(e=>e.column_name===this.accessor))&&this._summary)return await this._getDistinctValues(this._summary)}async shouldUpdateComponentData(){return!this._currentColorAccessor||(await this._internalApi.configManager.configUpdated(),this._currentColorAccessor!==this.accessor)}async _getDistinctValues(e){var t;const{public:{activePointColorStrategy:n}}=this._internalApi;let i="DESC";!this.useLinksData&&[Xj.Continuous,Xj.Categorical].includes(n)&&(i=this._config.sortOrder??"DESC");const r=`ORDER BY "${this._config.sortBy??"count"}" ${i}`,o=null==(t=e.find(e=>e.column_name===this.accessor))?void 0:t.column_type;return await this._internalApi.dbCoordinator.query((e=>"VARCHAR"===e?`SELECT "${this.accessor}", COUNT(*) as count \n                FROM ${this.tableName}\n                GROUP BY "${this.accessor}"\n                ${r}`:`SELECT DISTINCT "${this.accessor}"\n                FROM ${this.tableName}\n                ORDER BY "${this.accessor}" ${this._config.sortOrder||i}`)(o))}_checkEvents(){const{enableEvents:e,overrideItems:t,onHover:n}=this._config;let i=e??!0;t&&(i=e??(this._hasClickableEvents||void 0!==n)),this._uiComponentConfig.enableEvents=i}async _updateLegend(){this._checkEvents();const e=this.accessor;if(this._config.showLabel){const t=this._config.labelResolver,n="function"==typeof t?t(e):t;this._uiComponentConfig.label=n??e}else this._uiComponentConfig.label=void 0;this._uiComponent.setConfig(this.createComponentConfig({...this._config,...this._uiComponentConfig}))}async _updateItems(){var e,t;const{activePointColorStrategy:n,activeLinkColorStrategy:i}=this._internalApi.public,{overrideItems:r}=this._config;if(r)this._uiComponentConfig.items=r;else{if(!this.useLinksData&&n===Xj.LinkDirection){const e=this._internalApi.public.pointDirections;if(e){const t=Array.from(new Set(e)).map(String);this._uiComponentConfig.items=await this._createLegendItems(t)}return}const r=[Xj.Degree,Xj.PreciseDegree,Xj.Single,Xj.Direct].includes(n),o=[Zj.Direct,Zj.Single].includes(i);if(!this.accessor||!this.useLinksData&&r||this.useLinksData&&o)return this._uiComponentConfig.items=void 0,void this._uiComponent.showState();if(null==(e=this._currentData)?void 0:e.numRows){const e=null==(t=this._currentData.getChildAt(0))?void 0:t.toArray();if(e)return void(this._uiComponentConfig.items=await this._createLegendItems(e))}this._uiComponentConfig.items=void 0}}async _createLegendItems(e){const{public:{activePointColorStrategy:t},config:n}=this._internalApi,i=await this._getMappingFunction();if(i){const r=$j(null==n?void 0:n.unknownColor,_j),o=e=>({color:$j(i(e),r),label:String(e)});if(!this.useLinksData&&t===Xj.LinkDirection)return Array.from(e,e=>({color:$j(i(e),r),label:HX[e]}));if(this.useLinksData||t!==Xj.Map)return Array.from(e,o);{const t=new Set(Object.keys(n.pointColorByMap??{}));return[...Array.from(e.filter(e=>t.has(e)),o),...this._config.hideUnknown?[]:Array.from(e.filter(e=>!t.has(e)),o)]}}return[]}async _getMappingFunction(){return this._config.useLinksData?await this._internalApi.public.getActiveLinkColorFn():await this._internalApi.public.getActivePointColorFn()}show(){this.checkReady(()=>this.show())&&this._uiComponent.show()}hide(){this.checkReady(()=>this.hide())&&this._uiComponent.hide()}remove(){this._internalApi.removeEventListener("pointColorUpdated",this._pointColorUpdateHandler),this._internalApi.removeEventListener("linkColorUpdated",this._linkColorUpdateHandler),super.remove()}}),tK(class{constructor(e,t,n={}){s(this,"_button"),this._button=new JG(t,n)}setConfig(e={}){this._button.setConfig(e)}remove(){this._button.destroy()}show(){this._button.show()}hide(){this._button.hide()}}),tK(class{constructor(e,t,n={}){s(this,"_internalApi"),s(this,"_config"),s(this,"_uiButtonConfig"),s(this,"_fitViewButton"),s(this,"_handleClick",()=>{var e,t;null==(t=(e=this._config).onClick)||t.call(e),this._internalApi.public.fitView(this._config.duration,this._config.padding)}),s(this,"_show",()=>{this._fitViewButton.show()}),this._internalApi=MY(e),this._fitViewButton=new JG(t),this._internalApi.addEventListener("graphRebuilt",this._show),this.setConfig(n)}setConfig(e={}){this._config=R$(GX,e),this._uiButtonConfig={...this._config,onClick:this._handleClick},this._fitViewButton.setConfig(this._uiButtonConfig)}remove(){this._fitViewButton.destroy(),this._internalApi.removeEventListener("graphRebuilt",this._show)}}),tK(class{constructor(e,t,n={}){s(this,"_internalApi"),s(this,"_config",YX),s(this,"_playPauseButton"),s(this,"_update",()=>{this._internalApi.cosmos&&(!1===this._internalApi.cosmos.config.enableSimulation?this._playPauseButton.hide():this._playPauseButton.show(),this._config.iconSvg=this._internalApi.public.isSimulationRunning?'\n<svg width="100%" height="100%" viewBox="0 0 14 18" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.91659 0.666656H0.333252V17.3333H4.91659V0.666656ZM13.6666 0.666656H9.08325V17.3333H13.6666V0.666656Z"/>\n</svg>\n':jX,this._playPauseButton.setConfig(this._config))}),this._internalApi=MY(e),this._playPauseButton=new JG(t,{iconSvg:jX}),this._internalApi.addEventListener("onSimulationEnd",this._update),this._internalApi.addEventListener("onSimulationStart",this._update),this._internalApi.addEventListener("onSimulationPause",this._update),this._internalApi.addEventListener("graphRebuilt",this._update),this.setConfig(n)}setConfig(e={}){this._config=R$(YX,e),this._config.onClick=()=>{var t;if(null==(t=null==e?void 0:e.onClick)||t.call(e),0!==this._internalApi.public.progress||this._internalApi.public.isSimulationRunning)if(this._internalApi.public.isSimulationRunning)this._internalApi.public.pause();else{if(1===this._internalApi.public.progress)return void this._internalApi.public.start();this._internalApi.public.unpause()}else this._internalApi.public.start()},this._update()}remove(){this._playPauseButton.destroy(),this._internalApi.removeEventListener("onSimulationEnd",this._update),this._internalApi.removeEventListener("onSimulationStart",this._update),this._internalApi.removeEventListener("onSimulationPause",this._update),this._internalApi.removeEventListener("graphRebuilt",this._update)}}),tK(class{constructor(e,t,n={}){s(this,"_internalApi"),s(this,"_config"),s(this,"_selectRectButton"),s(this,"_rectSelectedHandler"),s(this,"_show",()=>{this._selectRectButton.show()}),this._internalApi=MY(e),this._config=R$(qX,n),this._config.onClick=()=>{var e;null==(e=null==n?void 0:n.onClick)||e.call(n),this._internalApi.public.activateRectSelection()},this._selectRectButton=new JG(t,this._config),this._rectSelectedHandler=()=>{this._internalApi.public.deactivateRectSelection()},this._internalApi.addEventListener("graphRebuilt",this._show),this._internalApi.addEventListener("rectSelected",this._rectSelectedHandler)}setConfig(e={}){this._config=R$(qX,e)}remove(){this._selectRectButton.destroy(),this._internalApi.removeEventListener("graphRebuilt",this._show),this._internalApi.removeEventListener("rectSelected",this._rectSelectedHandler)}}),tK(class{constructor(e,t,n={}){s(this,"_internalApi"),s(this,"_config"),s(this,"_selectPolygonButton"),s(this,"_polygonSelectedHandler"),s(this,"_show",()=>{this._selectPolygonButton.show()}),this._internalApi=MY(e),this._config=R$(XX,n),this._config.onClick=()=>{var e;null==(e=null==n?void 0:n.onClick)||e.call(n),this._internalApi.public.activatePolygonalSelection()},this._selectPolygonButton=new JG(t,this._config),this._polygonSelectedHandler=()=>{this._internalApi.public.deactivatePolygonalSelection()},this._internalApi.addEventListener("graphRebuilt",this._show),this._internalApi.addEventListener("polygonSelected",this._polygonSelectedHandler)}setConfig(e={}){this._config=R$(XX,e)}remove(){this._selectPolygonButton.destroy(),this._internalApi.removeEventListener("graphRebuilt",this._show),this._internalApi.removeEventListener("polygonSelected",this._polygonSelectedHandler)}}),tK(class{constructor(e,t,n){s(this,"_internalApi"),s(this,"_config"),s(this,"_zoomInButtonConfig"),s(this,"_zoomOutButtonConfig"),s(this,"_zoomInButton"),s(this,"_zoomOutButton"),s(this,"_zoomInButtonDiv"),s(this,"_zoomOutButtonDiv"),s(this,"_show",()=>{this._zoomInButton.show(),this._zoomOutButton.show()}),this._internalApi=MY(e),t.classList.add("style_module_zoomButtons__738b35dc"),this._zoomInButtonDiv=document.createElement("div"),this._zoomInButtonDiv.classList.add(ZX,"style_module_zoomInButton__738b35dc"),this._zoomOutButtonDiv=document.createElement("div"),this._zoomOutButtonDiv.classList.add(ZX,"style_module_zoomOutButton__738b35dc"),t.appendChild(this._zoomInButtonDiv),t.appendChild(this._zoomOutButtonDiv),this._zoomInButton=new JG(this._zoomInButtonDiv),this._zoomOutButton=new JG(this._zoomOutButtonDiv),this._internalApi.addEventListener("graphRebuilt",this._show),this.setConfig(n??{})}setConfig(e){this._config=R$(KX,e??{}),this._zoomInButtonConfig={onClick:()=>{var e,t;const n=this._internalApi.public.getZoomLevel();if(n){const e=this._config.zoomIncrement??KX.zoomIncrement;this._internalApi.public.setZoomLevel(n*e,this._config.duration)}null==(t=(e=this._config).onZoomInClick)||t.call(e)},iconSvg:this._config.zoomInIconSvg},this._zoomOutButtonConfig={onClick:()=>{var e,t;const n=this._internalApi.public.getZoomLevel();if(n){const e=this._config.zoomIncrement??KX.zoomIncrement;this._internalApi.public.setZoomLevel(n/e,this._config.duration)}null==(t=(e=this._config).onZoomOutClick)||t.call(e)},iconSvg:this._config.zoomOutIconSvg},this._zoomInButton.setConfig(this._zoomInButtonConfig),this._zoomOutButton.setConfig(this._zoomOutButtonConfig)}remove(){this._zoomInButton.destroy(),this._zoomOutButton.destroy(),this._internalApi.removeEventListener("graphRebuilt",this._show)}});var iK,rK={},oK={};function sK(){if(iK)return oK;iK=1;var e=y();function t(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=Object.prototype.hasOwnProperty,i=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,r={},o={};function s(e){return!!n.call(o,e)||!n.call(r,e)&&(i.test(e)?o[e]=!0:(r[e]=!0,!1))}function a(e,t,n,i,r,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var l={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){l[e]=new a(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];l[t]=new a(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){l[e]=new a(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){l[e]=new a(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){l[e]=new a(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){l[e]=new a(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){l[e]=new a(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){l[e]=new a(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){l[e]=new a(e,5,!1,e.toLowerCase(),null,!1,!1)});var c=/[\-:]([a-z])/g;function u(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(c,u);l[t]=new a(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(c,u);l[t]=new a(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(c,u);l[t]=new a(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){l[e]=new a(e,1,!1,e.toLowerCase(),null,!1,!1)}),l.xlinkHref=new a("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){l[e]=new a(e,1,!1,e.toLowerCase(),null,!0,!0)});var d={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},h=["Webkit","ms","Moz","O"];Object.keys(d).forEach(function(e){h.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),d[t]=d[e]})});var f=/["'&<>]/;function p(e){if("boolean"==typeof e||"number"==typeof e)return""+e;e=""+e;var t=f.exec(e);if(t){var n,i="",r=0;for(n=t.index;n<e.length;n++){switch(e.charCodeAt(n)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}r!==n&&(i+=e.substring(r,n)),r=n+1,i+=t}e=r!==n?i+e.substring(r,n):i}return e}var m=/([A-Z])/g,g=/^ms-/,_=Array.isArray;function v(e,t){return{insertionMode:e,selectedValue:t}}var b=new Map;function x(e,i,r){if("object"!=typeof r)throw Error(t(62));for(var o in i=!0,r)if(n.call(r,o)){var s=r[o];if(null!=s&&"boolean"!=typeof s&&""!==s){if(0===o.indexOf("--")){var a=p(o);s=p((""+s).trim())}else{a=o;var l=b.get(a);void 0!==l||(l=p(a.replace(m,"-$1").toLowerCase().replace(g,"-ms-")),b.set(a,l)),a=l,s="number"==typeof s?0===s||n.call(d,o)?""+s:s+"px":p((""+s).trim())}i?(i=!1,e.push(' style="',a,":",s)):e.push(";",a,":",s)}}i||e.push('"')}function w(e,t,n,i){switch(n){case"style":return void x(e,t,i);case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])if(null!==(t=l.hasOwnProperty(n)?l[n]:null)){switch(typeof i){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(n=t.attributeName,t.type){case 3:i&&e.push(" ",n,'=""');break;case 4:!0===i?e.push(" ",n,'=""'):!1!==i&&e.push(" ",n,'="',p(i),'"');break;case 5:isNaN(i)||e.push(" ",n,'="',p(i),'"');break;case 6:!isNaN(i)&&1<=i&&e.push(" ",n,'="',p(i),'"');break;default:t.sanitizeURL&&(i=""+i),e.push(" ",n,'="',p(i),'"')}}else if(s(n)){switch(typeof i){case"function":case"symbol":return;case"boolean":if("data-"!==(t=n.toLowerCase().slice(0,5))&&"aria-"!==t)return}e.push(" ",n,'="',p(i),'"')}}function S(e,n,i){if(null!=n){if(null!=i)throw Error(t(60));if("object"!=typeof n||!("__html"in n))throw Error(t(61));null!=(n=n.__html)&&e.push(""+n)}}function E(e,t,i,r){e.push(k(i));var o,s=i=null;for(o in t)if(n.call(t,o)){var a=t[o];if(null!=a)switch(o){case"children":i=a;break;case"dangerouslySetInnerHTML":s=a;break;default:w(e,r,o,a)}}return e.push(">"),S(e,s,i),"string"==typeof i?(e.push(p(i)),null):i}var C=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,T=new Map;function k(e){var n=T.get(e);if(void 0===n){if(!C.test(e))throw Error(t(65,e));n="<"+e,T.set(e,n)}return n}function I(e,n,i){if(e.push('\x3c!--$?--\x3e<template id="'),null===i)throw Error(t(395));return e.push(i),e.push('"></template>')}var A=/[<\u2028\u2029]/g;function L(e){return JSON.stringify(e).replace(A,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function R(e,t,n,i){return n.generateStaticMarkup?(e.push(p(t)),!1):(""===t?e=i:(i&&e.push("\x3c!-- --\x3e"),e.push(p(t)),e=!0),e)}var P=Object.assign,M=Symbol.for("react.element"),D=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),B=Symbol.for("react.provider"),z=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),W=Symbol.for("react.memo"),$=Symbol.for("react.lazy"),G=Symbol.for("react.scope"),j=Symbol.for("react.debug_trace_mode"),Y=Symbol.for("react.legacy_hidden"),q=Symbol.for("react.default_value"),X=Symbol.iterator;function K(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case N:return"Fragment";case D:return"Portal";case O:return"Profiler";case F:return"StrictMode";case V:return"Suspense";case H:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case z:return(e.displayName||"Context")+".Consumer";case B:return(e._context.displayName||"Context")+".Provider";case U:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case W:return null!==(t=e.displayName||null)?t:K(e.type)||"Memo";case $:t=e._payload,e=e._init;try{return K(e(t))}catch(TD){}}return null}var Z={};function Q(e,t){if(!(e=e.contextTypes))return Z;var n,i={};for(n in e)i[n]=t[n];return i}var J=null;function ee(e,n){if(e!==n){e.context._currentValue2=e.parentValue,e=e.parent;var i=n.parent;if(null===e){if(null!==i)throw Error(t(401))}else{if(null===i)throw Error(t(401));ee(e,i)}n.context._currentValue2=n.value}}function te(e){e.context._currentValue2=e.parentValue,null!==(e=e.parent)&&te(e)}function ne(e){var t=e.parent;null!==t&&ne(t),e.context._currentValue2=e.value}function ie(e,n){if(e.context._currentValue2=e.parentValue,null===(e=e.parent))throw Error(t(402));e.depth===n.depth?ee(e,n):ie(e,n)}function re(e,n){var i=n.parent;if(null===i)throw Error(t(402));e.depth===i.depth?ee(e,i):re(e,i),n.context._currentValue2=n.value}function oe(e){var t=J;t!==e&&(null===t?ne(e):null===e?te(t):t.depth===e.depth?ee(t,e):t.depth>e.depth?ie(t,e):re(t,e),J=e)}var se={isMounted:function(){return!1},enqueueSetState:function(e,t){null!==(e=e._reactInternals).queue&&e.queue.push(t)},enqueueReplaceState:function(e,t){(e=e._reactInternals).replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function ae(e,t,n,i){var r=void 0!==e.state?e.state:null;e.updater=se,e.props=n,e.state=r;var o={queue:[],replace:!1};e._reactInternals=o;var s=t.contextType;if(e.context="object"==typeof s&&null!==s?s._currentValue2:i,"function"==typeof(s=t.getDerivedStateFromProps)&&(r=null==(s=s(n,r))?r:P({},r,s),e.state=r),"function"!=typeof t.getDerivedStateFromProps&&"function"!=typeof e.getSnapshotBeforeUpdate&&("function"==typeof e.UNSAFE_componentWillMount||"function"==typeof e.componentWillMount))if(t=e.state,"function"==typeof e.componentWillMount&&e.componentWillMount(),"function"==typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),t!==e.state&&se.enqueueReplaceState(e,e.state,null),null!==o.queue&&0<o.queue.length)if(t=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&1===t.length)e.state=t[0];else{for(o=s?t[0]:e.state,r=!0,s=s?1:0;s<t.length;s++){var a=t[s];null!=(a="function"==typeof a?a.call(e,o,n,i):a)&&(r?(r=!1,o=P({},o,a)):P(o,a))}e.state=o}else o.queue=null}var le={id:1,overflow:""};function ce(e,t,n){var i=e.id;e=e.overflow;var r=32-ue(i)-1;i&=~(1<<r),n+=1;var o=32-ue(t)+r;if(30<o){var s=r-r%5;return o=(i&(1<<s)-1).toString(32),i>>=s,r-=s,{id:1<<32-ue(t)+r|n<<r|i,overflow:o+e}}return{id:1<<o|n<<r|i,overflow:e}}var ue=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(de(e)/he|0)|0},de=Math.log,he=Math.LN2,fe="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},pe=null,me=null,ge=null,_e=null,ye=!1,ve=!1,be=0,xe=null,we=0;function Se(){if(null===pe)throw Error(t(321));return pe}function Ee(){if(0<we)throw Error(t(312));return{memoizedState:null,queue:null,next:null}}function Ce(){return null===_e?null===ge?(ye=!1,ge=_e=Ee()):(ye=!0,_e=ge):null===_e.next?(ye=!1,_e=_e.next=Ee()):(ye=!0,_e=_e.next),_e}function Te(){me=pe=null,ve=!1,ge=null,we=0,_e=xe=null}function ke(e,t){return"function"==typeof t?t(e):t}function Ie(e,t,n){if(pe=Se(),_e=Ce(),ye){var i=_e.queue;if(t=i.dispatch,null!==xe&&void 0!==(n=xe.get(i))){xe.delete(i),i=_e.memoizedState;do{i=e(i,n.action),n=n.next}while(null!==n);return _e.memoizedState=i,[i,t]}return[_e.memoizedState,t]}return e=e===ke?"function"==typeof t?t():t:void 0!==n?n(t):t,_e.memoizedState=e,e=(e=_e.queue={last:null,dispatch:null}).dispatch=Le.bind(null,pe,e),[_e.memoizedState,e]}function Ae(e,t){if(pe=Se(),t=void 0===t?null:t,null!==(_e=Ce())){var n=_e.memoizedState;if(null!==n&&null!==t){var i=n[1];e:if(null===i)i=!1;else{for(var r=0;r<i.length&&r<t.length;r++)if(!fe(t[r],i[r])){i=!1;break e}i=!0}if(i)return n[0]}}return e=e(),_e.memoizedState=[e,t],e}function Le(e,n,i){if(25<=we)throw Error(t(301));if(e===pe)if(ve=!0,e={action:i,next:null},null===xe&&(xe=new Map),void 0===(i=xe.get(n)))xe.set(n,e);else{for(n=i;null!==n.next;)n=n.next;n.next=e}}function Re(){throw Error(t(394))}function Pe(){}var Me={readContext:function(e){return e._currentValue2},useContext:function(e){return Se(),e._currentValue2},useMemo:Ae,useReducer:Ie,useRef:function(e){pe=Se();var t=(_e=Ce()).memoizedState;return null===t?(e={current:e},_e.memoizedState=e):t},useState:function(e){return Ie(ke,e)},useInsertionEffect:Pe,useLayoutEffect:function(){},useCallback:function(e,t){return Ae(function(){return e},t)},useImperativeHandle:Pe,useEffect:Pe,useDebugValue:Pe,useDeferredValue:function(e){return Se(),e},useTransition:function(){return Se(),[!1,Re]},useId:function(){var e=me.treeContext,n=e.overflow;e=((e=e.id)&~(1<<32-ue(e)-1)).toString(32)+n;var i=De;if(null===i)throw Error(t(404));return n=be++,e=":"+i.idPrefix+"R"+e,0<n&&(e+="H"+n.toString(32)),e+":"},useMutableSource:function(e,t){return Se(),t(e._source)},useSyncExternalStore:function(e,n,i){if(void 0===i)throw Error(t(407));return i()}},De=null,Ne=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Fe(e){return null}function Oe(){}function Be(e,t,n,i,r,o,s,a){e.allPendingTasks++,null===n?e.pendingRootTasks++:n.pendingTasks++;var l={node:t,ping:function(){var t=e.pingedTasks;t.push(l),1===t.length&&Je(e)},blockedBoundary:n,blockedSegment:i,abortSet:r,legacyContext:o,context:s,treeContext:a};return r.add(l),l}function ze(e,t,n,i,r,o){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:i,boundary:n,lastPushedText:r,textEmbedded:o}}function Ue(e,t){if(null!=(e=e.onError(t))&&"string"!=typeof e)throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function Ve(e,t){var n=e.onShellError;n(t),(n=e.onFatalError)(t),null!==e.destination?(e.status=2,e.destination.destroy(t)):(e.status=1,e.fatalError=t)}function He(e,t,n,i,r){for(pe={},me=t,be=0,e=n(i,r);ve;)ve=!1,be=0,we+=1,_e=null,e=n(i,r);return Te(),e}function We(e,n,i,r){var o=i.render(),s=r.childContextTypes;if(null!=s){var a=n.legacyContext;if("function"!=typeof i.getChildContext)r=a;else{for(var l in i=i.getChildContext())if(!(l in s))throw Error(t(108,K(r)||"Unknown",l));r=P({},a,i)}n.legacyContext=r,je(e,n,o),n.legacyContext=a}else je(e,n,o)}function $e(e,t){if(e&&e.defaultProps){for(var n in t=P({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function Ge(i,r,o,a,l){if("function"==typeof o)if(o.prototype&&o.prototype.isReactComponent){l=Q(o,r.legacyContext);var c=o.contextType;ae(c=new o(a,"object"==typeof c&&null!==c?c._currentValue2:l),o,a,l),We(i,r,c,o)}else{l=He(i,r,o,a,c=Q(o,r.legacyContext));var u=0!==be;if("object"==typeof l&&null!==l&&"function"==typeof l.render&&void 0===l.$$typeof)ae(l,o,a,c),We(i,r,l,o);else if(u){a=r.treeContext,r.treeContext=ce(a,1,0);try{je(i,r,l)}finally{r.treeContext=a}}else je(i,r,l)}else{if("string"!=typeof o){switch(o){case Y:case j:case F:case O:case N:case H:return void je(i,r,a.children);case G:throw Error(t(343));case V:e:{o=r.blockedBoundary,l=r.blockedSegment,c=a.fallback,a=a.children;var d={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:u=new Set,errorDigest:null},h=ze(0,l.chunks.length,d,l.formatContext,!1,!1);l.children.push(h),l.lastPushedText=!1;var f=ze(0,0,null,l.formatContext,!1,!1);f.parentFlushed=!0,r.blockedBoundary=d,r.blockedSegment=f;try{if(qe(i,r,a),i.responseState.generateStaticMarkup||f.lastPushedText&&f.textEmbedded&&f.chunks.push("\x3c!-- --\x3e"),f.status=1,Ze(d,f),0===d.pendingTasks)break e}catch(qn){f.status=4,d.forceClientRender=!0,d.errorDigest=Ue(i,qn)}finally{r.blockedBoundary=o,r.blockedSegment=l}r=Be(i,c,o,h,u,r.legacyContext,r.context,r.treeContext),i.pingedTasks.push(r)}return}if("object"==typeof o&&null!==o)switch(o.$$typeof){case U:if(a=He(i,r,o.render,a,l),0!==be){o=r.treeContext,r.treeContext=ce(o,1,0);try{je(i,r,a)}finally{r.treeContext=o}}else je(i,r,a);return;case W:return void Ge(i,r,o=o.type,a=$e(o,a),l);case B:if(l=a.children,o=o._context,a=a.value,c=o._currentValue2,o._currentValue2=a,J=a={parent:u=J,depth:null===u?0:u.depth+1,context:o,parentValue:c,value:a},r.context=a,je(i,r,l),null===(i=J))throw Error(t(403));return a=i.parentValue,i.context._currentValue2=a===q?i.context._defaultValue:a,i=J=i.parent,void(r.context=i);case z:return void je(i,r,a=(a=a.children)(o._currentValue2));case $:return void Ge(i,r,o=(l=o._init)(o._payload),a=$e(o,a),void 0)}throw Error(t(130,null==o?o:typeof o,""))}switch(c=function(i,r,o,a,l){switch(r){case"select":i.push(k("select"));var c=null,u=null;for(m in o)if(n.call(o,m)){var d=o[m];if(null!=d)switch(m){case"children":c=d;break;case"dangerouslySetInnerHTML":u=d;break;case"defaultValue":case"value":break;default:w(i,a,m,d)}}return i.push(">"),S(i,u,c),c;case"option":u=l.selectedValue,i.push(k("option"));var h=d=null,f=null,m=null;for(c in o)if(n.call(o,c)){var g=o[c];if(null!=g)switch(c){case"children":d=g;break;case"selected":f=g;break;case"dangerouslySetInnerHTML":m=g;break;case"value":h=g;default:w(i,a,c,g)}}if(null!=u)if(o=null!==h?""+h:function(t){var n="";return e.Children.forEach(t,function(e){null!=e&&(n+=e)}),n}(d),_(u)){for(a=0;a<u.length;a++)if(""+u[a]===o){i.push(' selected=""');break}}else""+u===o&&i.push(' selected=""');else f&&i.push(' selected=""');return i.push(">"),S(i,m,d),d;case"textarea":for(d in i.push(k("textarea")),m=u=c=null,o)if(n.call(o,d)&&null!=(h=o[d]))switch(d){case"children":m=h;break;case"value":c=h;break;case"defaultValue":u=h;break;case"dangerouslySetInnerHTML":throw Error(t(91));default:w(i,a,d,h)}if(null===c&&null!==u&&(c=u),i.push(">"),null!=m){if(null!=c)throw Error(t(92));if(_(m)&&1<m.length)throw Error(t(93));c=""+m}return"string"==typeof c&&"\n"===c[0]&&i.push("\n"),null!==c&&i.push(p(""+c)),null;case"input":for(u in i.push(k("input")),h=m=d=c=null,o)if(n.call(o,u)&&null!=(f=o[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,"input"));case"defaultChecked":h=f;break;case"defaultValue":d=f;break;case"checked":m=f;break;case"value":c=f;break;default:w(i,a,u,f)}return null!==m?w(i,a,"checked",m):null!==h&&w(i,a,"checked",h),null!==c?w(i,a,"value",c):null!==d&&w(i,a,"value",d),i.push("/>"),null;case"menuitem":for(var y in i.push(k("menuitem")),o)if(n.call(o,y)&&null!=(c=o[y]))switch(y){case"children":case"dangerouslySetInnerHTML":throw Error(t(400));default:w(i,a,y,c)}return i.push(">"),null;case"title":for(g in i.push(k("title")),c=null,o)if(n.call(o,g)&&null!=(u=o[g]))switch(g){case"children":c=u;break;case"dangerouslySetInnerHTML":throw Error(t(434));default:w(i,a,g,u)}return i.push(">"),c;case"listing":case"pre":for(h in i.push(k(r)),u=c=null,o)if(n.call(o,h)&&null!=(d=o[h]))switch(h){case"children":c=d;break;case"dangerouslySetInnerHTML":u=d;break;default:w(i,a,h,d)}if(i.push(">"),null!=u){if(null!=c)throw Error(t(60));if("object"!=typeof u||!("__html"in u))throw Error(t(61));null!=(o=u.__html)&&("string"==typeof o&&0<o.length&&"\n"===o[0]?i.push("\n",o):i.push(""+o))}return"string"==typeof c&&"\n"===c[0]&&i.push("\n"),c;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":for(var v in i.push(k(r)),o)if(n.call(o,v)&&null!=(c=o[v]))switch(v){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,r));default:w(i,a,v,c)}return i.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return E(i,o,r,a);case"html":return 0===l.insertionMode&&i.push("<!DOCTYPE html>"),E(i,o,r,a);default:if(-1===r.indexOf("-")&&"string"!=typeof o.is)return E(i,o,r,a);for(f in i.push(k(r)),u=c=null,o)if(n.call(o,f)&&null!=(d=o[f]))switch(f){case"children":c=d;break;case"dangerouslySetInnerHTML":u=d;break;case"style":x(i,a,d);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:s(f)&&"function"!=typeof d&&"symbol"!=typeof d&&i.push(" ",f,'="',p(d),'"')}return i.push(">"),S(i,u,c),c}}((l=r.blockedSegment).chunks,o,a,i.responseState,l.formatContext),l.lastPushedText=!1,u=l.formatContext,l.formatContext=function(e,t,n){switch(t){case"select":return v(1,null!=n.value?n.value:n.defaultValue);case"svg":return v(2,null);case"math":return v(3,null);case"foreignObject":return v(1,null);case"table":return v(4,null);case"thead":case"tbody":case"tfoot":return v(5,null);case"colgroup":return v(7,null);case"tr":return v(6,null)}return 4<=e.insertionMode||0===e.insertionMode?v(1,null):e}(u,o,a),qe(i,r,c),l.formatContext=u,o){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:l.chunks.push("</",o,">")}l.lastPushedText=!1}}function je(e,n,i){if(n.node=i,"object"==typeof i&&null!==i){switch(i.$$typeof){case M:return void Ge(e,n,i.type,i.props,i.ref);case D:throw Error(t(257));case $:var r=i._init;return void je(e,n,i=r(i._payload))}if(_(i))return void Ye(e,n,i);if((r=null===i||"object"!=typeof i?null:"function"==typeof(r=X&&i[X]||i["@@iterator"])?r:null)&&(r=r.call(i))){if(!(i=r.next()).done){var o=[];do{o.push(i.value),i=r.next()}while(!i.done);Ye(e,n,o)}return}throw e=Object.prototype.toString.call(i),Error(t(31,"[object Object]"===e?"object with keys {"+Object.keys(i).join(", ")+"}":e))}"string"==typeof i?(r=n.blockedSegment).lastPushedText=R(n.blockedSegment.chunks,i,e.responseState,r.lastPushedText):"number"==typeof i&&((r=n.blockedSegment).lastPushedText=R(n.blockedSegment.chunks,""+i,e.responseState,r.lastPushedText))}function Ye(e,t,n){for(var i=n.length,r=0;r<i;r++){var o=t.treeContext;t.treeContext=ce(o,i,r);try{qe(e,t,n[r])}finally{t.treeContext=o}}}function qe(e,t,n){var i=t.blockedSegment.formatContext,r=t.legacyContext,o=t.context;try{return je(e,t,n)}catch(l){if(Te(),"object"!=typeof l||null===l||"function"!=typeof l.then)throw t.blockedSegment.formatContext=i,t.legacyContext=r,t.context=o,oe(o),l;n=l;var s=t.blockedSegment,a=ze(0,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,e=Be(e,t.node,t.blockedBoundary,a,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,n.then(e,e),t.blockedSegment.formatContext=i,t.legacyContext=r,t.context=o,oe(o)}}function Xe(e){var t=e.blockedBoundary;(e=e.blockedSegment).status=3,Qe(this,t,e)}function Ke(e,n,i){var r=e.blockedBoundary;e.blockedSegment.status=3,null===r?(n.allPendingTasks--,2!==n.status&&(n.status=2,null!==n.destination&&n.destination.push(null))):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,e=void 0===i?Error(t(432)):i,r.errorDigest=n.onError(e),r.parentFlushed&&n.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(e){return Ke(e,n,i)}),r.fallbackAbortableTasks.clear(),n.allPendingTasks--,0===n.allPendingTasks&&(r=n.onAllReady)())}function Ze(e,t){if(0===t.chunks.length&&1===t.children.length&&null===t.children[0].boundary){var n=t.children[0];n.id=t.id,n.parentFlushed=!0,1===n.status&&Ze(e,n)}else e.completedSegments.push(t)}function Qe(e,n,i){if(null===n){if(i.parentFlushed){if(null!==e.completedRootSegment)throw Error(t(389));e.completedRootSegment=i}e.pendingRootTasks--,0===e.pendingRootTasks&&(e.onShellError=Oe,(n=e.onShellReady)())}else n.pendingTasks--,n.forceClientRender||(0===n.pendingTasks?(i.parentFlushed&&1===i.status&&Ze(n,i),n.parentFlushed&&e.completedBoundaries.push(n),n.fallbackAbortableTasks.forEach(Xe,e),n.fallbackAbortableTasks.clear()):i.parentFlushed&&1===i.status&&(Ze(n,i),1===n.completedSegments.length&&n.parentFlushed&&e.partialBoundaries.push(n)));e.allPendingTasks--,0===e.allPendingTasks&&(e=e.onAllReady)()}function Je(e){if(2!==e.status){var t=J,n=Ne.current;Ne.current=Me;var i=De;De=e.responseState;try{var r,o=e.pingedTasks;for(r=0;r<o.length;r++){var s=o[r],a=e,l=s.blockedSegment;if(0===l.status){oe(s.context);try{je(a,s,s.node),a.responseState.generateStaticMarkup||l.lastPushedText&&l.textEmbedded&&l.chunks.push("\x3c!-- --\x3e"),s.abortSet.delete(s),l.status=1,Qe(a,s.blockedBoundary,l)}catch(f){if(Te(),"object"==typeof f&&null!==f&&"function"==typeof f.then){var c=s.ping;f.then(c,c)}else{s.abortSet.delete(s),l.status=4;var u=s.blockedBoundary,d=f,h=Ue(a,d);null===u?Ve(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=h,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,0===a.allPendingTasks&&(0,a.onAllReady)()}}}}o.splice(0,r),null!==e.destination&&ot(e,e.destination)}catch(f){Ue(e,f),Ve(e,f)}finally{De=i,Ne.current=n,n===Me&&oe(t)}}}function et(e,n,i){switch(i.parentFlushed=!0,i.status){case 0:var r=i.id=e.nextSegmentId++;return i.lastPushedText=!1,i.textEmbedded=!1,e=e.responseState,n.push('<template id="'),n.push(e.placeholderPrefix),e=r.toString(16),n.push(e),n.push('"></template>');case 1:i.status=2;var o=!0;r=i.chunks;var s=0;i=i.children;for(var a=0;a<i.length;a++){for(o=i[a];s<o.index;s++)n.push(r[s]);o=tt(e,n,o)}for(;s<r.length-1;s++)n.push(r[s]);return s<r.length&&(o=n.push(r[s])),o;default:throw Error(t(390))}}function tt(e,n,i){var r=i.boundary;if(null===r)return et(e,n,i);if(r.parentFlushed=!0,r.forceClientRender)return e.responseState.generateStaticMarkup||(r=r.errorDigest,n.push("\x3c!--$!--\x3e"),n.push("<template"),r&&(n.push(' data-dgst="'),r=p(r),n.push(r),n.push('"')),n.push("></template>")),et(e,n,i),!!e.responseState.generateStaticMarkup||n.push("\x3c!--/$--\x3e");if(0<r.pendingTasks){r.rootSegmentID=e.nextSegmentId++,0<r.completedSegments.length&&e.partialBoundaries.push(r);var o=e.responseState,s=o.nextSuspenseID++;return o=o.boundaryPrefix+s.toString(16),r=r.id=o,I(n,e.responseState,r),et(e,n,i),n.push("\x3c!--/$--\x3e")}if(r.byteSize>e.progressiveChunkSize)return r.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(r),I(n,e.responseState,r.id),et(e,n,i),n.push("\x3c!--/$--\x3e");if(e.responseState.generateStaticMarkup||n.push("\x3c!--$--\x3e"),1!==(i=r.completedSegments).length)throw Error(t(391));return tt(e,n,i[0]),!!e.responseState.generateStaticMarkup||n.push("\x3c!--/$--\x3e")}function nt(e,n,i){return function(e,n,i,r){switch(i.insertionMode){case 0:case 1:return e.push('<div hidden id="'),e.push(n.segmentPrefix),n=r.toString(16),e.push(n),e.push('">');case 2:return e.push('<svg aria-hidden="true" style="display:none" id="'),e.push(n.segmentPrefix),n=r.toString(16),e.push(n),e.push('">');case 3:return e.push('<math aria-hidden="true" style="display:none" id="'),e.push(n.segmentPrefix),n=r.toString(16),e.push(n),e.push('">');case 4:return e.push('<table hidden id="'),e.push(n.segmentPrefix),n=r.toString(16),e.push(n),e.push('">');case 5:return e.push('<table hidden><tbody id="'),e.push(n.segmentPrefix),n=r.toString(16),e.push(n),e.push('">');case 6:return e.push('<table hidden><tr id="'),e.push(n.segmentPrefix),n=r.toString(16),e.push(n),e.push('">');case 7:return e.push('<table hidden><colgroup id="'),e.push(n.segmentPrefix),n=r.toString(16),e.push(n),e.push('">');default:throw Error(t(397))}}(n,e.responseState,i.formatContext,i.id),tt(e,n,i),function(e,n){switch(n.insertionMode){case 0:case 1:return e.push("</div>");case 2:return e.push("</svg>");case 3:return e.push("</math>");case 4:return e.push("</table>");case 5:return e.push("</tbody></table>");case 6:return e.push("</tr></table>");case 7:return e.push("</colgroup></table>");default:throw Error(t(397))}}(n,i.formatContext)}function it(e,n,i){for(var r=i.completedSegments,o=0;o<r.length;o++)rt(e,n,i,r[o]);if(r.length=0,e=e.responseState,r=i.id,i=i.rootSegmentID,n.push(e.startInlineScript),e.sentCompleteBoundaryFunction?n.push('$RC("'):(e.sentCompleteBoundaryFunction=!0,n.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),null===r)throw Error(t(395));return i=i.toString(16),n.push(r),n.push('","'),n.push(e.segmentPrefix),n.push(i),n.push('")<\/script>')}function rt(e,n,i,r){if(2===r.status)return!0;var o=r.id;if(-1===o){if(-1===(r.id=i.rootSegmentID))throw Error(t(392));return nt(e,n,r)}return nt(e,n,r),e=e.responseState,n.push(e.startInlineScript),e.sentCompleteSegmentFunction?n.push('$RS("'):(e.sentCompleteSegmentFunction=!0,n.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),n.push(e.segmentPrefix),o=o.toString(16),n.push(o),n.push('","'),n.push(e.placeholderPrefix),n.push(o),n.push('")<\/script>')}function ot(e,n){try{var i=e.completedRootSegment;if(null!==i&&0===e.pendingRootTasks){tt(e,n,i),e.completedRootSegment=null;var r=e.responseState.bootstrapChunks;for(i=0;i<r.length-1;i++)n.push(r[i]);i<r.length&&n.push(r[i])}var o,s=e.clientRenderedBoundaries;for(o=0;o<s.length;o++){var a=s[o];r=n;var l=e.responseState,c=a.id,u=a.errorDigest,d=a.errorMessage,h=a.errorComponentStack;if(r.push(l.startInlineScript),l.sentClientRenderFunction?r.push('$RX("'):(l.sentClientRenderFunction=!0,r.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),null===c)throw Error(t(395));if(r.push(c),r.push('"'),u||d||h){r.push(",");var f=L(u||"");r.push(f)}if(d||h){r.push(",");var p=L(d||"");r.push(p)}if(h){r.push(",");var m=L(h);r.push(m)}if(!r.push(")<\/script>"))return e.destination=null,o++,void s.splice(0,o)}s.splice(0,o);var g=e.completedBoundaries;for(o=0;o<g.length;o++)if(!it(e,n,g[o]))return e.destination=null,o++,void g.splice(0,o);g.splice(0,o);var _=e.partialBoundaries;for(o=0;o<_.length;o++){var y=_[o];e:{s=e,a=n;var v=y.completedSegments;for(l=0;l<v.length;l++)if(!rt(s,a,y,v[l])){l++,v.splice(0,l);var b=!1;break e}v.splice(0,l),b=!0}if(!b)return e.destination=null,o++,void _.splice(0,o)}_.splice(0,o);var x=e.completedBoundaries;for(o=0;o<x.length;o++)if(!it(e,n,x[o]))return e.destination=null,o++,void x.splice(0,o);x.splice(0,o)}finally{0===e.allPendingTasks&&0===e.pingedTasks.length&&0===e.clientRenderedBoundaries.length&&0===e.completedBoundaries.length&&n.push(null)}}function st(e,t){try{var n=e.abortableTasks;n.forEach(function(n){return Ke(n,e,t)}),n.clear(),null!==e.destination&&ot(e,e.destination)}catch(i){Ue(e,i),Ve(e,i)}}function at(){}function lt(e,n,i,r){var o=!1,s=null,a="",l={push:function(e){return null!==e&&(a+=e),!0},destroy:function(e){o=!0,s=e}},c=!1;if(e=function(e,t,n,i,r,o,s){var a=[],l=new Set;return(n=ze(t={destination:null,responseState:t,progressiveChunkSize:i,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:l,pingedTasks:a,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:void 0===r?Fe:r,onAllReady:Oe,onShellReady:void 0===s?Oe:s,onShellError:Oe,onFatalError:Oe},0,null,n,!1,!1)).parentFlushed=!0,e=Be(t,e,null,n,l,Z,null,le),a.push(e),t}(e,function(e,t){return{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:(t=void 0===t?"":t)+"P:",segmentPrefix:t+"S:",boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:e}}(i,n?n.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,at,0,function(){c=!0}),Je(e),st(e,r),1===e.status)e.status=2,l.destroy(e.fatalError);else if(2!==e.status&&null===e.destination){e.destination=l;try{ot(e,l)}catch(u){Ue(e,u),Ve(e,u)}}if(o)throw s;if(!c)throw Error(t(426));return a}return oK.renderToNodeStream=function(){throw Error(t(207))},oK.renderToStaticMarkup=function(e,t){return lt(e,t,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},oK.renderToStaticNodeStream=function(){throw Error(t(208))},oK.renderToString=function(e,t){return lt(e,t,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')},oK.version="18.3.1",oK}var aK,lK,cK={};function uK(){if(aK)return cK;aK=1;var e=y();function t(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=null,i=0;function r(e,t){if(0!==t.length)if(512<t.length)0<i&&(e.enqueue(new Uint8Array(n.buffer,0,i)),n=new Uint8Array(512),i=0),e.enqueue(t);else{var r=n.length-i;r<t.length&&(0===r?e.enqueue(n):(n.set(t.subarray(0,r),i),e.enqueue(n),t=t.subarray(r)),n=new Uint8Array(512),i=0),n.set(t,i),i+=t.length}}function o(e,t){return r(e,t),!0}function s(e){n&&0<i&&(e.enqueue(new Uint8Array(n.buffer,0,i)),n=null,i=0)}var a=new TextEncoder;function l(e){return a.encode(e)}function c(e){return a.encode(e)}function u(e,t){"function"==typeof e.error?e.error(t):e.close()}var d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}function g(e,t,n,i,r,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var _={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){_[e]=new g(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];_[t]=new g(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){_[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){_[e]=new g(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){_[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){_[e]=new g(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){_[e]=new g(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){_[e]=new g(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){_[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,b);_[t]=new g(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,b);_[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,b);_[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){_[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)}),_.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){_[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)});var x={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},w=["Webkit","ms","Moz","O"];Object.keys(x).forEach(function(e){w.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),x[t]=x[e]})});var S=/["'&<>]/;function E(e){if("boolean"==typeof e||"number"==typeof e)return""+e;e=""+e;var t=S.exec(e);if(t){var n,i="",r=0;for(n=t.index;n<e.length;n++){switch(e.charCodeAt(n)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}r!==n&&(i+=e.substring(r,n)),r=n+1,i+=t}e=r!==n?i+e.substring(r,n):i}return e}var C=/([A-Z])/g,T=/^ms-/,k=Array.isArray,I=c("<script>"),A=c("<\/script>"),L=c('<script src="'),R=c('<script type="module" src="'),P=c('" async=""><\/script>'),M=/(<\/|<)(s)(cript)/gi;function D(e,t,n,i){return t+("s"===n?"\\u0073":"\\u0053")+i}function N(e,t){return{insertionMode:e,selectedValue:t}}var F=c("\x3c!-- --\x3e");function O(e,t,n,i){return""===t?i:(i&&e.push(F),e.push(l(E(t))),!0)}var B=new Map,z=c(' style="'),U=c(":"),V=c(";");function H(e,n,i){if("object"!=typeof i)throw Error(t(62));for(var r in n=!0,i)if(d.call(i,r)){var o=i[r];if(null!=o&&"boolean"!=typeof o&&""!==o){if(0===r.indexOf("--")){var s=l(E(r));o=l(E((""+o).trim()))}else{s=r;var a=B.get(s);void 0!==a||(a=c(E(s.replace(C,"-$1").toLowerCase().replace(T,"-ms-"))),B.set(s,a)),s=a,o="number"==typeof o?0===o||d.call(x,r)?l(""+o):l(o+"px"):l(E((""+o).trim()))}n?(n=!1,e.push(z,s,U,o)):e.push(V,s,U,o)}}n||e.push(G)}var W=c(" "),$=c('="'),G=c('"'),j=c('=""');function Y(e,t,n,i){switch(n){case"style":return void H(e,t,i);case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])if(null!==(t=_.hasOwnProperty(n)?_[n]:null)){switch(typeof i){case"function":case"symbol":return;case"boolean":if(!t.acceptsBooleans)return}switch(n=l(t.attributeName),t.type){case 3:i&&e.push(W,n,j);break;case 4:!0===i?e.push(W,n,j):!1!==i&&e.push(W,n,$,l(E(i)),G);break;case 5:isNaN(i)||e.push(W,n,$,l(E(i)),G);break;case 6:!isNaN(i)&&1<=i&&e.push(W,n,$,l(E(i)),G);break;default:t.sanitizeURL&&(i=""+i),e.push(W,n,$,l(E(i)),G)}}else if(m(n)){switch(typeof i){case"function":case"symbol":return;case"boolean":if("data-"!==(t=n.toLowerCase().slice(0,5))&&"aria-"!==t)return}e.push(W,l(n),$,l(E(i)),G)}}var q=c(">"),X=c("/>");function K(e,n,i){if(null!=n){if(null!=i)throw Error(t(60));if("object"!=typeof n||!("__html"in n))throw Error(t(61));null!=(n=n.__html)&&e.push(l(""+n))}}var Z=c(' selected=""');function Q(e,t,n,i){e.push(ne(n));var r,o=n=null;for(r in t)if(d.call(t,r)){var s=t[r];if(null!=s)switch(r){case"children":n=s;break;case"dangerouslySetInnerHTML":o=s;break;default:Y(e,i,r,s)}}return e.push(q),K(e,o,n),"string"==typeof n?(e.push(l(E(n))),null):n}var J=c("\n"),ee=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,te=new Map;function ne(e){var n=te.get(e);if(void 0===n){if(!ee.test(e))throw Error(t(65,e));n=c("<"+e),te.set(e,n)}return n}var ie=c("<!DOCTYPE html>");var re=c("</"),oe=c(">"),se=c('<template id="'),ae=c('"></template>'),le=c("\x3c!--$--\x3e"),ce=c('\x3c!--$?--\x3e<template id="'),ue=c('"></template>'),de=c("\x3c!--$!--\x3e"),he=c("\x3c!--/$--\x3e"),fe=c("<template"),pe=c('"'),me=c(' data-dgst="');c(' data-msg="'),c(' data-stck="');var ge=c("></template>");function _e(e,n,i){if(r(e,ce),null===i)throw Error(t(395));return r(e,i),o(e,ue)}var ye=c('<div hidden id="'),ve=c('">'),be=c("</div>"),xe=c('<svg aria-hidden="true" style="display:none" id="'),we=c('">'),Se=c("</svg>"),Ee=c('<math aria-hidden="true" style="display:none" id="'),Ce=c('">'),Te=c("</math>"),ke=c('<table hidden id="'),Ie=c('">'),Ae=c("</table>"),Le=c('<table hidden><tbody id="'),Re=c('">'),Pe=c("</tbody></table>"),Me=c('<table hidden><tr id="'),De=c('">'),Ne=c("</tr></table>"),Fe=c('<table hidden><colgroup id="'),Oe=c('">'),Be=c("</colgroup></table>"),ze=c('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),Ue=c('$RS("'),Ve=c('","'),He=c('")<\/script>'),We=c('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),$e=c('$RC("'),Ge=c('","'),je=c('")<\/script>'),Ye=c('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),qe=c('$RX("'),Xe=c('"'),Ke=c(")<\/script>"),Ze=c(","),Qe=/[<\u2028\u2029]/g;function Je(e){return JSON.stringify(e).replace(Qe,function(e){switch(e){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var et=Object.assign,tt=Symbol.for("react.element"),nt=Symbol.for("react.portal"),it=Symbol.for("react.fragment"),rt=Symbol.for("react.strict_mode"),ot=Symbol.for("react.profiler"),st=Symbol.for("react.provider"),at=Symbol.for("react.context"),lt=Symbol.for("react.forward_ref"),ct=Symbol.for("react.suspense"),ut=Symbol.for("react.suspense_list"),dt=Symbol.for("react.memo"),ht=Symbol.for("react.lazy"),ft=Symbol.for("react.scope"),pt=Symbol.for("react.debug_trace_mode"),mt=Symbol.for("react.legacy_hidden"),gt=Symbol.for("react.default_value"),_t=Symbol.iterator;function yt(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case it:return"Fragment";case nt:return"Portal";case ot:return"Profiler";case rt:return"StrictMode";case ct:return"Suspense";case ut:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case at:return(e.displayName||"Context")+".Consumer";case st:return(e._context.displayName||"Context")+".Provider";case lt:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case dt:return null!==(t=e.displayName||null)?t:yt(e.type)||"Memo";case ht:t=e._payload,e=e._init;try{return yt(e(t))}catch(TD){}}return null}var vt={};function bt(e,t){if(!(e=e.contextTypes))return vt;var n,i={};for(n in e)i[n]=t[n];return i}var xt=null;function wt(e,n){if(e!==n){e.context._currentValue=e.parentValue,e=e.parent;var i=n.parent;if(null===e){if(null!==i)throw Error(t(401))}else{if(null===i)throw Error(t(401));wt(e,i)}n.context._currentValue=n.value}}function St(e){e.context._currentValue=e.parentValue,null!==(e=e.parent)&&St(e)}function Et(e){var t=e.parent;null!==t&&Et(t),e.context._currentValue=e.value}function Ct(e,n){if(e.context._currentValue=e.parentValue,null===(e=e.parent))throw Error(t(402));e.depth===n.depth?wt(e,n):Ct(e,n)}function Tt(e,n){var i=n.parent;if(null===i)throw Error(t(402));e.depth===i.depth?wt(e,i):Tt(e,i),n.context._currentValue=n.value}function kt(e){var t=xt;t!==e&&(null===t?Et(e):null===e?St(t):t.depth===e.depth?wt(t,e):t.depth>e.depth?Ct(t,e):Tt(t,e),xt=e)}var It={isMounted:function(){return!1},enqueueSetState:function(e,t){null!==(e=e._reactInternals).queue&&e.queue.push(t)},enqueueReplaceState:function(e,t){(e=e._reactInternals).replace=!0,e.queue=[t]},enqueueForceUpdate:function(){}};function At(e,t,n,i){var r=void 0!==e.state?e.state:null;e.updater=It,e.props=n,e.state=r;var o={queue:[],replace:!1};e._reactInternals=o;var s=t.contextType;if(e.context="object"==typeof s&&null!==s?s._currentValue:i,"function"==typeof(s=t.getDerivedStateFromProps)&&(r=null==(s=s(n,r))?r:et({},r,s),e.state=r),"function"!=typeof t.getDerivedStateFromProps&&"function"!=typeof e.getSnapshotBeforeUpdate&&("function"==typeof e.UNSAFE_componentWillMount||"function"==typeof e.componentWillMount))if(t=e.state,"function"==typeof e.componentWillMount&&e.componentWillMount(),"function"==typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),t!==e.state&&It.enqueueReplaceState(e,e.state,null),null!==o.queue&&0<o.queue.length)if(t=o.queue,s=o.replace,o.queue=null,o.replace=!1,s&&1===t.length)e.state=t[0];else{for(o=s?t[0]:e.state,r=!0,s=s?1:0;s<t.length;s++){var a=t[s];null!=(a="function"==typeof a?a.call(e,o,n,i):a)&&(r?(r=!1,o=et({},o,a)):et(o,a))}e.state=o}else o.queue=null}var Lt={id:1,overflow:""};function Rt(e,t,n){var i=e.id;e=e.overflow;var r=32-Pt(i)-1;i&=~(1<<r),n+=1;var o=32-Pt(t)+r;if(30<o){var s=r-r%5;return o=(i&(1<<s)-1).toString(32),i>>=s,r-=s,{id:1<<32-Pt(t)+r|n<<r|i,overflow:o+e}}return{id:1<<o|n<<r|i,overflow:e}}var Pt=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(Mt(e)/Dt|0)|0},Mt=Math.log,Dt=Math.LN2,Nt="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Ot=null,Bt=null,zt=null,Ut=null,Vt=!1,Ht=!1,Wt=0,$t=null,Gt=0;function jt(){if(null===Ot)throw Error(t(321));return Ot}function Yt(){if(0<Gt)throw Error(t(312));return{memoizedState:null,queue:null,next:null}}function qt(){return null===Ut?null===zt?(Vt=!1,zt=Ut=Yt()):(Vt=!0,Ut=zt):null===Ut.next?(Vt=!1,Ut=Ut.next=Yt()):(Vt=!0,Ut=Ut.next),Ut}function Xt(){Bt=Ot=null,Ht=!1,zt=null,Gt=0,Ut=$t=null}function Kt(e,t){return"function"==typeof t?t(e):t}function Zt(e,t,n){if(Ot=jt(),Ut=qt(),Vt){var i=Ut.queue;if(t=i.dispatch,null!==$t&&void 0!==(n=$t.get(i))){$t.delete(i),i=Ut.memoizedState;do{i=e(i,n.action),n=n.next}while(null!==n);return Ut.memoizedState=i,[i,t]}return[Ut.memoizedState,t]}return e=e===Kt?"function"==typeof t?t():t:void 0!==n?n(t):t,Ut.memoizedState=e,e=(e=Ut.queue={last:null,dispatch:null}).dispatch=Jt.bind(null,Ot,e),[Ut.memoizedState,e]}function Qt(e,t){if(Ot=jt(),t=void 0===t?null:t,null!==(Ut=qt())){var n=Ut.memoizedState;if(null!==n&&null!==t){var i=n[1];e:if(null===i)i=!1;else{for(var r=0;r<i.length&&r<t.length;r++)if(!Nt(t[r],i[r])){i=!1;break e}i=!0}if(i)return n[0]}}return e=e(),Ut.memoizedState=[e,t],e}function Jt(e,n,i){if(25<=Gt)throw Error(t(301));if(e===Ot)if(Ht=!0,e={action:i,next:null},null===$t&&($t=new Map),void 0===(i=$t.get(n)))$t.set(n,e);else{for(n=i;null!==n.next;)n=n.next;n.next=e}}function en(){throw Error(t(394))}function tn(){}var nn={readContext:function(e){return e._currentValue},useContext:function(e){return jt(),e._currentValue},useMemo:Qt,useReducer:Zt,useRef:function(e){Ot=jt();var t=(Ut=qt()).memoizedState;return null===t?(e={current:e},Ut.memoizedState=e):t},useState:function(e){return Zt(Kt,e)},useInsertionEffect:tn,useLayoutEffect:function(){},useCallback:function(e,t){return Qt(function(){return e},t)},useImperativeHandle:tn,useEffect:tn,useDebugValue:tn,useDeferredValue:function(e){return jt(),e},useTransition:function(){return jt(),[!1,en]},useId:function(){var e=Bt.treeContext,n=e.overflow;e=((e=e.id)&~(1<<32-Pt(e)-1)).toString(32)+n;var i=rn;if(null===i)throw Error(t(404));return n=Wt++,e=":"+i.idPrefix+"R"+e,0<n&&(e+="H"+n.toString(32)),e+":"},useMutableSource:function(e,t){return jt(),t(e._source)},useSyncExternalStore:function(e,n,i){if(void 0===i)throw Error(t(407));return i()}},rn=null,on=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function sn(e){return null}function an(){}function ln(e,t,n,i,r,o,s,a){e.allPendingTasks++,null===n?e.pendingRootTasks++:n.pendingTasks++;var l={node:t,ping:function(){var t=e.pingedTasks;t.push(l),1===t.length&&Sn(e)},blockedBoundary:n,blockedSegment:i,abortSet:r,legacyContext:o,context:s,treeContext:a};return r.add(l),l}function cn(e,t,n,i,r,o){return{status:0,id:-1,index:t,parentFlushed:!1,chunks:[],children:[],formatContext:i,boundary:n,lastPushedText:r,textEmbedded:o}}function un(e,t){if(null!=(e=e.onError(t))&&"string"!=typeof e)throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof e+'" instead');return e}function dn(e,t){var n=e.onShellError;n(t),(n=e.onFatalError)(t),null!==e.destination?(e.status=2,u(e.destination,t)):(e.status=1,e.fatalError=t)}function hn(e,t,n,i,r){for(Ot={},Bt=t,Wt=0,e=n(i,r);Ht;)Ht=!1,Wt=0,Gt+=1,Ut=null,e=n(i,r);return Xt(),e}function fn(e,n,i,r){var o=i.render(),s=r.childContextTypes;if(null!=s){var a=n.legacyContext;if("function"!=typeof i.getChildContext)r=a;else{for(var l in i=i.getChildContext())if(!(l in s))throw Error(t(108,yt(r)||"Unknown",l));r=et({},a,i)}n.legacyContext=r,gn(e,n,o),n.legacyContext=a}else gn(e,n,o)}function pn(e,t){if(e&&e.defaultProps){for(var n in t=et({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function mn(n,i,r,o,s){if("function"==typeof r)if(r.prototype&&r.prototype.isReactComponent){s=bt(r,i.legacyContext);var a=r.contextType;At(a=new r(o,"object"==typeof a&&null!==a?a._currentValue:s),r,o,s),fn(n,i,a,r)}else{s=hn(n,i,r,o,a=bt(r,i.legacyContext));var c=0!==Wt;if("object"==typeof s&&null!==s&&"function"==typeof s.render&&void 0===s.$$typeof)At(s,r,o,a),fn(n,i,s,r);else if(c){o=i.treeContext,i.treeContext=Rt(o,1,0);try{gn(n,i,s)}finally{i.treeContext=o}}else gn(n,i,s)}else{if("string"!=typeof r){switch(r){case mt:case pt:case rt:case ot:case it:case ut:return void gn(n,i,o.children);case ft:throw Error(t(343));case ct:e:{r=i.blockedBoundary,s=i.blockedSegment,a=o.fallback,o=o.children;var u={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:c=new Set,errorDigest:null},h=cn(0,s.chunks.length,u,s.formatContext,!1,!1);s.children.push(h),s.lastPushedText=!1;var f=cn(0,0,null,s.formatContext,!1,!1);f.parentFlushed=!0,i.blockedBoundary=u,i.blockedSegment=f;try{if(yn(n,i,o),f.lastPushedText&&f.textEmbedded&&f.chunks.push(F),f.status=1,xn(u,f),0===u.pendingTasks)break e}catch(Ft){f.status=4,u.forceClientRender=!0,u.errorDigest=un(n,Ft)}finally{i.blockedBoundary=r,i.blockedSegment=s}i=ln(n,a,r,h,c,i.legacyContext,i.context,i.treeContext),n.pingedTasks.push(i)}return}if("object"==typeof r&&null!==r)switch(r.$$typeof){case lt:if(o=hn(n,i,r.render,o,s),0!==Wt){r=i.treeContext,i.treeContext=Rt(r,1,0);try{gn(n,i,o)}finally{i.treeContext=r}}else gn(n,i,o);return;case dt:return void mn(n,i,r=r.type,o=pn(r,o),s);case st:if(s=o.children,r=r._context,o=o.value,a=r._currentValue,r._currentValue=o,xt=o={parent:c=xt,depth:null===c?0:c.depth+1,context:r,parentValue:a,value:o},i.context=o,gn(n,i,s),null===(n=xt))throw Error(t(403));return o=n.parentValue,n.context._currentValue=o===gt?n.context._defaultValue:o,n=xt=n.parent,void(i.context=n);case at:return void gn(n,i,o=(o=o.children)(r._currentValue));case ht:return void mn(n,i,r=(s=r._init)(r._payload),o=pn(r,o),void 0)}throw Error(t(130,null==r?r:typeof r,""))}switch(a=function(n,i,r,o,s){switch(i){case"select":n.push(ne("select"));var a=null,c=null;for(p in r)if(d.call(r,p)){var u=r[p];if(null!=u)switch(p){case"children":a=u;break;case"dangerouslySetInnerHTML":c=u;break;case"defaultValue":case"value":break;default:Y(n,o,p,u)}}return n.push(q),K(n,c,a),a;case"option":c=s.selectedValue,n.push(ne("option"));var h=u=null,f=null,p=null;for(a in r)if(d.call(r,a)){var g=r[a];if(null!=g)switch(a){case"children":u=g;break;case"selected":f=g;break;case"dangerouslySetInnerHTML":p=g;break;case"value":h=g;default:Y(n,o,a,g)}}if(null!=c)if(r=null!==h?""+h:function(t){var n="";return e.Children.forEach(t,function(e){null!=e&&(n+=e)}),n}(u),k(c)){for(o=0;o<c.length;o++)if(""+c[o]===r){n.push(Z);break}}else""+c===r&&n.push(Z);else f&&n.push(Z);return n.push(q),K(n,p,u),u;case"textarea":for(u in n.push(ne("textarea")),p=c=a=null,r)if(d.call(r,u)&&null!=(h=r[u]))switch(u){case"children":p=h;break;case"value":a=h;break;case"defaultValue":c=h;break;case"dangerouslySetInnerHTML":throw Error(t(91));default:Y(n,o,u,h)}if(null===a&&null!==c&&(a=c),n.push(q),null!=p){if(null!=a)throw Error(t(92));if(k(p)&&1<p.length)throw Error(t(93));a=""+p}return"string"==typeof a&&"\n"===a[0]&&n.push(J),null!==a&&n.push(l(E(""+a))),null;case"input":for(c in n.push(ne("input")),h=p=u=a=null,r)if(d.call(r,c)&&null!=(f=r[c]))switch(c){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,"input"));case"defaultChecked":h=f;break;case"defaultValue":u=f;break;case"checked":p=f;break;case"value":a=f;break;default:Y(n,o,c,f)}return null!==p?Y(n,o,"checked",p):null!==h&&Y(n,o,"checked",h),null!==a?Y(n,o,"value",a):null!==u&&Y(n,o,"value",u),n.push(X),null;case"menuitem":for(var _ in n.push(ne("menuitem")),r)if(d.call(r,_)&&null!=(a=r[_]))switch(_){case"children":case"dangerouslySetInnerHTML":throw Error(t(400));default:Y(n,o,_,a)}return n.push(q),null;case"title":for(g in n.push(ne("title")),a=null,r)if(d.call(r,g)&&null!=(c=r[g]))switch(g){case"children":a=c;break;case"dangerouslySetInnerHTML":throw Error(t(434));default:Y(n,o,g,c)}return n.push(q),a;case"listing":case"pre":for(h in n.push(ne(i)),c=a=null,r)if(d.call(r,h)&&null!=(u=r[h]))switch(h){case"children":a=u;break;case"dangerouslySetInnerHTML":c=u;break;default:Y(n,o,h,u)}if(n.push(q),null!=c){if(null!=a)throw Error(t(60));if("object"!=typeof c||!("__html"in c))throw Error(t(61));null!=(r=c.__html)&&("string"==typeof r&&0<r.length&&"\n"===r[0]?n.push(J,l(r)):n.push(l(""+r)))}return"string"==typeof a&&"\n"===a[0]&&n.push(J),a;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":for(var y in n.push(ne(i)),r)if(d.call(r,y)&&null!=(a=r[y]))switch(y){case"children":case"dangerouslySetInnerHTML":throw Error(t(399,i));default:Y(n,o,y,a)}return n.push(X),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return Q(n,r,i,o);case"html":return 0===s.insertionMode&&n.push(ie),Q(n,r,i,o);default:if(-1===i.indexOf("-")&&"string"!=typeof r.is)return Q(n,r,i,o);for(f in n.push(ne(i)),c=a=null,r)if(d.call(r,f)&&null!=(u=r[f]))switch(f){case"children":a=u;break;case"dangerouslySetInnerHTML":c=u;break;case"style":H(n,o,u);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:m(f)&&"function"!=typeof u&&"symbol"!=typeof u&&n.push(W,l(f),$,l(E(u)),G)}return n.push(q),K(n,c,a),a}}((s=i.blockedSegment).chunks,r,o,n.responseState,s.formatContext),s.lastPushedText=!1,c=s.formatContext,s.formatContext=function(e,t,n){switch(t){case"select":return N(1,null!=n.value?n.value:n.defaultValue);case"svg":return N(2,null);case"math":return N(3,null);case"foreignObject":return N(1,null);case"table":return N(4,null);case"thead":case"tbody":case"tfoot":return N(5,null);case"colgroup":return N(7,null);case"tr":return N(6,null)}return 4<=e.insertionMode||0===e.insertionMode?N(1,null):e}(c,r,o),yn(n,i,a),s.formatContext=c,r){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:s.chunks.push(re,l(r),oe)}s.lastPushedText=!1}}function gn(e,n,i){if(n.node=i,"object"==typeof i&&null!==i){switch(i.$$typeof){case tt:return void mn(e,n,i.type,i.props,i.ref);case nt:throw Error(t(257));case ht:var r=i._init;return void gn(e,n,i=r(i._payload))}if(k(i))return void _n(e,n,i);if((r=null===i||"object"!=typeof i?null:"function"==typeof(r=_t&&i[_t]||i["@@iterator"])?r:null)&&(r=r.call(i))){if(!(i=r.next()).done){var o=[];do{o.push(i.value),i=r.next()}while(!i.done);_n(e,n,o)}return}throw e=Object.prototype.toString.call(i),Error(t(31,"[object Object]"===e?"object with keys {"+Object.keys(i).join(", ")+"}":e))}"string"==typeof i?(r=n.blockedSegment).lastPushedText=O(n.blockedSegment.chunks,i,e.responseState,r.lastPushedText):"number"==typeof i&&((r=n.blockedSegment).lastPushedText=O(n.blockedSegment.chunks,""+i,e.responseState,r.lastPushedText))}function _n(e,t,n){for(var i=n.length,r=0;r<i;r++){var o=t.treeContext;t.treeContext=Rt(o,i,r);try{yn(e,t,n[r])}finally{t.treeContext=o}}}function yn(e,t,n){var i=t.blockedSegment.formatContext,r=t.legacyContext,o=t.context;try{return gn(e,t,n)}catch(l){if(Xt(),"object"!=typeof l||null===l||"function"!=typeof l.then)throw t.blockedSegment.formatContext=i,t.legacyContext=r,t.context=o,kt(o),l;n=l;var s=t.blockedSegment,a=cn(0,s.chunks.length,null,s.formatContext,s.lastPushedText,!0);s.children.push(a),s.lastPushedText=!1,e=ln(e,t.node,t.blockedBoundary,a,t.abortSet,t.legacyContext,t.context,t.treeContext).ping,n.then(e,e),t.blockedSegment.formatContext=i,t.legacyContext=r,t.context=o,kt(o)}}function vn(e){var t=e.blockedBoundary;(e=e.blockedSegment).status=3,wn(this,t,e)}function bn(e,n,i){var r=e.blockedBoundary;e.blockedSegment.status=3,null===r?(n.allPendingTasks--,2!==n.status&&(n.status=2,null!==n.destination&&n.destination.close())):(r.pendingTasks--,r.forceClientRender||(r.forceClientRender=!0,e=void 0===i?Error(t(432)):i,r.errorDigest=n.onError(e),r.parentFlushed&&n.clientRenderedBoundaries.push(r)),r.fallbackAbortableTasks.forEach(function(e){return bn(e,n,i)}),r.fallbackAbortableTasks.clear(),n.allPendingTasks--,0===n.allPendingTasks&&(r=n.onAllReady)())}function xn(e,t){if(0===t.chunks.length&&1===t.children.length&&null===t.children[0].boundary){var n=t.children[0];n.id=t.id,n.parentFlushed=!0,1===n.status&&xn(e,n)}else e.completedSegments.push(t)}function wn(e,n,i){if(null===n){if(i.parentFlushed){if(null!==e.completedRootSegment)throw Error(t(389));e.completedRootSegment=i}e.pendingRootTasks--,0===e.pendingRootTasks&&(e.onShellError=an,(n=e.onShellReady)())}else n.pendingTasks--,n.forceClientRender||(0===n.pendingTasks?(i.parentFlushed&&1===i.status&&xn(n,i),n.parentFlushed&&e.completedBoundaries.push(n),n.fallbackAbortableTasks.forEach(vn,e),n.fallbackAbortableTasks.clear()):i.parentFlushed&&1===i.status&&(xn(n,i),1===n.completedSegments.length&&n.parentFlushed&&e.partialBoundaries.push(n)));e.allPendingTasks--,0===e.allPendingTasks&&(e=e.onAllReady)()}function Sn(e){if(2!==e.status){var t=xt,n=on.current;on.current=nn;var i=rn;rn=e.responseState;try{var r,o=e.pingedTasks;for(r=0;r<o.length;r++){var s=o[r],a=e,l=s.blockedSegment;if(0===l.status){kt(s.context);try{gn(a,s,s.node),l.lastPushedText&&l.textEmbedded&&l.chunks.push(F),s.abortSet.delete(s),l.status=1,wn(a,s.blockedBoundary,l)}catch(f){if(Xt(),"object"==typeof f&&null!==f&&"function"==typeof f.then){var c=s.ping;f.then(c,c)}else{s.abortSet.delete(s),l.status=4;var u=s.blockedBoundary,d=f,h=un(a,d);null===u?dn(a,d):(u.pendingTasks--,u.forceClientRender||(u.forceClientRender=!0,u.errorDigest=h,u.parentFlushed&&a.clientRenderedBoundaries.push(u))),a.allPendingTasks--,0===a.allPendingTasks&&(0,a.onAllReady)()}}}}o.splice(0,r),null!==e.destination&&An(e,e.destination)}catch(f){un(e,f),dn(e,f)}finally{rn=i,on.current=n,n===nn&&kt(t)}}}function En(e,n,i){switch(i.parentFlushed=!0,i.status){case 0:var s=i.id=e.nextSegmentId++;return i.lastPushedText=!1,i.textEmbedded=!1,e=e.responseState,r(n,se),r(n,e.placeholderPrefix),r(n,e=l(s.toString(16))),o(n,ae);case 1:i.status=2;var a=!0;s=i.chunks;var c=0;i=i.children;for(var u=0;u<i.length;u++){for(a=i[u];c<a.index;c++)r(n,s[c]);a=Cn(e,n,a)}for(;c<s.length-1;c++)r(n,s[c]);return c<s.length&&(a=o(n,s[c])),a;default:throw Error(t(390))}}function Cn(e,n,i){var s=i.boundary;if(null===s)return En(e,n,i);if(s.parentFlushed=!0,s.forceClientRender)s=s.errorDigest,o(n,de),r(n,fe),s&&(r(n,me),r(n,l(E(s))),r(n,pe)),o(n,ge),En(e,n,i);else if(0<s.pendingTasks){s.rootSegmentID=e.nextSegmentId++,0<s.completedSegments.length&&e.partialBoundaries.push(s);var a=e.responseState,u=a.nextSuspenseID++;a=c(a.boundaryPrefix+u.toString(16)),s=s.id=a,_e(n,e.responseState,s),En(e,n,i)}else if(s.byteSize>e.progressiveChunkSize)s.rootSegmentID=e.nextSegmentId++,e.completedBoundaries.push(s),_e(n,e.responseState,s.id),En(e,n,i);else{if(o(n,le),1!==(i=s.completedSegments).length)throw Error(t(391));Cn(e,n,i[0])}return o(n,he)}function Tn(e,n,i){return function(e,n,i,s){switch(i.insertionMode){case 0:case 1:return r(e,ye),r(e,n.segmentPrefix),r(e,l(s.toString(16))),o(e,ve);case 2:return r(e,xe),r(e,n.segmentPrefix),r(e,l(s.toString(16))),o(e,we);case 3:return r(e,Ee),r(e,n.segmentPrefix),r(e,l(s.toString(16))),o(e,Ce);case 4:return r(e,ke),r(e,n.segmentPrefix),r(e,l(s.toString(16))),o(e,Ie);case 5:return r(e,Le),r(e,n.segmentPrefix),r(e,l(s.toString(16))),o(e,Re);case 6:return r(e,Me),r(e,n.segmentPrefix),r(e,l(s.toString(16))),o(e,De);case 7:return r(e,Fe),r(e,n.segmentPrefix),r(e,l(s.toString(16))),o(e,Oe);default:throw Error(t(397))}}(n,e.responseState,i.formatContext,i.id),Cn(e,n,i),function(e,n){switch(n.insertionMode){case 0:case 1:return o(e,be);case 2:return o(e,Se);case 3:return o(e,Te);case 4:return o(e,Ae);case 5:return o(e,Pe);case 6:return o(e,Ne);case 7:return o(e,Be);default:throw Error(t(397))}}(n,i.formatContext)}function kn(e,n,i){for(var s=i.completedSegments,a=0;a<s.length;a++)In(e,n,i,s[a]);if(s.length=0,e=e.responseState,s=i.id,i=i.rootSegmentID,r(n,e.startInlineScript),e.sentCompleteBoundaryFunction?r(n,$e):(e.sentCompleteBoundaryFunction=!0,r(n,We)),null===s)throw Error(t(395));return i=l(i.toString(16)),r(n,s),r(n,Ge),r(n,e.segmentPrefix),r(n,i),o(n,je)}function In(e,n,i,s){if(2===s.status)return!0;var a=s.id;if(-1===a){if(-1===(s.id=i.rootSegmentID))throw Error(t(392));return Tn(e,n,s)}return Tn(e,n,s),r(n,(e=e.responseState).startInlineScript),e.sentCompleteSegmentFunction?r(n,Ue):(e.sentCompleteSegmentFunction=!0,r(n,ze)),r(n,e.segmentPrefix),r(n,a=l(a.toString(16))),r(n,Ve),r(n,e.placeholderPrefix),r(n,a),o(n,He)}function An(e,a){n=new Uint8Array(512),i=0;try{var c=e.completedRootSegment;if(null!==c&&0===e.pendingRootTasks){Cn(e,a,c),e.completedRootSegment=null;var u=e.responseState.bootstrapChunks;for(c=0;c<u.length-1;c++)r(a,u[c]);c<u.length&&o(a,u[c])}var d,h=e.clientRenderedBoundaries;for(d=0;d<h.length;d++){var f=h[d];u=a;var p=e.responseState,m=f.id,g=f.errorDigest,_=f.errorMessage,y=f.errorComponentStack;if(r(u,p.startInlineScript),p.sentClientRenderFunction?r(u,qe):(p.sentClientRenderFunction=!0,r(u,Ye)),null===m)throw Error(t(395));r(u,m),r(u,Xe),(g||_||y)&&(r(u,Ze),r(u,l(Je(g||"")))),(_||y)&&(r(u,Ze),r(u,l(Je(_||"")))),y&&(r(u,Ze),r(u,l(Je(y)))),o(u,Ke)}h.splice(0,d);var v=e.completedBoundaries;for(d=0;d<v.length;d++)kn(e,a,v[d]);v.splice(0,d),s(a),n=new Uint8Array(512),i=0;var b=e.partialBoundaries;for(d=0;d<b.length;d++){var x=b[d];e:{h=e,f=a;var w=x.completedSegments;for(p=0;p<w.length;p++)if(!In(h,f,x,w[p])){p++,w.splice(0,p);var S=!1;break e}w.splice(0,p),S=!0}if(!S)return e.destination=null,d++,void b.splice(0,d)}b.splice(0,d);var E=e.completedBoundaries;for(d=0;d<E.length;d++)kn(e,a,E[d]);E.splice(0,d)}finally{s(a),0===e.allPendingTasks&&0===e.pingedTasks.length&&0===e.clientRenderedBoundaries.length&&0===e.completedBoundaries.length&&a.close()}}function Ln(e,t){try{var n=e.abortableTasks;n.forEach(function(n){return bn(n,e,t)}),n.clear(),null!==e.destination&&An(e,e.destination)}catch(i){un(e,i),dn(e,i)}}return cK.renderToReadableStream=function(e,t){return new Promise(function(n,i){var r,o,s=new Promise(function(e,t){o=e,r=t}),a=function(e,t,n,i,r,o,s,a,l){var c=[],u=new Set;return(n=cn(t={destination:null,responseState:t,progressiveChunkSize:void 0===i?12800:i,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:u,pingedTasks:c,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:void 0===r?sn:r,onAllReady:void 0===o?an:o,onShellReady:void 0===s?an:s,onShellError:void 0===a?an:a,onFatalError:void 0===l?an:l},0,null,n,!1,!1)).parentFlushed=!0,e=ln(t,e,null,n,u,vt,null,Lt),c.push(e),t}(e,function(e,t,n,i,r){e=void 0===e?"":e,t=void 0===t?I:c('<script nonce="'+E(t)+'">');var o=[];if(void 0!==n&&o.push(t,l((""+n).replace(M,D)),A),void 0!==i)for(n=0;n<i.length;n++)o.push(L,l(E(i[n])),P);if(void 0!==r)for(i=0;i<r.length;i++)o.push(R,l(E(r[i])),P);return{bootstrapChunks:o,startInlineScript:t,placeholderPrefix:c(e+"P:"),segmentPrefix:c(e+"S:"),boundaryPrefix:e+"B:",idPrefix:e,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}(t?t.identifierPrefix:void 0,t?t.nonce:void 0,t?t.bootstrapScriptContent:void 0,t?t.bootstrapScripts:void 0,t?t.bootstrapModules:void 0),function(e){return N("http://www.w3.org/2000/svg"===e?2:"http://www.w3.org/1998/Math/MathML"===e?3:0,null)}(t?t.namespaceURI:void 0),t?t.progressiveChunkSize:void 0,t?t.onError:void 0,o,function(){var e=new ReadableStream({type:"bytes",pull:function(e){if(1===a.status)a.status=2,u(e,a.fatalError);else if(2!==a.status&&null===a.destination){a.destination=e;try{An(a,e)}catch(t){un(a,t),dn(a,t)}}},cancel:function(){Ln(a)}},{highWaterMark:0});e.allReady=s,n(e)},function(e){s.catch(function(){}),i(e)},r);if(t&&t.signal){var d=t.signal,h=function(){Ln(a,d.reason),d.removeEventListener("abort",h)};d.addEventListener("abort",h)}Sn(a)})},cK.version="18.3.1",cK}!function(){return lK||(lK=1,e=sK(),t=uK(),rK.version=e.version,rK.renderToString=e.renderToString,rK.renderToStaticMarkup=e.renderToStaticMarkup,rK.renderToNodeStream=e.renderToNodeStream,rK.renderToStaticNodeStream=e.renderToStaticNodeStream,rK.renderToReadableStream=t.renderToReadableStream),rK;var e,t}();export{bd as $,ch as A,gs as B,Ju as C,rh as D,Zu as E,Ed as F,yd as G,xs as H,Eh as I,Qu as J,fh as K,lt as L,vh as M,Xd as N,_d as O,ra as Q,$d as T,vs as U,wa as X,B as _,x as a,Ss as b,j as c,xa as d,F as e,N as f,bs as g,oa as h,bq as i,v as j,_s as k,eq as l,QX as m,md as n,Hh as o,Yd as p,ah as q,b as r,jd as s,Ih as t,$h as u,gh as v,Sd as w,ba as x,Gt as y,ia as z};
